{
  "version": 3,
  "sources": ["../src/core/types.ts", "../src/core/state.ts", "../src/core/event-stream.ts", "../node_modules/zod/v3/external.js", "../node_modules/zod/v3/helpers/util.js", "../node_modules/zod/v3/ZodError.js", "../node_modules/zod/v3/locales/en.js", "../node_modules/zod/v3/errors.js", "../node_modules/zod/v3/helpers/parseUtil.js", "../node_modules/zod/v3/helpers/errorUtil.js", "../node_modules/zod/v3/types.js", "../src/core/tool-registry.ts", "../src/core/error-handler.ts", "../src/core/node.ts", "../src/core/runner/node-executor.ts", "../src/core/runner/next-node-resolver.ts", "../src/core/runner/checkpoint-manager.ts", "../src/core/runner.ts", "../src/core/llm-provider.ts", "../src/providers/openai-provider.ts", "../src/providers/gemini-provider.ts", "../src/providers/lm-studio-provider.ts", "../src/providers/provider-factory.ts", "../src/nodes/llm-planner.ts", "../src/core/schema-utils.ts", "../src/nodes/tool-call-decider.ts", "../src/nodes/tool-runner.ts", "../src/nodes/confirmation.ts", "../src/nodes/verifier.ts", "../src/nodes/responder.ts", "../src/nodes/llm-responder.ts", "../src/core/memory/memory-heuristics.ts", "../src/nodes/memory.ts", "../src/core/agent-utils.ts", "../src/core/abort-controller.ts", "../src/core/intent-router.ts", "../src/core/audit.ts", "../src/core/rbac.ts", "../src/core/memory/chat-memory.ts", "../src/core/agent.ts", "../src/core/debug-bundle.ts", "../src/nodes/planner.ts", "../src/tools/example-tools.ts", "../src/core/llm-service/cache.ts", "../src/core/llm-service/stats.ts", "../src/core/llm-service/types.ts", "../src/core/llm-service/service.ts", "../src/core/llm-service/middlewares.ts"],
  "sourcesContent": ["/**\n * \u6838\u5FC3\u7C7B\u578B\u5B9A\u4E49\n * \u5B9A\u4E49\u6846\u67B6\u7684\u6240\u6709\u6838\u5FC3\u63A5\u53E3\u4E0E\u7C7B\u578B\n */\n\nimport { z } from 'zod';\n\n// ============================================================================\n// State \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\n/** \u5BF9\u8BDD\u6D88\u606F */\nexport interface Message {\n    role: 'user' | 'assistant' | 'system' | 'tool';\n    content: string;\n    timestamp: number;\n    metadata?: Record<string, unknown>;\n}\n\n/** \u5BF9\u8BDD\u4E0A\u4E0B\u6587 */\nexport interface Conversation {\n    messages: Message[];\n    systemPrompt?: string;\n    toolResultsSummary: string[]; // \u5DE5\u5177\u7ED3\u679C\u6458\u8981\n}\n\n/** \u4EFB\u52A1\u5B50\u6B65\u9AA4 */\nexport interface TaskStep {\n    id: string;\n    description: string;\n    status: 'pending' | 'running' | 'completed' | 'failed';\n    result?: unknown;\n    error?: string;\n}\n\n/** \u4EFB\u52A1\u4FE1\u606F */\nexport interface Task {\n    goal: string; // \u7528\u6237\u76EE\u6807\n    plan?: string; // Planner \u4EA7\u51FA\u7684\u8BA1\u5212\n    steps: TaskStep[]; // \u5B50\u4EFB\u52A1\u5217\u8868\n    currentNode: string; // \u5F53\u524D\u6267\u884C\u8282\u70B9\n    currentStepIndex: number; // \u5F53\u524D\u6B65\u9AA4\u7D22\u5F15\n    progress: number; // \u8FDB\u5EA6 0-100\n    pendingToolCall?: PendingToolCall; // \u7B49\u5F85\u786E\u8BA4\u7684\u5DE5\u5177\u8C03\u7528\n}\n\n/** \u8BB0\u5FC6\u5B58\u50A8 */\nexport interface Memory {\n    shortTerm: Record<string, unknown>; // \u77ED\u671F\u4EFB\u52A1\u8BB0\u5FC6\n    longTermKeys: string[]; // \u957F\u671F\u8BB0\u5FC6\u6307\u9488\uFF08\u53EF\u6269\u5C55\u4E3A\u5411\u91CF\u5E93\u952E\uFF09\n}\n\n/** \u5DE5\u4EF6\u5B58\u50A8 */\nexport interface Artifacts {\n    sql?: string[]; // SQL \u8BED\u53E5\n    results?: unknown[]; // \u7ED3\u679C\u96C6\u6458\u8981\n    references?: string[]; // \u5F15\u7528\u6765\u6E90\n    files?: Array<{ name: string; path: string; metadata: Record<string, unknown> }>;\n    [key: string]: unknown; // \u5141\u8BB8\u6269\u5C55\n}\n\n/** \u9065\u6D4B\u6570\u636E */\nexport interface Telemetry {\n    totalDuration: number; // \u603B\u8017\u65F6\uFF08ms\uFF09\n    tokenCount: number; // token \u6570\n    toolCallCount: number; // \u5DE5\u5177\u8C03\u7528\u6B21\u6570\n    errorCount: number; // \u9519\u8BEF\u6B21\u6570\n    retryCount: number; // \u91CD\u8BD5\u6B21\u6570\n    nodeTimings: Record<string, number>; // \u5404\u8282\u70B9\u8017\u65F6\n}\n\n/** \u7B56\u7565\u914D\u7F6E */\nexport interface Policy {\n    maxToolCalls: number; // \u6700\u5927\u5DE5\u5177\u8C03\u7528\u6B21\u6570\n    maxDuration: number; // \u6700\u5927\u603B\u8017\u65F6\uFF08ms\uFF09\n    maxRetries: number; // \u6700\u5927\u91CD\u8BD5\u6B21\u6570\n    allowedTools?: string[]; // \u5141\u8BB8\u7684\u5DE5\u5177\u767D\u540D\u5355\n    permissions: Record<string, boolean>; // \u6743\u9650\u63A7\u5236\n    roles?: string[]; // RBAC \u89D2\u8272\n    useStreaming?: boolean; // \u662F\u5426\u542F\u7528\u6D41\u5F0F\u8F93\u51FA\uFF08\u9ED8\u8BA4 true\uFF09\n    memoryEnabled?: boolean; // \u662F\u5426\u542F\u7528\u8BB0\u5FC6\uFF08\u9ED8\u8BA4\u7531\u914D\u7F6E\u51B3\u5B9A\uFF09\n}\n\n/** \u7EDF\u4E00\u72B6\u6001\u5BB9\u5668 */\nexport interface State {\n    id: string; // \u72B6\u6001\u552F\u4E00 ID\n    conversation: Conversation;\n    task: Task;\n    memory: Memory;\n    artifacts: Artifacts;\n    telemetry: Telemetry;\n    policy: Policy;\n    createdAt: number;\n    updatedAt: number;\n}\n\n// ============================================================================\n// Event \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\nexport type EventType =\n    | 'node_start'\n    | 'node_end'\n    | 'tool_call'\n    | 'tool_result'\n    | 'memory_save'\n    | 'memory_recall'\n    | 'audit'\n    | 'confirmation_required'\n    | 'confirmation_result'\n    | 'error'\n    | 'retry'\n    | 'checkpoint'\n    | 'health_metrics'\n    | 'budget_warning'\n    | 'budget_exceeded'\n    | 'stream_chunk'\n    | 'abort'   // \u4EFB\u52A1\u4E2D\u65AD\n    | 'resume'; // \u4EFB\u52A1\u6062\u590D\n\nexport interface Event {\n    id: string;\n    timestamp: number;\n    type: EventType;\n    nodeId?: string;\n    status: 'success' | 'failure' | 'warning' | 'info';\n    summary: string;\n    payloadRef?: string; // \u6307\u5411\u8BE6\u7EC6\u6570\u636E\u7684\u5F15\u7528\uFF08\u907F\u514D\u4E8B\u4EF6\u8FC7\u5927\uFF09\n    metadata?: Record<string, unknown>;\n}\n\n// ============================================================================\n// Node \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\nexport interface NodeResult {\n    state: State;\n    events: Event[];\n    nextNode?: string; // \u4E0B\u4E00\u4E2A\u8282\u70B9\uFF08\u7528\u4E8E\u52A8\u6001\u8DEF\u7531\uFF09\n}\n\nexport interface Node {\n    id: string;\n    name: string;\n    execute(state: State, context?: NodeContext): Promise<NodeResult>; // \u66F4\u65B0\uFF1A\u589E\u52A0 context \u53C2\u6570\n}\n\n/** \u8282\u70B9\u6267\u884C\u4E0A\u4E0B\u6587 */\nexport interface NodeContext {\n    emitEvent: (type: EventType, status: Event['status'], summary: string, payload?: unknown) => void;\n}\n\n// ============================================================================\n// Tool \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\n/** \u5DE5\u5177\u91CD\u8BD5\u7B56\u7565 */\nexport interface RetryPolicy {\n    maxRetries: number;\n    backoffMs: number; // \u521D\u59CB\u9000\u907F\u65F6\u95F4\n    backoffMultiplier: number; // \u9000\u907F\u500D\u6570\n}\n\n/** \u5DE5\u5177\u5B9A\u4E49 */\nexport interface Tool {\n    name: string;\n    description: string;\n    inputSchema: z.ZodSchema; // \u4F7F\u7528 Zod \u8FDB\u884C schema \u6821\u9A8C\n    outputSchema: z.ZodSchema;\n    timeout: number; // \u8D85\u65F6\u65F6\u95F4\uFF08ms\uFF09\n    retryPolicy: RetryPolicy;\n    permissions: string[]; // \u6240\u9700\u6743\u9650\n    requiresConfirmation?: boolean; // \u662F\u5426\u9700\u8981\u4EBA\u5DE5\u786E\u8BA4\n    confirmationMessage?: string; // \u786E\u8BA4\u63D0\u793A\u6587\u672C\n    allowedNodes?: string[]; // \u5141\u8BB8\u8C03\u7528\u7684\u8282\u70B9\u767D\u540D\u5355\n    execute(input: unknown, context?: ToolContext): Promise<unknown>; // \u66F4\u65B0\uFF1A\u589E\u52A0 context \u53C2\u6570\n}\n\n/** \u5DE5\u5177\u6267\u884C\u4E0A\u4E0B\u6587 */\nexport interface ToolContext {\n    onStream?: (chunk: ToolStreamChunk) => void; // \u6D41\u5F0F\u56DE\u8C03\n    signal?: AbortSignal; // \u4E2D\u65AD\u4FE1\u53F7\n}\n\n/** \u5DE5\u5177\u6D41\u5F0F\u8F93\u51FA\u5757 */\nexport type ToolStreamChunk =\n    | string\n    | {\n        type: 'text' | 'json';\n        content: string;\n        data?: unknown;\n    };\n\n/** \u5F85\u786E\u8BA4\u7684\u5DE5\u5177\u8C03\u7528 */\nexport interface PendingToolCall {\n    toolName: string;\n    input: unknown;\n    stepId: string;\n    stepDescription: string;\n    permissions: string[];\n    confirmationMessage?: string;\n    requestedAt: number;\n    status: 'pending' | 'approved' | 'denied';\n    decisionReason?: string;\n    decidedAt?: number;\n}\n\nexport interface ToolConfirmationRequest {\n    toolName: string;\n    input: unknown;\n    stepId: string;\n    stepDescription: string;\n    permissions: string[];\n    confirmationMessage?: string;\n    requestedAt: number;\n}\n\nexport interface ToolConfirmationDecision {\n    approved: boolean;\n    reason?: string;\n}\n\nexport type ToolConfirmationHandler = (\n    request: ToolConfirmationRequest\n) => Promise<ToolConfirmationDecision | boolean>;\n\n// ============================================================================\n// Error \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\nexport enum ErrorType {\n    NETWORK = 'network',\n    TIMEOUT = 'timeout',\n    PERMISSION = 'permission',\n    VALIDATION = 'validation',\n    EXECUTION = 'execution',\n    EMPTY_RESULT = 'empty_result',\n    UNTRUSTED_RESULT = 'untrusted_result',\n    BUDGET_EXCEEDED = 'budget_exceeded',\n    UNKNOWN = 'unknown',\n}\n\nexport interface AgentError {\n    type: ErrorType;\n    message: string;\n    nodeId?: string;\n    toolName?: string;\n    retryable: boolean;\n    originalError?: Error;\n    timestamp: number;\n}\n\n// ============================================================================\n// Checkpoint \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\nexport interface Checkpoint {\n    id: string;\n    stateId: string;\n    state: State;\n    eventIndex: number; // \u4E8B\u4EF6\u6D41\u7D22\u5F15\n    timestamp: number;\n    metadata?: Record<string, unknown>;\n}\n\n// ============================================================================\n// Graph \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\nexport type EdgeCondition = (state: State) => boolean;\n\nexport interface Edge {\n    from: string;\n    to: string;\n    condition?: EdgeCondition; // \u6761\u4EF6\u8FB9\uFF08\u7528\u4E8E\u5206\u652F\uFF09\n}\n\nexport interface GraphDefinition {\n    nodes: Node[];\n    edges: Edge[];\n    entryNode: string;\n    maxSteps: number; // \u6700\u5927\u6267\u884C\u6B65\u6570\uFF08\u9632\u6B62\u65E0\u9650\u5FAA\u73AF\uFF09\n}\n\n// ============================================================================\n// Persistence \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\nexport interface PersistenceAdapter {\n    saveCheckpoint(checkpoint: Checkpoint): Promise<void>;\n    loadCheckpoint(checkpointId: string): Promise<Checkpoint | null>;\n    listCheckpoints(stateId: string): Promise<Checkpoint[]>;\n    deleteCheckpoint(checkpointId: string): Promise<void>;\n}\n\n// ============================================================================\n// Hooks \u76F8\u5173\u7C7B\u578B\n// ============================================================================\n\nexport interface RunnerHooks {\n    onNodeStart?(nodeId: string, state: State): void | Promise<void>;\n    onNodeEnd?(nodeId: string, result: NodeResult): void | Promise<void>;\n    onToolCall?(toolName: string, input: unknown): void | Promise<void>;\n    onToolResult?(toolName: string, output: unknown): void | Promise<void>;\n    onError?(error: AgentError): void | Promise<void>;\n    onCheckpoint?(checkpoint: Checkpoint): void | Promise<void>;\n    onBudgetWarning?(metric: string, current: number, limit: number): void | Promise<void>;\n}\n", "/**\n * State \u7BA1\u7406\u5668\n * \u63D0\u4F9B State \u7684\u521B\u5EFA\u3001\u66F4\u65B0\u3001\u5E8F\u5217\u5316\u529F\u80FD\n */\n\nimport type { State, Conversation, Task, Memory, Artifacts, Telemetry, Policy } from './types';\n\n/**\n * \u521B\u5EFA\u521D\u59CB State\n */\nexport function createState(goal: string, policy?: Partial<Policy>): State {\n    const now = Date.now();\n\n    return {\n        id: generateId(),\n        conversation: {\n            messages: [],\n            toolResultsSummary: [],\n        },\n        task: {\n            goal,\n            steps: [],\n            currentNode: '',\n            currentStepIndex: 0,\n            progress: 0,\n        },\n        memory: {\n            shortTerm: {},\n            longTermKeys: [],\n        },\n        artifacts: {},\n        telemetry: {\n            totalDuration: 0,\n            tokenCount: 0,\n            toolCallCount: 0,\n            errorCount: 0,\n            retryCount: 0,\n            nodeTimings: {},\n        },\n        policy: {\n            maxToolCalls: 20,\n            maxDuration: 300000, // 5 \u5206\u949F\n            maxRetries: 3,\n            permissions: {},\n            useStreaming: true, // \u9ED8\u8BA4\u542F\u7528\u6D41\u5F0F\n            ...policy,\n        },\n        createdAt: now,\n        updatedAt: now,\n    };\n}\n\n/**\n * \u66F4\u65B0 State\uFF08\u4E0D\u53EF\u53D8\u66F4\u65B0\uFF09\n * \u4F7F\u7528\u6DF1\u62F7\u8D1D\u786E\u4FDD\u4E0D\u53EF\u53D8\u6027\n */\nexport function updateState(\n    state: State,\n    updater: (draft: State) => void | State\n): State {\n    // \u6DF1\u62F7\u8D1D\u5F53\u524D\u72B6\u6001\n    const draft = deepClone(state);\n\n    // \u6267\u884C\u66F4\u65B0\n    const result = updater(draft);\n\n    // \u5982\u679C updater \u8FD4\u56DE\u65B0\u72B6\u6001\uFF0C\u4F7F\u7528\u8FD4\u56DE\u503C\uFF1B\u5426\u5219\u4F7F\u7528 draft\n    const newState = result || draft;\n\n    // \u66F4\u65B0\u65F6\u95F4\u6233\n    newState.updatedAt = Date.now();\n\n    return newState;\n}\n\n/**\n * \u5E8F\u5217\u5316 State\n */\nexport function serializeState(state: State): string {\n    return JSON.stringify(state);\n}\n\n/**\n * \u53CD\u5E8F\u5217\u5316 State\n */\nexport function deserializeState(json: string): State {\n    return JSON.parse(json);\n}\n\n/**\n * \u9A8C\u8BC1 State \u5B8C\u6574\u6027\n */\nexport function validateState(state: State): boolean {\n    return !!(\n        state.id &&\n        state.conversation &&\n        state.task &&\n        state.memory &&\n        state.artifacts &&\n        state.telemetry &&\n        state.policy\n    );\n}\n\n// ============================================================================\n// \u8F85\u52A9\u51FD\u6570\n// ============================================================================\n\nfunction generateId(): string {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\nfunction deepClone<T>(obj: T): T {\n    // \u4F18\u5148\u4F7F\u7528\u73B0\u4EE3\u6D4F\u89C8\u5668/Node \u539F\u751F\u7684\u9AD8\u6027\u80FD\u7ED3\u6784\u5316\u514B\u9686\n    if (typeof structuredClone === 'function') {\n        return structuredClone(obj);\n    }\n\n    if (obj === null || typeof obj !== 'object') {\n        return obj;\n    }\n\n    if (obj instanceof Date) {\n        return new Date(obj.getTime()) as T;\n    }\n\n    if (obj instanceof Array) {\n        return obj.map(item => deepClone(item)) as T;\n    }\n\n    if (obj instanceof Object) {\n        const clonedObj = {} as T;\n        for (const key in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, key)) {\n                clonedObj[key] = deepClone(obj[key]);\n            }\n        }\n        return clonedObj;\n    }\n\n    return obj;\n}\n\n/**\n * \u4FBF\u6377\u7684 State \u66F4\u65B0\u8F85\u52A9\u51FD\u6570\n */\nexport const StateHelpers = {\n    /** \u6DFB\u52A0\u6D88\u606F */\n    addMessage(state: State, role: 'user' | 'assistant' | 'system' | 'tool', content: string) {\n        return updateState(state, draft => {\n            draft.conversation.messages.push({\n                role,\n                content,\n                timestamp: Date.now(),\n            });\n        });\n    },\n\n    /** \u66F4\u65B0\u4EFB\u52A1\u8FDB\u5EA6 */\n    updateProgress(state: State, progress: number) {\n        return updateState(state, draft => {\n            draft.task.progress = Math.min(100, Math.max(0, progress));\n        });\n    },\n\n    /** \u8BBE\u7F6E\u5F53\u524D\u8282\u70B9 */\n    setCurrentNode(state: State, nodeId: string) {\n        return updateState(state, draft => {\n            draft.task.currentNode = nodeId;\n        });\n    },\n\n    /** \u6DFB\u52A0\u5DE5\u5177\u8C03\u7528\u8BA1\u6570 */\n    incrementToolCall(state: State) {\n        return updateState(state, draft => {\n            draft.telemetry.toolCallCount += 1;\n        });\n    },\n\n    /** \u6DFB\u52A0\u9519\u8BEF\u8BA1\u6570 */\n    incrementError(state: State) {\n        return updateState(state, draft => {\n            draft.telemetry.errorCount += 1;\n        });\n    },\n\n    /** \u6DFB\u52A0\u91CD\u8BD5\u8BA1\u6570 */\n    incrementRetry(state: State) {\n        return updateState(state, draft => {\n            draft.telemetry.retryCount += 1;\n        });\n    },\n\n    /** \u8BB0\u5F55\u8282\u70B9\u8017\u65F6 */\n    recordNodeTiming(state: State, nodeId: string, duration: number) {\n        return updateState(state, draft => {\n            draft.telemetry.nodeTimings[nodeId] =\n                (draft.telemetry.nodeTimings[nodeId] || 0) + duration;\n            draft.telemetry.totalDuration += duration;\n        });\n    },\n\n    /** \u8BB0\u5F55 Token \u4F7F\u7528\u60C5\u51B5 */\n    addTokenUsage(state: State, usage: { prompt?: number; completion?: number; total?: number }) {\n        return updateState(state, draft => {\n            if (usage.prompt) draft.telemetry.tokenCount += usage.prompt;\n            if (usage.completion) draft.telemetry.tokenCount += usage.completion;\n            // \u5982\u679C\u53EA\u6709\u603B\u8BA1\uFF0C\u4E14\u6CA1\u6709\u5206\u9879\uFF0C\u5219\u4F7F\u7528\u603B\u8BA1\n            if (!usage.prompt && !usage.completion && usage.total) {\n                draft.telemetry.tokenCount += usage.total;\n            }\n        });\n    },\n\n    /** \u68C0\u67E5\u9884\u7B97\u662F\u5426\u8D85\u9650 */\n    checkBudget(state: State): { exceeded: boolean; reason?: string } {\n        const { telemetry, policy } = state;\n\n        if (telemetry.toolCallCount >= policy.maxToolCalls) {\n            return { exceeded: true, reason: `\u5DE5\u5177\u8C03\u7528\u6B21\u6570\u8D85\u9650 (${telemetry.toolCallCount}/${policy.maxToolCalls})` };\n        }\n\n        if (telemetry.totalDuration >= policy.maxDuration) {\n            return { exceeded: true, reason: `\u603B\u8017\u65F6\u8D85\u9650 (${telemetry.totalDuration}ms/${policy.maxDuration}ms)` };\n        }\n\n        if (telemetry.retryCount >= policy.maxRetries) {\n            return { exceeded: true, reason: `\u91CD\u8BD5\u6B21\u6570\u8D85\u9650 (${telemetry.retryCount}/${policy.maxRetries})` };\n        }\n\n        return { exceeded: false };\n    },\n};\n", "/**\n * \u4E8B\u4EF6\u6D41\u7CFB\u7EDF\n * \u63D0\u4F9B\u4E8B\u4EF6\u53D1\u5C04\u3001\u8BA2\u9605\u3001\u5B58\u50A8\u529F\u80FD\n */\n\nimport type { Event, EventType } from './types';\n\ntype EventListener = (event: Event) => void | Promise<void>;\n\nexport class EventStream {\n    private events: Event[] = [];\n    private listeners: Map<EventType | '*', Set<EventListener>> = new Map();\n    private payloadStore: Map<string, unknown> = new Map();\n\n    /**\n     * \u53D1\u5C04\u4E8B\u4EF6\n     */\n    emit(\n        type: EventType,\n        status: Event['status'],\n        summary: string,\n        options?: {\n            nodeId?: string;\n            payload?: unknown;\n            metadata?: Record<string, unknown>;\n        }\n    ): Event {\n        const event: Event = {\n            id: this.generateEventId(),\n            timestamp: Date.now(),\n            type,\n            status,\n            summary,\n            nodeId: options?.nodeId,\n            metadata: options?.metadata,\n        };\n\n        // \u5982\u679C\u6709 payload\uFF0C\u5B58\u50A8\u5E76\u751F\u6210\u5F15\u7528\n        if (options?.payload !== undefined) {\n            const payloadRef = `payload-${event.id}`;\n            this.payloadStore.set(payloadRef, options.payload);\n            event.payloadRef = payloadRef;\n        }\n\n        this.events.push(event);\n\n        // \u81EA\u52A8\u6E05\u7406\uFF0C\u9632\u6B62\u5185\u5B58\u65E0\u9650\u589E\u957F (Keep last 1000 events)\n        if (this.events.length > 1000) {\n            this.cleanup();\n        }\n\n        // \u89E6\u53D1\u76D1\u542C\u5668\n        this.notifyListeners(type, event);\n        this.notifyListeners('*', event); // \u901A\u914D\u7B26\u76D1\u542C\u5668\n\n        return event;\n    }\n\n    private cleanup() {\n        // \u4FDD\u7559\u6700\u8FD1 1000 \u6761\n        const removalCount = this.events.length - 1000;\n        if (removalCount <= 0) return;\n\n        const removedEvents = this.events.splice(0, removalCount);\n\n        // \u6E05\u7406\u5BF9\u5E94\u7684 payload\n        removedEvents.forEach(evt => {\n            if (evt.payloadRef) {\n                this.payloadStore.delete(evt.payloadRef);\n            }\n        });\n    }\n\n    /**\n     * \u8BA2\u9605\u4E8B\u4EF6\n     */\n    on(type: EventType | '*', listener: EventListener): () => void {\n        if (!this.listeners.has(type)) {\n            this.listeners.set(type, new Set());\n        }\n        this.listeners.get(type)!.add(listener);\n\n        // \u8FD4\u56DE\u53D6\u6D88\u8BA2\u9605\u51FD\u6570\n        return () => {\n            this.listeners.get(type)?.delete(listener);\n        };\n    }\n\n    /**\n     * \u83B7\u53D6\u6240\u6709\u4E8B\u4EF6\n     */\n    getEvents(): Event[] {\n        return [...this.events];\n    }\n\n    /**\n     * \u83B7\u53D6 payload\n     */\n    getPayload(payloadRef: string): unknown {\n        return this.payloadStore.get(payloadRef);\n    }\n\n    /**\n     * \u6E05\u7A7A\u4E8B\u4EF6\u6D41\n     */\n    clear(): void {\n        this.events = [];\n        this.payloadStore.clear();\n    }\n\n    /**\n     * \u5BFC\u51FA\u4E8B\u4EF6\u6D41\uFF08\u7528\u4E8E debug bundle\uFF09\n     */\n    export(): { events: Event[]; payloads: Record<string, unknown> } {\n        const payloads: Record<string, unknown> = {};\n        this.payloadStore.forEach((value, key) => {\n            payloads[key] = value;\n        });\n\n        return {\n            events: this.events,\n            payloads,\n        };\n    }\n\n    /**\n     * \u4ECE\u5BFC\u51FA\u6570\u636E\u6062\u590D\n     */\n    import(data: { events: Event[]; payloads: Record<string, unknown> }): void {\n        this.events = data.events;\n        this.payloadStore = new Map(Object.entries(data.payloads));\n    }\n\n    private notifyListeners(type: EventType | '*', event: Event): void {\n        const listeners = this.listeners.get(type);\n        if (listeners) {\n            listeners.forEach(listener => {\n                try {\n                    listener(event);\n                } catch (error) {\n                    console.error(`Error in event listener for ${type}:`, error);\n                }\n            });\n        }\n    }\n\n    private generateEventId(): string {\n        return `evt-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n    }\n}\n", "export * from \"./errors.js\";\nexport * from \"./helpers/parseUtil.js\";\nexport * from \"./helpers/typeAliases.js\";\nexport * from \"./helpers/util.js\";\nexport * from \"./types.js\";\nexport * from \"./ZodError.js\";\n", "export var util;\n(function (util) {\n    util.assertEqual = (_) => { };\n    function assertIs(_arg) { }\n    util.assertIs = assertIs;\n    function assertNever(_x) {\n        throw new Error();\n    }\n    util.assertNever = assertNever;\n    util.arrayToEnum = (items) => {\n        const obj = {};\n        for (const item of items) {\n            obj[item] = item;\n        }\n        return obj;\n    };\n    util.getValidEnumValues = (obj) => {\n        const validKeys = util.objectKeys(obj).filter((k) => typeof obj[obj[k]] !== \"number\");\n        const filtered = {};\n        for (const k of validKeys) {\n            filtered[k] = obj[k];\n        }\n        return util.objectValues(filtered);\n    };\n    util.objectValues = (obj) => {\n        return util.objectKeys(obj).map(function (e) {\n            return obj[e];\n        });\n    };\n    util.objectKeys = typeof Object.keys === \"function\" // eslint-disable-line ban/ban\n        ? (obj) => Object.keys(obj) // eslint-disable-line ban/ban\n        : (object) => {\n            const keys = [];\n            for (const key in object) {\n                if (Object.prototype.hasOwnProperty.call(object, key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        };\n    util.find = (arr, checker) => {\n        for (const item of arr) {\n            if (checker(item))\n                return item;\n        }\n        return undefined;\n    };\n    util.isInteger = typeof Number.isInteger === \"function\"\n        ? (val) => Number.isInteger(val) // eslint-disable-line ban/ban\n        : (val) => typeof val === \"number\" && Number.isFinite(val) && Math.floor(val) === val;\n    function joinValues(array, separator = \" | \") {\n        return array.map((val) => (typeof val === \"string\" ? `'${val}'` : val)).join(separator);\n    }\n    util.joinValues = joinValues;\n    util.jsonStringifyReplacer = (_, value) => {\n        if (typeof value === \"bigint\") {\n            return value.toString();\n        }\n        return value;\n    };\n})(util || (util = {}));\nexport var objectUtil;\n(function (objectUtil) {\n    objectUtil.mergeShapes = (first, second) => {\n        return {\n            ...first,\n            ...second, // second overwrites first\n        };\n    };\n})(objectUtil || (objectUtil = {}));\nexport const ZodParsedType = util.arrayToEnum([\n    \"string\",\n    \"nan\",\n    \"number\",\n    \"integer\",\n    \"float\",\n    \"boolean\",\n    \"date\",\n    \"bigint\",\n    \"symbol\",\n    \"function\",\n    \"undefined\",\n    \"null\",\n    \"array\",\n    \"object\",\n    \"unknown\",\n    \"promise\",\n    \"void\",\n    \"never\",\n    \"map\",\n    \"set\",\n]);\nexport const getParsedType = (data) => {\n    const t = typeof data;\n    switch (t) {\n        case \"undefined\":\n            return ZodParsedType.undefined;\n        case \"string\":\n            return ZodParsedType.string;\n        case \"number\":\n            return Number.isNaN(data) ? ZodParsedType.nan : ZodParsedType.number;\n        case \"boolean\":\n            return ZodParsedType.boolean;\n        case \"function\":\n            return ZodParsedType.function;\n        case \"bigint\":\n            return ZodParsedType.bigint;\n        case \"symbol\":\n            return ZodParsedType.symbol;\n        case \"object\":\n            if (Array.isArray(data)) {\n                return ZodParsedType.array;\n            }\n            if (data === null) {\n                return ZodParsedType.null;\n            }\n            if (data.then && typeof data.then === \"function\" && data.catch && typeof data.catch === \"function\") {\n                return ZodParsedType.promise;\n            }\n            if (typeof Map !== \"undefined\" && data instanceof Map) {\n                return ZodParsedType.map;\n            }\n            if (typeof Set !== \"undefined\" && data instanceof Set) {\n                return ZodParsedType.set;\n            }\n            if (typeof Date !== \"undefined\" && data instanceof Date) {\n                return ZodParsedType.date;\n            }\n            return ZodParsedType.object;\n        default:\n            return ZodParsedType.unknown;\n    }\n};\n", "import { util } from \"./helpers/util.js\";\nexport const ZodIssueCode = util.arrayToEnum([\n    \"invalid_type\",\n    \"invalid_literal\",\n    \"custom\",\n    \"invalid_union\",\n    \"invalid_union_discriminator\",\n    \"invalid_enum_value\",\n    \"unrecognized_keys\",\n    \"invalid_arguments\",\n    \"invalid_return_type\",\n    \"invalid_date\",\n    \"invalid_string\",\n    \"too_small\",\n    \"too_big\",\n    \"invalid_intersection_types\",\n    \"not_multiple_of\",\n    \"not_finite\",\n]);\nexport const quotelessJson = (obj) => {\n    const json = JSON.stringify(obj, null, 2);\n    return json.replace(/\"([^\"]+)\":/g, \"$1:\");\n};\nexport class ZodError extends Error {\n    get errors() {\n        return this.issues;\n    }\n    constructor(issues) {\n        super();\n        this.issues = [];\n        this.addIssue = (sub) => {\n            this.issues = [...this.issues, sub];\n        };\n        this.addIssues = (subs = []) => {\n            this.issues = [...this.issues, ...subs];\n        };\n        const actualProto = new.target.prototype;\n        if (Object.setPrototypeOf) {\n            // eslint-disable-next-line ban/ban\n            Object.setPrototypeOf(this, actualProto);\n        }\n        else {\n            this.__proto__ = actualProto;\n        }\n        this.name = \"ZodError\";\n        this.issues = issues;\n    }\n    format(_mapper) {\n        const mapper = _mapper ||\n            function (issue) {\n                return issue.message;\n            };\n        const fieldErrors = { _errors: [] };\n        const processError = (error) => {\n            for (const issue of error.issues) {\n                if (issue.code === \"invalid_union\") {\n                    issue.unionErrors.map(processError);\n                }\n                else if (issue.code === \"invalid_return_type\") {\n                    processError(issue.returnTypeError);\n                }\n                else if (issue.code === \"invalid_arguments\") {\n                    processError(issue.argumentsError);\n                }\n                else if (issue.path.length === 0) {\n                    fieldErrors._errors.push(mapper(issue));\n                }\n                else {\n                    let curr = fieldErrors;\n                    let i = 0;\n                    while (i < issue.path.length) {\n                        const el = issue.path[i];\n                        const terminal = i === issue.path.length - 1;\n                        if (!terminal) {\n                            curr[el] = curr[el] || { _errors: [] };\n                            // if (typeof el === \"string\") {\n                            //   curr[el] = curr[el] || { _errors: [] };\n                            // } else if (typeof el === \"number\") {\n                            //   const errorArray: any = [];\n                            //   errorArray._errors = [];\n                            //   curr[el] = curr[el] || errorArray;\n                            // }\n                        }\n                        else {\n                            curr[el] = curr[el] || { _errors: [] };\n                            curr[el]._errors.push(mapper(issue));\n                        }\n                        curr = curr[el];\n                        i++;\n                    }\n                }\n            }\n        };\n        processError(this);\n        return fieldErrors;\n    }\n    static assert(value) {\n        if (!(value instanceof ZodError)) {\n            throw new Error(`Not a ZodError: ${value}`);\n        }\n    }\n    toString() {\n        return this.message;\n    }\n    get message() {\n        return JSON.stringify(this.issues, util.jsonStringifyReplacer, 2);\n    }\n    get isEmpty() {\n        return this.issues.length === 0;\n    }\n    flatten(mapper = (issue) => issue.message) {\n        const fieldErrors = {};\n        const formErrors = [];\n        for (const sub of this.issues) {\n            if (sub.path.length > 0) {\n                const firstEl = sub.path[0];\n                fieldErrors[firstEl] = fieldErrors[firstEl] || [];\n                fieldErrors[firstEl].push(mapper(sub));\n            }\n            else {\n                formErrors.push(mapper(sub));\n            }\n        }\n        return { formErrors, fieldErrors };\n    }\n    get formErrors() {\n        return this.flatten();\n    }\n}\nZodError.create = (issues) => {\n    const error = new ZodError(issues);\n    return error;\n};\n", "import { ZodIssueCode } from \"../ZodError.js\";\nimport { util, ZodParsedType } from \"../helpers/util.js\";\nconst errorMap = (issue, _ctx) => {\n    let message;\n    switch (issue.code) {\n        case ZodIssueCode.invalid_type:\n            if (issue.received === ZodParsedType.undefined) {\n                message = \"Required\";\n            }\n            else {\n                message = `Expected ${issue.expected}, received ${issue.received}`;\n            }\n            break;\n        case ZodIssueCode.invalid_literal:\n            message = `Invalid literal value, expected ${JSON.stringify(issue.expected, util.jsonStringifyReplacer)}`;\n            break;\n        case ZodIssueCode.unrecognized_keys:\n            message = `Unrecognized key(s) in object: ${util.joinValues(issue.keys, \", \")}`;\n            break;\n        case ZodIssueCode.invalid_union:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_union_discriminator:\n            message = `Invalid discriminator value. Expected ${util.joinValues(issue.options)}`;\n            break;\n        case ZodIssueCode.invalid_enum_value:\n            message = `Invalid enum value. Expected ${util.joinValues(issue.options)}, received '${issue.received}'`;\n            break;\n        case ZodIssueCode.invalid_arguments:\n            message = `Invalid function arguments`;\n            break;\n        case ZodIssueCode.invalid_return_type:\n            message = `Invalid function return type`;\n            break;\n        case ZodIssueCode.invalid_date:\n            message = `Invalid date`;\n            break;\n        case ZodIssueCode.invalid_string:\n            if (typeof issue.validation === \"object\") {\n                if (\"includes\" in issue.validation) {\n                    message = `Invalid input: must include \"${issue.validation.includes}\"`;\n                    if (typeof issue.validation.position === \"number\") {\n                        message = `${message} at one or more positions greater than or equal to ${issue.validation.position}`;\n                    }\n                }\n                else if (\"startsWith\" in issue.validation) {\n                    message = `Invalid input: must start with \"${issue.validation.startsWith}\"`;\n                }\n                else if (\"endsWith\" in issue.validation) {\n                    message = `Invalid input: must end with \"${issue.validation.endsWith}\"`;\n                }\n                else {\n                    util.assertNever(issue.validation);\n                }\n            }\n            else if (issue.validation !== \"regex\") {\n                message = `Invalid ${issue.validation}`;\n            }\n            else {\n                message = \"Invalid\";\n            }\n            break;\n        case ZodIssueCode.too_small:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `more than`} ${issue.minimum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `over`} ${issue.minimum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"bigint\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${new Date(Number(issue.minimum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.too_big:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `less than`} ${issue.maximum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `under`} ${issue.maximum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"bigint\")\n                message = `BigInt must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly` : issue.inclusive ? `smaller than or equal to` : `smaller than`} ${new Date(Number(issue.maximum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.custom:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_intersection_types:\n            message = `Intersection results could not be merged`;\n            break;\n        case ZodIssueCode.not_multiple_of:\n            message = `Number must be a multiple of ${issue.multipleOf}`;\n            break;\n        case ZodIssueCode.not_finite:\n            message = \"Number must be finite\";\n            break;\n        default:\n            message = _ctx.defaultError;\n            util.assertNever(issue);\n    }\n    return { message };\n};\nexport default errorMap;\n", "import defaultErrorMap from \"./locales/en.js\";\nlet overrideErrorMap = defaultErrorMap;\nexport { defaultErrorMap };\nexport function setErrorMap(map) {\n    overrideErrorMap = map;\n}\nexport function getErrorMap() {\n    return overrideErrorMap;\n}\n", "import { getErrorMap } from \"../errors.js\";\nimport defaultErrorMap from \"../locales/en.js\";\nexport const makeIssue = (params) => {\n    const { data, path, errorMaps, issueData } = params;\n    const fullPath = [...path, ...(issueData.path || [])];\n    const fullIssue = {\n        ...issueData,\n        path: fullPath,\n    };\n    if (issueData.message !== undefined) {\n        return {\n            ...issueData,\n            path: fullPath,\n            message: issueData.message,\n        };\n    }\n    let errorMessage = \"\";\n    const maps = errorMaps\n        .filter((m) => !!m)\n        .slice()\n        .reverse();\n    for (const map of maps) {\n        errorMessage = map(fullIssue, { data, defaultError: errorMessage }).message;\n    }\n    return {\n        ...issueData,\n        path: fullPath,\n        message: errorMessage,\n    };\n};\nexport const EMPTY_PATH = [];\nexport function addIssueToContext(ctx, issueData) {\n    const overrideMap = getErrorMap();\n    const issue = makeIssue({\n        issueData: issueData,\n        data: ctx.data,\n        path: ctx.path,\n        errorMaps: [\n            ctx.common.contextualErrorMap, // contextual error map is first priority\n            ctx.schemaErrorMap, // then schema-bound map if available\n            overrideMap, // then global override map\n            overrideMap === defaultErrorMap ? undefined : defaultErrorMap, // then global default map\n        ].filter((x) => !!x),\n    });\n    ctx.common.issues.push(issue);\n}\nexport class ParseStatus {\n    constructor() {\n        this.value = \"valid\";\n    }\n    dirty() {\n        if (this.value === \"valid\")\n            this.value = \"dirty\";\n    }\n    abort() {\n        if (this.value !== \"aborted\")\n            this.value = \"aborted\";\n    }\n    static mergeArray(status, results) {\n        const arrayValue = [];\n        for (const s of results) {\n            if (s.status === \"aborted\")\n                return INVALID;\n            if (s.status === \"dirty\")\n                status.dirty();\n            arrayValue.push(s.value);\n        }\n        return { status: status.value, value: arrayValue };\n    }\n    static async mergeObjectAsync(status, pairs) {\n        const syncPairs = [];\n        for (const pair of pairs) {\n            const key = await pair.key;\n            const value = await pair.value;\n            syncPairs.push({\n                key,\n                value,\n            });\n        }\n        return ParseStatus.mergeObjectSync(status, syncPairs);\n    }\n    static mergeObjectSync(status, pairs) {\n        const finalObject = {};\n        for (const pair of pairs) {\n            const { key, value } = pair;\n            if (key.status === \"aborted\")\n                return INVALID;\n            if (value.status === \"aborted\")\n                return INVALID;\n            if (key.status === \"dirty\")\n                status.dirty();\n            if (value.status === \"dirty\")\n                status.dirty();\n            if (key.value !== \"__proto__\" && (typeof value.value !== \"undefined\" || pair.alwaysSet)) {\n                finalObject[key.value] = value.value;\n            }\n        }\n        return { status: status.value, value: finalObject };\n    }\n}\nexport const INVALID = Object.freeze({\n    status: \"aborted\",\n});\nexport const DIRTY = (value) => ({ status: \"dirty\", value });\nexport const OK = (value) => ({ status: \"valid\", value });\nexport const isAborted = (x) => x.status === \"aborted\";\nexport const isDirty = (x) => x.status === \"dirty\";\nexport const isValid = (x) => x.status === \"valid\";\nexport const isAsync = (x) => typeof Promise !== \"undefined\" && x instanceof Promise;\n", "export var errorUtil;\n(function (errorUtil) {\n    errorUtil.errToObj = (message) => typeof message === \"string\" ? { message } : message || {};\n    // biome-ignore lint:\n    errorUtil.toString = (message) => typeof message === \"string\" ? message : message?.message;\n})(errorUtil || (errorUtil = {}));\n", "import { ZodError, ZodIssueCode, } from \"./ZodError.js\";\nimport { defaultErrorMap, getErrorMap } from \"./errors.js\";\nimport { errorUtil } from \"./helpers/errorUtil.js\";\nimport { DIRTY, INVALID, OK, ParseStatus, addIssueToContext, isAborted, isAsync, isDirty, isValid, makeIssue, } from \"./helpers/parseUtil.js\";\nimport { util, ZodParsedType, getParsedType } from \"./helpers/util.js\";\nclass ParseInputLazyPath {\n    constructor(parent, value, path, key) {\n        this._cachedPath = [];\n        this.parent = parent;\n        this.data = value;\n        this._path = path;\n        this._key = key;\n    }\n    get path() {\n        if (!this._cachedPath.length) {\n            if (Array.isArray(this._key)) {\n                this._cachedPath.push(...this._path, ...this._key);\n            }\n            else {\n                this._cachedPath.push(...this._path, this._key);\n            }\n        }\n        return this._cachedPath;\n    }\n}\nconst handleResult = (ctx, result) => {\n    if (isValid(result)) {\n        return { success: true, data: result.value };\n    }\n    else {\n        if (!ctx.common.issues.length) {\n            throw new Error(\"Validation failed but no issues detected.\");\n        }\n        return {\n            success: false,\n            get error() {\n                if (this._error)\n                    return this._error;\n                const error = new ZodError(ctx.common.issues);\n                this._error = error;\n                return this._error;\n            },\n        };\n    }\n};\nfunction processCreateParams(params) {\n    if (!params)\n        return {};\n    const { errorMap, invalid_type_error, required_error, description } = params;\n    if (errorMap && (invalid_type_error || required_error)) {\n        throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);\n    }\n    if (errorMap)\n        return { errorMap: errorMap, description };\n    const customMap = (iss, ctx) => {\n        const { message } = params;\n        if (iss.code === \"invalid_enum_value\") {\n            return { message: message ?? ctx.defaultError };\n        }\n        if (typeof ctx.data === \"undefined\") {\n            return { message: message ?? required_error ?? ctx.defaultError };\n        }\n        if (iss.code !== \"invalid_type\")\n            return { message: ctx.defaultError };\n        return { message: message ?? invalid_type_error ?? ctx.defaultError };\n    };\n    return { errorMap: customMap, description };\n}\nexport class ZodType {\n    get description() {\n        return this._def.description;\n    }\n    _getType(input) {\n        return getParsedType(input.data);\n    }\n    _getOrReturnCtx(input, ctx) {\n        return (ctx || {\n            common: input.parent.common,\n            data: input.data,\n            parsedType: getParsedType(input.data),\n            schemaErrorMap: this._def.errorMap,\n            path: input.path,\n            parent: input.parent,\n        });\n    }\n    _processInputParams(input) {\n        return {\n            status: new ParseStatus(),\n            ctx: {\n                common: input.parent.common,\n                data: input.data,\n                parsedType: getParsedType(input.data),\n                schemaErrorMap: this._def.errorMap,\n                path: input.path,\n                parent: input.parent,\n            },\n        };\n    }\n    _parseSync(input) {\n        const result = this._parse(input);\n        if (isAsync(result)) {\n            throw new Error(\"Synchronous parse encountered promise.\");\n        }\n        return result;\n    }\n    _parseAsync(input) {\n        const result = this._parse(input);\n        return Promise.resolve(result);\n    }\n    parse(data, params) {\n        const result = this.safeParse(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    safeParse(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: params?.async ?? false,\n                contextualErrorMap: params?.errorMap,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const result = this._parseSync({ data, path: ctx.path, parent: ctx });\n        return handleResult(ctx, result);\n    }\n    \"~validate\"(data) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: !!this[\"~standard\"].async,\n            },\n            path: [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        if (!this[\"~standard\"].async) {\n            try {\n                const result = this._parseSync({ data, path: [], parent: ctx });\n                return isValid(result)\n                    ? {\n                        value: result.value,\n                    }\n                    : {\n                        issues: ctx.common.issues,\n                    };\n            }\n            catch (err) {\n                if (err?.message?.toLowerCase()?.includes(\"encountered\")) {\n                    this[\"~standard\"].async = true;\n                }\n                ctx.common = {\n                    issues: [],\n                    async: true,\n                };\n            }\n        }\n        return this._parseAsync({ data, path: [], parent: ctx }).then((result) => isValid(result)\n            ? {\n                value: result.value,\n            }\n            : {\n                issues: ctx.common.issues,\n            });\n    }\n    async parseAsync(data, params) {\n        const result = await this.safeParseAsync(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    async safeParseAsync(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                contextualErrorMap: params?.errorMap,\n                async: true,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const maybeAsyncResult = this._parse({ data, path: ctx.path, parent: ctx });\n        const result = await (isAsync(maybeAsyncResult) ? maybeAsyncResult : Promise.resolve(maybeAsyncResult));\n        return handleResult(ctx, result);\n    }\n    refine(check, message) {\n        const getIssueProperties = (val) => {\n            if (typeof message === \"string\" || typeof message === \"undefined\") {\n                return { message };\n            }\n            else if (typeof message === \"function\") {\n                return message(val);\n            }\n            else {\n                return message;\n            }\n        };\n        return this._refinement((val, ctx) => {\n            const result = check(val);\n            const setError = () => ctx.addIssue({\n                code: ZodIssueCode.custom,\n                ...getIssueProperties(val),\n            });\n            if (typeof Promise !== \"undefined\" && result instanceof Promise) {\n                return result.then((data) => {\n                    if (!data) {\n                        setError();\n                        return false;\n                    }\n                    else {\n                        return true;\n                    }\n                });\n            }\n            if (!result) {\n                setError();\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    refinement(check, refinementData) {\n        return this._refinement((val, ctx) => {\n            if (!check(val)) {\n                ctx.addIssue(typeof refinementData === \"function\" ? refinementData(val, ctx) : refinementData);\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    _refinement(refinement) {\n        return new ZodEffects({\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"refinement\", refinement },\n        });\n    }\n    superRefine(refinement) {\n        return this._refinement(refinement);\n    }\n    constructor(def) {\n        /** Alias of safeParseAsync */\n        this.spa = this.safeParseAsync;\n        this._def = def;\n        this.parse = this.parse.bind(this);\n        this.safeParse = this.safeParse.bind(this);\n        this.parseAsync = this.parseAsync.bind(this);\n        this.safeParseAsync = this.safeParseAsync.bind(this);\n        this.spa = this.spa.bind(this);\n        this.refine = this.refine.bind(this);\n        this.refinement = this.refinement.bind(this);\n        this.superRefine = this.superRefine.bind(this);\n        this.optional = this.optional.bind(this);\n        this.nullable = this.nullable.bind(this);\n        this.nullish = this.nullish.bind(this);\n        this.array = this.array.bind(this);\n        this.promise = this.promise.bind(this);\n        this.or = this.or.bind(this);\n        this.and = this.and.bind(this);\n        this.transform = this.transform.bind(this);\n        this.brand = this.brand.bind(this);\n        this.default = this.default.bind(this);\n        this.catch = this.catch.bind(this);\n        this.describe = this.describe.bind(this);\n        this.pipe = this.pipe.bind(this);\n        this.readonly = this.readonly.bind(this);\n        this.isNullable = this.isNullable.bind(this);\n        this.isOptional = this.isOptional.bind(this);\n        this[\"~standard\"] = {\n            version: 1,\n            vendor: \"zod\",\n            validate: (data) => this[\"~validate\"](data),\n        };\n    }\n    optional() {\n        return ZodOptional.create(this, this._def);\n    }\n    nullable() {\n        return ZodNullable.create(this, this._def);\n    }\n    nullish() {\n        return this.nullable().optional();\n    }\n    array() {\n        return ZodArray.create(this);\n    }\n    promise() {\n        return ZodPromise.create(this, this._def);\n    }\n    or(option) {\n        return ZodUnion.create([this, option], this._def);\n    }\n    and(incoming) {\n        return ZodIntersection.create(this, incoming, this._def);\n    }\n    transform(transform) {\n        return new ZodEffects({\n            ...processCreateParams(this._def),\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"transform\", transform },\n        });\n    }\n    default(def) {\n        const defaultValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodDefault({\n            ...processCreateParams(this._def),\n            innerType: this,\n            defaultValue: defaultValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodDefault,\n        });\n    }\n    brand() {\n        return new ZodBranded({\n            typeName: ZodFirstPartyTypeKind.ZodBranded,\n            type: this,\n            ...processCreateParams(this._def),\n        });\n    }\n    catch(def) {\n        const catchValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodCatch({\n            ...processCreateParams(this._def),\n            innerType: this,\n            catchValue: catchValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodCatch,\n        });\n    }\n    describe(description) {\n        const This = this.constructor;\n        return new This({\n            ...this._def,\n            description,\n        });\n    }\n    pipe(target) {\n        return ZodPipeline.create(this, target);\n    }\n    readonly() {\n        return ZodReadonly.create(this);\n    }\n    isOptional() {\n        return this.safeParse(undefined).success;\n    }\n    isNullable() {\n        return this.safeParse(null).success;\n    }\n}\nconst cuidRegex = /^c[^\\s-]{8,}$/i;\nconst cuid2Regex = /^[0-9a-z]+$/;\nconst ulidRegex = /^[0-9A-HJKMNP-TV-Z]{26}$/i;\n// const uuidRegex =\n//   /^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i;\nconst uuidRegex = /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i;\nconst nanoidRegex = /^[a-z0-9_-]{21}$/i;\nconst jwtRegex = /^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/;\nconst durationRegex = /^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/;\n// from https://stackoverflow.com/a/46181/1550155\n// old version: too slow, didn't support unicode\n// const emailRegex = /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i;\n//old email regex\n// const emailRegex = /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@((?!-)([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{1,})[^-<>()[\\].,;:\\s@\"]$/i;\n// eslint-disable-next-line\n// const emailRegex =\n//   /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$/;\n// const emailRegex =\n//   /^[a-zA-Z0-9\\.\\!\\#\\$\\%\\&\\'\\*\\+\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~\\-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n// const emailRegex =\n//   /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/i;\nconst emailRegex = /^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i;\n// const emailRegex =\n//   /^[a-z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-z0-9-]+(?:\\.[a-z0-9\\-]+)*$/i;\n// from https://thekevinscott.com/emojis-in-javascript/#writing-a-regular-expression\nconst _emojiRegex = `^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$`;\nlet emojiRegex;\n// faster, simpler, safer\nconst ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/;\nconst ipv4CidrRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/;\n// const ipv6Regex =\n// /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;\nconst ipv6Regex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;\nconst ipv6CidrRegex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/;\n// https://stackoverflow.com/questions/7860392/determine-if-string-is-in-base64-using-javascript\nconst base64Regex = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;\n// https://base64.guru/standards/base64url\nconst base64urlRegex = /^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/;\n// simple\n// const dateRegexSource = `\\\\d{4}-\\\\d{2}-\\\\d{2}`;\n// no leap year validation\n// const dateRegexSource = `\\\\d{4}-((0[13578]|10|12)-31|(0[13-9]|1[0-2])-30|(0[1-9]|1[0-2])-(0[1-9]|1\\\\d|2\\\\d))`;\n// with leap year validation\nconst dateRegexSource = `((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))`;\nconst dateRegex = new RegExp(`^${dateRegexSource}$`);\nfunction timeRegexSource(args) {\n    let secondsRegexSource = `[0-5]\\\\d`;\n    if (args.precision) {\n        secondsRegexSource = `${secondsRegexSource}\\\\.\\\\d{${args.precision}}`;\n    }\n    else if (args.precision == null) {\n        secondsRegexSource = `${secondsRegexSource}(\\\\.\\\\d+)?`;\n    }\n    const secondsQuantifier = args.precision ? \"+\" : \"?\"; // require seconds if precision is nonzero\n    return `([01]\\\\d|2[0-3]):[0-5]\\\\d(:${secondsRegexSource})${secondsQuantifier}`;\n}\nfunction timeRegex(args) {\n    return new RegExp(`^${timeRegexSource(args)}$`);\n}\n// Adapted from https://stackoverflow.com/a/3143231\nexport function datetimeRegex(args) {\n    let regex = `${dateRegexSource}T${timeRegexSource(args)}`;\n    const opts = [];\n    opts.push(args.local ? `Z?` : `Z`);\n    if (args.offset)\n        opts.push(`([+-]\\\\d{2}:?\\\\d{2})`);\n    regex = `${regex}(${opts.join(\"|\")})`;\n    return new RegExp(`^${regex}$`);\n}\nfunction isValidIP(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4Regex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6Regex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nfunction isValidJWT(jwt, alg) {\n    if (!jwtRegex.test(jwt))\n        return false;\n    try {\n        const [header] = jwt.split(\".\");\n        if (!header)\n            return false;\n        // Convert base64url to base64\n        const base64 = header\n            .replace(/-/g, \"+\")\n            .replace(/_/g, \"/\")\n            .padEnd(header.length + ((4 - (header.length % 4)) % 4), \"=\");\n        const decoded = JSON.parse(atob(base64));\n        if (typeof decoded !== \"object\" || decoded === null)\n            return false;\n        if (\"typ\" in decoded && decoded?.typ !== \"JWT\")\n            return false;\n        if (!decoded.alg)\n            return false;\n        if (alg && decoded.alg !== alg)\n            return false;\n        return true;\n    }\n    catch {\n        return false;\n    }\n}\nfunction isValidCidr(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4CidrRegex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6CidrRegex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nexport class ZodString extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = String(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.string) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.string,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.length < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.length > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"length\") {\n                const tooBig = input.data.length > check.value;\n                const tooSmall = input.data.length < check.value;\n                if (tooBig || tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    if (tooBig) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_big,\n                            maximum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    else if (tooSmall) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_small,\n                            minimum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"email\") {\n                if (!emailRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"email\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"emoji\") {\n                if (!emojiRegex) {\n                    emojiRegex = new RegExp(_emojiRegex, \"u\");\n                }\n                if (!emojiRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"emoji\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"uuid\") {\n                if (!uuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"uuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"nanoid\") {\n                if (!nanoidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"nanoid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid\") {\n                if (!cuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid2\") {\n                if (!cuid2Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid2\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ulid\") {\n                if (!ulidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ulid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"url\") {\n                try {\n                    new URL(input.data);\n                }\n                catch {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"regex\") {\n                check.regex.lastIndex = 0;\n                const testResult = check.regex.test(input.data);\n                if (!testResult) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"regex\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"trim\") {\n                input.data = input.data.trim();\n            }\n            else if (check.kind === \"includes\") {\n                if (!input.data.includes(check.value, check.position)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { includes: check.value, position: check.position },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"toLowerCase\") {\n                input.data = input.data.toLowerCase();\n            }\n            else if (check.kind === \"toUpperCase\") {\n                input.data = input.data.toUpperCase();\n            }\n            else if (check.kind === \"startsWith\") {\n                if (!input.data.startsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { startsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"endsWith\") {\n                if (!input.data.endsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { endsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"datetime\") {\n                const regex = datetimeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"datetime\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"date\") {\n                const regex = dateRegex;\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"date\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"time\") {\n                const regex = timeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"time\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"duration\") {\n                if (!durationRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"duration\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ip\") {\n                if (!isValidIP(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ip\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"jwt\") {\n                if (!isValidJWT(input.data, check.alg)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"jwt\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cidr\") {\n                if (!isValidCidr(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cidr\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64\") {\n                if (!base64Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64url\") {\n                if (!base64urlRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _regex(regex, validation, message) {\n        return this.refinement((data) => regex.test(data), {\n            validation,\n            code: ZodIssueCode.invalid_string,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    _addCheck(check) {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    email(message) {\n        return this._addCheck({ kind: \"email\", ...errorUtil.errToObj(message) });\n    }\n    url(message) {\n        return this._addCheck({ kind: \"url\", ...errorUtil.errToObj(message) });\n    }\n    emoji(message) {\n        return this._addCheck({ kind: \"emoji\", ...errorUtil.errToObj(message) });\n    }\n    uuid(message) {\n        return this._addCheck({ kind: \"uuid\", ...errorUtil.errToObj(message) });\n    }\n    nanoid(message) {\n        return this._addCheck({ kind: \"nanoid\", ...errorUtil.errToObj(message) });\n    }\n    cuid(message) {\n        return this._addCheck({ kind: \"cuid\", ...errorUtil.errToObj(message) });\n    }\n    cuid2(message) {\n        return this._addCheck({ kind: \"cuid2\", ...errorUtil.errToObj(message) });\n    }\n    ulid(message) {\n        return this._addCheck({ kind: \"ulid\", ...errorUtil.errToObj(message) });\n    }\n    base64(message) {\n        return this._addCheck({ kind: \"base64\", ...errorUtil.errToObj(message) });\n    }\n    base64url(message) {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return this._addCheck({\n            kind: \"base64url\",\n            ...errorUtil.errToObj(message),\n        });\n    }\n    jwt(options) {\n        return this._addCheck({ kind: \"jwt\", ...errorUtil.errToObj(options) });\n    }\n    ip(options) {\n        return this._addCheck({ kind: \"ip\", ...errorUtil.errToObj(options) });\n    }\n    cidr(options) {\n        return this._addCheck({ kind: \"cidr\", ...errorUtil.errToObj(options) });\n    }\n    datetime(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"datetime\",\n                precision: null,\n                offset: false,\n                local: false,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"datetime\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            offset: options?.offset ?? false,\n            local: options?.local ?? false,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    date(message) {\n        return this._addCheck({ kind: \"date\", message });\n    }\n    time(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"time\",\n                precision: null,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"time\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    duration(message) {\n        return this._addCheck({ kind: \"duration\", ...errorUtil.errToObj(message) });\n    }\n    regex(regex, message) {\n        return this._addCheck({\n            kind: \"regex\",\n            regex: regex,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    includes(value, options) {\n        return this._addCheck({\n            kind: \"includes\",\n            value: value,\n            position: options?.position,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    startsWith(value, message) {\n        return this._addCheck({\n            kind: \"startsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    endsWith(value, message) {\n        return this._addCheck({\n            kind: \"endsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    min(minLength, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    max(maxLength, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    length(len, message) {\n        return this._addCheck({\n            kind: \"length\",\n            value: len,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    /**\n     * Equivalent to `.min(1)`\n     */\n    nonempty(message) {\n        return this.min(1, errorUtil.errToObj(message));\n    }\n    trim() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"trim\" }],\n        });\n    }\n    toLowerCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toLowerCase\" }],\n        });\n    }\n    toUpperCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toUpperCase\" }],\n        });\n    }\n    get isDatetime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"datetime\");\n    }\n    get isDate() {\n        return !!this._def.checks.find((ch) => ch.kind === \"date\");\n    }\n    get isTime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"time\");\n    }\n    get isDuration() {\n        return !!this._def.checks.find((ch) => ch.kind === \"duration\");\n    }\n    get isEmail() {\n        return !!this._def.checks.find((ch) => ch.kind === \"email\");\n    }\n    get isURL() {\n        return !!this._def.checks.find((ch) => ch.kind === \"url\");\n    }\n    get isEmoji() {\n        return !!this._def.checks.find((ch) => ch.kind === \"emoji\");\n    }\n    get isUUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"uuid\");\n    }\n    get isNANOID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"nanoid\");\n    }\n    get isCUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid\");\n    }\n    get isCUID2() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid2\");\n    }\n    get isULID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ulid\");\n    }\n    get isIP() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ip\");\n    }\n    get isCIDR() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cidr\");\n    }\n    get isBase64() {\n        return !!this._def.checks.find((ch) => ch.kind === \"base64\");\n    }\n    get isBase64url() {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return !!this._def.checks.find((ch) => ch.kind === \"base64url\");\n    }\n    get minLength() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxLength() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodString.create = (params) => {\n    return new ZodString({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodString,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\n// https://stackoverflow.com/questions/3966484/why-does-modulus-operator-return-fractional-number-in-javascript/31711034#31711034\nfunction floatSafeRemainder(val, step) {\n    const valDecCount = (val.toString().split(\".\")[1] || \"\").length;\n    const stepDecCount = (step.toString().split(\".\")[1] || \"\").length;\n    const decCount = valDecCount > stepDecCount ? valDecCount : stepDecCount;\n    const valInt = Number.parseInt(val.toFixed(decCount).replace(\".\", \"\"));\n    const stepInt = Number.parseInt(step.toFixed(decCount).replace(\".\", \"\"));\n    return (valInt % stepInt) / 10 ** decCount;\n}\nexport class ZodNumber extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n        this.step = this.multipleOf;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Number(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.number) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.number,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"int\") {\n                if (!util.isInteger(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_type,\n                        expected: \"integer\",\n                        received: \"float\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (floatSafeRemainder(input.data, check.value) !== 0) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"finite\") {\n                if (!Number.isFinite(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_finite,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    int(message) {\n        return this._addCheck({\n            kind: \"int\",\n            message: errorUtil.toString(message),\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value: value,\n            message: errorUtil.toString(message),\n        });\n    }\n    finite(message) {\n        return this._addCheck({\n            kind: \"finite\",\n            message: errorUtil.toString(message),\n        });\n    }\n    safe(message) {\n        return this._addCheck({\n            kind: \"min\",\n            inclusive: true,\n            value: Number.MIN_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        })._addCheck({\n            kind: \"max\",\n            inclusive: true,\n            value: Number.MAX_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n    get isInt() {\n        return !!this._def.checks.find((ch) => ch.kind === \"int\" || (ch.kind === \"multipleOf\" && util.isInteger(ch.value)));\n    }\n    get isFinite() {\n        let max = null;\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"finite\" || ch.kind === \"int\" || ch.kind === \"multipleOf\") {\n                return true;\n            }\n            else if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n            else if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return Number.isFinite(min) && Number.isFinite(max);\n    }\n}\nZodNumber.create = (params) => {\n    return new ZodNumber({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodNumber,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBigInt extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            try {\n                input.data = BigInt(input.data);\n            }\n            catch {\n                return this._getInvalidInput(input);\n            }\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.bigint) {\n            return this._getInvalidInput(input);\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        type: \"bigint\",\n                        minimum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        type: \"bigint\",\n                        maximum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (input.data % check.value !== BigInt(0)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _getInvalidInput(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.bigint,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodBigInt.create = (params) => {\n    return new ZodBigInt({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodBigInt,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBoolean extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Boolean(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.boolean) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.boolean,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodBoolean.create = (params) => {\n    return new ZodBoolean({\n        typeName: ZodFirstPartyTypeKind.ZodBoolean,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDate extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = new Date(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.date) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.date,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (Number.isNaN(input.data.getTime())) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_date,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.getTime() < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        minimum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.getTime() > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        maximum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return {\n            status: status.value,\n            value: new Date(input.data.getTime()),\n        };\n    }\n    _addCheck(check) {\n        return new ZodDate({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    min(minDate, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    max(maxDate, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    get minDate() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min != null ? new Date(min) : null;\n    }\n    get maxDate() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max != null ? new Date(max) : null;\n    }\n}\nZodDate.create = (params) => {\n    return new ZodDate({\n        checks: [],\n        coerce: params?.coerce || false,\n        typeName: ZodFirstPartyTypeKind.ZodDate,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSymbol extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.symbol) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.symbol,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodSymbol.create = (params) => {\n    return new ZodSymbol({\n        typeName: ZodFirstPartyTypeKind.ZodSymbol,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUndefined extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.undefined,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodUndefined.create = (params) => {\n    return new ZodUndefined({\n        typeName: ZodFirstPartyTypeKind.ZodUndefined,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNull extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.null) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.null,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodNull.create = (params) => {\n    return new ZodNull({\n        typeName: ZodFirstPartyTypeKind.ZodNull,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodAny extends ZodType {\n    constructor() {\n        super(...arguments);\n        // to prevent instances of other classes from extending ZodAny. this causes issues with catchall in ZodObject.\n        this._any = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodAny.create = (params) => {\n    return new ZodAny({\n        typeName: ZodFirstPartyTypeKind.ZodAny,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnknown extends ZodType {\n    constructor() {\n        super(...arguments);\n        // required\n        this._unknown = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodUnknown.create = (params) => {\n    return new ZodUnknown({\n        typeName: ZodFirstPartyTypeKind.ZodUnknown,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNever extends ZodType {\n    _parse(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.never,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n}\nZodNever.create = (params) => {\n    return new ZodNever({\n        typeName: ZodFirstPartyTypeKind.ZodNever,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodVoid extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.void,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodVoid.create = (params) => {\n    return new ZodVoid({\n        typeName: ZodFirstPartyTypeKind.ZodVoid,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodArray extends ZodType {\n    _parse(input) {\n        const { ctx, status } = this._processInputParams(input);\n        const def = this._def;\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (def.exactLength !== null) {\n            const tooBig = ctx.data.length > def.exactLength.value;\n            const tooSmall = ctx.data.length < def.exactLength.value;\n            if (tooBig || tooSmall) {\n                addIssueToContext(ctx, {\n                    code: tooBig ? ZodIssueCode.too_big : ZodIssueCode.too_small,\n                    minimum: (tooSmall ? def.exactLength.value : undefined),\n                    maximum: (tooBig ? def.exactLength.value : undefined),\n                    type: \"array\",\n                    inclusive: true,\n                    exact: true,\n                    message: def.exactLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.minLength !== null) {\n            if (ctx.data.length < def.minLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxLength !== null) {\n            if (ctx.data.length > def.maxLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.all([...ctx.data].map((item, i) => {\n                return def.type._parseAsync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n            })).then((result) => {\n                return ParseStatus.mergeArray(status, result);\n            });\n        }\n        const result = [...ctx.data].map((item, i) => {\n            return def.type._parseSync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n        });\n        return ParseStatus.mergeArray(status, result);\n    }\n    get element() {\n        return this._def.type;\n    }\n    min(minLength, message) {\n        return new ZodArray({\n            ...this._def,\n            minLength: { value: minLength, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxLength, message) {\n        return new ZodArray({\n            ...this._def,\n            maxLength: { value: maxLength, message: errorUtil.toString(message) },\n        });\n    }\n    length(len, message) {\n        return new ZodArray({\n            ...this._def,\n            exactLength: { value: len, message: errorUtil.toString(message) },\n        });\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodArray.create = (schema, params) => {\n    return new ZodArray({\n        type: schema,\n        minLength: null,\n        maxLength: null,\n        exactLength: null,\n        typeName: ZodFirstPartyTypeKind.ZodArray,\n        ...processCreateParams(params),\n    });\n};\nfunction deepPartialify(schema) {\n    if (schema instanceof ZodObject) {\n        const newShape = {};\n        for (const key in schema.shape) {\n            const fieldSchema = schema.shape[key];\n            newShape[key] = ZodOptional.create(deepPartialify(fieldSchema));\n        }\n        return new ZodObject({\n            ...schema._def,\n            shape: () => newShape,\n        });\n    }\n    else if (schema instanceof ZodArray) {\n        return new ZodArray({\n            ...schema._def,\n            type: deepPartialify(schema.element),\n        });\n    }\n    else if (schema instanceof ZodOptional) {\n        return ZodOptional.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodNullable) {\n        return ZodNullable.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodTuple) {\n        return ZodTuple.create(schema.items.map((item) => deepPartialify(item)));\n    }\n    else {\n        return schema;\n    }\n}\nexport class ZodObject extends ZodType {\n    constructor() {\n        super(...arguments);\n        this._cached = null;\n        /**\n         * @deprecated In most cases, this is no longer needed - unknown properties are now silently stripped.\n         * If you want to pass through unknown properties, use `.passthrough()` instead.\n         */\n        this.nonstrict = this.passthrough;\n        // extend<\n        //   Augmentation extends ZodRawShape,\n        //   NewOutput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_output\"]\n        //       : k extends keyof Output\n        //       ? Output[k]\n        //       : never;\n        //   }>,\n        //   NewInput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_input\"]\n        //       : k extends keyof Input\n        //       ? Input[k]\n        //       : never;\n        //   }>\n        // >(\n        //   augmentation: Augmentation\n        // ): ZodObject<\n        //   extendShape<T, Augmentation>,\n        //   UnknownKeys,\n        //   Catchall,\n        //   NewOutput,\n        //   NewInput\n        // > {\n        //   return new ZodObject({\n        //     ...this._def,\n        //     shape: () => ({\n        //       ...this._def.shape(),\n        //       ...augmentation,\n        //     }),\n        //   }) as any;\n        // }\n        /**\n         * @deprecated Use `.extend` instead\n         *  */\n        this.augment = this.extend;\n    }\n    _getCached() {\n        if (this._cached !== null)\n            return this._cached;\n        const shape = this._def.shape();\n        const keys = util.objectKeys(shape);\n        this._cached = { shape, keys };\n        return this._cached;\n    }\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.object) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const { status, ctx } = this._processInputParams(input);\n        const { shape, keys: shapeKeys } = this._getCached();\n        const extraKeys = [];\n        if (!(this._def.catchall instanceof ZodNever && this._def.unknownKeys === \"strip\")) {\n            for (const key in ctx.data) {\n                if (!shapeKeys.includes(key)) {\n                    extraKeys.push(key);\n                }\n            }\n        }\n        const pairs = [];\n        for (const key of shapeKeys) {\n            const keyValidator = shape[key];\n            const value = ctx.data[key];\n            pairs.push({\n                key: { status: \"valid\", value: key },\n                value: keyValidator._parse(new ParseInputLazyPath(ctx, value, ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (this._def.catchall instanceof ZodNever) {\n            const unknownKeys = this._def.unknownKeys;\n            if (unknownKeys === \"passthrough\") {\n                for (const key of extraKeys) {\n                    pairs.push({\n                        key: { status: \"valid\", value: key },\n                        value: { status: \"valid\", value: ctx.data[key] },\n                    });\n                }\n            }\n            else if (unknownKeys === \"strict\") {\n                if (extraKeys.length > 0) {\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.unrecognized_keys,\n                        keys: extraKeys,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (unknownKeys === \"strip\") {\n            }\n            else {\n                throw new Error(`Internal ZodObject error: invalid unknownKeys value.`);\n            }\n        }\n        else {\n            // run catchall validation\n            const catchall = this._def.catchall;\n            for (const key of extraKeys) {\n                const value = ctx.data[key];\n                pairs.push({\n                    key: { status: \"valid\", value: key },\n                    value: catchall._parse(new ParseInputLazyPath(ctx, value, ctx.path, key) //, ctx.child(key), value, getParsedType(value)\n                    ),\n                    alwaysSet: key in ctx.data,\n                });\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.resolve()\n                .then(async () => {\n                const syncPairs = [];\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    syncPairs.push({\n                        key,\n                        value,\n                        alwaysSet: pair.alwaysSet,\n                    });\n                }\n                return syncPairs;\n            })\n                .then((syncPairs) => {\n                return ParseStatus.mergeObjectSync(status, syncPairs);\n            });\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get shape() {\n        return this._def.shape();\n    }\n    strict(message) {\n        errorUtil.errToObj;\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strict\",\n            ...(message !== undefined\n                ? {\n                    errorMap: (issue, ctx) => {\n                        const defaultError = this._def.errorMap?.(issue, ctx).message ?? ctx.defaultError;\n                        if (issue.code === \"unrecognized_keys\")\n                            return {\n                                message: errorUtil.errToObj(message).message ?? defaultError,\n                            };\n                        return {\n                            message: defaultError,\n                        };\n                    },\n                }\n                : {}),\n        });\n    }\n    strip() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strip\",\n        });\n    }\n    passthrough() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"passthrough\",\n        });\n    }\n    // const AugmentFactory =\n    //   <Def extends ZodObjectDef>(def: Def) =>\n    //   <Augmentation extends ZodRawShape>(\n    //     augmentation: Augmentation\n    //   ): ZodObject<\n    //     extendShape<ReturnType<Def[\"shape\"]>, Augmentation>,\n    //     Def[\"unknownKeys\"],\n    //     Def[\"catchall\"]\n    //   > => {\n    //     return new ZodObject({\n    //       ...def,\n    //       shape: () => ({\n    //         ...def.shape(),\n    //         ...augmentation,\n    //       }),\n    //     }) as any;\n    //   };\n    extend(augmentation) {\n        return new ZodObject({\n            ...this._def,\n            shape: () => ({\n                ...this._def.shape(),\n                ...augmentation,\n            }),\n        });\n    }\n    /**\n     * Prior to zod@1.0.12 there was a bug in the\n     * inferred type of merged objects. Please\n     * upgrade if you are experiencing issues.\n     */\n    merge(merging) {\n        const merged = new ZodObject({\n            unknownKeys: merging._def.unknownKeys,\n            catchall: merging._def.catchall,\n            shape: () => ({\n                ...this._def.shape(),\n                ...merging._def.shape(),\n            }),\n            typeName: ZodFirstPartyTypeKind.ZodObject,\n        });\n        return merged;\n    }\n    // merge<\n    //   Incoming extends AnyZodObject,\n    //   Augmentation extends Incoming[\"shape\"],\n    //   NewOutput extends {\n    //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_output\"]\n    //       : k extends keyof Output\n    //       ? Output[k]\n    //       : never;\n    //   },\n    //   NewInput extends {\n    //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_input\"]\n    //       : k extends keyof Input\n    //       ? Input[k]\n    //       : never;\n    //   }\n    // >(\n    //   merging: Incoming\n    // ): ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"],\n    //   NewOutput,\n    //   NewInput\n    // > {\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    setKey(key, schema) {\n        return this.augment({ [key]: schema });\n    }\n    // merge<Incoming extends AnyZodObject>(\n    //   merging: Incoming\n    // ): //ZodObject<T & Incoming[\"_shape\"], UnknownKeys, Catchall> = (merging) => {\n    // ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"]\n    // > {\n    //   // const mergedShape = objectUtil.mergeShapes(\n    //   //   this._def.shape(),\n    //   //   merging._def.shape()\n    //   // );\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    catchall(index) {\n        return new ZodObject({\n            ...this._def,\n            catchall: index,\n        });\n    }\n    pick(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(mask)) {\n            if (mask[key] && this.shape[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    omit(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (!mask[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    /**\n     * @deprecated\n     */\n    deepPartial() {\n        return deepPartialify(this);\n    }\n    partial(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            const fieldSchema = this.shape[key];\n            if (mask && !mask[key]) {\n                newShape[key] = fieldSchema;\n            }\n            else {\n                newShape[key] = fieldSchema.optional();\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    required(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (mask && !mask[key]) {\n                newShape[key] = this.shape[key];\n            }\n            else {\n                const fieldSchema = this.shape[key];\n                let newField = fieldSchema;\n                while (newField instanceof ZodOptional) {\n                    newField = newField._def.innerType;\n                }\n                newShape[key] = newField;\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    keyof() {\n        return createZodEnum(util.objectKeys(this.shape));\n    }\n}\nZodObject.create = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.strictCreate = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strict\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.lazycreate = (shape, params) => {\n    return new ZodObject({\n        shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const options = this._def.options;\n        function handleResults(results) {\n            // return first issue-free validation if it exists\n            for (const result of results) {\n                if (result.result.status === \"valid\") {\n                    return result.result;\n                }\n            }\n            for (const result of results) {\n                if (result.result.status === \"dirty\") {\n                    // add issues from dirty option\n                    ctx.common.issues.push(...result.ctx.common.issues);\n                    return result.result;\n                }\n            }\n            // return invalid\n            const unionErrors = results.map((result) => new ZodError(result.ctx.common.issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return Promise.all(options.map(async (option) => {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                return {\n                    result: await option._parseAsync({\n                        data: ctx.data,\n                        path: ctx.path,\n                        parent: childCtx,\n                    }),\n                    ctx: childCtx,\n                };\n            })).then(handleResults);\n        }\n        else {\n            let dirty = undefined;\n            const issues = [];\n            for (const option of options) {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                const result = option._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: childCtx,\n                });\n                if (result.status === \"valid\") {\n                    return result;\n                }\n                else if (result.status === \"dirty\" && !dirty) {\n                    dirty = { result, ctx: childCtx };\n                }\n                if (childCtx.common.issues.length) {\n                    issues.push(childCtx.common.issues);\n                }\n            }\n            if (dirty) {\n                ctx.common.issues.push(...dirty.ctx.common.issues);\n                return dirty.result;\n            }\n            const unionErrors = issues.map((issues) => new ZodError(issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n    }\n    get options() {\n        return this._def.options;\n    }\n}\nZodUnion.create = (types, params) => {\n    return new ZodUnion({\n        options: types,\n        typeName: ZodFirstPartyTypeKind.ZodUnion,\n        ...processCreateParams(params),\n    });\n};\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\n//////////                                 //////////\n//////////      ZodDiscriminatedUnion      //////////\n//////////                                 //////////\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\nconst getDiscriminator = (type) => {\n    if (type instanceof ZodLazy) {\n        return getDiscriminator(type.schema);\n    }\n    else if (type instanceof ZodEffects) {\n        return getDiscriminator(type.innerType());\n    }\n    else if (type instanceof ZodLiteral) {\n        return [type.value];\n    }\n    else if (type instanceof ZodEnum) {\n        return type.options;\n    }\n    else if (type instanceof ZodNativeEnum) {\n        // eslint-disable-next-line ban/ban\n        return util.objectValues(type.enum);\n    }\n    else if (type instanceof ZodDefault) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else if (type instanceof ZodUndefined) {\n        return [undefined];\n    }\n    else if (type instanceof ZodNull) {\n        return [null];\n    }\n    else if (type instanceof ZodOptional) {\n        return [undefined, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodNullable) {\n        return [null, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodBranded) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodReadonly) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodCatch) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else {\n        return [];\n    }\n};\nexport class ZodDiscriminatedUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const discriminator = this.discriminator;\n        const discriminatorValue = ctx.data[discriminator];\n        const option = this.optionsMap.get(discriminatorValue);\n        if (!option) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union_discriminator,\n                options: Array.from(this.optionsMap.keys()),\n                path: [discriminator],\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return option._parseAsync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n        else {\n            return option._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n    }\n    get discriminator() {\n        return this._def.discriminator;\n    }\n    get options() {\n        return this._def.options;\n    }\n    get optionsMap() {\n        return this._def.optionsMap;\n    }\n    /**\n     * The constructor of the discriminated union schema. Its behaviour is very similar to that of the normal z.union() constructor.\n     * However, it only allows a union of objects, all of which need to share a discriminator property. This property must\n     * have a different value for each object in the union.\n     * @param discriminator the name of the discriminator property\n     * @param types an array of object schemas\n     * @param params\n     */\n    static create(discriminator, options, params) {\n        // Get all the valid discriminator values\n        const optionsMap = new Map();\n        // try {\n        for (const type of options) {\n            const discriminatorValues = getDiscriminator(type.shape[discriminator]);\n            if (!discriminatorValues.length) {\n                throw new Error(`A discriminator value for key \\`${discriminator}\\` could not be extracted from all schema options`);\n            }\n            for (const value of discriminatorValues) {\n                if (optionsMap.has(value)) {\n                    throw new Error(`Discriminator property ${String(discriminator)} has duplicate value ${String(value)}`);\n                }\n                optionsMap.set(value, type);\n            }\n        }\n        return new ZodDiscriminatedUnion({\n            typeName: ZodFirstPartyTypeKind.ZodDiscriminatedUnion,\n            discriminator,\n            options,\n            optionsMap,\n            ...processCreateParams(params),\n        });\n    }\n}\nfunction mergeValues(a, b) {\n    const aType = getParsedType(a);\n    const bType = getParsedType(b);\n    if (a === b) {\n        return { valid: true, data: a };\n    }\n    else if (aType === ZodParsedType.object && bType === ZodParsedType.object) {\n        const bKeys = util.objectKeys(b);\n        const sharedKeys = util.objectKeys(a).filter((key) => bKeys.indexOf(key) !== -1);\n        const newObj = { ...a, ...b };\n        for (const key of sharedKeys) {\n            const sharedValue = mergeValues(a[key], b[key]);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newObj[key] = sharedValue.data;\n        }\n        return { valid: true, data: newObj };\n    }\n    else if (aType === ZodParsedType.array && bType === ZodParsedType.array) {\n        if (a.length !== b.length) {\n            return { valid: false };\n        }\n        const newArray = [];\n        for (let index = 0; index < a.length; index++) {\n            const itemA = a[index];\n            const itemB = b[index];\n            const sharedValue = mergeValues(itemA, itemB);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newArray.push(sharedValue.data);\n        }\n        return { valid: true, data: newArray };\n    }\n    else if (aType === ZodParsedType.date && bType === ZodParsedType.date && +a === +b) {\n        return { valid: true, data: a };\n    }\n    else {\n        return { valid: false };\n    }\n}\nexport class ZodIntersection extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const handleParsed = (parsedLeft, parsedRight) => {\n            if (isAborted(parsedLeft) || isAborted(parsedRight)) {\n                return INVALID;\n            }\n            const merged = mergeValues(parsedLeft.value, parsedRight.value);\n            if (!merged.valid) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.invalid_intersection_types,\n                });\n                return INVALID;\n            }\n            if (isDirty(parsedLeft) || isDirty(parsedRight)) {\n                status.dirty();\n            }\n            return { status: status.value, value: merged.data };\n        };\n        if (ctx.common.async) {\n            return Promise.all([\n                this._def.left._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n                this._def.right._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n            ]).then(([left, right]) => handleParsed(left, right));\n        }\n        else {\n            return handleParsed(this._def.left._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }), this._def.right._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }));\n        }\n    }\n}\nZodIntersection.create = (left, right, params) => {\n    return new ZodIntersection({\n        left: left,\n        right: right,\n        typeName: ZodFirstPartyTypeKind.ZodIntersection,\n        ...processCreateParams(params),\n    });\n};\n// type ZodTupleItems = [ZodTypeAny, ...ZodTypeAny[]];\nexport class ZodTuple extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (ctx.data.length < this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_small,\n                minimum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            return INVALID;\n        }\n        const rest = this._def.rest;\n        if (!rest && ctx.data.length > this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_big,\n                maximum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            status.dirty();\n        }\n        const items = [...ctx.data]\n            .map((item, itemIndex) => {\n            const schema = this._def.items[itemIndex] || this._def.rest;\n            if (!schema)\n                return null;\n            return schema._parse(new ParseInputLazyPath(ctx, item, ctx.path, itemIndex));\n        })\n            .filter((x) => !!x); // filter nulls\n        if (ctx.common.async) {\n            return Promise.all(items).then((results) => {\n                return ParseStatus.mergeArray(status, results);\n            });\n        }\n        else {\n            return ParseStatus.mergeArray(status, items);\n        }\n    }\n    get items() {\n        return this._def.items;\n    }\n    rest(rest) {\n        return new ZodTuple({\n            ...this._def,\n            rest,\n        });\n    }\n}\nZodTuple.create = (schemas, params) => {\n    if (!Array.isArray(schemas)) {\n        throw new Error(\"You must pass an array of schemas to z.tuple([ ... ])\");\n    }\n    return new ZodTuple({\n        items: schemas,\n        typeName: ZodFirstPartyTypeKind.ZodTuple,\n        rest: null,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodRecord extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const pairs = [];\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        for (const key in ctx.data) {\n            pairs.push({\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, key)),\n                value: valueType._parse(new ParseInputLazyPath(ctx, ctx.data[key], ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (ctx.common.async) {\n            return ParseStatus.mergeObjectAsync(status, pairs);\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get element() {\n        return this._def.valueType;\n    }\n    static create(first, second, third) {\n        if (second instanceof ZodType) {\n            return new ZodRecord({\n                keyType: first,\n                valueType: second,\n                typeName: ZodFirstPartyTypeKind.ZodRecord,\n                ...processCreateParams(third),\n            });\n        }\n        return new ZodRecord({\n            keyType: ZodString.create(),\n            valueType: first,\n            typeName: ZodFirstPartyTypeKind.ZodRecord,\n            ...processCreateParams(second),\n        });\n    }\n}\nexport class ZodMap extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.map) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.map,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        const pairs = [...ctx.data.entries()].map(([key, value], index) => {\n            return {\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, [index, \"key\"])),\n                value: valueType._parse(new ParseInputLazyPath(ctx, value, ctx.path, [index, \"value\"])),\n            };\n        });\n        if (ctx.common.async) {\n            const finalMap = new Map();\n            return Promise.resolve().then(async () => {\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    if (key.status === \"aborted\" || value.status === \"aborted\") {\n                        return INVALID;\n                    }\n                    if (key.status === \"dirty\" || value.status === \"dirty\") {\n                        status.dirty();\n                    }\n                    finalMap.set(key.value, value.value);\n                }\n                return { status: status.value, value: finalMap };\n            });\n        }\n        else {\n            const finalMap = new Map();\n            for (const pair of pairs) {\n                const key = pair.key;\n                const value = pair.value;\n                if (key.status === \"aborted\" || value.status === \"aborted\") {\n                    return INVALID;\n                }\n                if (key.status === \"dirty\" || value.status === \"dirty\") {\n                    status.dirty();\n                }\n                finalMap.set(key.value, value.value);\n            }\n            return { status: status.value, value: finalMap };\n        }\n    }\n}\nZodMap.create = (keyType, valueType, params) => {\n    return new ZodMap({\n        valueType,\n        keyType,\n        typeName: ZodFirstPartyTypeKind.ZodMap,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSet extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.set) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.set,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const def = this._def;\n        if (def.minSize !== null) {\n            if (ctx.data.size < def.minSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minSize.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxSize !== null) {\n            if (ctx.data.size > def.maxSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxSize.message,\n                });\n                status.dirty();\n            }\n        }\n        const valueType = this._def.valueType;\n        function finalizeSet(elements) {\n            const parsedSet = new Set();\n            for (const element of elements) {\n                if (element.status === \"aborted\")\n                    return INVALID;\n                if (element.status === \"dirty\")\n                    status.dirty();\n                parsedSet.add(element.value);\n            }\n            return { status: status.value, value: parsedSet };\n        }\n        const elements = [...ctx.data.values()].map((item, i) => valueType._parse(new ParseInputLazyPath(ctx, item, ctx.path, i)));\n        if (ctx.common.async) {\n            return Promise.all(elements).then((elements) => finalizeSet(elements));\n        }\n        else {\n            return finalizeSet(elements);\n        }\n    }\n    min(minSize, message) {\n        return new ZodSet({\n            ...this._def,\n            minSize: { value: minSize, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxSize, message) {\n        return new ZodSet({\n            ...this._def,\n            maxSize: { value: maxSize, message: errorUtil.toString(message) },\n        });\n    }\n    size(size, message) {\n        return this.min(size, message).max(size, message);\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodSet.create = (valueType, params) => {\n    return new ZodSet({\n        valueType,\n        minSize: null,\n        maxSize: null,\n        typeName: ZodFirstPartyTypeKind.ZodSet,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodFunction extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.validate = this.implement;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.function) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.function,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        function makeArgsIssue(args, error) {\n            return makeIssue({\n                data: args,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_arguments,\n                    argumentsError: error,\n                },\n            });\n        }\n        function makeReturnsIssue(returns, error) {\n            return makeIssue({\n                data: returns,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_return_type,\n                    returnTypeError: error,\n                },\n            });\n        }\n        const params = { errorMap: ctx.common.contextualErrorMap };\n        const fn = ctx.data;\n        if (this._def.returns instanceof ZodPromise) {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(async function (...args) {\n                const error = new ZodError([]);\n                const parsedArgs = await me._def.args.parseAsync(args, params).catch((e) => {\n                    error.addIssue(makeArgsIssue(args, e));\n                    throw error;\n                });\n                const result = await Reflect.apply(fn, this, parsedArgs);\n                const parsedReturns = await me._def.returns._def.type\n                    .parseAsync(result, params)\n                    .catch((e) => {\n                    error.addIssue(makeReturnsIssue(result, e));\n                    throw error;\n                });\n                return parsedReturns;\n            });\n        }\n        else {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(function (...args) {\n                const parsedArgs = me._def.args.safeParse(args, params);\n                if (!parsedArgs.success) {\n                    throw new ZodError([makeArgsIssue(args, parsedArgs.error)]);\n                }\n                const result = Reflect.apply(fn, this, parsedArgs.data);\n                const parsedReturns = me._def.returns.safeParse(result, params);\n                if (!parsedReturns.success) {\n                    throw new ZodError([makeReturnsIssue(result, parsedReturns.error)]);\n                }\n                return parsedReturns.data;\n            });\n        }\n    }\n    parameters() {\n        return this._def.args;\n    }\n    returnType() {\n        return this._def.returns;\n    }\n    args(...items) {\n        return new ZodFunction({\n            ...this._def,\n            args: ZodTuple.create(items).rest(ZodUnknown.create()),\n        });\n    }\n    returns(returnType) {\n        return new ZodFunction({\n            ...this._def,\n            returns: returnType,\n        });\n    }\n    implement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    strictImplement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    static create(args, returns, params) {\n        return new ZodFunction({\n            args: (args ? args : ZodTuple.create([]).rest(ZodUnknown.create())),\n            returns: returns || ZodUnknown.create(),\n            typeName: ZodFirstPartyTypeKind.ZodFunction,\n            ...processCreateParams(params),\n        });\n    }\n}\nexport class ZodLazy extends ZodType {\n    get schema() {\n        return this._def.getter();\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const lazySchema = this._def.getter();\n        return lazySchema._parse({ data: ctx.data, path: ctx.path, parent: ctx });\n    }\n}\nZodLazy.create = (getter, params) => {\n    return new ZodLazy({\n        getter: getter,\n        typeName: ZodFirstPartyTypeKind.ZodLazy,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodLiteral extends ZodType {\n    _parse(input) {\n        if (input.data !== this._def.value) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_literal,\n                expected: this._def.value,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n    get value() {\n        return this._def.value;\n    }\n}\nZodLiteral.create = (value, params) => {\n    return new ZodLiteral({\n        value: value,\n        typeName: ZodFirstPartyTypeKind.ZodLiteral,\n        ...processCreateParams(params),\n    });\n};\nfunction createZodEnum(values, params) {\n    return new ZodEnum({\n        values,\n        typeName: ZodFirstPartyTypeKind.ZodEnum,\n        ...processCreateParams(params),\n    });\n}\nexport class ZodEnum extends ZodType {\n    _parse(input) {\n        if (typeof input.data !== \"string\") {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(this._def.values);\n        }\n        if (!this._cache.has(input.data)) {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get options() {\n        return this._def.values;\n    }\n    get enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Values() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    extract(values, newDef = this._def) {\n        return ZodEnum.create(values, {\n            ...this._def,\n            ...newDef,\n        });\n    }\n    exclude(values, newDef = this._def) {\n        return ZodEnum.create(this.options.filter((opt) => !values.includes(opt)), {\n            ...this._def,\n            ...newDef,\n        });\n    }\n}\nZodEnum.create = createZodEnum;\nexport class ZodNativeEnum extends ZodType {\n    _parse(input) {\n        const nativeEnumValues = util.getValidEnumValues(this._def.values);\n        const ctx = this._getOrReturnCtx(input);\n        if (ctx.parsedType !== ZodParsedType.string && ctx.parsedType !== ZodParsedType.number) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(util.getValidEnumValues(this._def.values));\n        }\n        if (!this._cache.has(input.data)) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get enum() {\n        return this._def.values;\n    }\n}\nZodNativeEnum.create = (values, params) => {\n    return new ZodNativeEnum({\n        values: values,\n        typeName: ZodFirstPartyTypeKind.ZodNativeEnum,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodPromise extends ZodType {\n    unwrap() {\n        return this._def.type;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.promise && ctx.common.async === false) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.promise,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const promisified = ctx.parsedType === ZodParsedType.promise ? ctx.data : Promise.resolve(ctx.data);\n        return OK(promisified.then((data) => {\n            return this._def.type.parseAsync(data, {\n                path: ctx.path,\n                errorMap: ctx.common.contextualErrorMap,\n            });\n        }));\n    }\n}\nZodPromise.create = (schema, params) => {\n    return new ZodPromise({\n        type: schema,\n        typeName: ZodFirstPartyTypeKind.ZodPromise,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodEffects extends ZodType {\n    innerType() {\n        return this._def.schema;\n    }\n    sourceType() {\n        return this._def.schema._def.typeName === ZodFirstPartyTypeKind.ZodEffects\n            ? this._def.schema.sourceType()\n            : this._def.schema;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const effect = this._def.effect || null;\n        const checkCtx = {\n            addIssue: (arg) => {\n                addIssueToContext(ctx, arg);\n                if (arg.fatal) {\n                    status.abort();\n                }\n                else {\n                    status.dirty();\n                }\n            },\n            get path() {\n                return ctx.path;\n            },\n        };\n        checkCtx.addIssue = checkCtx.addIssue.bind(checkCtx);\n        if (effect.type === \"preprocess\") {\n            const processed = effect.transform(ctx.data, checkCtx);\n            if (ctx.common.async) {\n                return Promise.resolve(processed).then(async (processed) => {\n                    if (status.value === \"aborted\")\n                        return INVALID;\n                    const result = await this._def.schema._parseAsync({\n                        data: processed,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                    if (result.status === \"aborted\")\n                        return INVALID;\n                    if (result.status === \"dirty\")\n                        return DIRTY(result.value);\n                    if (status.value === \"dirty\")\n                        return DIRTY(result.value);\n                    return result;\n                });\n            }\n            else {\n                if (status.value === \"aborted\")\n                    return INVALID;\n                const result = this._def.schema._parseSync({\n                    data: processed,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (result.status === \"aborted\")\n                    return INVALID;\n                if (result.status === \"dirty\")\n                    return DIRTY(result.value);\n                if (status.value === \"dirty\")\n                    return DIRTY(result.value);\n                return result;\n            }\n        }\n        if (effect.type === \"refinement\") {\n            const executeRefinement = (acc) => {\n                const result = effect.refinement(acc, checkCtx);\n                if (ctx.common.async) {\n                    return Promise.resolve(result);\n                }\n                if (result instanceof Promise) {\n                    throw new Error(\"Async refinement encountered during synchronous parse operation. Use .parseAsync instead.\");\n                }\n                return acc;\n            };\n            if (ctx.common.async === false) {\n                const inner = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inner.status === \"aborted\")\n                    return INVALID;\n                if (inner.status === \"dirty\")\n                    status.dirty();\n                // return value is ignored\n                executeRefinement(inner.value);\n                return { status: status.value, value: inner.value };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((inner) => {\n                    if (inner.status === \"aborted\")\n                        return INVALID;\n                    if (inner.status === \"dirty\")\n                        status.dirty();\n                    return executeRefinement(inner.value).then(() => {\n                        return { status: status.value, value: inner.value };\n                    });\n                });\n            }\n        }\n        if (effect.type === \"transform\") {\n            if (ctx.common.async === false) {\n                const base = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (!isValid(base))\n                    return INVALID;\n                const result = effect.transform(base.value, checkCtx);\n                if (result instanceof Promise) {\n                    throw new Error(`Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.`);\n                }\n                return { status: status.value, value: result };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((base) => {\n                    if (!isValid(base))\n                        return INVALID;\n                    return Promise.resolve(effect.transform(base.value, checkCtx)).then((result) => ({\n                        status: status.value,\n                        value: result,\n                    }));\n                });\n            }\n        }\n        util.assertNever(effect);\n    }\n}\nZodEffects.create = (schema, effect, params) => {\n    return new ZodEffects({\n        schema,\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        effect,\n        ...processCreateParams(params),\n    });\n};\nZodEffects.createWithPreprocess = (preprocess, schema, params) => {\n    return new ZodEffects({\n        schema,\n        effect: { type: \"preprocess\", transform: preprocess },\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        ...processCreateParams(params),\n    });\n};\nexport { ZodEffects as ZodTransformer };\nexport class ZodOptional extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.undefined) {\n            return OK(undefined);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodOptional.create = (type, params) => {\n    return new ZodOptional({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodOptional,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNullable extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.null) {\n            return OK(null);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodNullable.create = (type, params) => {\n    return new ZodNullable({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodNullable,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDefault extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        let data = ctx.data;\n        if (ctx.parsedType === ZodParsedType.undefined) {\n            data = this._def.defaultValue();\n        }\n        return this._def.innerType._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    removeDefault() {\n        return this._def.innerType;\n    }\n}\nZodDefault.create = (type, params) => {\n    return new ZodDefault({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodDefault,\n        defaultValue: typeof params.default === \"function\" ? params.default : () => params.default,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodCatch extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        // newCtx is used to not collect issues from inner types in ctx\n        const newCtx = {\n            ...ctx,\n            common: {\n                ...ctx.common,\n                issues: [],\n            },\n        };\n        const result = this._def.innerType._parse({\n            data: newCtx.data,\n            path: newCtx.path,\n            parent: {\n                ...newCtx,\n            },\n        });\n        if (isAsync(result)) {\n            return result.then((result) => {\n                return {\n                    status: \"valid\",\n                    value: result.status === \"valid\"\n                        ? result.value\n                        : this._def.catchValue({\n                            get error() {\n                                return new ZodError(newCtx.common.issues);\n                            },\n                            input: newCtx.data,\n                        }),\n                };\n            });\n        }\n        else {\n            return {\n                status: \"valid\",\n                value: result.status === \"valid\"\n                    ? result.value\n                    : this._def.catchValue({\n                        get error() {\n                            return new ZodError(newCtx.common.issues);\n                        },\n                        input: newCtx.data,\n                    }),\n            };\n        }\n    }\n    removeCatch() {\n        return this._def.innerType;\n    }\n}\nZodCatch.create = (type, params) => {\n    return new ZodCatch({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodCatch,\n        catchValue: typeof params.catch === \"function\" ? params.catch : () => params.catch,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNaN extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.nan) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.nan,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n}\nZodNaN.create = (params) => {\n    return new ZodNaN({\n        typeName: ZodFirstPartyTypeKind.ZodNaN,\n        ...processCreateParams(params),\n    });\n};\nexport const BRAND = Symbol(\"zod_brand\");\nexport class ZodBranded extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const data = ctx.data;\n        return this._def.type._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    unwrap() {\n        return this._def.type;\n    }\n}\nexport class ZodPipeline extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.common.async) {\n            const handleAsync = async () => {\n                const inResult = await this._def.in._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inResult.status === \"aborted\")\n                    return INVALID;\n                if (inResult.status === \"dirty\") {\n                    status.dirty();\n                    return DIRTY(inResult.value);\n                }\n                else {\n                    return this._def.out._parseAsync({\n                        data: inResult.value,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                }\n            };\n            return handleAsync();\n        }\n        else {\n            const inResult = this._def.in._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n            if (inResult.status === \"aborted\")\n                return INVALID;\n            if (inResult.status === \"dirty\") {\n                status.dirty();\n                return {\n                    status: \"dirty\",\n                    value: inResult.value,\n                };\n            }\n            else {\n                return this._def.out._parseSync({\n                    data: inResult.value,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n            }\n        }\n    }\n    static create(a, b) {\n        return new ZodPipeline({\n            in: a,\n            out: b,\n            typeName: ZodFirstPartyTypeKind.ZodPipeline,\n        });\n    }\n}\nexport class ZodReadonly extends ZodType {\n    _parse(input) {\n        const result = this._def.innerType._parse(input);\n        const freeze = (data) => {\n            if (isValid(data)) {\n                data.value = Object.freeze(data.value);\n            }\n            return data;\n        };\n        return isAsync(result) ? result.then((data) => freeze(data)) : freeze(result);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodReadonly.create = (type, params) => {\n    return new ZodReadonly({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodReadonly,\n        ...processCreateParams(params),\n    });\n};\n////////////////////////////////////////\n////////////////////////////////////////\n//////////                    //////////\n//////////      z.custom      //////////\n//////////                    //////////\n////////////////////////////////////////\n////////////////////////////////////////\nfunction cleanParams(params, data) {\n    const p = typeof params === \"function\" ? params(data) : typeof params === \"string\" ? { message: params } : params;\n    const p2 = typeof p === \"string\" ? { message: p } : p;\n    return p2;\n}\nexport function custom(check, _params = {}, \n/**\n * @deprecated\n *\n * Pass `fatal` into the params object instead:\n *\n * ```ts\n * z.string().custom((val) => val.length > 5, { fatal: false })\n * ```\n *\n */\nfatal) {\n    if (check)\n        return ZodAny.create().superRefine((data, ctx) => {\n            const r = check(data);\n            if (r instanceof Promise) {\n                return r.then((r) => {\n                    if (!r) {\n                        const params = cleanParams(_params, data);\n                        const _fatal = params.fatal ?? fatal ?? true;\n                        ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n                    }\n                });\n            }\n            if (!r) {\n                const params = cleanParams(_params, data);\n                const _fatal = params.fatal ?? fatal ?? true;\n                ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n            }\n            return;\n        });\n    return ZodAny.create();\n}\nexport { ZodType as Schema, ZodType as ZodSchema };\nexport const late = {\n    object: ZodObject.lazycreate,\n};\nexport var ZodFirstPartyTypeKind;\n(function (ZodFirstPartyTypeKind) {\n    ZodFirstPartyTypeKind[\"ZodString\"] = \"ZodString\";\n    ZodFirstPartyTypeKind[\"ZodNumber\"] = \"ZodNumber\";\n    ZodFirstPartyTypeKind[\"ZodNaN\"] = \"ZodNaN\";\n    ZodFirstPartyTypeKind[\"ZodBigInt\"] = \"ZodBigInt\";\n    ZodFirstPartyTypeKind[\"ZodBoolean\"] = \"ZodBoolean\";\n    ZodFirstPartyTypeKind[\"ZodDate\"] = \"ZodDate\";\n    ZodFirstPartyTypeKind[\"ZodSymbol\"] = \"ZodSymbol\";\n    ZodFirstPartyTypeKind[\"ZodUndefined\"] = \"ZodUndefined\";\n    ZodFirstPartyTypeKind[\"ZodNull\"] = \"ZodNull\";\n    ZodFirstPartyTypeKind[\"ZodAny\"] = \"ZodAny\";\n    ZodFirstPartyTypeKind[\"ZodUnknown\"] = \"ZodUnknown\";\n    ZodFirstPartyTypeKind[\"ZodNever\"] = \"ZodNever\";\n    ZodFirstPartyTypeKind[\"ZodVoid\"] = \"ZodVoid\";\n    ZodFirstPartyTypeKind[\"ZodArray\"] = \"ZodArray\";\n    ZodFirstPartyTypeKind[\"ZodObject\"] = \"ZodObject\";\n    ZodFirstPartyTypeKind[\"ZodUnion\"] = \"ZodUnion\";\n    ZodFirstPartyTypeKind[\"ZodDiscriminatedUnion\"] = \"ZodDiscriminatedUnion\";\n    ZodFirstPartyTypeKind[\"ZodIntersection\"] = \"ZodIntersection\";\n    ZodFirstPartyTypeKind[\"ZodTuple\"] = \"ZodTuple\";\n    ZodFirstPartyTypeKind[\"ZodRecord\"] = \"ZodRecord\";\n    ZodFirstPartyTypeKind[\"ZodMap\"] = \"ZodMap\";\n    ZodFirstPartyTypeKind[\"ZodSet\"] = \"ZodSet\";\n    ZodFirstPartyTypeKind[\"ZodFunction\"] = \"ZodFunction\";\n    ZodFirstPartyTypeKind[\"ZodLazy\"] = \"ZodLazy\";\n    ZodFirstPartyTypeKind[\"ZodLiteral\"] = \"ZodLiteral\";\n    ZodFirstPartyTypeKind[\"ZodEnum\"] = \"ZodEnum\";\n    ZodFirstPartyTypeKind[\"ZodEffects\"] = \"ZodEffects\";\n    ZodFirstPartyTypeKind[\"ZodNativeEnum\"] = \"ZodNativeEnum\";\n    ZodFirstPartyTypeKind[\"ZodOptional\"] = \"ZodOptional\";\n    ZodFirstPartyTypeKind[\"ZodNullable\"] = \"ZodNullable\";\n    ZodFirstPartyTypeKind[\"ZodDefault\"] = \"ZodDefault\";\n    ZodFirstPartyTypeKind[\"ZodCatch\"] = \"ZodCatch\";\n    ZodFirstPartyTypeKind[\"ZodPromise\"] = \"ZodPromise\";\n    ZodFirstPartyTypeKind[\"ZodBranded\"] = \"ZodBranded\";\n    ZodFirstPartyTypeKind[\"ZodPipeline\"] = \"ZodPipeline\";\n    ZodFirstPartyTypeKind[\"ZodReadonly\"] = \"ZodReadonly\";\n})(ZodFirstPartyTypeKind || (ZodFirstPartyTypeKind = {}));\n// requires TS 4.4+\nclass Class {\n    constructor(..._) { }\n}\nconst instanceOfType = (\n// const instanceOfType = <T extends new (...args: any[]) => any>(\ncls, params = {\n    message: `Input not instance of ${cls.name}`,\n}) => custom((data) => data instanceof cls, params);\nconst stringType = ZodString.create;\nconst numberType = ZodNumber.create;\nconst nanType = ZodNaN.create;\nconst bigIntType = ZodBigInt.create;\nconst booleanType = ZodBoolean.create;\nconst dateType = ZodDate.create;\nconst symbolType = ZodSymbol.create;\nconst undefinedType = ZodUndefined.create;\nconst nullType = ZodNull.create;\nconst anyType = ZodAny.create;\nconst unknownType = ZodUnknown.create;\nconst neverType = ZodNever.create;\nconst voidType = ZodVoid.create;\nconst arrayType = ZodArray.create;\nconst objectType = ZodObject.create;\nconst strictObjectType = ZodObject.strictCreate;\nconst unionType = ZodUnion.create;\nconst discriminatedUnionType = ZodDiscriminatedUnion.create;\nconst intersectionType = ZodIntersection.create;\nconst tupleType = ZodTuple.create;\nconst recordType = ZodRecord.create;\nconst mapType = ZodMap.create;\nconst setType = ZodSet.create;\nconst functionType = ZodFunction.create;\nconst lazyType = ZodLazy.create;\nconst literalType = ZodLiteral.create;\nconst enumType = ZodEnum.create;\nconst nativeEnumType = ZodNativeEnum.create;\nconst promiseType = ZodPromise.create;\nconst effectsType = ZodEffects.create;\nconst optionalType = ZodOptional.create;\nconst nullableType = ZodNullable.create;\nconst preprocessType = ZodEffects.createWithPreprocess;\nconst pipelineType = ZodPipeline.create;\nconst ostring = () => stringType().optional();\nconst onumber = () => numberType().optional();\nconst oboolean = () => booleanType().optional();\nexport const coerce = {\n    string: ((arg) => ZodString.create({ ...arg, coerce: true })),\n    number: ((arg) => ZodNumber.create({ ...arg, coerce: true })),\n    boolean: ((arg) => ZodBoolean.create({\n        ...arg,\n        coerce: true,\n    })),\n    bigint: ((arg) => ZodBigInt.create({ ...arg, coerce: true })),\n    date: ((arg) => ZodDate.create({ ...arg, coerce: true })),\n};\nexport { anyType as any, arrayType as array, bigIntType as bigint, booleanType as boolean, dateType as date, discriminatedUnionType as discriminatedUnion, effectsType as effect, enumType as enum, functionType as function, instanceOfType as instanceof, intersectionType as intersection, lazyType as lazy, literalType as literal, mapType as map, nanType as nan, nativeEnumType as nativeEnum, neverType as never, nullType as null, nullableType as nullable, numberType as number, objectType as object, oboolean, onumber, optionalType as optional, ostring, pipelineType as pipeline, preprocessType as preprocess, promiseType as promise, recordType as record, setType as set, strictObjectType as strictObject, stringType as string, symbolType as symbol, effectsType as transformer, tupleType as tuple, undefinedType as undefined, unionType as union, unknownType as unknown, voidType as void, };\nexport const NEVER = INVALID;\n", "/**\n * \u5DE5\u5177\u6CE8\u518C\u4E2D\u5FC3\n * \u7BA1\u7406\u5DE5\u5177\u6CE8\u518C\u3001\u6821\u9A8C\u3001\u8C03\u7528\n */\n\nimport type { Tool, ToolStreamChunk } from './types';\nimport { z } from 'zod';\n\nexport class ToolRegistry {\n    private tools: Map<string, Tool> = new Map();\n\n    /**\n     * \u6CE8\u518C\u5DE5\u5177\n     */\n    register(tool: Tool): void {\n        if (this.tools.has(tool.name)) {\n            throw new Error(`\u5DE5\u5177 \"${tool.name}\" \u5DF2\u6CE8\u518C`);\n        }\n        this.tools.set(tool.name, tool);\n    }\n\n    /**\n     * \u6279\u91CF\u6CE8\u518C\u5DE5\u5177\n     */\n    registerAll(tools: Tool[]): void {\n        tools.forEach(tool => this.register(tool));\n    }\n\n    /**\n     * \u83B7\u53D6\u5DE5\u5177\n     */\n    get(name: string): Tool | undefined {\n        return this.tools.get(name);\n    }\n\n    /**\n     * \u68C0\u67E5\u5DE5\u5177\u662F\u5426\u5B58\u5728\n     */\n    has(name: string): boolean {\n        return this.tools.has(name);\n    }\n\n    /**\n     * \u83B7\u53D6\u6240\u6709\u5DE5\u5177\u540D\u79F0\n     */\n    list(): string[] {\n        return Array.from(this.tools.keys());\n    }\n\n    /**\n     * \u6821\u9A8C\u8F93\u5165\n     */\n    validateInput(toolName: string, input: unknown): { valid: boolean; error?: string; data?: unknown } {\n        const tool = this.tools.get(toolName);\n        if (!tool) {\n            return { valid: false, error: `\u5DE5\u5177 \"${toolName}\" \u4E0D\u5B58\u5728` };\n        }\n\n        try {\n            const data = tool.inputSchema.parse(input);\n            return { valid: true, data };\n        } catch (error) {\n            if (error instanceof z.ZodError) {\n                return { valid: false, error: `\u8F93\u5165\u6821\u9A8C\u5931\u8D25: ${error.errors.map(e => e.message).join(', ')}` };\n            }\n            return { valid: false, error: String(error) };\n        }\n    }\n\n    /**\n     * \u6821\u9A8C\u8F93\u51FA\n     */\n    validateOutput(toolName: string, output: unknown): { valid: boolean; error?: string; data?: unknown } {\n        const tool = this.tools.get(toolName);\n        if (!tool) {\n            return { valid: false, error: `\u5DE5\u5177 \"${toolName}\" \u4E0D\u5B58\u5728` };\n        }\n\n        try {\n            const data = tool.outputSchema.parse(output);\n            return { valid: true, data };\n        } catch (error) {\n            if (error instanceof z.ZodError) {\n                return { valid: false, error: `\u8F93\u51FA\u6821\u9A8C\u5931\u8D25: ${error.errors.map(e => e.message).join(', ')}` };\n            }\n            return { valid: false, error: String(error) };\n        }\n    }\n\n    /**\n     * \u68C0\u67E5\u6743\u9650\n     */\n    checkPermission(toolName: string, permissions: Record<string, boolean>): boolean {\n        const tool = this.tools.get(toolName);\n        if (!tool) return false;\n\n        // \u5982\u679C\u5DE5\u5177\u6CA1\u6709\u6743\u9650\u8981\u6C42\uFF0C\u9ED8\u8BA4\u5141\u8BB8\n        if (!tool.permissions || tool.permissions.length === 0) {\n            return true;\n        }\n\n        // \u68C0\u67E5\u662F\u5426\u62E5\u6709\u6240\u6709\u5FC5\u9700\u6743\u9650\n        return tool.permissions.every(perm => permissions[perm] === true);\n    }\n\n    /**\n     * \u68C0\u67E5\u8282\u70B9\u662F\u5426\u5141\u8BB8\u8C03\u7528\u5DE5\u5177\n     */\n    checkNodeAllowed(toolName: string, nodeId: string): boolean {\n        const tool = this.tools.get(toolName);\n        if (!tool) return false;\n\n        // \u5982\u679C\u6CA1\u6709\u8282\u70B9\u767D\u540D\u5355\uFF0C\u9ED8\u8BA4\u5141\u8BB8\u6240\u6709\u8282\u70B9\n        if (!tool.allowedNodes || tool.allowedNodes.length === 0) {\n            return true;\n        }\n\n        return tool.allowedNodes.includes(nodeId);\n    }\n\n    /**\n     * \u6267\u884C\u5DE5\u5177\uFF08\u5E26\u8D85\u65F6\u63A7\u5236\uFF09\n     */\n    async execute(\n        toolName: string,\n        input: unknown,\n        options?: {\n            nodeId?: string;\n            permissions?: Record<string, boolean>;\n            onStream?: (chunk: ToolStreamChunk) => void;\n        }\n    ): Promise<{ success: boolean; output?: unknown; error?: string }> {\n        const tool = this.tools.get(toolName);\n        if (!tool) {\n            return { success: false, error: `\u5DE5\u5177 \"${toolName}\" \u4E0D\u5B58\u5728` };\n        }\n\n        // \u68C0\u67E5\u8282\u70B9\u6743\u9650\n        if (options?.nodeId && !this.checkNodeAllowed(toolName, options.nodeId)) {\n            return { success: false, error: `\u8282\u70B9 \"${options.nodeId}\" \u4E0D\u5141\u8BB8\u8C03\u7528\u5DE5\u5177 \"${toolName}\"` };\n        }\n\n        // \u68C0\u67E5\u7528\u6237\u6743\u9650\n        if (options?.permissions && !this.checkPermission(toolName, options.permissions)) {\n            return { success: false, error: `\u7F3A\u5C11\u5FC5\u9700\u6743\u9650: ${tool.permissions.join(', ')}` };\n        }\n\n        // \u6821\u9A8C\u8F93\u5165\n        const inputValidation = this.validateInput(toolName, input);\n        if (!inputValidation.valid) {\n            return { success: false, error: inputValidation.error };\n        }\n\n        try {\n            // \u6267\u884C\u5DE5\u5177\uFF08\u5E26\u8D85\u65F6\uFF09\n            const output = await this.executeWithTimeout(\n                tool.execute(inputValidation.data, {\n                    onStream: options?.onStream,\n                }),\n                tool.timeout\n            );\n\n            // \u6821\u9A8C\u8F93\u51FA\n            const outputValidation = this.validateOutput(toolName, output);\n            if (!outputValidation.valid) {\n                return { success: false, error: `\u5951\u7EA6\u9519\u8BEF: ${outputValidation.error}` };\n            }\n\n            return { success: true, output: outputValidation.data };\n        } catch (error) {\n            return { success: false, error: String(error) };\n        }\n    }\n\n    private executeWithTimeout<T>(promise: Promise<T>, timeoutMs: number): Promise<T> {\n        let timeoutHandle: ReturnType<typeof setTimeout>;\n\n        const timeoutPromise = new Promise<T>((_, reject) => {\n            timeoutHandle = setTimeout(() => {\n                reject(new Error(`\u5DE5\u5177\u6267\u884C\u8D85\u65F6 (${timeoutMs}ms)`));\n            }, timeoutMs);\n        });\n\n        return Promise.race([\n            promise,\n            timeoutPromise,\n        ]).finally(() => {\n            // \u786E\u4FDD\u5B9A\u65F6\u5668\u88AB\u6E05\u7406\uFF0C\u9632\u6B62\u5185\u5B58\u6CC4\u9732\u548C\u8FDB\u7A0B\u6302\u8D77\n            clearTimeout(timeoutHandle);\n        });\n    }\n}\n", "/**\n * \u9519\u8BEF\u5904\u7406\u7CFB\u7EDF\n * \u9519\u8BEF\u5206\u7C7B\u3001\u91CD\u8BD5\u7B56\u7565\u3001\u964D\u7EA7\u3001\u56DE\u6EDA\n */\n\nimport type { AgentError, State, Checkpoint } from './types';\nimport { ErrorType } from './types';\n\n// \u91CD\u65B0\u5BFC\u51FA ErrorType\nexport { ErrorType };\n\n/**\n * \u521B\u5EFA AgentError\n */\nexport function createError(\n    type: ErrorType,\n    message: string,\n    options?: {\n        nodeId?: string;\n        toolName?: string;\n        retryable?: boolean;\n        originalError?: Error;\n    }\n): AgentError {\n    return {\n        type,\n        message,\n        nodeId: options?.nodeId,\n        toolName: options?.toolName,\n        retryable: options?.retryable ?? isRetryable(type),\n        originalError: options?.originalError,\n        timestamp: Date.now(),\n    };\n}\n\n/**\n * \u5224\u65AD\u9519\u8BEF\u662F\u5426\u53EF\u91CD\u8BD5\n */\nfunction isRetryable(type: ErrorType): boolean {\n    switch (type) {\n        case 'network':\n        case 'timeout':\n        case 'execution':\n            return true;\n        case 'permission':\n        case 'validation':\n        case 'budget_exceeded':\n            return false;\n        default:\n            return false;\n    }\n}\n\n/**\n * \u9519\u8BEF\u5904\u7406\u7B56\u7565\n */\nexport interface ErrorStrategy {\n    shouldRetry: boolean;\n    shouldDegrade: boolean;\n    shouldRollback: boolean;\n    shouldTerminate: boolean;\n    suggestion?: string;\n}\n\n/**\n * \u83B7\u53D6\u9519\u8BEF\u5904\u7406\u7B56\u7565\n */\nexport function getErrorStrategy(error: AgentError, retryCount: number, maxRetries: number): ErrorStrategy {\n    // \u9884\u7B97\u8D85\u9650 -> \u76F4\u63A5\u7EC8\u6B62\n    if (error.type === 'budget_exceeded') {\n        return {\n            shouldRetry: false,\n            shouldDegrade: false,\n            shouldRollback: false,\n            shouldTerminate: true,\n            suggestion: '\u5DF2\u8FBE\u5230\u9884\u7B97\u9650\u5236\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E\u6216\u4F18\u5316\u5DE5\u5177\u8C03\u7528',\n        };\n    }\n\n    // \u6743\u9650\u9519\u8BEF -> \u76F4\u63A5\u7EC8\u6B62\n    if (error.type === 'permission') {\n        return {\n            shouldRetry: false,\n            shouldDegrade: false,\n            shouldRollback: false,\n            shouldTerminate: true,\n            suggestion: '\u6743\u9650\u4E0D\u8DB3\uFF0C\u8BF7\u68C0\u67E5\u5DE5\u5177\u6743\u9650\u914D\u7F6E',\n        };\n    }\n\n    // \u6821\u9A8C\u9519\u8BEF -> \u5C1D\u8BD5\u964D\u7EA7\u6216\u7EC8\u6B62\n    if (error.type === 'validation') {\n        return {\n            shouldRetry: false,\n            shouldDegrade: true,\n            shouldRollback: false,\n            shouldTerminate: !error.retryable,\n            suggestion: '\u8F93\u5165\u6216\u8F93\u51FA\u6821\u9A8C\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u5DE5\u5177\u5951\u7EA6',\n        };\n    }\n\n    // \u53EF\u91CD\u8BD5\u9519\u8BEF\n    if (error.retryable && retryCount < maxRetries) {\n        return {\n            shouldRetry: true,\n            shouldDegrade: false,\n            shouldRollback: false,\n            shouldTerminate: false,\n            suggestion: `\u5C06\u5728 ${getBackoffDelay(retryCount)}ms \u540E\u91CD\u8BD5 (${retryCount + 1}/${maxRetries})`,\n        };\n    }\n\n    // \u91CD\u8BD5\u6B21\u6570\u8017\u5C3D -> \u5C1D\u8BD5\u964D\u7EA7\n    if (retryCount >= maxRetries) {\n        return {\n            shouldRetry: false,\n            shouldDegrade: true,\n            shouldRollback: false,\n            shouldTerminate: false,\n            suggestion: '\u91CD\u8BD5\u6B21\u6570\u5DF2\u8017\u5C3D\uFF0C\u5C1D\u8BD5\u964D\u7EA7\u7B56\u7565',\n        };\n    }\n\n    // \u9ED8\u8BA4\u7EC8\u6B62\n    return {\n        shouldRetry: false,\n        shouldDegrade: false,\n        shouldRollback: false,\n        shouldTerminate: true,\n        suggestion: '\u65E0\u6CD5\u6062\u590D\u7684\u9519\u8BEF',\n    };\n}\n\n/**\n * \u8BA1\u7B97\u6307\u6570\u9000\u907F\u5EF6\u8FDF\n */\nexport function getBackoffDelay(retryCount: number, baseMs: number = 1000, multiplier: number = 2): number {\n    return baseMs * Math.pow(multiplier, retryCount);\n}\n\n/**\n * \u6267\u884C\u91CD\u8BD5\uFF08\u5E26\u6307\u6570\u9000\u907F\uFF09\n */\nexport async function retryWithBackoff<T>(\n    fn: () => Promise<T>,\n    maxRetries: number,\n    baseMs: number = 1000,\n    multiplier: number = 2\n): Promise<T> {\n    let lastError: Error | undefined;\n\n    for (let i = 0; i <= maxRetries; i++) {\n        try {\n            return await fn();\n        } catch (error) {\n            lastError = error instanceof Error ? error : new Error(String(error));\n\n            if (i < maxRetries) {\n                const delay = getBackoffDelay(i, baseMs, multiplier);\n                await sleep(delay);\n            }\n        }\n    }\n\n    throw lastError;\n}\n\n/**\n * \u964D\u7EA7\u7B56\u7565\u793A\u4F8B\n * \u5B9E\u9645\u9879\u76EE\u4E2D\u5E94\u6839\u636E\u5177\u4F53\u573A\u666F\u5B9E\u73B0\n */\nexport interface DegradationOptions {\n    alternativeTool?: string; // \u5907\u7528\u5DE5\u5177\n    simplifiedInput?: unknown; // \u7B80\u5316\u8F93\u5165\n    fallbackValue?: unknown; // \u964D\u7EA7\u9ED8\u8BA4\u503C\n}\n\n/**\n * \u56DE\u6EDA\u5230 checkpoint\n */\nexport function rollbackToCheckpoint(checkpoint: Checkpoint): State {\n    return checkpoint.state;\n}\n\n/**\n * \u683C\u5F0F\u5316\u9519\u8BEF\u4FE1\u606F\uFF08\u7528\u6237\u53CB\u597D\uFF09\n */\nexport function formatErrorMessage(error: AgentError): string {\n    const parts = [`[${error.type.toUpperCase()}]`, error.message];\n\n    if (error.nodeId) {\n        parts.push(`(\u8282\u70B9: ${error.nodeId})`);\n    }\n\n    if (error.toolName) {\n        parts.push(`(\u5DE5\u5177: ${error.toolName})`);\n    }\n\n    return parts.join(' ');\n}\n\n// ============================================================================\n// \u8F85\u52A9\u51FD\u6570\n// ============================================================================\n\nfunction sleep(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n", "/**\n * Node \u57FA\u7C7B\n * \u6240\u6709\u8282\u70B9\u7684\u57FA\u7840\u5B9E\u73B0\n */\n\nimport type { Node, NodeResult, State, NodeContext } from './types';\n\nexport abstract class BaseNode implements Node {\n    constructor(\n        public readonly id: string,\n        public readonly name: string\n    ) { }\n\n    /**\n     * \u6267\u884C\u8282\u70B9\u903B\u8F91\uFF08\u5B50\u7C7B\u5FC5\u987B\u5B9E\u73B0\uFF09\n     */\n    abstract execute(state: State, context?: NodeContext): Promise<NodeResult>;\n\n    /**\n     * \u521B\u5EFA\u57FA\u7840 NodeResult\n     */\n    protected createResult(state: State, events: NodeResult['events'] = []): NodeResult {\n        return { state, events };\n    }\n}\n", "import type { Node, NodeResult, RunnerHooks, State } from '../types';\nimport { EventStream } from '../event-stream';\nimport { StateHelpers } from '../state';\nimport { createError, getErrorStrategy, getBackoffDelay, ErrorType } from '../error-handler';\n\ninterface NodeExecutorDeps {\n    eventStream: EventStream;\n    hooks?: RunnerHooks;\n}\n\nexport class NodeExecutor {\n    constructor(private readonly deps: NodeExecutorDeps) { }\n\n    async run(node: Node, state: State): Promise<NodeResult> {\n        await this.deps.hooks?.onNodeStart?.(node.id, state);\n\n        this.deps.eventStream.emit('node_start', 'info', `\u5F00\u59CB\u6267\u884C\u8282\u70B9: ${node.name}`, {\n            nodeId: node.id,\n            metadata: {\n                nodeName: node.name,\n            },\n        });\n\n        let retryCount = 0;\n        let lastError: Error | undefined;\n\n        const context = {\n            emitEvent: (type: any, status: any, summary: string, payload?: unknown) => {\n                this.deps.eventStream.emit(type, status, summary, {\n                    nodeId: node.id,\n                    payload,\n                });\n            }\n        };\n\n        while (retryCount <= state.policy.maxRetries) {\n            const attemptStartTime = Date.now();\n            try {\n                const result = await node.execute(state, context);\n                const duration = Date.now() - attemptStartTime;\n\n                result.state = StateHelpers.recordNodeTiming(result.state, node.id, duration);\n\n                await this.deps.hooks?.onNodeEnd?.(node.id, result);\n\n                this.deps.eventStream.emit('node_end', 'success', `\u5B8C\u6210\u8282\u70B9: ${node.name}`, {\n                    nodeId: node.id,\n                    metadata: {\n                        nodeName: node.name,\n                        durationMs: duration,\n                    },\n                });\n\n                return result;\n            } catch (error) {\n                lastError = error instanceof Error ? error : new Error(String(error));\n                const duration = Date.now() - attemptStartTime;\n\n                const agentError = createError(\n                    ErrorType.EXECUTION,\n                    lastError.message,\n                    {\n                        nodeId: node.id,\n                        retryable: true,\n                        originalError: lastError,\n                    }\n                );\n                const strategy = getErrorStrategy(agentError, retryCount, state.policy.maxRetries);\n\n                if (strategy.shouldRetry) {\n                    retryCount++;\n                    const delay = getBackoffDelay(retryCount - 1);\n\n                    this.deps.eventStream.emit('retry', 'warning', strategy.suggestion || '\u91CD\u8BD5\u4E2D...', {\n                        nodeId: node.id,\n                        metadata: { retryCount, delay },\n                    });\n\n                    state = StateHelpers.incrementRetry(state);\n                    await new Promise(resolve => setTimeout(resolve, delay));\n                } else {\n                    state = StateHelpers.incrementError(state);\n\n                    this.deps.eventStream.emit('node_end', 'failure', `\u8282\u70B9\u6267\u884C\u5931\u8D25: ${node.name}`, {\n                        nodeId: node.id,\n                        metadata: {\n                            nodeName: node.name,\n                            error: lastError.message,\n                            attemptedRetries: retryCount,\n                            durationMs: duration,\n                        },\n                    });\n\n                    throw lastError;\n                }\n            }\n        }\n\n        throw lastError;\n    }\n}\n", "import type { GraphDefinition, State } from '../types';\n\nexport function resolveNextNode(\n    graph: GraphDefinition,\n    currentNodeId: string,\n    state: State,\n    explicitNext?: string\n): string | null {\n    if (explicitNext) {\n        return explicitNext;\n    }\n\n    const edges = graph.edges.filter(e => e.from === currentNodeId);\n\n    for (const edge of edges) {\n        if (edge.condition) {\n            if (edge.condition(state)) {\n                return edge.to;\n            }\n        } else {\n            return edge.to;\n        }\n    }\n\n    return null;\n}\n", "import type { Checkpoint, PersistenceAdapter, RunnerHooks, State } from '../types';\nimport { EventStream } from '../event-stream';\n\nexport class CheckpointManager {\n    constructor(\n        private readonly persistence: PersistenceAdapter | undefined,\n        private readonly eventStream: EventStream,\n        private readonly hooks?: RunnerHooks,\n    ) { }\n\n    async save(state: State): Promise<void> {\n        if (!this.persistence) return;\n\n        const checkpoint: Checkpoint = {\n            id: `checkpoint-${Date.now()}`,\n            stateId: state.id,\n            state,\n            eventIndex: this.eventStream.getEvents().length,\n            timestamp: Date.now(),\n        };\n\n        await this.persistence.saveCheckpoint(checkpoint);\n\n        this.eventStream.emit('checkpoint', 'success', `\u5DF2\u4FDD\u5B58 checkpoint ${checkpoint.id}`, {\n            metadata: { checkpointId: checkpoint.id },\n        });\n\n        await this.hooks?.onCheckpoint?.(checkpoint);\n    }\n\n    async load(checkpointId: string): Promise<Checkpoint> {\n        if (!this.persistence) {\n            throw new Error('\u672A\u914D\u7F6E\u6301\u4E45\u5316\u9002\u914D\u5668\uFF0C\u65E0\u6CD5\u6062\u590D');\n        }\n\n        const checkpoint = await this.persistence.loadCheckpoint(checkpointId);\n        if (!checkpoint) {\n            throw new Error(`Checkpoint \"${checkpointId}\" \u4E0D\u5B58\u5728`);\n        }\n\n        return checkpoint;\n    }\n}\n", "/**\n * Graph Runner \u6267\u884C\u5668\n * \u8D1F\u8D23\u6267\u884C\u6D41\u7A0B\u56FE\u3001\u7BA1\u7406\u72B6\u6001\u3001\u5904\u7406\u9519\u8BEF\u3001\u751F\u6210 checkpoint\n */\n\nimport type {\n    State,\n    GraphDefinition,\n    RunnerHooks,\n    PersistenceAdapter,\n} from './types';\nimport { EventStream } from './event-stream';\nimport { StateHelpers } from './state';\nimport { createError } from './error-handler';\nimport { ErrorType } from './types';\nimport { NodeExecutor } from './runner/node-executor';\nimport { resolveNextNode } from './runner/next-node-resolver';\nimport { CheckpointManager } from './runner/checkpoint-manager';\n\nexport class GraphRunner {\n    private eventStream: EventStream;\n    private checkpointInterval: number; // \u6BCF N \u4E2A\u8282\u70B9\u4FDD\u5B58\u4E00\u6B21 checkpoint\n    private nodeExecutor: NodeExecutor;\n    private checkpointManager: CheckpointManager;\n\n    constructor(\n        private graph: GraphDefinition,\n        private persistence?: PersistenceAdapter,\n        private hooks?: RunnerHooks,\n        options?: {\n            checkpointInterval?: number;\n        }\n    ) {\n        this.eventStream = new EventStream();\n        this.checkpointInterval = options?.checkpointInterval ?? 1; // \u9ED8\u8BA4\u6BCF\u4E2A\u8282\u70B9\u90FD\u4FDD\u5B58\n        this.nodeExecutor = new NodeExecutor({\n            eventStream: this.eventStream,\n            hooks: this.hooks,\n        });\n        this.checkpointManager = new CheckpointManager(this.persistence, this.eventStream, this.hooks);\n    }\n\n    /**\n     * \u6267\u884C\u6D41\u7A0B\n     */\n    async execute(initialState: State): Promise<{ state: State; events: EventStream }> {\n        let currentState = initialState;\n        let currentNodeId = this.graph.entryNode;\n        let stepCount = 0;\n        const startTime = Date.now();\n\n        try {\n            while (currentNodeId && stepCount < this.graph.maxSteps) {\n                // \u68C0\u67E5\u9884\u7B97\n                const budgetCheck = StateHelpers.checkBudget(currentState);\n                if (budgetCheck.exceeded) {\n                    this.eventStream.emit('budget_exceeded', 'failure', budgetCheck.reason!);\n                    await this.hooks?.onBudgetWarning?.('budget', 0, 0);\n                    break;\n                }\n\n                // \u67E5\u627E\u8282\u70B9\n                const node = this.graph.nodes.find(n => n.id === currentNodeId);\n                if (!node) {\n                    throw new Error(`\u8282\u70B9 \"${currentNodeId}\" \u4E0D\u5B58\u5728`);\n                }\n\n                // \u66F4\u65B0\u5F53\u524D\u8282\u70B9\n                currentState = StateHelpers.setCurrentNode(currentState, currentNodeId);\n\n                // \u6267\u884C\u8282\u70B9\n                const result = await this.nodeExecutor.run(node, currentState);\n                currentState = result.state;\n\n                // \u5408\u5E76\u4E8B\u4EF6\n                result.events.forEach(event => {\n                    this.eventStream.emit(\n                        event.type,\n                        event.status,\n                        event.summary,\n                        {\n                            nodeId: event.nodeId,\n                            payload: event.payloadRef ? this.eventStream.getPayload(event.payloadRef) : undefined,\n                            metadata: event.metadata,\n                        }\n                    );\n                });\n\n                // \u4FDD\u5B58 checkpoint\n                if (stepCount % this.checkpointInterval === 0) {\n                    await this.checkpointManager.save(currentState);\n                }\n\n                // \u51B3\u5B9A\u4E0B\u4E00\u4E2A\u8282\u70B9\n                const nextNode = resolveNextNode(this.graph, currentNodeId, currentState, result.nextNode);\n                if (!nextNode) break;\n                currentNodeId = nextNode;\n                stepCount++;\n            }\n\n            // \u68C0\u67E5\u662F\u5426\u8FBE\u5230\u6700\u5927\u6B65\u6570\n            if (stepCount >= this.graph.maxSteps) {\n                this.eventStream.emit(\n                    'budget_exceeded',\n                    'warning',\n                    `\u5DF2\u8FBE\u5230\u6700\u5927\u6B65\u6570\u9650\u5236 (${this.graph.maxSteps})`\n                );\n            }\n\n            const totalDuration = Date.now() - startTime;\n            this.eventStream.emit('health_metrics', 'info', 'Execution health metrics', {\n                metadata: {\n                    totalDurationMs: totalDuration,\n                    tokenCount: currentState.telemetry.tokenCount,\n                    toolCallCount: currentState.telemetry.toolCallCount,\n                    errorCount: currentState.telemetry.errorCount,\n                },\n            });\n\n            return { state: currentState, events: this.eventStream };\n        } catch (error) {\n            const agentError = createError(\n                ErrorType.EXECUTION,\n                String(error),\n                { originalError: error instanceof Error ? error : undefined }\n            );\n            this.eventStream.emit('error', 'failure', agentError.message, {\n                payload: agentError,\n            });\n\n            await this.hooks?.onError?.(agentError);\n\n            throw error;\n        }\n    }\n\n    /**\n     * \u4ECE checkpoint \u6062\u590D\u6267\u884C\n     */\n    async resume(checkpointId: string): Promise<{ state: State; events: EventStream }> {\n        const checkpoint = await this.checkpointManager.load(checkpointId);\n\n        this.eventStream.emit('checkpoint', 'info', `\u4ECE checkpoint ${checkpointId} \u6062\u590D`);\n\n        return this.execute(checkpoint.state);\n    }\n\n    /**\n     * \u83B7\u53D6\u4E8B\u4EF6\u6D41\n     */\n    getEventStream(): EventStream {\n        return this.eventStream;\n    }\n\n    /**\n     * \u83B7\u53D6\u56FE\u5B9A\u4E49\uFF08\u7528\u4E8E\u8C03\u8BD5\uFF09\n     */\n    getGraphDefinition() {\n        return this.graph;\n    }\n\n}\n", "/**\n * LLM Provider \u62BD\u8C61\u5C42\n * \u7EDF\u4E00\u7684 LLM \u5BA2\u6237\u7AEF\u63A5\u53E3\uFF0C\u652F\u6301\u591A\u79CD\u63D0\u4F9B\u5546\n */\n\nimport { z } from 'zod';\n\n/**\n * \u6807\u51C6\u5316\u7684\u804A\u5929\u6D88\u606F\u683C\u5F0F\n */\nexport interface ChatMessage {\n    role: 'system' | 'user' | 'assistant' | 'tool';\n    content: string;\n    name?: string; // \u7528\u4E8E tool \u6D88\u606F\n    toolCallId?: string; // \u7528\u4E8E tool response\n}\n\n/**\n * LLM \u8C03\u7528\u8BF7\u6C42\n */\nexport interface ChatRequest {\n    messages: ChatMessage[];\n    temperature?: number;\n    topP?: number;\n    stopSequences?: string[];\n    stream?: boolean;\n    /** AbortSignal for canceling the request */\n    signal?: AbortSignal;\n}\n\n/**\n * Token \u4F7F\u7528\u7EDF\u8BA1\n */\nexport interface TokenUsage {\n    promptTokens: number;\n    completionTokens: number;\n    totalTokens: number;\n}\n\n/**\n * LLM \u8C03\u7528\u54CD\u5E94\n */\nexport interface ChatResponse {\n    content: string;\n    finishReason?: 'stop' | 'length' | 'tool_calls' | 'content_filter';\n    usage?: TokenUsage;\n    model?: string;\n}\n\n/**\n * \u6D41\u5F0F\u54CD\u5E94\u5757\n */\nexport interface ChatStreamChunk {\n    delta: string;\n    finishReason?: 'stop' | 'length' | 'tool_calls' | 'content_filter';\n    usage?: TokenUsage;\n}\n\n/**\n * LLM Provider \u914D\u7F6E\u57FA\u7C7B\n */\nexport interface LLMProviderConfig {\n    model: string;\n    temperature?: number;\n    timeout?: number;\n}\n\n/**\n * LLM Provider \u62BD\u8C61\u63A5\u53E3\n */\nexport abstract class LLMProvider {\n    protected config: LLMProviderConfig;\n\n    constructor(config: LLMProviderConfig) {\n        this.config = {\n            temperature: 0.7,\n            timeout: 60000,\n            ...config,\n        };\n    }\n\n    /**\n     * \u6267\u884C\u804A\u5929\u8BF7\u6C42\uFF08\u975E\u6D41\u5F0F\uFF09\n     */\n    abstract chat(request: ChatRequest): Promise<ChatResponse>;\n\n    /**\n     * \u6267\u884C\u804A\u5929\u8BF7\u6C42\uFF08\u6D41\u5F0F\uFF09\n     */\n    abstract chatStream(request: ChatRequest): AsyncGenerator<ChatStreamChunk>;\n\n    /**\n     * \u83B7\u53D6\u63D0\u4F9B\u5546\u540D\u79F0\n     */\n    abstract getProviderName(): string;\n\n    /**\n     * \u83B7\u53D6\u5F53\u524D\u6A21\u578B\n     */\n    getModel(): string {\n        return this.config.model;\n    }\n\n    /**\n     * \u7B80\u4FBF\u65B9\u6CD5\uFF1A\u53D1\u9001\u5355\u6761\u6D88\u606F\n     */\n    async complete(prompt: string, systemPrompt?: string): Promise<string> {\n        const messages: ChatMessage[] = [];\n\n        if (systemPrompt) {\n            messages.push({ role: 'system', content: systemPrompt });\n        }\n\n        messages.push({ role: 'user', content: prompt });\n\n        const response = await this.chat({ messages });\n        return response.content;\n    }\n\n    /**\n     * \u8F85\u52A9\u65B9\u6CD5\uFF1A\u6784\u5EFA\u6D88\u606F\u5217\u8868\n     */\n    protected buildMessages(request: ChatRequest): ChatMessage[] {\n        return request.messages;\n    }\n\n    /**\n     * \u8F85\u52A9\u65B9\u6CD5\uFF1A\u5408\u5E76\u914D\u7F6E\n     */\n    protected mergeConfig(request: ChatRequest): Required<Pick<ChatRequest, 'temperature'>> {\n        return {\n            temperature: request.temperature ?? this.config.temperature ?? 0.7,\n        };\n    }\n}\n\n/**\n * LLM Provider \u5DE5\u5382\n */\nexport type LLMProviderType = 'openai' | 'gemini' | 'lm-studio';\n\nexport interface ProviderFactoryConfig {\n    type: LLMProviderType;\n    config: any; // \u5177\u4F53\u7684\u914D\u7F6E\u7531\u5404\u4E2A Provider \u5B9A\u4E49\n}\n\n/**\n * \u9519\u8BEF\u7C7B\u578B\n */\nexport class LLMProviderError extends Error {\n    constructor(\n        message: string,\n        public provider: string,\n        public originalError?: Error,\n        public statusCode?: number\n    ) {\n        super(message);\n        this.name = 'LLMProviderError';\n    }\n}\n", "/**\n * OpenAI Provider \u5B9E\u73B0\n */\n\nimport {\n    LLMProvider,\n    LLMProviderError,\n    type ChatRequest,\n    type ChatResponse,\n    type ChatStreamChunk,\n    type ChatMessage,\n} from '../core/llm-provider';\n\nexport interface OpenAIProviderConfig {\n    apiKey: string;\n    model: string;\n    baseURL?: string;\n    temperature?: number;\n    timeout?: number;\n}\n\nexport class OpenAIProvider extends LLMProvider {\n    private apiKey: string;\n    private baseURL: string;\n\n    constructor(config: OpenAIProviderConfig) {\n        super(config);\n        this.apiKey = config.apiKey;\n        this.baseURL = config.baseURL || 'https://api.openai.com';\n    }\n\n    getProviderName(): string {\n        return 'OpenAI';\n    }\n\n    async chat(request: ChatRequest): Promise<ChatResponse> {\n        const { temperature } = this.mergeConfig(request);\n\n        const requestBody = {\n            model: this.config.model,\n            messages: request.messages,\n            temperature,\n            ...(request.topP && { top_p: request.topP }),\n            ...(request.stopSequences && { stop: request.stopSequences }),\n        };\n\n        try {\n            // Combine user signal with timeout\n            const timeoutSignal = AbortSignal.timeout(this.config.timeout || 60000);\n            const controller = new AbortController();\n\n            // Abort if either signal fires\n            const onAbort = () => controller.abort();\n            request.signal?.addEventListener('abort', onAbort);\n            timeoutSignal.addEventListener('abort', onAbort);\n\n            const response = await fetch(`${this.baseURL}/v1/chat/completions`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${this.apiKey}`,\n                },\n                body: JSON.stringify(requestBody),\n                signal: controller.signal,\n            });\n\n            // Cleanup listeners\n            request.signal?.removeEventListener('abort', onAbort);\n\n            if (!response.ok) {\n                const errorText = await response.text();\n                throw new LLMProviderError(\n                    `OpenAI API error: ${response.statusText}`,\n                    'OpenAI',\n                    undefined,\n                    response.status\n                );\n            }\n\n            const data = await response.json();\n\n            return {\n                content: data.choices[0].message.content,\n                finishReason: this.mapFinishReason(data.choices[0].finish_reason),\n                usage: data.usage ? {\n                    promptTokens: data.usage.prompt_tokens,\n                    completionTokens: data.usage.completion_tokens,\n                    totalTokens: data.usage.total_tokens,\n                } : undefined,\n                model: data.model,\n            };\n        } catch (error) {\n            if (error instanceof LLMProviderError) throw error;\n            throw new LLMProviderError(\n                `Failed to call OpenAI: ${error instanceof Error ? error.message : String(error)}`,\n                'OpenAI',\n                error instanceof Error ? error : undefined\n            );\n        }\n    }\n\n    async *chatStream(request: ChatRequest): AsyncGenerator<ChatStreamChunk> {\n        const { temperature } = this.mergeConfig(request);\n\n        const requestBody = {\n            model: this.config.model,\n            messages: request.messages,\n            temperature,\n            stream: true,\n            stream_options: { include_usage: true },\n            ...(request.topP && { top_p: request.topP }),\n            ...(request.stopSequences && { stop: request.stopSequences }),\n        };\n\n        try {\n            const response = await fetch(`${this.baseURL}/v1/chat/completions`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${this.apiKey}`,\n                },\n                body: JSON.stringify(requestBody),\n                signal: request.signal, // Pass through the abort signal for streaming\n            });\n\n            if (!response.ok) {\n                throw new LLMProviderError(\n                    `OpenAI API error: ${response.statusText}`,\n                    'OpenAI',\n                    undefined,\n                    response.status\n                );\n            }\n\n            const reader = response.body?.getReader();\n            if (!reader) throw new Error('No response body');\n\n            const decoder = new TextDecoder();\n            let buffer = '';\n\n            while (true) {\n                const { done, value } = await reader.read();\n                if (done) break;\n\n                buffer += decoder.decode(value, { stream: true });\n                const lines = buffer.split('\\n');\n                buffer = lines.pop() || '';\n\n                for (const line of lines) {\n                    if (line.startsWith('data: ')) {\n                        const data = line.slice(6);\n                        if (data === '[DONE]') continue;\n\n                        try {\n                            const parsed = JSON.parse(data);\n                            const delta = parsed.choices[0]?.delta?.content;\n                            const finishReason = parsed.choices[0]?.finish_reason;\n\n                            if (delta) {\n                                yield { delta };\n                            }\n\n                            if (finishReason) {\n                                yield {\n                                    delta: '',\n                                    finishReason: this.mapFinishReason(finishReason),\n                                };\n                            }\n\n                            if (parsed.usage) {\n                                yield {\n                                    delta: '',\n                                    usage: {\n                                        promptTokens: parsed.usage.prompt_tokens,\n                                        completionTokens: parsed.usage.completion_tokens,\n                                        totalTokens: parsed.usage.total_tokens,\n                                    }\n                                };\n                            }\n                        } catch (e) {\n                            // \u5FFD\u7565\u89E3\u6790\u9519\u8BEF\n                        }\n                    }\n                }\n            }\n        } catch (error) {\n            if (error instanceof LLMProviderError) throw error;\n            throw new LLMProviderError(\n                `Failed to stream from OpenAI: ${error instanceof Error ? error.message : String(error)}`,\n                'OpenAI',\n                error instanceof Error ? error : undefined\n            );\n        }\n    }\n\n    private mapFinishReason(reason: string): ChatResponse['finishReason'] {\n        switch (reason) {\n            case 'stop': return 'stop';\n            case 'length': return 'length';\n            case 'content_filter': return 'content_filter';\n            case 'tool_calls': return 'tool_calls';\n            default: return 'stop';\n        }\n    }\n}\n", "/**\n * Google Gemini Provider \u5B9E\u73B0\n */\n\nimport {\n    LLMProvider,\n    LLMProviderError,\n    type ChatRequest,\n    type ChatResponse,\n    type ChatStreamChunk,\n    type ChatMessage,\n} from '../core/llm-provider';\n\nexport interface GeminiProviderConfig {\n    apiKey: string;\n    model: string;\n    temperature?: number;\n    timeout?: number;\n}\n\nexport class GeminiProvider extends LLMProvider {\n    private apiKey: string;\n\n    constructor(config: GeminiProviderConfig) {\n        super(config);\n        this.apiKey = config.apiKey;\n    }\n\n    getProviderName(): string {\n        return 'Gemini';\n    }\n\n    async chat(request: ChatRequest): Promise<ChatResponse> {\n        const { temperature } = this.mergeConfig(request);\n\n        // \u8F6C\u6362\u6D88\u606F\u683C\u5F0F\n        const contents = this.convertMessages(request.messages);\n\n        const requestBody = {\n            contents,\n            generationConfig: {\n                temperature,\n                ...(request.topP && { topP: request.topP }),\n                ...(request.stopSequences && { stopSequences: request.stopSequences }),\n            },\n        };\n\n        try {\n            // Combine user signal with timeout\n            const timeoutSignal = AbortSignal.timeout(this.config.timeout || 60000);\n            const controller = new AbortController();\n\n            // Abort if either signal fires\n            const onAbort = () => controller.abort();\n            request.signal?.addEventListener('abort', onAbort);\n            timeoutSignal.addEventListener('abort', onAbort);\n\n            const response = await fetch(\n                `https://generativelanguage.googleapis.com/v1beta/models/${this.config.model}:generateContent?key=${this.apiKey}`,\n                {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify(requestBody),\n                    signal: controller.signal,\n                }\n            );\n\n            // Cleanup listeners\n            request.signal?.removeEventListener('abort', onAbort);\n\n            if (!response.ok) {\n                const errorText = await response.text();\n                throw new LLMProviderError(\n                    `Gemini API error: ${response.statusText}`,\n                    'Gemini',\n                    undefined,\n                    response.status\n                );\n            }\n\n            const data = await response.json();\n\n            if (!data.candidates?.[0]?.content?.parts?.[0]?.text) {\n                throw new LLMProviderError('Invalid Gemini response format', 'Gemini');\n            }\n\n            return {\n                content: data.candidates[0].content.parts[0].text,\n                finishReason: this.mapFinishReason(data.candidates[0].finishReason),\n                usage: data.usageMetadata ? {\n                    promptTokens: data.usageMetadata.promptTokenCount || 0,\n                    completionTokens: data.usageMetadata.candidatesTokenCount || 0,\n                    totalTokens: data.usageMetadata.totalTokenCount || 0,\n                } : undefined,\n                model: this.config.model,\n            };\n        } catch (error) {\n            if (error instanceof LLMProviderError) throw error;\n            throw new LLMProviderError(\n                `Failed to call Gemini: ${error instanceof Error ? error.message : String(error)}`,\n                'Gemini',\n                error instanceof Error ? error : undefined\n            );\n        }\n    }\n\n    async *chatStream(request: ChatRequest): AsyncGenerator<ChatStreamChunk> {\n        const { temperature } = this.mergeConfig(request);\n\n        const contents = this.convertMessages(request.messages);\n\n        const requestBody = {\n            contents,\n            generationConfig: {\n                temperature,\n                ...(request.topP && { topP: request.topP }),\n                ...(request.stopSequences && { stopSequences: request.stopSequences }),\n            },\n        };\n\n        try {\n            const response = await fetch(\n                `https://generativelanguage.googleapis.com/v1beta/models/${this.config.model}:streamGenerateContent?key=${this.apiKey}`,\n                {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify(requestBody),\n                    signal: request.signal, // Pass through the abort signal for streaming\n                }\n            );\n\n            if (!response.ok) {\n                throw new LLMProviderError(\n                    `Gemini API error: ${response.statusText}`,\n                    'Gemini',\n                    undefined,\n                    response.status\n                );\n            }\n\n            const reader = response.body?.getReader();\n            if (!reader) throw new Error('No response body');\n\n            const decoder = new TextDecoder();\n            let buffer = '';\n\n            while (true) {\n                const { done, value } = await reader.read();\n                if (done) break;\n\n                buffer += decoder.decode(value, { stream: true });\n                const lines = buffer.split('\\n');\n                buffer = lines.pop() || '';\n\n                for (const line of lines) {\n                    if (line.trim()) {\n                        try {\n                            const parsed = JSON.parse(line);\n                            const text = parsed.candidates?.[0]?.content?.parts?.[0]?.text;\n                            const finishReason = parsed.candidates?.[0]?.finishReason;\n\n                            if (text) {\n                                yield { delta: text };\n                            }\n\n                            if (finishReason) {\n                                yield {\n                                    delta: '',\n                                    finishReason: this.mapFinishReason(finishReason),\n                                };\n                            }\n                        } catch (e) {\n                            // \u5FFD\u7565\u89E3\u6790\u9519\u8BEF\n                        }\n                    }\n                }\n            }\n        } catch (error) {\n            if (error instanceof LLMProviderError) throw error;\n            throw new LLMProviderError(\n                `Failed to stream from Gemini: ${error instanceof Error ? error.message : String(error)}`,\n                'Gemini',\n                error instanceof Error ? error : undefined\n            );\n        }\n    }\n\n    /**\n     * \u8F6C\u6362\u6807\u51C6\u6D88\u606F\u683C\u5F0F\u4E3A Gemini \u683C\u5F0F\n     */\n    private convertMessages(messages: ChatMessage[]): any[] {\n        const contents: any[] = [];\n\n        for (const msg of messages) {\n            if (msg.role === 'system') {\n                // Gemini \u901A\u8FC7\u5728\u7B2C\u4E00\u6761\u6D88\u606F\u4E2D\u6CE8\u5165 system prompt\n                contents.push({\n                    role: 'user',\n                    parts: [{ text: `System: ${msg.content}` }],\n                });\n                contents.push({\n                    role: 'model',\n                    parts: [{ text: 'Understood. I will follow these instructions.' }],\n                });\n            } else if (msg.role === 'user') {\n                contents.push({\n                    role: 'user',\n                    parts: [{ text: msg.content }],\n                });\n            } else if (msg.role === 'assistant') {\n                contents.push({\n                    role: 'model',\n                    parts: [{ text: msg.content }],\n                });\n            }\n        }\n\n        return contents;\n    }\n\n    private mapFinishReason(reason?: string): ChatResponse['finishReason'] {\n        switch (reason) {\n            case 'STOP': return 'stop';\n            case 'MAX_TOKENS': return 'length';\n            case 'SAFETY': return 'content_filter';\n            default: return 'stop';\n        }\n    }\n}\n", "/**\n * LM Studio Provider \u5B9E\u73B0\n * \u4F7F\u7528 OpenAI \u517C\u5BB9\u7684 API \u683C\u5F0F\n */\n\nimport {\n    LLMProvider,\n    LLMProviderError,\n    type ChatRequest,\n    type ChatResponse,\n    type ChatStreamChunk,\n} from '../core/llm-provider';\n\nexport interface LMStudioProviderConfig {\n    baseURL: string;\n    model: string;\n    temperature?: number;\n    timeout?: number;\n}\n\nexport class LMStudioProvider extends LLMProvider {\n    private baseURL: string;\n\n    constructor(config: LMStudioProviderConfig) {\n        super(config);\n        this.baseURL = config.baseURL;\n    }\n\n    getProviderName(): string {\n        return 'LM Studio';\n    }\n\n    async chat(request: ChatRequest): Promise<ChatResponse> {\n        const { temperature } = this.mergeConfig(request);\n\n        const requestBody = {\n            model: this.config.model,\n            messages: request.messages,\n            temperature,\n            ...(request.topP && { top_p: request.topP }),\n            ...(request.stopSequences && { stop: request.stopSequences }),\n        };\n\n        try {\n            // Combine user signal with timeout\n            const timeoutSignal = AbortSignal.timeout(this.config.timeout || 60000);\n            const controller = new AbortController();\n\n            // Abort if either signal fires\n            const onAbort = () => controller.abort();\n            request.signal?.addEventListener('abort', onAbort);\n            timeoutSignal.addEventListener('abort', onAbort);\n\n            const response = await fetch(`${this.baseURL}/v1/chat/completions`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(requestBody),\n                signal: controller.signal,\n            });\n\n            // Cleanup listeners\n            request.signal?.removeEventListener('abort', onAbort);\n\n            if (!response.ok) {\n                const errorText = await response.text();\n                throw new LLMProviderError(\n                    `LM Studio API error: ${response.statusText}`,\n                    'LM Studio',\n                    undefined,\n                    response.status\n                );\n            }\n\n            const data = await response.json();\n\n            return {\n                content: data.choices[0].message.content,\n                finishReason: this.mapFinishReason(data.choices[0].finish_reason),\n                usage: data.usage ? {\n                    promptTokens: data.usage.prompt_tokens,\n                    completionTokens: data.usage.completion_tokens,\n                    totalTokens: data.usage.total_tokens,\n                } : undefined,\n                model: data.model,\n            };\n        } catch (error) {\n            if (error instanceof LLMProviderError) throw error;\n            throw new LLMProviderError(\n                `Failed to call LM Studio: ${error instanceof Error ? error.message : String(error)}`,\n                'LM Studio',\n                error instanceof Error ? error : undefined\n            );\n        }\n    }\n\n    async *chatStream(request: ChatRequest): AsyncGenerator<ChatStreamChunk> {\n        const { temperature } = this.mergeConfig(request);\n\n        const requestBody = {\n            model: this.config.model,\n            messages: request.messages,\n            temperature,\n            stream: true,\n            stream_options: { include_usage: true },\n            ...(request.topP && { top_p: request.topP }),\n            ...(request.stopSequences && { stop: request.stopSequences }),\n        };\n\n        try {\n            const response = await fetch(`${this.baseURL}/v1/chat/completions`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(requestBody),\n                signal: request.signal, // Pass through the abort signal for streaming\n            });\n\n            if (!response.ok) {\n                throw new LLMProviderError(\n                    `LM Studio API error: ${response.statusText}`,\n                    'LM Studio',\n                    undefined,\n                    response.status\n                );\n            }\n\n            const reader = response.body?.getReader();\n            if (!reader) throw new Error('No response body');\n\n            const decoder = new TextDecoder();\n            let buffer = '';\n\n            let reasoningOpen = false;\n\n            while (true) {\n                // Check if abort was requested\n                if (request.signal?.aborted) {\n                    await reader.cancel();\n                    break;\n                }\n\n                const { done, value } = await reader.read();\n                if (done) break;\n\n                buffer += decoder.decode(value, { stream: true });\n                const lines = buffer.split('\\n');\n                buffer = lines.pop() || '';\n\n                for (const line of lines) {\n                    if (line.startsWith('data: ')) {\n                        const data = line.slice(6);\n                        if (data === '[DONE]') continue;\n\n                        try {\n                            const parsed = JSON.parse(data);\n                            const contentDelta = parsed.choices[0]?.delta?.content;\n                            const reasoningDelta = parsed.choices[0]?.delta?.reasoning_content;\n                            const finishReason = parsed.choices[0]?.finish_reason;\n\n                            if (reasoningDelta) {\n                                const prefix = reasoningOpen ? '' : '<think>';\n                                reasoningOpen = true;\n                                yield { delta: `${prefix}${reasoningDelta}` };\n                            }\n\n                            if (contentDelta) {\n                                const prefix = reasoningOpen ? '</think>' : '';\n                                reasoningOpen = false;\n                                yield { delta: `${prefix}${contentDelta}` };\n                            }\n\n                            if (finishReason) {\n                                if (reasoningOpen) {\n                                    reasoningOpen = false;\n                                    yield { delta: '</think>' };\n                                }\n                                yield {\n                                    delta: '',\n                                    finishReason: this.mapFinishReason(finishReason),\n                                };\n                            }\n\n                            if (parsed.usage) {\n                                yield {\n                                    delta: '',\n                                    usage: {\n                                        promptTokens: parsed.usage.prompt_tokens,\n                                        completionTokens: parsed.usage.completion_tokens,\n                                        totalTokens: parsed.usage.total_tokens,\n                                    }\n                                };\n                            }\n                        } catch (e) {\n                            // \u5FFD\u7565\u89E3\u6790\u9519\u8BEF\n                        }\n                    }\n                }\n            }\n\n            if (reasoningOpen) {\n                yield { delta: '</think>' };\n            }\n        } catch (error) {\n            if (error instanceof LLMProviderError) throw error;\n            throw new LLMProviderError(\n                `Failed to stream from LM Studio: ${error instanceof Error ? error.message : String(error)}`,\n                'LM Studio',\n                error instanceof Error ? error : undefined\n            );\n        }\n    }\n\n    private mapFinishReason(reason: string): ChatResponse['finishReason'] {\n        switch (reason) {\n            case 'stop': return 'stop';\n            case 'length': return 'length';\n            case 'content_filter': return 'content_filter';\n            default: return 'stop';\n        }\n    }\n}\n", "/**\n * LLM Provider \u5DE5\u5382\n * \u7EDF\u4E00\u521B\u5EFA\u4E0D\u540C\u7C7B\u578B\u7684 LLM Provider\n */\n\nimport { LLMProvider } from '../core/llm-provider';\nimport { OpenAIProvider, type OpenAIProviderConfig } from './openai-provider';\nimport { GeminiProvider, type GeminiProviderConfig } from './gemini-provider';\nimport { LMStudioProvider, type LMStudioProviderConfig } from './lm-studio-provider';\n\n/**\n * Provider \u914D\u7F6E\u7C7B\u578B\n */\nexport type LLMProviderConfig =\n    | ({ type: 'openai' } & OpenAIProviderConfig)\n    | ({ type: 'gemini' } & GeminiProviderConfig)\n    | ({ type: 'lm-studio' } & LMStudioProviderConfig);\n\n/**\n * \u521B\u5EFA LLM Provider\n */\nexport function createLLMProvider(config: LLMProviderConfig): LLMProvider {\n    switch (config.type) {\n        case 'openai':\n            return new OpenAIProvider({\n                apiKey: config.apiKey,\n                model: config.model,\n                baseURL: config.baseURL,\n                temperature: config.temperature,\n                timeout: config.timeout,\n            });\n\n        case 'gemini':\n            return new GeminiProvider({\n                apiKey: config.apiKey,\n                model: config.model,\n                temperature: config.temperature,\n                timeout: config.timeout,\n            });\n\n        case 'lm-studio':\n            return new LMStudioProvider({\n                baseURL: config.baseURL,\n                model: config.model,\n                temperature: config.temperature,\n                timeout: config.timeout,\n            });\n\n        default:\n            throw new Error(`Unknown provider type: ${(config as any).type}`);\n    }\n}\n\n/**\n * \u4ECE\u8BBE\u7F6E\u5BF9\u8C61\u521B\u5EFA Provider\n */\nexport interface SettingsBasedConfig {\n    provider: 'openai' | 'gemini' | 'lm-studio';\n    lmStudio: {\n        baseURL: string;\n        model: string;\n    };\n    gemini: {\n        apiKey: string;\n        model: string;\n    };\n    openai: {\n        apiKey: string;\n        baseURL: string;\n        model: string;\n    };\n}\n\nexport function createProviderFromSettings(settings: SettingsBasedConfig): LLMProvider {\n    switch (settings.provider) {\n        case 'openai':\n            return createLLMProvider({\n                type: 'openai',\n                apiKey: settings.openai.apiKey,\n                model: settings.openai.model,\n                baseURL: settings.openai.baseURL,\n            });\n\n        case 'gemini':\n            return createLLMProvider({\n                type: 'gemini',\n                apiKey: settings.gemini.apiKey,\n                model: settings.gemini.model,\n            });\n\n        case 'lm-studio':\n            return createLLMProvider({\n                type: 'lm-studio',\n                baseURL: settings.lmStudio.baseURL,\n                model: settings.lmStudio.model,\n            });\n\n        default:\n            throw new Error(`Unknown provider: ${settings.provider}`);\n    }\n}\n", "/**\n * Planner \u8282\u70B9\uFF08LLM \u7248\u672C\uFF09\n * \u4F7F\u7528 LLM Provider \u751F\u6210\u4EFB\u52A1\u8BA1\u5212\n */\n\nimport { BaseNode } from '../core/node';\nimport type { NodeResult, State, TaskStep } from '../core/types';\nimport { updateState, StateHelpers } from '../core/state';\nimport type { ToolRegistry } from '../core/tool-registry';\nimport type { LLMProvider, ChatMessage } from '../core/llm-provider';\n\nexport interface LLMPlannerNodeConfig {\n    /** LLM Provider \u5B9E\u4F8B\uFF08\u53EF\u9009\uFF0C\u5982\u679C\u4E0D\u4F20\u5219\u4ECE ToolRegistry \u83B7\u53D6\uFF09 */\n    provider?: LLMProvider;\n}\n\nexport class LLMPlannerNode extends BaseNode {\n    private provider?: LLMProvider;\n\n    constructor(\n        private toolRegistry: ToolRegistry,\n        config?: LLMPlannerNodeConfig\n    ) {\n        super('planner', 'LLM Planner');\n        this.provider = config?.provider;\n    }\n\n    /**\n     * \u8BBE\u7F6E LLM Provider\uFF08\u652F\u6301\u52A8\u6001\u66F4\u65B0\uFF09\n     */\n    setProvider(provider: LLMProvider): void {\n        this.provider = provider;\n    }\n\n    async execute(state: State, context?: any): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n\n        try {\n            // \u4F7F\u7528 LLM \u751F\u6210\u8BA1\u5212\n            const { content, usage } = await this.generatePlanWithLLM(state, state.task.goal, context);\n            const steps = this.parseSteps(content);\n\n            // \u66F4\u65B0 State\n            let newState = updateState(state, draft => {\n                draft.task.plan = content;\n                draft.task.steps = steps;\n                draft.task.progress = 10;\n            });\n\n            // \u8BB0\u5F55 Token \u4F7F\u7528\u91CF\n            if (usage) {\n                newState = StateHelpers.addTokenUsage(newState, {\n                    prompt: usage.promptTokens,\n                    completion: usage.completionTokens,\n                    total: usage.totalTokens\n                });\n            }\n\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'node_end',\n                nodeId: this.id,\n                status: 'success',\n                summary: `LLM \u751F\u6210\u4E86 ${steps.length} \u4E2A\u5B50\u4EFB\u52A1 (Tokens: ${usage?.totalTokens || 'unknown'})`,\n                metadata: {\n                    stepCount: steps.length,\n                    usage\n                },\n            });\n\n            return this.createResult(newState, events);\n        } catch (error) {\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'error',\n                nodeId: this.id,\n                status: 'failure',\n                summary: `\u89C4\u5212\u5931\u8D25: ${error}`,\n            });\n\n            throw error;\n        }\n    }\n\n    /**\n     * \u4F7F\u7528 LLM \u751F\u6210\u8BA1\u5212\n     */\n    private async generatePlanWithLLM(\n        state: State,\n        goal: string,\n        context?: any\n    ): Promise<{ content: string, usage?: any }> {\n        const systemPrompt = `\u4F60\u662F\u4E00\u4E2A\u4EFB\u52A1\u89C4\u5212\u52A9\u624B\u3002\u7528\u6237\u4F1A\u7ED9\u4F60\u4E00\u4E2A\u76EE\u6807\uFF0C\u4F60\u9700\u8981\u5C06\u5176\u62C6\u89E3\u4E3A\u6E05\u6670\u7684\u6B65\u9AA4\u3002\n\n\u8981\u6C42\uFF1A\n1. \u6BCF\u4E2A\u6B65\u9AA4\u4E00\u884C\uFF0C\u683C\u5F0F\u4E3A \"1. \u6B65\u9AA4\u63CF\u8FF0\"\n2. \u6B65\u9AA4\u8981\u5177\u4F53\u3001\u53EF\u6267\u884C\n3. \u6B65\u9AA4\u6570\u91CF\u63A7\u5236\u5728 3-6 \u4E2A\n4. \u53EA\u8F93\u51FA\u6B65\u9AA4\u5217\u8868\uFF0C\u4E0D\u8981\u5176\u4ED6\u5185\u5BB9\n\n\u793A\u4F8B\uFF1A\n\u7528\u6237\u76EE\u6807\uFF1A\u4F18\u5316\u8FD9\u6BB5 SQL \u5E76\u4FDD\u6301\u7ED3\u679C\u4E00\u81F4\n\u4F60\u7684\u8F93\u51FA\uFF1A\n1. \u5206\u6790\u5F53\u524D SQL \u8BED\u53E5\u7ED3\u6784\n2. \u8BC6\u522B\u6027\u80FD\u74F6\u9888\u548C\u4F18\u5316\u70B9\n3. \u751F\u6210\u4F18\u5316\u540E\u7684 SQL \u8BED\u53E5\n4. \u9A8C\u8BC1\u4F18\u5316\u524D\u540E\u7ED3\u679C\u4E00\u81F4\u6027`;\n\n        const userPrompt = `\u7528\u6237\u76EE\u6807\uFF1A${goal}\\n\\n\u8BF7\u751F\u6210\u4EFB\u52A1\u6B65\u9AA4\uFF1A`;\n\n        // \u4F18\u5148\u4F7F\u7528\u6CE8\u5165\u7684 Provider\n        if (this.provider) {\n            return this.callWithProvider(systemPrompt, userPrompt, state, context);\n        }\n\n        // \u56DE\u9000\uFF1A\u4F7F\u7528 ToolRegistry \u4E2D\u7684 LLM \u5DE5\u5177\n        return this.callWithToolRegistry(systemPrompt, userPrompt, state, context);\n    }\n\n    /**\n     * \u4F7F\u7528 Provider \u8C03\u7528 LLM\n     */\n    private async callWithProvider(\n        systemPrompt: string,\n        userPrompt: string,\n        state: State,\n        context?: any\n    ): Promise<{ content: string, usage?: any }> {\n        const messages: ChatMessage[] = [\n            { role: 'system', content: systemPrompt },\n            { role: 'user', content: userPrompt },\n        ];\n\n        const useStreaming = state.policy.useStreaming !== false;\n\n        if (useStreaming && context?.emitEvent) {\n            // \u6D41\u5F0F\u54CD\u5E94\n            let fullContent = '';\n            const stream = this.provider!.chatStream({\n                messages,\n                temperature: 0.3,\n            });\n\n            for await (const chunk of stream) {\n                if (chunk.delta) {\n                    fullContent += chunk.delta;\n                    context.emitEvent('stream_chunk', 'info', 'generating plan...', { chunk: chunk.delta });\n                }\n            }\n\n            console.log('[LLMPlanner] LLM Raw Output:', fullContent);\n\n            return {\n                content: fullContent.trim(),\n                usage: undefined, // \u6D41\u5F0F\u6A21\u5F0F\u901A\u5E38\u4E0D\u8FD4\u56DE usage\n            };\n        } else {\n            // \u975E\u6D41\u5F0F\u54CD\u5E94\n            const response = await this.provider!.chat({\n                messages,\n                temperature: 0.3,\n            });\n\n            console.log('[LLMPlanner] LLM Raw Output:', response.content);\n\n            return {\n                content: response.content.trim(),\n                usage: response.usage,\n            };\n        }\n    }\n\n    /**\n     * \u4F7F\u7528 ToolRegistry \u8C03\u7528 LLM\uFF08\u56DE\u9000\u65B9\u6848\uFF09\n     */\n    private async callWithToolRegistry(\n        systemPrompt: string,\n        userPrompt: string,\n        state: State,\n        context?: any\n    ): Promise<{ content: string, usage?: any }> {\n        const useStreaming = state.policy.useStreaming !== false;\n\n        const result = await this.toolRegistry.execute('lm-studio-llm', {\n            prompt: userPrompt,\n            systemPrompt,\n            temperature: 0.3,\n            onStream: useStreaming ? (chunk: string) => {\n                context?.emitEvent('stream_chunk', 'info', 'generating plan...', { chunk });\n            } : undefined\n        });\n\n        if (!result.success || !result.output) {\n            console.error('[LLMPlanner] \u274C LLM \u8C03\u7528\u5931\u8D25');\n            throw new Error('LLM \u8C03\u7528\u5931\u8D25');\n        }\n\n        const output = result.output as { content: string, usage?: any };\n        console.log('[LLMPlanner] LLM Raw Output:', output.content);\n\n        return {\n            content: output.content.trim(),\n            usage: output.usage\n        };\n    }\n\n    /**\n     * \u89E3\u6790\u6B65\u9AA4\n     */\n    private parseSteps(plan: string): TaskStep[] {\n        const lines = plan.split('\\n').filter(line => line.trim());\n\n        return lines.map((line, index) => ({\n            id: `step-${index + 1}`,\n            description: line.replace(/^\\d+\\.\\s*/, ''), // \u79FB\u9664\u5E8F\u53F7\n            status: 'pending' as const,\n        }));\n    }\n}\n", "/**\n * Schema \u5DE5\u5177\u51FD\u6570\n * \u7528\u4E8E\u4ECE Zod schema \u63D0\u53D6\u4FE1\u606F\n */\n\n/**\n * \u4ECE Zod schema \u63D0\u53D6\u5C5E\u6027\n */\nexport function extractSchemaProperties(schema: any): Record<string, any> {\n    if (!schema || !schema._def) return {};\n\n    try {\n        const shape = schema._def.shape?.();\n        if (!shape) return {};\n\n        const properties: Record<string, any> = {};\n        for (const [key, value] of Object.entries(shape)) {\n            const def = (value as any)?._def;\n            if (def) {\n                properties[key] = {\n                    type: zodTypeToJsonType(def.typeName),\n                    description: def.description || key\n                };\n            }\n        }\n        return properties;\n    } catch {\n        return {};\n    }\n}\n\n/**\n * \u63D0\u53D6\u5FC5\u586B\u5B57\u6BB5\n */\nexport function extractRequiredFields(schema: any): string[] {\n    if (!schema || !schema._def) return [];\n\n    try {\n        const shape = schema._def.shape?.();\n        if (!shape) return [];\n\n        const required: string[] = [];\n        for (const [key, value] of Object.entries(shape)) {\n            const def = (value as any)?._def;\n            if (def && def.typeName !== 'ZodOptional') {\n                required.push(key);\n            }\n        }\n        return required;\n    } catch {\n        return [];\n    }\n}\n\n/**\n * Zod \u7C7B\u578B\u8F6C JSON Schema \u7C7B\u578B\n */\nexport function zodTypeToJsonType(zodType: string): string {\n    const mapping: Record<string, string> = {\n        'ZodString': 'string',\n        'ZodNumber': 'number',\n        'ZodBoolean': 'boolean',\n        'ZodArray': 'array',\n        'ZodObject': 'object',\n    };\n    return mapping[zodType] || 'string';\n}\n\n/**\n * \u6784\u5EFA OpenAI \u683C\u5F0F\u7684 tools \u5217\u8868\n */\nexport function buildOpenAIToolsList(\n    toolRegistry: { list: () => string[]; get: (name: string) => any },\n    excludeTools: string[] = ['lm-studio-llm']\n): Array<{ type: string; function: any }> {\n    return toolRegistry.list()\n        .filter(name => !excludeTools.includes(name))\n        .map(name => {\n            const tool = toolRegistry.get(name)!;\n            return {\n                type: 'function',\n                function: {\n                    name: name,\n                    description: tool.description,\n                    parameters: {\n                        type: 'object',\n                        properties: extractSchemaProperties(tool.inputSchema),\n                        required: extractRequiredFields(tool.inputSchema),\n                    }\n                }\n            };\n        });\n}\n", "/**\n * Tool call decision helpers\n */\n\nimport type { ToolRegistry } from '../core/tool-registry';\nimport type { LLMProvider, ChatMessage } from '../core/llm-provider';\nimport { buildOpenAIToolsList } from '../core/schema-utils';\n\nexport interface ToolCallDecision {\n    call: { toolName: string; input: unknown } | null;\n    usage?: any;\n}\n\nexport interface ToolCallDeciderOptions {\n    provider?: LLMProvider;\n    providerConfig?: { baseURL?: string; model?: string } | null;\n}\n\nexport async function decideToolCall(\n    toolRegistry: ToolRegistry,\n    stepDescription: string,\n    options: ToolCallDeciderOptions = {}\n): Promise<ToolCallDecision> {\n    if (options.provider) {\n        return decideWithProvider(toolRegistry, stepDescription, options.provider);\n    }\n\n    const providerConfig = options.providerConfig;\n    if (providerConfig?.baseURL) {\n        return decideWithFetch(toolRegistry, stepDescription, providerConfig.baseURL, providerConfig.model || 'default-model');\n    }\n\n    return decideWithFetch(toolRegistry, stepDescription, 'http://127.0.0.1:6354', 'zai-org/glm-4.6v-flash');\n}\n\nasync function decideWithProvider(\n    toolRegistry: ToolRegistry,\n    stepDescription: string,\n    provider: LLMProvider\n): Promise<ToolCallDecision> {\n    const tools = buildOpenAIToolsList(toolRegistry);\n\n    if (tools.length === 0) {\n        return { call: null, usage: undefined };\n    }\n\n    const messages: ChatMessage[] = [\n        {\n            role: 'system',\n            content: `You are an assistant. Available tools:\\n${tools.map(t => `- ${t.function.name}: ${t.function.description}`).join('\\n')}\\n\\nRespond with JSON: {\"tool\": \"name\", \"input\": {}} or {\"tool\": null}`\n        },\n        { role: 'user', content: `Task: ${stepDescription}` }\n    ];\n\n    try {\n        const response = await provider.chat({ messages, temperature: 0.1 });\n        const parsed = parseToolDecision(response.content);\n\n        if (parsed?.tool && toolRegistry.has(parsed.tool)) {\n            return { call: { toolName: parsed.tool, input: parsed.input || {} }, usage: response.usage };\n        }\n        return { call: null, usage: response.usage };\n    } catch (error) {\n        console.error('[ToolRunner] Provider error:', error);\n        return { call: fallbackDecide(stepDescription), usage: undefined };\n    }\n}\n\nasync function decideWithFetch(\n    toolRegistry: ToolRegistry,\n    stepDescription: string,\n    baseURL: string,\n    model: string\n): Promise<ToolCallDecision> {\n    const tools = buildOpenAIToolsList(toolRegistry);\n    if (tools.length === 0) return { call: null, usage: undefined };\n\n    try {\n        const response = await fetch(`${baseURL}/v1/chat/completions`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                model,\n                messages: [\n                    { role: 'system', content: 'Select appropriate tool if needed.' },\n                    { role: 'user', content: `Task: ${stepDescription}` }\n                ],\n                tools,\n                temperature: 0.1,\n            }),\n        });\n\n        if (!response.ok) {\n            return { call: fallbackDecide(stepDescription), usage: undefined };\n        }\n\n        const data = await response.json();\n        const toolCalls = data.choices?.[0]?.message?.tool_calls;\n\n        if (toolCalls?.[0]) {\n            const { name, arguments: args } = toolCalls[0].function;\n            if (toolRegistry.has(name)) {\n                return { call: { toolName: name, input: JSON.parse(args) }, usage: data.usage };\n            }\n        }\n        return { call: null, usage: data.usage };\n    } catch (error) {\n        return { call: fallbackDecide(stepDescription), usage: undefined };\n    }\n}\n\nfunction parseToolDecision(content: string): { tool: string | null; input?: any } | null {\n    try {\n        const match = content.match(/\\{[\\s\\S]*\\}/);\n        if (match) return JSON.parse(match[0]);\n    } catch { }\n    return null;\n}\n\nfunction fallbackDecide(desc: string): { toolName: string; input: unknown } | null {\n    const lower = desc.toLowerCase();\n    if (lower.includes('sql') || lower.includes('\u67E5\u8BE2')) {\n        return { toolName: 'sql-query', input: { query: 'SELECT * FROM users LIMIT 10' } };\n    }\n    if (lower.includes('\u6587\u6863') || lower.includes('\u641C\u7D22')) {\n        return { toolName: 'document-search', input: { keywords: ['\u4F18\u5316'] } };\n    }\n    return null;\n}\n", "/**\n * ToolRunner \u8282\u70B9\n * \u8D1F\u8D23\u6267\u884C\u5DE5\u5177\u8C03\u7528\n */\n\nimport { BaseNode } from '../core/node';\nimport type { NodeContext, NodeResult, PendingToolCall, State, TaskStep, ToolStreamChunk } from '../core/types';\nimport { updateState, StateHelpers } from '../core/state';\nimport type { ToolRegistry } from '../core/tool-registry';\nimport type { LLMProvider } from '../core/llm-provider';\nimport { createError, ErrorType } from '../core/error-handler';\nimport { decideToolCall } from './tool-call-decider';\n\nexport interface ToolRunnerNodeConfig {\n    /** LLM Provider \u5B9E\u4F8B\uFF08\u7528\u4E8E\u5DE5\u5177\u9009\u62E9\u51B3\u7B56\uFF09 */\n    provider?: LLMProvider;\n}\n\nexport class ToolRunnerNode extends BaseNode {\n    private provider?: LLMProvider;\n\n    constructor(\n        private toolRegistry: ToolRegistry,\n        config?: ToolRunnerNodeConfig\n    ) {\n        super('tool-runner', 'ToolRunner');\n        this.provider = config?.provider;\n    }\n\n    /** \u8BBE\u7F6E LLM Provider\uFF08\u652F\u6301\u52A8\u6001\u66F4\u65B0\uFF09 */\n    setProvider(provider: LLMProvider): void {\n        this.provider = provider;\n    }\n\n    async execute(state: State, context?: NodeContext): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n        let currentState = state;\n\n        const currentStep = state.task.steps[state.task.currentStepIndex];\n        if (!currentStep) {\n            throw new Error('\u6CA1\u6709\u53EF\u6267\u884C\u7684\u6B65\u9AA4');\n        }\n\n        currentState = updateState(currentState, draft => {\n            const step = draft.task.steps[draft.task.currentStepIndex];\n            if (step) {\n                step.status = 'running';\n            }\n        });\n\n        try {\n            const pendingCall = currentState.task.pendingToolCall;\n            if (pendingCall) {\n                if (pendingCall.stepId !== currentStep.id) {\n                    currentState = updateState(currentState, draft => {\n                        delete draft.task.pendingToolCall;\n                    });\n                } else if (pendingCall.status === 'pending') {\n                    return this.createResult(currentState, events);\n                } else if (pendingCall.status === 'approved') {\n                    return await this.executeToolCall(currentState, currentStep, pendingCall, context, events);\n                } else if (pendingCall.status === 'denied') {\n                    currentState = this.handleDeniedToolCall(currentState, pendingCall);\n                    events.push({\n                        id: `evt-${Date.now()}`,\n                        timestamp: Date.now(),\n                        type: 'tool_result',\n                        nodeId: this.id,\n                        status: 'warning',\n                        summary: `\u5DE5\u5177 ${pendingCall.toolName} \u5DF2\u88AB\u62D2\u7EDD`,\n                        metadata: {\n                            toolName: pendingCall.toolName,\n                            stepId: pendingCall.stepId,\n                            reason: pendingCall.decisionReason,\n                            success: false,\n                        },\n                    });\n                    return this.createResult(currentState, events);\n                }\n            }\n\n            const { call: toolCall, usage } = await decideToolCall(\n                this.toolRegistry,\n                currentStep.description,\n                { provider: this.provider, providerConfig: state.artifacts.providerConfig as any }\n            );\n\n            if (usage) {\n                currentState = StateHelpers.addTokenUsage(currentState, {\n                    prompt: usage.promptTokens,\n                    completion: usage.completionTokens,\n                    total: usage.totalTokens\n                });\n            }\n\n            if (!toolCall) {\n                currentState = updateState(currentState, draft => {\n                    draft.task.steps[draft.task.currentStepIndex].status = 'completed';\n                    draft.task.steps[draft.task.currentStepIndex].result = '\u5DF2\u5B8C\u6210';\n                    delete draft.task.pendingToolCall;\n                });\n\n                events.push({\n                    id: `evt-${Date.now()}`,\n                    timestamp: Date.now(),\n                    type: 'node_end',\n                    nodeId: this.id,\n                    status: 'info',\n                    summary: `\u6B65\u9AA4 \"${currentStep.description}\" \u65E0\u9700\u5DE5\u5177\u8C03\u7528`,\n                });\n\n                return this.createResult(currentState, events);\n            }\n\n            if (\n                currentState.policy.allowedTools\n                && currentState.policy.allowedTools.length > 0\n                && !currentState.policy.allowedTools.includes(toolCall.toolName)\n            ) {\n                currentState = updateState(currentState, draft => {\n                    const step = draft.task.steps[draft.task.currentStepIndex];\n                    if (step) {\n                        step.status = 'failed';\n                        step.error = `Tool \"${toolCall.toolName}\" is not allowed by policy.`;\n                    }\n                    delete draft.task.pendingToolCall;\n                });\n\n                events.push({\n                    id: `evt-${Date.now()}`,\n                    timestamp: Date.now(),\n                    type: 'tool_result',\n                    nodeId: this.id,\n                    status: 'warning',\n                    summary: `\u5DE5\u5177 ${toolCall.toolName} \u88AB\u7B56\u7565\u7981\u6B62`,\n                    metadata: {\n                        toolName: toolCall.toolName,\n                        stepId: currentStep.id,\n                        success: false,\n                        reason: 'policy',\n                    },\n                });\n                context?.emitEvent('audit', 'warning', 'tool_policy_block', {\n                    toolName: toolCall.toolName,\n                    stepId: currentStep.id,\n                    reason: 'policy',\n                });\n\n                return this.createResult(currentState, events);\n            }\n\n            const tool = this.toolRegistry.get(toolCall.toolName);\n            if (tool && tool.requiresConfirmation) {\n                const pending = this.buildPendingToolCall(toolCall.toolName, toolCall.input, currentStep, tool);\n                currentState = updateState(currentState, draft => {\n                    draft.task.pendingToolCall = pending;\n                });\n                return this.createResult(currentState, events);\n            }\n\n            return await this.executeToolCall(currentState, currentStep, toolCall, context, events);\n        } catch (error) {\n            currentState = StateHelpers.incrementError(currentState);\n            currentState = updateState(currentState, draft => {\n                const step = draft.task.steps[draft.task.currentStepIndex];\n                if (step) {\n                    step.status = 'failed';\n                    step.error = String(error);\n                }\n                delete draft.task.pendingToolCall;\n            });\n\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'error',\n                nodeId: this.id,\n                status: 'failure',\n                summary: `\u5DE5\u5177\u6267\u884C\u5931\u8D25: ${error}`,\n            });\n\n            throw error;\n        }\n    }\n\n    private buildPendingToolCall(\n        toolName: string,\n        input: unknown,\n        step: TaskStep,\n        tool: { permissions: string[]; confirmationMessage?: string }\n    ): PendingToolCall {\n        return {\n            toolName,\n            input,\n            stepId: step.id,\n            stepDescription: step.description,\n            permissions: tool.permissions || [],\n            confirmationMessage: tool.confirmationMessage,\n            requestedAt: Date.now(),\n            status: 'pending',\n        };\n    }\n\n    private handleDeniedToolCall(state: State, pendingCall: PendingToolCall): State {\n        return updateState(state, draft => {\n            const step = draft.task.steps[draft.task.currentStepIndex];\n            if (step) {\n                step.status = 'failed';\n                step.error = pendingCall.decisionReason || 'Tool execution denied';\n            }\n            delete draft.task.pendingToolCall;\n        });\n    }\n\n    private async executeToolCall(\n        currentState: State,\n        currentStep: TaskStep,\n        toolCall: { toolName: string; input: unknown },\n        context: NodeContext | undefined,\n        events: NodeResult['events']\n    ): Promise<NodeResult> {\n        events.push({\n            id: `evt-${Date.now()}`,\n            timestamp: Date.now(),\n            type: 'tool_call',\n            nodeId: this.id,\n            status: 'info',\n            summary: `\u8C03\u7528\u5DE5\u5177: ${toolCall.toolName}`,\n            metadata: {\n                toolName: toolCall.toolName,\n                stepId: currentStep.id,\n                input: toolCall.input,\n            },\n        });\n        context?.emitEvent('audit', 'info', 'tool_call', {\n            toolName: toolCall.toolName,\n            stepId: currentStep.id,\n        });\n\n        const useStreaming = currentState.policy.useStreaming !== false;\n        const onStream = useStreaming && context?.emitEvent\n            ? (chunk: ToolStreamChunk) => {\n                const normalized = normalizeToolStreamChunk(chunk);\n                context.emitEvent('stream_chunk', 'info', `tool stream: ${toolCall.toolName}`, {\n                    toolName: toolCall.toolName,\n                    stepId: currentStep.id,\n                    chunk: normalized.content,\n                    raw: normalized.raw,\n                    chunkType: normalized.type,\n                });\n            }\n            : undefined;\n\n        const startTime = Date.now();\n        const result = await this.toolRegistry.execute(toolCall.toolName, toolCall.input, {\n            nodeId: this.id,\n            permissions: currentState.policy.permissions,\n            onStream,\n        });\n        const duration = Date.now() - startTime;\n\n        if (!result.success) {\n            context?.emitEvent('audit', 'failure', 'tool_result', {\n                toolName: toolCall.toolName,\n                stepId: currentStep.id,\n                success: false,\n                error: result.error,\n            });\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'tool_result',\n                nodeId: this.id,\n                status: 'failure',\n                summary: `\u5DE5\u5177 ${toolCall.toolName} \u6267\u884C\u5931\u8D25`,\n                metadata: {\n                    toolName: toolCall.toolName,\n                    stepId: currentStep.id,\n                    success: false,\n                    error: result.error,\n                },\n            });\n            throw createError(ErrorType.EXECUTION, result.error || '\u5DE5\u5177\u6267\u884C\u5931\u8D25', {\n                nodeId: this.id,\n                toolName: toolCall.toolName,\n            });\n        }\n\n        currentState = StateHelpers.incrementToolCall(currentState);\n        currentState = StateHelpers.recordNodeTiming(currentState, this.id, duration);\n        currentState = updateState(currentState, draft => {\n            const step = draft.task.steps[draft.task.currentStepIndex];\n            if (step) {\n                step.status = 'completed';\n                step.result = result.output;\n            }\n\n            delete draft.task.pendingToolCall;\n            if (!draft.artifacts.toolResults) {\n                draft.artifacts.toolResults = [];\n            }\n            (draft.artifacts.toolResults as unknown[]).push({\n                stepId: currentStep.id,\n                toolName: toolCall.toolName,\n                output: result.output,\n                timestamp: Date.now(),\n            });\n        });\n\n        events.push({\n            id: `evt-${Date.now()}`,\n            timestamp: Date.now(),\n            type: 'tool_result',\n            nodeId: this.id,\n            status: 'success',\n            summary: `\u5DE5\u5177 ${toolCall.toolName} \u6267\u884C\u6210\u529F (${duration}ms)`,\n            metadata: {\n                durationMs: duration,\n                toolName: toolCall.toolName,\n                stepId: currentStep.id,\n                success: true,\n            },\n        });\n        context?.emitEvent('audit', 'success', 'tool_result', {\n            toolName: toolCall.toolName,\n            stepId: currentStep.id,\n            success: true,\n            durationMs: duration,\n        });\n\n        return this.createResult(currentState, events);\n    }\n\n}\n\nfunction normalizeToolStreamChunk(chunk: ToolStreamChunk): { content: string; type: 'text' | 'json'; raw?: unknown } {\n    if (typeof chunk === 'string') {\n        return { content: chunk, type: 'text' };\n    }\n    return {\n        content: chunk.content,\n        type: chunk.type,\n        raw: chunk.data,\n    };\n}\n", "/**\n * Confirmation \u8282\u70B9\n * \u5728\u654F\u611F\u5DE5\u5177\u6267\u884C\u524D\u8BF7\u6C42\u4EBA\u5DE5\u786E\u8BA4\n */\n\nimport { BaseNode } from '../core/node';\nimport type {\n    NodeContext,\n    NodeResult,\n    State,\n    ToolConfirmationDecision,\n    ToolConfirmationHandler,\n    ToolConfirmationRequest\n} from '../core/types';\nimport { updateState } from '../core/state';\n\nexport interface ConfirmationNodeConfig {\n    /** \u786E\u8BA4\u5904\u7406\u5668\uFF08\u672A\u63D0\u4F9B\u5219\u81EA\u52A8\u6279\u51C6\uFF09 */\n    onConfirm?: ToolConfirmationHandler;\n    /** \u662F\u5426\u9ED8\u8BA4\u81EA\u52A8\u6279\u51C6 */\n    autoApprove?: boolean;\n}\n\nexport class ConfirmationNode extends BaseNode {\n    private onConfirm?: ToolConfirmationHandler;\n    private autoApprove: boolean;\n\n    constructor(config?: ConfirmationNodeConfig) {\n        super('confirmation', 'Confirmation');\n        this.onConfirm = config?.onConfirm;\n        this.autoApprove = config?.autoApprove ?? true;\n    }\n\n    setConfirmationHandler(handler?: ToolConfirmationHandler): void {\n        this.onConfirm = handler;\n    }\n\n    async execute(state: State, context?: NodeContext): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n        const pending = state.task.pendingToolCall;\n\n        if (!pending || pending.status !== 'pending') {\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'node_end',\n                nodeId: this.id,\n                status: 'info',\n                summary: '\u6CA1\u6709\u9700\u8981\u786E\u8BA4\u7684\u5DE5\u5177\u8C03\u7528',\n            });\n            return this.createResult(state, events);\n        }\n\n        const request: ToolConfirmationRequest = {\n            toolName: pending.toolName,\n            input: pending.input,\n            stepId: pending.stepId,\n            stepDescription: pending.stepDescription,\n            permissions: pending.permissions,\n            confirmationMessage: pending.confirmationMessage,\n            requestedAt: pending.requestedAt,\n        };\n\n        context?.emitEvent('confirmation_required', 'warning', `\u7B49\u5F85\u5DE5\u5177\u786E\u8BA4: ${pending.toolName}`, request);\n\n        const decision = await this.resolveDecision(request);\n        const updatedState = updateState(state, draft => {\n            if (draft.task.pendingToolCall) {\n                draft.task.pendingToolCall.status = decision.approved ? 'approved' : 'denied';\n                draft.task.pendingToolCall.decidedAt = Date.now();\n                if (decision.reason) {\n                    draft.task.pendingToolCall.decisionReason = decision.reason;\n                }\n            }\n        });\n\n        events.push({\n            id: `evt-${Date.now()}`,\n            timestamp: Date.now(),\n            type: 'confirmation_result',\n            nodeId: this.id,\n            status: decision.approved ? 'success' : 'warning',\n            summary: decision.approved\n                ? `\u5DF2\u6279\u51C6\u5DE5\u5177: ${pending.toolName}`\n                : `\u5DF2\u62D2\u7EDD\u5DE5\u5177: ${pending.toolName}`,\n            metadata: {\n                toolName: pending.toolName,\n                approved: decision.approved,\n                reason: decision.reason,\n            },\n        });\n\n        events.push({\n            id: `evt-${Date.now()}`,\n            timestamp: Date.now(),\n            type: 'node_end',\n            nodeId: this.id,\n            status: decision.approved ? 'success' : 'warning',\n            summary: decision.approved ? '\u5DE5\u5177\u5DF2\u6279\u51C6' : '\u5DE5\u5177\u5DF2\u62D2\u7EDD',\n        });\n\n        return this.createResult(updatedState, events);\n    }\n\n    private async resolveDecision(request: ToolConfirmationRequest): Promise<ToolConfirmationDecision> {\n        if (this.onConfirm) {\n            const decision = await this.onConfirm(request);\n            if (typeof decision === 'boolean') {\n                return { approved: decision };\n            }\n            return decision;\n        }\n\n        if (this.autoApprove) {\n            return { approved: true, reason: 'auto-approved' };\n        }\n\n        return { approved: false, reason: 'no confirmation handler' };\n    }\n}\n", "/**\n * Verifier \u8282\u70B9\n * \u9A8C\u8BC1\u5DE5\u5177\u8F93\u51FA\u662F\u5426\u6EE1\u8DB3\u6210\u529F\u6761\u4EF6\n */\n\nimport { BaseNode } from '../core/node';\nimport type { NodeResult, State } from '../core/types';\nimport { updateState } from '../core/state';\n\nexport class VerifierNode extends BaseNode {\n    constructor() {\n        super('verifier', 'Verifier');\n    }\n\n    async execute(state: State): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n\n        try {\n            // \u68C0\u67E5\u5F53\u524D\u6B65\u9AA4\u662F\u5426\u6210\u529F\n            const currentStep = state.task.steps[state.task.currentStepIndex];\n\n            if (!currentStep) {\n                throw new Error('\u6CA1\u6709\u53EF\u9A8C\u8BC1\u7684\u6B65\u9AA4');\n            }\n\n            if (currentStep.status === 'failed') {\n                const nextStepIndex = Math.min(state.task.currentStepIndex + 1, state.task.steps.length);\n                const totalSteps = state.task.steps.length || 1;\n                const progress = (nextStepIndex / totalSteps) * 80 + 10; // 10-90%\n\n                const newState = updateState(state, draft => {\n                    draft.task.currentStepIndex = nextStepIndex;\n                    draft.task.progress = Math.round(progress);\n                });\n\n                events.push({\n                    id: `evt-${Date.now()}`,\n                    timestamp: Date.now(),\n                    type: 'node_end',\n                    nodeId: this.id,\n                    status: 'warning',\n                    summary: `\u6B65\u9AA4 \"${currentStep.description}\" \u5DF2\u5931\u8D25\uFF0C\u8DF3\u8FC7\u5230\u4E0B\u4E00\u6B65`,\n                });\n\n                return this.createResult(newState, events);\n            }\n\n            const isValid = this.verify(currentStep.result);\n\n            if (!isValid) {\n                events.push({\n                    id: `evt-${Date.now()}`,\n                    timestamp: Date.now(),\n                    type: 'error',\n                    nodeId: this.id,\n                    status: 'warning',\n                    summary: `\u6B65\u9AA4 \"${currentStep.description}\" \u9A8C\u8BC1\u5931\u8D25`,\n                });\n\n                return this.createResult(state, events);\n            }\n\n            // \u9A8C\u8BC1\u901A\u8FC7\uFF0C\u66F4\u65B0\u8FDB\u5EA6\u5E76\u63A8\u8FDB\u5230\u4E0B\u4E00\u6B65\n            const nextStepIndex = Math.min(state.task.currentStepIndex + 1, state.task.steps.length);\n            const totalSteps = state.task.steps.length || 1;\n            const progress = (nextStepIndex / totalSteps) * 80 + 10; // 10-90%\n\n            const newState = updateState(state, draft => {\n                draft.task.currentStepIndex = nextStepIndex;\n                draft.task.progress = Math.round(progress);\n            });\n\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'node_end',\n                nodeId: this.id,\n                status: 'success',\n                summary: `\u6B65\u9AA4\u9A8C\u8BC1\u901A\u8FC7 (\u8FDB\u5EA6: ${Math.round(progress)}%)`,\n            });\n\n            return this.createResult(newState, events);\n        } catch (error) {\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'error',\n                nodeId: this.id,\n                status: 'failure',\n                summary: `\u9A8C\u8BC1\u5931\u8D25: ${error}`,\n            });\n\n            throw error;\n        }\n    }\n\n    /**\n     * \u9A8C\u8BC1\u7ED3\u679C\uFF08\u7B80\u5316\u7248\uFF09\n     */\n    private verify(result: unknown): boolean {\n        // \u57FA\u672C\u9A8C\u8BC1\uFF1A\u7ED3\u679C\u4E0D\u4E3A\u7A7A\n        if (result === null || result === undefined) {\n            return false;\n        }\n\n        // \u5982\u679C\u662F\u6570\u7EC4\uFF0C\u68C0\u67E5\u662F\u5426\u4E3A\u7A7A\n        if (Array.isArray(result) && result.length === 0) {\n            return false;\n        }\n\n        // \u5982\u679C\u662F\u5BF9\u8C61\uFF0C\u68C0\u67E5\u662F\u5426\u6709\u5185\u5BB9\n        if (typeof result === 'object' && Object.keys(result).length === 0) {\n            return false;\n        }\n\n        return true;\n    }\n}\n", "/**\n * Responder \u8282\u70B9\n * \u6C47\u603B\u7ED3\u679C\u5E76\u751F\u6210\u6700\u7EC8\u7B54\u590D\n */\n\nimport { BaseNode } from '../core/node';\nimport type { NodeResult, State } from '../core/types';\nimport { updateState, StateHelpers } from '../core/state';\n\nexport class ResponderNode extends BaseNode {\n    constructor() {\n        super('responder', 'Responder');\n    }\n\n    async execute(state: State): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n\n        try {\n            // \u6C47\u603B\u6240\u6709\u6B65\u9AA4\u7ED3\u679C\n            const summary = this.summarizeResults(state);\n\n            // \u751F\u6210\u6700\u7EC8\u7B54\u590D\n            const response = this.generateResponse(state, summary);\n\n            // \u66F4\u65B0 State\n            let newState = StateHelpers.addMessage(state, 'assistant', response);\n            newState = StateHelpers.updateProgress(newState, 100);\n\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'node_end',\n                nodeId: this.id,\n                status: 'success',\n                summary: '\u5DF2\u751F\u6210\u6700\u7EC8\u7B54\u590D',\n                metadata: { responseLength: response.length },\n            });\n\n            return this.createResult(newState, events);\n        } catch (error) {\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'error',\n                nodeId: this.id,\n                status: 'failure',\n                summary: `\u751F\u6210\u7B54\u590D\u5931\u8D25: ${error}`,\n            });\n\n            throw error;\n        }\n    }\n\n    /**\n     * \u6C47\u603B\u7ED3\u679C\n     */\n    private summarizeResults(state: State): string {\n        const completedSteps = state.task.steps.filter(s => s.status === 'completed');\n        const failedSteps = state.task.steps.filter(s => s.status === 'failed');\n\n        let summary = `## \u4EFB\u52A1\u6267\u884C\u6458\u8981\\n\\n`;\n        summary += `**\u76EE\u6807**: ${state.task.goal}\\n\\n`;\n        summary += `**\u5B8C\u6210\u6B65\u9AA4**: ${completedSteps.length}/${state.task.steps.length}\\n\\n`;\n\n        if (completedSteps.length > 0) {\n            summary += `### \u5DF2\u5B8C\u6210\u6B65\u9AA4\\n`;\n            completedSteps.forEach(step => {\n                summary += `- ${step.description}\\n`;\n            });\n            summary += '\\n';\n        }\n\n        if (failedSteps.length > 0) {\n            summary += `### \u5931\u8D25\u6B65\u9AA4\\n`;\n            failedSteps.forEach(step => {\n                summary += `- ${step.description}: ${step.error}\\n`;\n            });\n            summary += '\\n';\n        }\n\n        return summary;\n    }\n\n    /**\n     * \u751F\u6210\u6700\u7EC8\u7B54\u590D\n     */\n    private generateResponse(state: State, summary: string): string {\n        let response = summary;\n\n        // \u6DFB\u52A0\u5DE5\u5177\u7ED3\u679C\uFF08\u5982\u679C\u6709\uFF09\n        const toolResults = state.artifacts.toolResults as Array<{\n            stepId: string;\n            toolName: string;\n            output: unknown;\n        }> | undefined;\n\n        if (toolResults && toolResults.length > 0) {\n            response += `### \u5DE5\u5177\u6267\u884C\u7ED3\u679C\\n\\n`;\n            toolResults.forEach(result => {\n                response += `**${result.toolName}**:\\n`;\n                response += `\\`\\`\\`json\\n${JSON.stringify(result.output, null, 2)}\\n\\`\\`\\`\\n\\n`;\n            });\n        }\n\n        // \u6DFB\u52A0\u9065\u6D4B\u6570\u636E\n        response += `### \u6027\u80FD\u7EDF\u8BA1\\n`;\n        response += `- \u603B\u8017\u65F6: ${state.telemetry.totalDuration}ms\\n`;\n        response += `- \u5DE5\u5177\u8C03\u7528\u6B21\u6570: ${state.telemetry.toolCallCount}\\n`;\n        response += `- \u9519\u8BEF\u6B21\u6570: ${state.telemetry.errorCount}\\n`;\n        response += `- \u91CD\u8BD5\u6B21\u6570: ${state.telemetry.retryCount}\\n`;\n\n        return response;\n    }\n}\n", "/**\n * LLM Responder \u8282\u70B9\n * \u4F7F\u7528 LLM \u751F\u6210\u81EA\u7136\u8BED\u8A00\u98CE\u683C\u7684\u6700\u7EC8\u7B54\u590D\n */\n\nimport { BaseNode } from '../core/node';\nimport type { NodeResult, State } from '../core/types';\nimport { StateHelpers } from '../core/state';\nimport type { LLMProvider, ChatMessage } from '../core/llm-provider';\n\nexport interface LLMResponderNodeConfig {\n    /** LLM Provider \u5B9E\u4F8B */\n    provider?: LLMProvider;\n    /** \u662F\u5426\u5305\u542B\u8BE6\u7EC6\u7684\u6267\u884C\u7EDF\u8BA1 */\n    includeStats?: boolean;\n    /** \u56DE\u590D\u8BED\u8A00 */\n    language?: 'auto' | 'zh' | 'en';\n}\n\nexport class LLMResponderNode extends BaseNode {\n    private provider?: LLMProvider;\n    private includeStats: boolean;\n    private language: 'auto' | 'zh' | 'en';\n\n    constructor(config?: LLMResponderNodeConfig) {\n        super('responder', 'LLM Responder');\n        this.provider = config?.provider;\n        this.includeStats = config?.includeStats ?? false;\n        this.language = config?.language ?? 'auto';\n    }\n\n    /** \u8BBE\u7F6E LLM Provider */\n    setProvider(provider: LLMProvider): void {\n        this.provider = provider;\n    }\n\n    async execute(state: State, context?: any): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n\n        try {\n            // \u6784\u5EFA\u6267\u884C\u6458\u8981\u4E0A\u4E0B\u6587\n            const executionContext = this.buildExecutionContext(state);\n\n            // \u4F7F\u7528 LLM \u751F\u6210\u81EA\u7136\u8BED\u8A00\u56DE\u590D\uFF0C\u6216\u56DE\u9000\u5230\u6A21\u677F\n            const response = this.provider\n                ? await this.generateWithLLM(state, executionContext, context)\n                : this.generateTemplateResponse(state, executionContext);\n\n            // \u66F4\u65B0 State\n            let newState = StateHelpers.addMessage(state, 'assistant', response);\n            newState = StateHelpers.updateProgress(newState, 100);\n\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'node_end',\n                nodeId: this.id,\n                status: 'success',\n                summary: '\u5DF2\u751F\u6210\u6700\u7EC8\u7B54\u590D',\n                metadata: { responseLength: response.length, usedLLM: !!this.provider },\n            });\n\n            return this.createResult(newState, events);\n        } catch (error) {\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'error',\n                nodeId: this.id,\n                status: 'failure',\n                summary: `\u751F\u6210\u7B54\u590D\u5931\u8D25: ${error}`,\n            });\n\n            throw error;\n        }\n    }\n\n    /** \u6784\u5EFA\u6267\u884C\u4E0A\u4E0B\u6587 */\n    private buildExecutionContext(state: State): ExecutionContext {\n        const completedSteps = state.task.steps.filter(s => s.status === 'completed');\n        const failedSteps = state.task.steps.filter(s => s.status === 'failed');\n        const toolResults = state.artifacts.toolResults as ToolResult[] | undefined;\n\n        return {\n            goal: state.task.goal,\n            totalSteps: state.task.steps.length,\n            completedSteps: completedSteps.map(s => ({\n                description: s.description,\n                result: s.result,\n            })),\n            failedSteps: failedSteps.map(s => ({\n                description: s.description,\n                error: s.error,\n            })),\n            toolResults: toolResults || [],\n            stats: {\n                duration: state.telemetry.totalDuration,\n                toolCalls: state.telemetry.toolCallCount,\n                tokenCount: state.telemetry.tokenCount,\n            },\n        };\n    }\n\n    /** \u4F7F\u7528 LLM \u751F\u6210\u56DE\u590D */\n    private async generateWithLLM(\n        state: State,\n        ctx: ExecutionContext,\n        nodeContext?: any\n    ): Promise<string> {\n        const systemPrompt = this.buildSystemPrompt();\n        const userPrompt = this.buildUserPrompt(ctx);\n\n        const messages: ChatMessage[] = [\n            { role: 'system', content: systemPrompt },\n            { role: 'user', content: userPrompt },\n        ];\n\n        const useStreaming = state.policy.useStreaming !== false;\n\n        if (useStreaming && nodeContext?.emitEvent) {\n            let fullContent = '';\n            const stream = this.provider!.chatStream({\n                messages,\n                temperature: 0.7,\n            });\n\n            for await (const chunk of stream) {\n                if (chunk.delta) {\n                    fullContent += chunk.delta;\n                    nodeContext.emitEvent('stream_chunk', 'info', 'generating response...', { chunk: chunk.delta });\n                }\n            }\n\n            return this.appendStats(fullContent.trim(), ctx);\n        }\n\n        const response = await this.provider!.chat({\n            messages,\n            temperature: 0.7,\n        });\n\n        return this.appendStats(response.content.trim(), ctx);\n    }\n\n    /** \u6784\u5EFA\u7CFB\u7EDF\u63D0\u793A\u8BCD */\n    private buildSystemPrompt(): string {\n        const langInstruction = this.language === 'zh'\n            ? '\u8BF7\u7528\u4E2D\u6587\u56DE\u590D\u3002'\n            : this.language === 'en'\n                ? 'Please respond in English.'\n                : '\u8BF7\u6839\u636E\u7528\u6237\u7684\u539F\u59CB\u95EE\u9898\u8BED\u8A00\u6765\u56DE\u590D\u3002';\n\n        return `\u4F60\u662F\u4E00\u4E2A\u667A\u80FD\u52A9\u624B\uFF0C\u6B63\u5728\u5411\u7528\u6237\u6C47\u62A5\u4EFB\u52A1\u6267\u884C\u7ED3\u679C\u3002\n\n\u8981\u6C42\uFF1A\n1. \u7528\u81EA\u7136\u3001\u53CB\u597D\u7684\u8BED\u8A00\u603B\u7ED3\u4EFB\u52A1\u5B8C\u6210\u60C5\u51B5\n2. \u7A81\u51FA\u91CD\u8981\u7684\u7ED3\u679C\u548C\u53D1\u73B0\n3. \u5982\u679C\u6709\u5931\u8D25\u7684\u6B65\u9AA4\uFF0C\u7B80\u8981\u8BF4\u660E\u539F\u56E0\n4. \u56DE\u590D\u8981\u7B80\u6D01\u660E\u4E86\uFF0C\u907F\u514D\u5197\u957F\u7684\u6280\u672F\u7EC6\u8282\n5. ${langInstruction}\n\n\u793A\u4F8B\u56DE\u590D\u98CE\u683C\uFF1A\n- \"\u6211\u5DF2\u7ECF\u5B8C\u6210\u4E86\u60A8\u7684\u8BF7\u6C42\uFF01\u4EE5\u4E0B\u662F\u4E3B\u8981\u53D1\u73B0\uFF1A...\"\n- \"\u4EFB\u52A1\u6267\u884C\u5B8C\u6BD5\u3002\u5173\u4E8E\u60A8\u8BE2\u95EE\u7684\u5185\u5BB9\uFF0C\u6211\u53D1\u73B0...\"\n- \"\u597D\u7684\uFF0C\u6211\u4E3A\u60A8\u67E5\u8BE2\u4E86\u76F8\u5173\u4FE1\u606F\u3002\u7ED3\u679C\u663E\u793A...\"`;\n    }\n\n    /** \u6784\u5EFA\u7528\u6237\u63D0\u793A\u8BCD */\n    private buildUserPrompt(ctx: ExecutionContext): string {\n        let prompt = `\u7528\u6237\u7684\u539F\u59CB\u76EE\u6807\uFF1A${ctx.goal}\\n\\n`;\n\n        prompt += `\u6267\u884C\u60C5\u51B5\uFF1A\\n`;\n        prompt += `- \u603B\u6B65\u9AA4\u6570\uFF1A${ctx.totalSteps}\\n`;\n        prompt += `- \u5B8C\u6210\uFF1A${ctx.completedSteps.length}\\n`;\n        prompt += `- \u5931\u8D25\uFF1A${ctx.failedSteps.length}\\n\\n`;\n\n        if (ctx.completedSteps.length > 0) {\n            prompt += `\u5DF2\u5B8C\u6210\u7684\u6B65\u9AA4\uFF1A\\n`;\n            ctx.completedSteps.forEach((step, i) => {\n                prompt += `${i + 1}. ${step.description}\\n`;\n                if (step.result) {\n                    prompt += `   \u7ED3\u679C: ${JSON.stringify(step.result).substring(0, 200)}\\n`;\n                }\n            });\n            prompt += '\\n';\n        }\n\n        if (ctx.toolResults.length > 0) {\n            prompt += `\u5DE5\u5177\u6267\u884C\u7ED3\u679C\uFF1A\\n`;\n            ctx.toolResults.forEach(result => {\n                prompt += `- ${result.toolName}: ${JSON.stringify(result.output).substring(0, 300)}\\n`;\n            });\n            prompt += '\\n';\n        }\n\n        if (ctx.failedSteps.length > 0) {\n            prompt += `\u5931\u8D25\u7684\u6B65\u9AA4\uFF1A\\n`;\n            ctx.failedSteps.forEach(step => {\n                prompt += `- ${step.description}: ${step.error}\\n`;\n            });\n        }\n\n        prompt += `\\n\u8BF7\u6839\u636E\u4EE5\u4E0A\u6267\u884C\u60C5\u51B5\uFF0C\u7528\u81EA\u7136\u8BED\u8A00\u5411\u7528\u6237\u6C47\u62A5\u7ED3\u679C\u3002`;\n\n        return prompt;\n    }\n\n    /** \u9644\u52A0\u7EDF\u8BA1\u4FE1\u606F */\n    private appendStats(response: string, ctx: ExecutionContext): string {\n        if (!this.includeStats) return response;\n\n        return response + `\\n\\n---\\n*\u6267\u884C\u7EDF\u8BA1: ${ctx.stats.toolCalls} \u6B21\u5DE5\u5177\u8C03\u7528, ${ctx.stats.tokenCount} tokens, ${ctx.stats.duration}ms*`;\n    }\n\n    /** \u6A21\u677F\u56DE\u590D\uFF08\u56DE\u9000\u65B9\u6848\uFF09 */\n    private generateTemplateResponse(state: State, ctx: ExecutionContext): string {\n        const allSuccess = ctx.failedSteps.length === 0;\n\n        let response = allSuccess\n            ? `\u2705 \u4EFB\u52A1\u5DF2\u5B8C\u6210\uFF01\\n\\n`\n            : `\u26A0\uFE0F \u4EFB\u52A1\u90E8\u5206\u5B8C\u6210\u3002\\n\\n`;\n\n        response += `**\u76EE\u6807**: ${ctx.goal}\\n\\n`;\n\n        if (ctx.completedSteps.length > 0) {\n            response += `**\u5DF2\u5B8C\u6210\u7684\u6B65\u9AA4**:\\n`;\n            ctx.completedSteps.forEach((step, i) => {\n                response += `${i + 1}. ${step.description}\\n`;\n            });\n            response += '\\n';\n        }\n\n        if (ctx.toolResults.length > 0) {\n            response += `**\u6267\u884C\u7ED3\u679C**:\\n`;\n            ctx.toolResults.forEach(result => {\n                response += `- **${result.toolName}**: `;\n                const output = JSON.stringify(result.output);\n                response += output.length > 100 ? output.substring(0, 100) + '...' : output;\n                response += '\\n';\n            });\n        }\n\n        if (ctx.failedSteps.length > 0) {\n            response += `\\n**\u5931\u8D25\u7684\u6B65\u9AA4**:\\n`;\n            ctx.failedSteps.forEach(step => {\n                response += `- ${step.description}: ${step.error}\\n`;\n            });\n        }\n\n        return this.appendStats(response, ctx);\n    }\n}\n\n// ============================================================================\n// \u7C7B\u578B\u5B9A\u4E49\n// ============================================================================\n\ninterface ExecutionContext {\n    goal: string;\n    totalSteps: number;\n    completedSteps: Array<{ description: string; result?: unknown }>;\n    failedSteps: Array<{ description: string; error?: string }>;\n    toolResults: ToolResult[];\n    stats: {\n        duration: number;\n        toolCalls: number;\n        tokenCount: number;\n    };\n}\n\ninterface ToolResult {\n    stepId: string;\n    toolName: string;\n    output: unknown;\n}\n", "/**\n * Shared heuristics for memory detection and formatting.\n */\n\nexport const DEFAULT_PREFERENCE_PATTERNS: RegExp[] = [\n    /i prefer/i,\n    /i like/i,\n    /i want/i,\n    /i need/i,\n    /i always/i,\n    /please.*always/i,\n    /by default/i,\n    /make sure/i,\n];\n\nexport const DEFAULT_INTENT_PATTERNS: RegExp[] = [\n    /^remember\\b/i,\n    /^remember that\\b/i,\n    /^save\\b/i,\n    /^save this\\b/i,\n    /^store\\b/i,\n    /^store this\\b/i,\n    /^add to memory\\b/i,\n    /^note that\\b/i,\n];\n\nexport function isPreferenceStatement(content: string, patterns: RegExp[] = DEFAULT_PREFERENCE_PATTERNS): boolean {\n    const normalized = content.toLowerCase();\n    return patterns.some(pattern => pattern.test(normalized));\n}\n\nexport function extractIntentMemory(content: string, patterns: RegExp[] = DEFAULT_INTENT_PATTERNS): string | null {\n    const trimmed = content.trim();\n    if (!trimmed) return null;\n\n    for (const pattern of patterns) {\n        if (pattern.test(trimmed)) {\n            const stripped = trimmed.replace(pattern, '').trim();\n            return stripped || trimmed;\n        }\n    }\n\n    return null;\n}\n\nexport function normalizeMemoryContent(content: unknown): string {\n    if (typeof content === 'string') return content;\n    try {\n        return JSON.stringify(content);\n    } catch (error) {\n        return String(content);\n    }\n}\n", "/**\n * Memory Node - Automatically saves important information to memory\n * This node runs after task completion to persist learnings\n */\n\nimport type { State, NodeResult } from '../core/types';\nimport type { MemoryManager } from '../core/memory/types';\nimport { isPreferenceStatement } from '../core/memory/memory-heuristics';\nimport { BaseNode } from '../core/node';\n\nexport interface MemoryNodeConfig {\n    /** Memory manager instance */\n    memoryManager: MemoryManager;\n    /** Whether to save completed tasks to long-term memory */\n    saveCompletedTasks?: boolean;\n    /** Whether to detect and save user preferences */\n    saveUserPreferences?: boolean;\n    /** Whether to save tool results */\n    saveToolResults?: boolean;\n    /** Custom importance scorer for tasks */\n    taskImportanceScorer?: (state: State) => number;\n}\n\n/**\n * Memory Node - saves important information from the execution\n */\nexport class MemoryNode extends BaseNode {\n    private memory: MemoryManager;\n    private config: Required<Omit<MemoryNodeConfig, 'taskImportanceScorer'>> & {\n        taskImportanceScorer?: (state: State) => number;\n    };\n\n    constructor(config: MemoryNodeConfig) {\n        super('memory', 'Memory Saver');\n        this.memory = config.memoryManager;\n        this.config = {\n            memoryManager: config.memoryManager,\n            saveCompletedTasks: config.saveCompletedTasks ?? true,\n            saveUserPreferences: config.saveUserPreferences ?? true,\n            saveToolResults: config.saveToolResults ?? false,\n            taskImportanceScorer: config.taskImportanceScorer,\n        };\n    }\n\n    async execute(state: State): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n\n        try {\n            if (state.policy.memoryEnabled === false) {\n                return this.createResult(state, events);\n            }\n\n            // Check if task is complete (all steps done)\n            const isComplete = state.task.steps.every(s => s.status === 'completed' || s.status === 'failed');\n            const hasCompletedSteps = state.task.steps.some(s => s.status === 'completed');\n\n            // 1. Save completed tasks\n            if (this.config.saveCompletedTasks && isComplete && hasCompletedSteps) {\n                const saved = await this.saveCompletedTask(state);\n                if (saved) {\n                    events.push({\n                        id: `evt-${Date.now()}`,\n                        timestamp: Date.now(),\n                        type: 'memory_save',\n                        nodeId: this.id,\n                        status: 'success',\n                        summary: 'Saved completed task to memory',\n                        metadata: { kind: 'completed-task', tags: ['completed-task', 'execution'] },\n                    });\n                }\n                events.push({\n                    id: `evt-${Date.now()}`,\n                    timestamp: Date.now(),\n                    type: 'node_end',\n                    nodeId: this.id,\n                    status: 'success',\n                    summary: 'Saved completed task to memory',\n                });\n            }\n\n            // 2. Save user preferences from conversation\n            if (this.config.saveUserPreferences) {\n                const saved = await this.saveUserPreferences(state);\n                if (saved) {\n                    events.push({\n                        id: `evt-${Date.now()}`,\n                        timestamp: Date.now(),\n                        type: 'memory_save',\n                        nodeId: this.id,\n                        status: 'success',\n                        summary: 'Saved user preference to memory',\n                        metadata: { kind: 'user-preference', tags: ['user-preference', 'conversation'] },\n                    });\n                    events.push({\n                        id: `evt-${Date.now()}`,\n                        timestamp: Date.now(),\n                        type: 'node_end',\n                        nodeId: this.id,\n                        status: 'success',\n                        summary: 'Saved user preference to memory',\n                    });\n                }\n            }\n\n            // 3. Save important tool results\n            if (this.config.saveToolResults) {\n                const savedCount = await this.saveToolResults(state);\n                if (savedCount > 0) {\n                    events.push({\n                        id: `evt-${Date.now()}`,\n                        timestamp: Date.now(),\n                        type: 'memory_save',\n                        nodeId: this.id,\n                        status: 'success',\n                        summary: `Saved ${savedCount} tool results to memory`,\n                        metadata: { kind: 'tool-result', count: savedCount, tags: ['tool-result', 'execution'] },\n                    });\n                }\n            }\n\n            // 4. Save important artifacts\n            const artifactCount = await this.saveArtifacts(state);\n            if (artifactCount > 0) {\n                events.push({\n                    id: `evt-${Date.now()}`,\n                    timestamp: Date.now(),\n                    type: 'memory_save',\n                    nodeId: this.id,\n                    status: 'success',\n                    summary: `Saved ${artifactCount} artifacts to memory`,\n                    metadata: { kind: 'artifact', count: artifactCount },\n                });\n            }\n\n            return this.createResult(state, events);\n        } catch (error) {\n            console.error('[MemoryNode] Failed to save memories:', error);\n            // Don't fail the entire execution if memory saving fails\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'error',\n                nodeId: this.id,\n                status: 'warning',\n                summary: `Memory save failed: ${error instanceof Error ? error.message : String(error)}`,\n            });\n            return this.createResult(state, events);\n        }\n    }\n\n    /**\n     * Save completed task to long-term memory\n     */\n    private async saveCompletedTask(state: State): Promise<boolean> {\n        const importance = this.config.taskImportanceScorer\n            ? this.config.taskImportanceScorer(state)\n            : this.calculateTaskImportance(state);\n\n        const completedSteps = state.task.steps.filter(s => s.status === 'completed');\n        const taskSummary = {\n            goal: state.task.goal,\n            stepsCompleted: completedSteps.length,\n            totalSteps: state.task.steps.length,\n            steps: completedSteps.map(s => ({\n                description: s.description,\n                status: s.status,\n            })),\n            completedAt: Date.now(),\n        };\n\n        await this.memory.remember(taskSummary, {\n            tags: ['completed-task', 'execution'],\n            importance,\n            longTerm: importance >= 0.6,\n        });\n        return true;\n    }\n\n    /**\n     * Detect and save user preferences from conversation\n     */\n    private async saveUserPreferences(state: State): Promise<boolean> {\n        const userMessages = state.conversation.messages.filter(m => m.role === 'user');\n        const lastUserMessage = userMessages[userMessages.length - 1];\n\n        if (!lastUserMessage) return false;\n\n        const isPreference = isPreferenceStatement(lastUserMessage.content);\n\n        if (isPreference) {\n            await this.memory.remember(lastUserMessage.content, {\n                tags: ['user-preference', 'conversation'],\n                importance: 0.85,\n                longTerm: true,\n            });\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Save important tool results\n     */\n    private async saveToolResults(state: State): Promise<number> {\n        let savedCount = 0;\n        for (const step of state.task.steps) {\n            if (step.status === 'completed' && step.result) {\n                // Only save non-trivial results\n                const resultStr = JSON.stringify(step.result);\n                if (resultStr.length > 50) {\n                    await this.memory.remember(\n                        {\n                            description: step.description,\n                            result: step.result,\n                        },\n                        {\n                            tags: ['tool-result', 'execution'],\n                            importance: 0.5,\n                        }\n                    );\n                    savedCount += 1;\n                }\n            }\n        }\n        return savedCount;\n    }\n\n    /**\n     * Save important artifacts (SQL queries, code, etc.)\n     */\n    private async saveArtifacts(state: State): Promise<number> {\n        let savedCount = 0;\n        // Save SQL queries\n        if (state.artifacts.sql && state.artifacts.sql.length > 0) {\n            await this.memory.remember(\n                {\n                    type: 'sql',\n                    queries: state.artifacts.sql,\n                    goal: state.task.goal,\n                },\n                {\n                    tags: ['artifact', 'sql', 'query'],\n                    importance: 0.6,\n                    longTerm: true,\n                }\n            );\n            savedCount += 1;\n        }\n\n        // Save file references\n        if (state.artifacts.files && state.artifacts.files.length > 0) {\n            await this.memory.remember(\n                {\n                    type: 'files',\n                    files: state.artifacts.files,\n                    goal: state.task.goal,\n                },\n                {\n                    tags: ['artifact', 'files', 'reference'],\n                    importance: 0.7,\n                    longTerm: true,\n                }\n            );\n            savedCount += 1;\n        }\n        return savedCount;\n    }\n\n    /**\n     * Calculate task importance based on execution characteristics\n     */\n    private calculateTaskImportance(state: State): number {\n        let importance = 0.5; // Base importance\n\n        // More steps = more complex = more important\n        const stepCount = state.task.steps.length;\n        importance += Math.min(stepCount * 0.05, 0.2);\n\n        // Failed steps reduce importance\n        const failedCount = state.task.steps.filter(s => s.status === 'failed').length;\n        if (failedCount > 0) {\n            importance -= failedCount * 0.1;\n        }\n\n        // Tasks with artifacts are more important\n        const hasArtifacts =\n            (state.artifacts.sql && state.artifacts.sql.length > 0) ||\n            (state.artifacts.files && state.artifacts.files.length > 0);\n        if (hasArtifacts) {\n            importance += 0.15;\n        }\n\n        // Long conversations indicate complexity\n        if (state.conversation.messages.length > 10) {\n            importance += 0.1;\n        }\n\n        return Math.min(Math.max(importance, 0.1), 1.0);\n    }\n}\n", "/**\n * Agent \u6A21\u5F0F\u5224\u65AD\u5DE5\u5177\n * \u5224\u65AD\u7528\u6237\u8F93\u5165\u5E94\u8BE5\u4F7F\u7528 chat \u8FD8\u662F agent \u6A21\u5F0F\n */\n\n/** \u7B80\u5355\u95EE\u5019\u5217\u8868 */\nconst GREETINGS = ['hi', 'hello', 'hey', '\u4F60\u597D', '\u55E8', 'thanks', 'thank you', '\u8C22\u8C22'];\n\n/** \u7B80\u5355\u95EE\u9898\u6A21\u5F0F */\nconst SIMPLE_PATTERNS = [\n    /^what is your name/,\n    /^who are you/,\n    /^\u4F60\u662F\u8C01/,\n    /^how are you/,\n    /^\u4F60\u597D\u5417/,\n];\n\n/** \u590D\u6742\u4EFB\u52A1\u5173\u952E\u8BCD */\nconst TASK_KEYWORDS = [\n    'search', 'find', 'query', 'analyze', 'research',\n    'create', 'generate', 'build', 'make', 'write',\n    '\u641C\u7D22', '\u67E5\u8BE2', '\u5206\u6790', '\u7814\u7A76', '\u521B\u5EFA', '\u751F\u6210', '\u7F16\u5199',\n    'sql', 'database', '\u6570\u636E\u5E93',\n    'optimize', '\u4F18\u5316',\n    'calculate', '\u8BA1\u7B97',\n    'summarize', '\u603B\u7ED3',\n];\n\n/**\n * \u5224\u65AD\u662F\u5426\u5E94\u8BE5\u4F7F\u7528 Agent \u6A21\u5F0F\n */\nexport function shouldUseAgentMode(message: string, hasTools: boolean): boolean {\n    // \u5982\u679C\u6CA1\u6709\u6CE8\u518C\u5DE5\u5177\uFF0C\u53EA\u80FD\u7528 chat \u6A21\u5F0F\n    if (!hasTools) {\n        return false;\n    }\n\n    const lowerMessage = message.toLowerCase().trim();\n\n    // \u7B80\u5355\u95EE\u5019 -> Chat\n    if (GREETINGS.some(g => lowerMessage === g || lowerMessage.startsWith(g + ' '))) {\n        return false;\n    }\n\n    // \u7B80\u5355\u95EE\u9898 -> Chat\n    if (SIMPLE_PATTERNS.some(p => p.test(lowerMessage))) {\n        return false;\n    }\n\n    // \u590D\u6742\u4EFB\u52A1\u5173\u952E\u8BCD -> Agent\n    if (TASK_KEYWORDS.some(k => lowerMessage.includes(k))) {\n        return true;\n    }\n\n    // \u9ED8\u8BA4\u4F7F\u7528 Chat\n    return false;\n}\n\n/**\n * \u683C\u5F0F\u5316 Agent \u6267\u884C\u7ED3\u679C\u4E3A\u53EF\u8BFB\u6587\u672C\n */\nexport function formatAgentResponse(\n    goal: string,\n    steps: Array<{ description: string; status: string }>\n): string {\n    const completedSteps = steps.filter(s => s.status === 'completed');\n\n    let response = `\u4EFB\u52A1\u5DF2\u5B8C\u6210\uFF01\\n\\n`;\n    response += `**\u76EE\u6807**: ${goal}\\n\\n`;\n\n    if (completedSteps.length > 0) {\n        response += `**\u6267\u884C\u6B65\u9AA4**:\\n`;\n        completedSteps.forEach((step, i) => {\n            response += `${i + 1}. ${step.description}\\n`;\n        });\n    }\n\n    return response;\n}\n", "/**\n * Agent Abort Controller\n * \u7BA1\u7406 Agent \u6267\u884C\u7684\u4E2D\u65AD\u548C\u6062\u590D\u529F\u80FD\n */\n\nimport type { Checkpoint, State } from './types';\n\n// ============================================================================\n// \u7C7B\u578B\u5B9A\u4E49\n// ============================================================================\n\nexport interface AbortState {\n    aborted: boolean;\n    reason?: string;\n    timestamp?: number;\n    checkpoint?: Checkpoint;\n}\n\nexport interface ResumeOptions {\n    fromCheckpoint?: string;\n    modifiedState?: Partial<State>;\n}\n\n// ============================================================================\n// AgentAbortController \u7C7B\n// ============================================================================\n\n/**\n * AgentAbortController\n * \u5C01\u88C5 AbortController\uFF0C\u63D0\u4F9B Agent \u7279\u5B9A\u7684\u4E2D\u65AD\u63A7\u5236\u529F\u80FD\n */\nexport class AgentAbortController {\n    private controller: AbortController;\n    private abortState: AbortState = { aborted: false };\n    private checkpoints: Map<string, Checkpoint> = new Map();\n\n    constructor() {\n        this.controller = new AbortController();\n    }\n\n    /**\n     * \u83B7\u53D6 AbortSignal\n     */\n    get signal(): AbortSignal {\n        return this.controller.signal;\n    }\n\n    /**\n     * \u68C0\u67E5\u662F\u5426\u5DF2\u4E2D\u65AD\n     */\n    get isAborted(): boolean {\n        return this.abortState.aborted;\n    }\n\n    /**\n     * \u83B7\u53D6\u4E2D\u65AD\u72B6\u6001\n     */\n    getAbortState(): Readonly<AbortState> {\n        return { ...this.abortState };\n    }\n\n    /**\n     * \u4E2D\u65AD\u6267\u884C\n     */\n    abort(reason?: string): void {\n        if (this.abortState.aborted) return;\n\n        this.abortState = {\n            aborted: true,\n            reason: reason || 'User initiated abort',\n            timestamp: Date.now(),\n        };\n        this.controller.abort(reason);\n    }\n\n    /**\n     * \u91CD\u7F6E\u63A7\u5236\u5668\uFF08\u7528\u4E8E\u6062\u590D\u6267\u884C\uFF09\n     */\n    reset(): void {\n        this.controller = new AbortController();\n        this.abortState = { aborted: false };\n    }\n\n    /**\n     * \u4FDD\u5B58 checkpoint\n     */\n    saveCheckpoint(checkpoint: Checkpoint): void {\n        this.checkpoints.set(checkpoint.id, checkpoint);\n        this.abortState.checkpoint = checkpoint;\n    }\n\n    /**\n     * \u83B7\u53D6 checkpoint\n     */\n    getCheckpoint(id: string): Checkpoint | undefined {\n        return this.checkpoints.get(id);\n    }\n\n    /**\n     * \u83B7\u53D6\u6700\u65B0\u7684 checkpoint\n     */\n    getLatestCheckpoint(): Checkpoint | undefined {\n        return this.abortState.checkpoint;\n    }\n\n    /**\n     * \u83B7\u53D6\u6240\u6709 checkpoints\n     */\n    listCheckpoints(): Checkpoint[] {\n        return Array.from(this.checkpoints.values())\n            .sort((a, b) => b.timestamp - a.timestamp);\n    }\n\n    /**\n     * \u6E05\u9664\u6240\u6709 checkpoints\n     */\n    clearCheckpoints(): void {\n        this.checkpoints.clear();\n        if (this.abortState.checkpoint) {\n            delete this.abortState.checkpoint;\n        }\n    }\n\n    /**\n     * \u68C0\u67E5\u662F\u5426\u5E94\u8BE5\u7EE7\u7EED\u6267\u884C\n     * @throws \u5982\u679C\u5DF2\u4E2D\u65AD\u5219\u629B\u51FA AbortError\n     */\n    throwIfAborted(): void {\n        if (this.controller.signal.aborted) {\n            const error = new Error(this.abortState.reason || 'Operation aborted');\n            error.name = 'AbortError';\n            throw error;\n        }\n    }\n\n    /**\n     * \u521B\u5EFA\u5E26\u4E2D\u65AD\u68C0\u6D4B\u7684 Promise wrapper\n     */\n    wrapWithAbort<T>(promise: Promise<T>): Promise<T> {\n        return new Promise((resolve, reject) => {\n            // \u5982\u679C\u5DF2\u7ECF\u4E2D\u65AD\uFF0C\u76F4\u63A5\u62D2\u7EDD\n            if (this.controller.signal.aborted) {\n                const error = new Error(this.abortState.reason || 'Operation aborted');\n                error.name = 'AbortError';\n                reject(error);\n                return;\n            }\n\n            // \u76D1\u542C\u4E2D\u65AD\u4E8B\u4EF6\n            const abortHandler = () => {\n                const error = new Error(this.abortState.reason || 'Operation aborted');\n                error.name = 'AbortError';\n                reject(error);\n            };\n            this.controller.signal.addEventListener('abort', abortHandler);\n\n            // \u6267\u884C\u539F\u59CB promise\n            promise\n                .then(resolve)\n                .catch(reject)\n                .finally(() => {\n                    this.controller.signal.removeEventListener('abort', abortHandler);\n                });\n        });\n    }\n}\n\n/**\n * \u68C0\u67E5\u9519\u8BEF\u662F\u5426\u4E3A AbortError\n */\nexport function isAbortError(error: unknown): boolean {\n    if (error instanceof Error) {\n        return error.name === 'AbortError' || error.message.includes('aborted');\n    }\n    return false;\n}\n\n/**\n * \u521B\u5EFA AgentAbortController \u5B9E\u4F8B\n */\nexport function createAbortController(): AgentAbortController {\n    return new AgentAbortController();\n}\n", "/**\n * Intent router for choosing chat/agent modes with optional policies.\n */\n\nimport type { LLMProvider, ChatMessage } from './llm-provider';\nimport { shouldUseAgentMode } from './agent-utils';\n\nexport type IntentMode = 'chat' | 'agent';\n\nexport interface IntentRouterContext {\n    message: string;\n    hasTools: boolean;\n    availableTools: string[];\n}\n\nexport interface IntentToolPolicy {\n    allowedTools?: string[];\n}\n\nexport interface IntentMemoryPolicy {\n    enableMemory?: boolean;\n    enableChatMemory?: boolean;\n}\n\nexport interface IntentDecision {\n    mode: IntentMode;\n    toolPolicy?: IntentToolPolicy;\n    memoryPolicy?: IntentMemoryPolicy;\n    reason?: string;\n}\n\nexport interface IntentRouter {\n    route(context: IntentRouterContext): Promise<IntentDecision>;\n}\n\nexport class RuleBasedIntentRouter implements IntentRouter {\n    async route(context: IntentRouterContext): Promise<IntentDecision> {\n        const mode = shouldUseAgentMode(context.message, context.hasTools) ? 'agent' : 'chat';\n        return { mode, reason: 'rule-based' };\n    }\n}\n\nexport interface LLMIntentRouterOptions {\n    systemPrompt?: string;\n    temperature?: number;\n    fallbackRouter?: IntentRouter;\n}\n\nconst DEFAULT_SYSTEM_PROMPT =\n    'You are a routing assistant. Decide whether to use chat or agent mode. ' +\n    'Return JSON only with fields: ' +\n    '{\"mode\":\"chat|agent\",\"allowedTools\"?:string[],\"enableMemory\"?:boolean,\"enableChatMemory\"?:boolean,\"reason\"?:string}.';\n\nexport class LLMIntentRouter implements IntentRouter {\n    private fallbackRouter: IntentRouter;\n\n    constructor(\n        private readonly provider: LLMProvider,\n        private readonly options: LLMIntentRouterOptions = {}\n    ) {\n        this.fallbackRouter = options.fallbackRouter ?? new RuleBasedIntentRouter();\n    }\n\n    async route(context: IntentRouterContext): Promise<IntentDecision> {\n        if (!context.hasTools) {\n            return { mode: 'chat', reason: 'no-tools' };\n        }\n\n        const messages: ChatMessage[] = [\n            {\n                role: 'system',\n                content: this.options.systemPrompt || DEFAULT_SYSTEM_PROMPT,\n            },\n            {\n                role: 'user',\n                content: [\n                    `User message: ${context.message}`,\n                    `Available tools: ${context.availableTools.join(', ') || 'none'}`,\n                ].join('\\n'),\n            },\n        ];\n\n        try {\n            const response = await this.provider.chat({\n                messages,\n                temperature: this.options.temperature ?? 0.1,\n            });\n\n            const decision = parseIntentDecision(response.content);\n            if (!decision) {\n                return await this.fallbackRouter.route(context);\n            }\n\n            return normalizeIntentDecision(decision, context);\n        } catch (error) {\n            console.error('[IntentRouter] Failed to route with LLM:', error);\n            return await this.fallbackRouter.route(context);\n        }\n    }\n}\n\nfunction parseIntentDecision(content: string): IntentDecision | null {\n    const match = content.match(/\\{[\\s\\S]*\\}/);\n    if (!match) return null;\n\n    try {\n        return JSON.parse(match[0]);\n    } catch {\n        return null;\n    }\n}\n\nfunction normalizeIntentDecision(decision: IntentDecision, context: IntentRouterContext): IntentDecision {\n    const mode = decision.mode === 'agent' ? 'agent' : 'chat';\n    const allowedTools = decision.toolPolicy?.allowedTools || (decision as any).allowedTools;\n    const enableMemory = decision.memoryPolicy?.enableMemory ?? (decision as any).enableMemory;\n    const enableChatMemory = decision.memoryPolicy?.enableChatMemory ?? (decision as any).enableChatMemory;\n\n    const normalized: IntentDecision = {\n        mode,\n        reason: decision.reason,\n        toolPolicy: undefined,\n        memoryPolicy: undefined,\n    };\n\n    if (Array.isArray(allowedTools) && allowedTools.length > 0) {\n        normalized.toolPolicy = {\n            allowedTools: allowedTools.filter(tool => context.availableTools.includes(tool)),\n        };\n    }\n\n    if (enableMemory !== undefined || enableChatMemory !== undefined) {\n        normalized.memoryPolicy = {\n            enableMemory: enableMemory === undefined ? undefined : Boolean(enableMemory),\n            enableChatMemory: enableChatMemory === undefined ? undefined : Boolean(enableChatMemory),\n        };\n    }\n\n    if (!context.hasTools) {\n        normalized.mode = 'chat';\n    }\n\n    return normalized;\n}\n", "/**\n * Audit logging helpers.\n */\n\nimport type { EventStream } from './event-stream';\nimport type { Event } from './types';\n\nexport type AuditStatus = Event['status'];\n\nexport interface AuditEntry {\n    action: string;\n    status: AuditStatus;\n    actor?: string;\n    roles?: string[];\n    metadata?: Record<string, unknown>;\n    timestamp?: number;\n}\n\nexport interface AuditLogger {\n    log(entry: AuditEntry): void | Promise<void>;\n}\n\nexport function createEventStreamAuditLogger(eventStream: EventStream): AuditLogger {\n    return {\n        log(entry: AuditEntry) {\n            const timestamp = entry.timestamp ?? Date.now();\n            eventStream.emit('audit', entry.status, entry.action, {\n                metadata: {\n                    actor: entry.actor,\n                    roles: entry.roles,\n                    ...entry.metadata,\n                },\n                payload: {\n                    ...entry,\n                    timestamp,\n                },\n            });\n        },\n    };\n}\n", "/**\n * RBAC policy helpers.\n */\n\nexport interface RBACPolicy {\n    roles: Record<string, string[]>;\n    defaultRoles?: string[];\n}\n\nexport interface RBACContext {\n    roles: string[];\n    permissions: Record<string, boolean>;\n}\n\nexport function resolveRoles(policy: RBACPolicy, roles?: string[]): string[] {\n    if (roles && roles.length > 0) return roles;\n    return policy.defaultRoles ? [...policy.defaultRoles] : [];\n}\n\nexport function resolvePermissions(policy: RBACPolicy, roles: string[]): Record<string, boolean> {\n    const permissions: Record<string, boolean> = {};\n\n    for (const role of roles) {\n        const grants = policy.roles[role] || [];\n        for (const permission of grants) {\n            permissions[permission] = true;\n        }\n    }\n\n    return permissions;\n}\n", "/**\n * Chat-mode memory helpers for recall and save policies.\n */\n\nimport type { MemoryItem, MemoryManager } from './types';\nimport {\n    DEFAULT_INTENT_PATTERNS,\n    DEFAULT_PREFERENCE_PATTERNS,\n    extractIntentMemory,\n    isPreferenceStatement,\n    normalizeMemoryContent,\n} from './memory-heuristics';\n\nexport type ChatMemoryMessageRole = 'system' | 'user' | 'assistant';\n\nexport interface ChatMemoryRecallPolicy {\n    limit?: number;\n    minImportance?: number;\n    tags?: string[];\n    messageRole?: ChatMemoryMessageRole;\n}\n\nexport interface ChatMemorySavePolicy {\n    saveUserPreferences?: boolean;\n    saveConversationTurns?: boolean;\n    saveIntentMessages?: boolean;\n    minMessageLength?: number;\n    preferencePatterns?: RegExp[];\n    intentPatterns?: RegExp[];\n    importance?: number;\n    intentImportance?: number;\n    longTerm?: boolean;\n    tags?: string[];\n}\n\nexport const DEFAULT_CHAT_MEMORY_RECALL_POLICY: Required<Pick<ChatMemoryRecallPolicy, 'limit' | 'messageRole'>> = {\n    limit: 5,\n    messageRole: 'system',\n};\n\nexport const DEFAULT_CHAT_MEMORY_SAVE_POLICY: Required<Pick<ChatMemorySavePolicy, 'saveUserPreferences' | 'saveConversationTurns' | 'saveIntentMessages' | 'minMessageLength' | 'importance' | 'longTerm'>> = {\n    saveUserPreferences: true,\n    saveConversationTurns: false,\n    saveIntentMessages: false,\n    minMessageLength: 20,\n    importance: 0.85,\n    longTerm: true,\n};\n\nexport function applyChatMemoryRecallPolicy(\n    memories: MemoryItem<unknown>[],\n    policy: ChatMemoryRecallPolicy\n): MemoryItem<unknown>[] {\n    let filtered = memories;\n\n    if (policy.minImportance !== undefined) {\n        filtered = filtered.filter(memory => memory.metadata.importance >= policy.minImportance!);\n    }\n\n    if (policy.tags && policy.tags.length > 0) {\n        filtered = filtered.filter(memory => {\n            if (!memory.metadata.tags) return false;\n            return memory.metadata.tags.some(tag => policy.tags!.includes(tag));\n        });\n    }\n\n    const limit = policy.limit ?? DEFAULT_CHAT_MEMORY_RECALL_POLICY.limit;\n    return filtered.slice(0, limit);\n}\n\nexport function formatChatMemories(memories: MemoryItem<unknown>[]): string {\n    const lines = memories.map(memory => normalizeMemoryContent(memory.content)).filter(Boolean);\n\n    if (lines.length === 0) return '';\n    if (lines.length === 1) return `Relevant memory: ${lines[0]}`;\n\n    return `Relevant memories:\\n${lines.map(line => `- ${line}`).join('\\n')}`;\n}\n\nexport async function saveChatMemoryTurn(\n    memory: MemoryManager,\n    userMessage: string,\n    assistantMessage: string,\n    policy: ChatMemorySavePolicy = {}\n): Promise<void> {\n    const resolvedPolicy = {\n        ...DEFAULT_CHAT_MEMORY_SAVE_POLICY,\n        ...policy,\n    };\n\n    const baseTags = policy.tags ?? [];\n\n    if (resolvedPolicy.saveIntentMessages) {\n        const patterns = policy.intentPatterns ?? DEFAULT_INTENT_PATTERNS;\n        const intentMemory = extractIntentMemory(userMessage, patterns);\n        if (intentMemory) {\n            await memory.remember(intentMemory, {\n                tags: uniqueTags(['explicit-memory', 'conversation', ...baseTags]),\n                importance: resolvedPolicy.intentImportance ?? Math.max(0.9, resolvedPolicy.importance),\n                longTerm: resolvedPolicy.longTerm,\n            });\n        }\n    }\n\n    if (resolvedPolicy.saveUserPreferences) {\n        const patterns = policy.preferencePatterns ?? DEFAULT_PREFERENCE_PATTERNS;\n        if (isPreferenceStatement(userMessage, patterns)) {\n            await memory.remember(userMessage, {\n                tags: uniqueTags(['user-preference', 'conversation', ...baseTags]),\n                importance: resolvedPolicy.importance,\n                longTerm: resolvedPolicy.longTerm,\n            });\n        }\n    }\n\n    if (resolvedPolicy.saveConversationTurns) {\n        const trimmed = userMessage.trim();\n        if (trimmed.length >= resolvedPolicy.minMessageLength) {\n            await memory.remember(\n                {\n                    user: trimmed,\n                    assistant: assistantMessage,\n                },\n                {\n                    tags: uniqueTags(['conversation-turn', ...baseTags]),\n                    importance: Math.min(resolvedPolicy.importance, 0.7),\n                    longTerm: resolvedPolicy.longTerm,\n                }\n            );\n        }\n    }\n}\n\nfunction uniqueTags(tags: string[]): string[] {\n    return Array.from(new Set(tags)).filter(Boolean);\n}\n", "/**\n * Agent \u6838\u5FC3\u7C7B\n * \u63D0\u4F9B\u7EDF\u4E00\u7684 Agent \u5165\u53E3\uFF0C\u5C01\u88C5 GraphRunner \u548C LLM Provider\n */\n\nimport { GraphRunner } from './runner';\nimport { EventStream } from './event-stream';\nimport { ToolRegistry } from './tool-registry';\nimport { createState } from './state';\nimport { LLMProvider, type ChatMessage } from './llm-provider';\nimport { createProviderFromSettings, createLLMProvider, type SettingsBasedConfig, type LLMProviderConfig } from '../providers';\nimport { LLMPlannerNode } from '../nodes/llm-planner';\nimport { ToolRunnerNode } from '../nodes/tool-runner';\nimport { ConfirmationNode } from '../nodes/confirmation';\nimport { VerifierNode } from '../nodes/verifier';\nimport { ResponderNode } from '../nodes/responder';\nimport { LLMResponderNode } from '../nodes/llm-responder';\nimport { MemoryNode } from '../nodes/memory';\nimport { shouldUseAgentMode, formatAgentResponse } from './agent-utils';\nimport { AgentAbortController, isAbortError, type ResumeOptions } from './abort-controller';\nimport type { State, Tool, GraphDefinition, RunnerHooks, Checkpoint, ToolConfirmationHandler } from './types';\nimport type { MemoryManager } from './memory/types';\nimport type { IntentDecision, IntentRouter } from './intent-router';\nimport { LLMIntentRouter } from './intent-router';\nimport type { AuditLogger } from './audit';\nimport { createEventStreamAuditLogger } from './audit';\nimport type { RBACPolicy } from './rbac';\nimport { resolvePermissions, resolveRoles } from './rbac';\nimport type { ChatMemoryRecallPolicy, ChatMemorySavePolicy, ChatMemoryMessageRole } from './memory/chat-memory';\nimport {\n    applyChatMemoryRecallPolicy,\n    DEFAULT_CHAT_MEMORY_RECALL_POLICY,\n    DEFAULT_CHAT_MEMORY_SAVE_POLICY,\n    formatChatMemories,\n    saveChatMemoryTurn,\n} from './memory/chat-memory';\nimport { normalizeMemoryContent } from './memory/memory-heuristics';\n\n// ============================================================================\n// \u7C7B\u578B\u5B9A\u4E49\n// ============================================================================\n\nexport type AgentMode = 'chat' | 'agent' | 'auto';\nexport type ProviderConfigInput = LLMProviderConfig | SettingsBasedConfig;\n\nexport interface AgentConfig {\n    provider: ProviderConfigInput;\n    tools?: Tool[];\n    mode?: AgentMode;\n    systemPrompt?: string;\n    streaming?: boolean;\n    maxSteps?: number;\n    hooks?: RunnerHooks;\n    /** \u662F\u5426\u4F7F\u7528 LLM \u751F\u6210\u81EA\u7136\u8BED\u8A00\u56DE\u590D */\n    useLLMResponder?: boolean;\n    /** \u5DE5\u5177\u786E\u8BA4\u56DE\u8C03\uFF08\u7528\u4E8E\u4EBA\u5DE5\u786E\u8BA4\uFF09 */\n    confirmTool?: ToolConfirmationHandler;\n    /** \u8BB0\u5FC6\u7BA1\u7406\u5668\uFF08\u53EF\u9009\uFF09 */\n    memory?: MemoryManager;\n    /** \u662F\u5426\u542F\u7528\u81EA\u52A8\u8BB0\u5FC6\u4FDD\u5B58 */\n    enableMemory?: boolean;\n    /** RBAC \u914D\u7F6E */\n    rbac?: {\n        policy: RBACPolicy;\n        roles?: string[];\n        actor?: string;\n    };\n    /** \u5BA1\u8BA1\u65E5\u5FD7\u8BB0\u5F55\u5668 */\n    auditLogger?: AuditLogger;\n    /** \u662F\u5426\u542F\u7528 LLM \u610F\u56FE\u8DEF\u7531 */\n    enableIntentRouter?: boolean;\n    /** \u81EA\u5B9A\u4E49\u610F\u56FE\u8DEF\u7531\u5668 */\n    intentRouter?: IntentRouter;\n    /** \u610F\u56FE\u8DEF\u7531\u5668\u914D\u7F6E */\n    intentRouterOptions?: {\n        systemPrompt?: string;\n        temperature?: number;\n    };\n    /** \u662F\u5426\u542F\u7528 Chat \u6A21\u5F0F\u8BB0\u5FC6 */\n    enableChatMemory?: boolean;\n    /** Chat \u6A21\u5F0F\u8BB0\u5FC6\u4FDD\u5B58\u7B56\u7565 */\n    chatMemorySavePolicy?: ChatMemorySavePolicy;\n    /** Chat \u6A21\u5F0F\u8BB0\u5FC6\u53EC\u56DE\u7B56\u7565 */\n    chatMemoryRecallPolicy?: ChatMemoryRecallPolicy;\n}\n\nexport interface ChatOptions {\n    stream?: boolean;\n    onStream?: (chunk: string) => void;\n    temperature?: number;\n    useChatMemory?: boolean;\n    chatMemorySavePolicy?: ChatMemorySavePolicy;\n    chatMemoryRecallPolicy?: ChatMemoryRecallPolicy;\n}\n\nexport interface AgentResult {\n    content: string;\n    usage?: { promptTokens: number; completionTokens: number; totalTokens: number };\n    mode: 'chat' | 'agent';\n    steps?: Array<{ description: string; status: string; result?: unknown }>;\n    duration: number;\n    /** \u662F\u5426\u88AB\u4E2D\u65AD */\n    aborted?: boolean;\n    /** \u4E2D\u65AD\u539F\u56E0 */\n    abortReason?: string;\n}\n\n// ============================================================================\n// Agent \u7C7B\n// ============================================================================\n\nexport class Agent {\n    private provider: LLMProvider;\n    private toolRegistry: ToolRegistry;\n    private runner: GraphRunner | null = null;\n    private eventStream: EventStream | null = null;\n    private abortController: AgentAbortController;\n    private isRunning: boolean = false;\n    private lastState: State | null = null;\n    private config: {\n        provider: ProviderConfigInput;\n        tools: Tool[];\n        mode: AgentMode;\n        systemPrompt: string;\n        streaming: boolean;\n        maxSteps: number;\n        hooks: RunnerHooks;\n        useLLMResponder: boolean;\n        confirmTool?: ToolConfirmationHandler;\n        memory?: MemoryManager;\n        enableMemory: boolean;\n        rbac?: {\n            policy: RBACPolicy;\n            roles?: string[];\n            actor?: string;\n        };\n        auditLogger?: AuditLogger;\n        enableIntentRouter: boolean;\n        intentRouter?: IntentRouter;\n        intentRouterOptions?: {\n            systemPrompt?: string;\n            temperature?: number;\n        };\n        enableChatMemory: boolean;\n        chatMemorySavePolicy?: ChatMemorySavePolicy;\n        chatMemoryRecallPolicy?: ChatMemoryRecallPolicy;\n    };\n    private intentRouter?: IntentRouter;\n    private conversationHistory: ChatMessage[] = [];\n    private auditLogger?: AuditLogger;\n\n    constructor(config: AgentConfig) {\n        this.config = {\n            provider: config.provider,\n            tools: config.tools || [],\n            mode: config.mode || 'auto',\n            systemPrompt: config.systemPrompt || 'You are a helpful AI assistant.',\n            streaming: config.streaming ?? true,\n            maxSteps: config.maxSteps || 15,\n            hooks: config.hooks || {},\n            useLLMResponder: config.useLLMResponder ?? false,\n            confirmTool: config.confirmTool,\n            memory: config.memory,\n            enableMemory: config.enableMemory ?? false,\n            rbac: config.rbac,\n            auditLogger: config.auditLogger,\n            enableIntentRouter: config.enableIntentRouter ?? false,\n            intentRouter: config.intentRouter,\n            intentRouterOptions: config.intentRouterOptions,\n            enableChatMemory: config.enableChatMemory ?? false,\n            chatMemorySavePolicy: config.chatMemorySavePolicy,\n            chatMemoryRecallPolicy: config.chatMemoryRecallPolicy,\n        };\n\n        this.provider = this.createProvider(this.config.provider);\n        this.toolRegistry = new ToolRegistry();\n        this.abortController = new AgentAbortController();\n        this.intentRouter = this.createIntentRouter();\n        this.config.tools.forEach(tool => this.toolRegistry.register(tool));\n        this.initializeRunner();\n        this.auditLogger = this.config.auditLogger ?? (this.eventStream ? createEventStreamAuditLogger(this.eventStream) : undefined);\n    }\n\n    private createProvider(config: ProviderConfigInput): LLMProvider {\n        if ('type' in config) {\n            return createLLMProvider(config as LLMProviderConfig);\n        }\n        return createProviderFromSettings(config as SettingsBasedConfig);\n    }\n\n    private createIntentRouter(): IntentRouter | undefined {\n        if (this.config.intentRouter) {\n            return this.config.intentRouter;\n        }\n\n        if (!this.config.enableIntentRouter) {\n            return undefined;\n        }\n\n        return new LLMIntentRouter(this.provider, this.config.intentRouterOptions);\n    }\n\n    private initializeRunner(): void {\n        const planner = new LLMPlannerNode(this.toolRegistry, { provider: this.provider });\n        const toolRunner = new ToolRunnerNode(this.toolRegistry, { provider: this.provider });\n        const confirmer = new ConfirmationNode({ onConfirm: this.config.confirmTool });\n        const verifier = new VerifierNode();\n\n        // \u6839\u636E\u914D\u7F6E\u9009\u62E9 Responder \u7C7B\u578B\n        const responder = this.config.useLLMResponder\n            ? new LLMResponderNode({ provider: this.provider })\n            : new ResponderNode();\n\n        // Build nodes list\n        const nodes: Array<typeof planner | typeof toolRunner | typeof confirmer | typeof verifier | typeof responder | MemoryNode> = [\n            planner,\n            toolRunner,\n            confirmer,\n            verifier,\n            responder,\n        ];\n\n        // Add memory node if enabled\n        let memoryNode: MemoryNode | null = null;\n        if (this.config.enableMemory && this.config.memory) {\n            memoryNode = new MemoryNode({\n                memoryManager: this.config.memory,\n                saveCompletedTasks: true,\n                saveUserPreferences: true,\n                saveToolResults: false,\n            });\n            nodes.push(memoryNode);\n        }\n\n        const graph: GraphDefinition = {\n            nodes,\n            edges: [\n                { from: 'planner', to: 'tool-runner' },\n                {\n                    from: 'tool-runner',\n                    to: 'confirmation',\n                    condition: (s) => s.task.pendingToolCall?.status === 'pending',\n                },\n                { from: 'tool-runner', to: 'verifier' },\n                { from: 'confirmation', to: 'tool-runner' },\n                { from: 'verifier', to: 'responder', condition: (s) => s.task.currentStepIndex >= s.task.steps.length },\n                { from: 'verifier', to: 'tool-runner', condition: (s) => s.task.currentStepIndex < s.task.steps.length },\n                // Add memory node after responder (if enabled)\n                ...(memoryNode ? [{ from: 'responder', to: 'memory' }] : []),\n            ],\n            entryNode: 'planner',\n            maxSteps: this.config.maxSteps,\n        };\n\n        this.runner = new GraphRunner(graph, undefined, this.config.hooks);\n        this.eventStream = this.runner.getEventStream();\n    }\n\n    /** \u4E3B\u5165\u53E3\uFF1A\u53D1\u9001\u6D88\u606F\u5E76\u83B7\u53D6\u56DE\u590D */\n    async chat(message: string, options: ChatOptions = {}): Promise<AgentResult> {\n        if (this.isRunning) {\n            throw new Error('Agent is already running. Call abort() first.');\n        }\n\n        this.isRunning = true;\n        this.abortController.reset();\n        const startTime = Date.now();\n        const decision = await this.determineRouting(message);\n        const mode = decision.mode;\n        this.logAudit({\n            action: 'route_decision',\n            status: 'info',\n            metadata: {\n                mode,\n                reason: decision.reason,\n                allowedTools: decision.toolPolicy?.allowedTools,\n                memoryPolicy: decision.memoryPolicy,\n            },\n        });\n\n        this.conversationHistory.push({ role: 'user', content: message });\n\n        try {\n            if (mode === 'chat') {\n                return await this.handleChatMode(message, options, startTime, decision);\n            }\n            return await this.handleAgentMode(message, startTime, decision);\n        } catch (error) {\n            if (isAbortError(error)) {\n                return {\n                    content: '[\u4EFB\u52A1\u5DF2\u4E2D\u65AD]',\n                    mode,\n                    duration: Date.now() - startTime,\n                    aborted: true,\n                    abortReason: this.abortController.getAbortState().reason,\n                };\n            }\n            throw error;\n        } finally {\n            this.isRunning = false;\n        }\n    }\n\n    private async determineRouting(message: string): Promise<IntentDecision> {\n        if (this.config.mode === 'chat') return { mode: 'chat', reason: 'config' };\n        if (this.config.mode === 'agent') return { mode: 'agent', reason: 'config' };\n\n        const hasTools = this.toolRegistry.list().length > 0;\n        if (!this.intentRouter) {\n            return {\n                mode: shouldUseAgentMode(message, hasTools) ? 'agent' : 'chat',\n                reason: 'rule-based',\n            };\n        }\n\n        const decision = await this.intentRouter.route({\n            message,\n            hasTools,\n            availableTools: this.toolRegistry.list(),\n        });\n\n        if (!hasTools && decision.mode === 'agent') {\n            return { ...decision, mode: 'chat' };\n        }\n\n        return decision;\n    }\n\n    private async handleChatMode(\n        message: string,\n        options: ChatOptions,\n        startTime: number,\n        decision?: IntentDecision\n    ): Promise<AgentResult> {\n        const messages: ChatMessage[] = [{ role: 'system', content: this.config.systemPrompt }];\n        const rbac = this.resolveRBAC();\n        const canRecall = this.isPermissionAllowed(rbac.permissions, 'memory:read');\n        const canWrite = this.isPermissionAllowed(rbac.permissions, 'memory:write');\n        const useChatMemory = options.useChatMemory\n            ?? decision?.memoryPolicy?.enableChatMemory\n            ?? this.config.enableChatMemory;\n\n        if (useChatMemory && this.config.memory) {\n            const recallPolicy = this.mergeChatMemoryRecallPolicy(options.chatMemoryRecallPolicy);\n            if (canRecall) {\n                const memoryMessage = await this.buildChatMemoryMessage(message, recallPolicy);\n                if (memoryMessage) {\n                    messages.push(memoryMessage);\n                }\n            } else {\n                this.logAudit({\n                    action: 'memory_recall_blocked',\n                    status: 'warning',\n                    metadata: { scope: 'chat', reason: 'permission' },\n                });\n            }\n        }\n\n        messages.push(...this.conversationHistory);\n\n        const useStream = options.stream ?? this.config.streaming;\n\n        if (useStream && options.onStream) {\n            let fullContent = '';\n            let usage: { promptTokens: number; completionTokens: number; totalTokens: number } | undefined;\n            const stream = this.provider.chatStream({\n                messages,\n                temperature: options.temperature,\n                signal: this.abortController.signal\n            });\n\n            for await (const chunk of stream) {\n                if (chunk.delta) {\n                    fullContent += chunk.delta;\n                    options.onStream(chunk.delta);\n                }\n                if (chunk.usage) {\n                    usage = chunk.usage;\n                }\n            }\n\n            this.conversationHistory.push({ role: 'assistant', content: fullContent });\n            if (useChatMemory && this.config.memory) {\n                if (!canWrite) {\n                    this.logAudit({\n                        action: 'memory_save_blocked',\n                        status: 'warning',\n                        metadata: { scope: 'chat', reason: 'permission' },\n                    });\n                } else {\n                await this.saveChatMemory(message, fullContent, options.chatMemorySavePolicy);\n                }\n            }\n            return {\n                content: fullContent,\n                mode: 'chat',\n                duration: Date.now() - startTime,\n                usage\n            };\n        }\n\n        const response = await this.provider.chat({\n            messages,\n            temperature: options.temperature,\n            signal: this.abortController.signal\n        });\n        this.conversationHistory.push({ role: 'assistant', content: response.content });\n        if (useChatMemory && this.config.memory) {\n            if (!canWrite) {\n                this.logAudit({\n                    action: 'memory_save_blocked',\n                    status: 'warning',\n                    metadata: { scope: 'chat', reason: 'permission' },\n                });\n            } else {\n            await this.saveChatMemory(message, response.content, options.chatMemorySavePolicy);\n            }\n        }\n\n        return {\n            content: response.content,\n            usage: response.usage,\n            mode: 'chat',\n            duration: Date.now() - startTime,\n        };\n    }\n\n    private async handleAgentMode(\n        message: string,\n        startTime: number,\n        decision?: IntentDecision\n    ): Promise<AgentResult> {\n        if (!this.runner) throw new Error('GraphRunner not initialized');\n\n        // Recall relevant memories before task execution\n        let relevantMemories: string[] = [];\n        const memoryEnabled = decision?.memoryPolicy?.enableMemory ?? this.config.enableMemory;\n        const rbac = this.resolveRBAC();\n        const permissions = rbac.permissions ?? { 'sql:read': true, 'document:read': true };\n        const roles = rbac.roles;\n        const canRecall = this.isPermissionAllowed(rbac.permissions, 'memory:read');\n        const canWrite = this.isPermissionAllowed(rbac.permissions, 'memory:write');\n        const memoryEnabledForWrite = memoryEnabled && canWrite;\n        if (memoryEnabled && this.config.memory) {\n            if (!canRecall) {\n                this.logAudit({\n                    action: 'memory_recall_blocked',\n                    status: 'warning',\n                    metadata: { scope: 'agent', reason: 'permission' },\n                });\n            } else {\n            relevantMemories = await this.recallRelevantMemories(message);\n            }\n        }\n\n        const initialState = createState(message, {\n            permissions,\n            allowedTools: decision?.toolPolicy?.allowedTools,\n            memoryEnabled: memoryEnabledForWrite,\n            roles,\n        });\n\n        // Add relevant memories to initial state context\n        if (relevantMemories.length > 0) {\n            initialState.memory.shortTerm['recalled_context'] = relevantMemories;\n        }\n\n        // \u4F7F\u7528 AbortController \u5305\u88C5\u6267\u884C\n        const result = await this.abortController.wrapWithAbort(\n            this.runner.execute(initialState)\n        );\n        const finalState = result.state;\n        this.lastState = finalState;\n\n        const lastMessage = finalState.conversation.messages.filter(m => m.role === 'assistant').pop();\n        const content = lastMessage?.content || formatAgentResponse(\n            finalState.task.goal,\n            finalState.task.steps.map(s => ({ description: s.description, status: s.status }))\n        );\n\n        this.conversationHistory.push({ role: 'assistant', content });\n\n        return {\n            content,\n            mode: 'agent',\n            steps: finalState.task.steps.map(s => ({ description: s.description, status: s.status, result: s.result })),\n            duration: Date.now() - startTime,\n            usage: { promptTokens: 0, completionTokens: 0, totalTokens: finalState.telemetry.tokenCount },\n        };\n    }\n\n    /**\n     * Recall relevant memories for a given query\n     */\n    private async recallRelevantMemories(query: string): Promise<string[]> {\n        if (!this.config.memory) return [];\n\n        try {\n            const memories = await this.config.memory.recall(query);\n            this.eventStream?.emit('memory_recall', 'info', 'Recalled agent memories', {\n                metadata: {\n                    query,\n                    count: memories.length,\n                    source: 'agent',\n                },\n            });\n            this.logAudit({\n                action: 'memory_recall',\n                status: 'info',\n                metadata: { scope: 'agent', query, count: memories.length },\n            });\n            return memories.slice(0, 5).map(m => normalizeMemoryContent(m.content));\n        } catch (error) {\n            console.error('[Agent] Failed to recall memories:', error);\n            return [];\n        }\n    }\n\n    private mergeChatMemoryRecallPolicy(override?: ChatMemoryRecallPolicy): ChatMemoryRecallPolicy {\n        return {\n            ...DEFAULT_CHAT_MEMORY_RECALL_POLICY,\n            ...this.config.chatMemoryRecallPolicy,\n            ...override,\n        };\n    }\n\n    private mergeChatMemorySavePolicy(override?: ChatMemorySavePolicy): ChatMemorySavePolicy {\n        return {\n            ...DEFAULT_CHAT_MEMORY_SAVE_POLICY,\n            ...this.config.chatMemorySavePolicy,\n            ...override,\n        };\n    }\n\n    private async buildChatMemoryMessage(\n        query: string,\n        policy: ChatMemoryRecallPolicy\n    ): Promise<ChatMessage | null> {\n        if (!this.config.memory) return null;\n\n        try {\n            const memories = await this.config.memory.recall(query);\n            this.eventStream?.emit('memory_recall', 'info', 'Recalled chat memories', {\n                metadata: {\n                    query,\n                    count: memories.length,\n                    source: 'chat',\n                },\n            });\n            this.logAudit({\n                action: 'memory_recall',\n                status: 'info',\n                metadata: { scope: 'chat', query, count: memories.length },\n            });\n            const filtered = applyChatMemoryRecallPolicy(memories, policy);\n            const formatted = formatChatMemories(filtered);\n            if (!formatted) return null;\n\n            const role = (policy.messageRole ?? DEFAULT_CHAT_MEMORY_RECALL_POLICY.messageRole) as ChatMemoryMessageRole;\n            return { role, content: formatted };\n        } catch (error) {\n            console.error('[Agent] Failed to recall chat memories:', error);\n            return null;\n        }\n    }\n\n    private async saveChatMemory(\n        userMessage: string,\n        assistantMessage: string,\n        overridePolicy?: ChatMemorySavePolicy\n    ): Promise<void> {\n        if (!this.config.memory) return;\n\n        const savePolicy = this.mergeChatMemorySavePolicy(overridePolicy);\n        try {\n            await saveChatMemoryTurn(this.config.memory, userMessage, assistantMessage, savePolicy);\n            this.eventStream?.emit('memory_save', 'info', 'Saved chat memory', {\n                metadata: {\n                    source: 'chat',\n                    saveIntentMessages: !!savePolicy.saveIntentMessages,\n                    saveUserPreferences: !!savePolicy.saveUserPreferences,\n                    saveConversationTurns: !!savePolicy.saveConversationTurns,\n                },\n            });\n            this.logAudit({\n                action: 'memory_save',\n                status: 'info',\n                metadata: {\n                    scope: 'chat',\n                    saveIntentMessages: !!savePolicy.saveIntentMessages,\n                    saveUserPreferences: !!savePolicy.saveUserPreferences,\n                    saveConversationTurns: !!savePolicy.saveConversationTurns,\n                },\n            });\n        } catch (error) {\n            console.error('[Agent] Failed to save chat memories:', error);\n        }\n    }\n\n    private resolveRBAC(): { roles?: string[]; permissions?: Record<string, boolean> } {\n        const policy = this.config.rbac?.policy;\n        if (!policy) return {};\n        const roles = resolveRoles(policy, this.config.rbac?.roles);\n        const permissions = resolvePermissions(policy, roles);\n        return { roles, permissions };\n    }\n\n    private isPermissionAllowed(permissions: Record<string, boolean> | undefined, permission: string): boolean {\n        if (!permissions) return true;\n        return permissions[permission] === true;\n    }\n\n    private logAudit(entry: Omit<import('./audit').AuditEntry, 'actor' | 'roles'>): void {\n        if (!this.auditLogger) return;\n        const policy = this.config.rbac?.policy;\n        const roles = policy ? resolveRoles(policy, this.config.rbac?.roles) : this.config.rbac?.roles;\n        this.auditLogger.log({\n            ...entry,\n            actor: this.config.rbac?.actor,\n            roles,\n        });\n    }\n\n    // Public API\n    getEventStream(): EventStream {\n        if (!this.eventStream) {\n            throw new Error('EventStream not initialized');\n        }\n        return this.eventStream;\n    }\n    getToolRegistry(): ToolRegistry { return this.toolRegistry; }\n    getProvider(): LLMProvider { return this.provider; }\n    getHistory(): ChatMessage[] { return [...this.conversationHistory]; }\n    getMemory(): MemoryManager | undefined { return this.config.memory; }\n    getGraphDefinition() { return this.runner?.getGraphDefinition(); }\n\n    registerTool(tool: Tool): void { this.toolRegistry.register(tool); }\n    clearHistory(): void { this.conversationHistory = []; }\n    setHistory(history: ChatMessage[]): void { this.conversationHistory = [...history]; }\n\n    // ========================================================================\n    // Abort/Resume API\n    // ========================================================================\n\n    /**\n     * \u4E2D\u65AD\u5F53\u524D\u6267\u884C\n     * @param reason \u4E2D\u65AD\u539F\u56E0\n     */\n    abort(reason?: string): void {\n        if (!this.isRunning) {\n            console.warn('Agent is not running, nothing to abort.');\n            return;\n        }\n        this.abortController.abort(reason);\n        this.eventStream?.emit('abort', 'warning', reason || 'User initiated abort');\n    }\n\n    /**\n     * \u4ECE\u6700\u8FD1\u7684 checkpoint \u6062\u590D\u6267\u884C\n     * @param options \u6062\u590D\u9009\u9879\n     */\n    async resume(options: ResumeOptions = {}): Promise<AgentResult> {\n        if (this.isRunning) {\n            throw new Error('Agent is already running.');\n        }\n\n        const checkpointId = options.fromCheckpoint;\n        let resumeState: State | null = null;\n\n        if (checkpointId) {\n            const checkpoint = this.abortController.getCheckpoint(checkpointId);\n            if (!checkpoint) {\n                throw new Error(`Checkpoint \"${checkpointId}\" not found.`);\n            }\n            resumeState = checkpoint.state;\n        } else {\n            // \u4F7F\u7528\u6700\u8FD1\u4E00\u6B21\u4FDD\u5B58\u7684\u72B6\u6001\n            const latestCheckpoint = this.abortController.getLatestCheckpoint();\n            resumeState = latestCheckpoint?.state || this.lastState;\n        }\n\n        if (!resumeState) {\n            throw new Error('No state available to resume from.');\n        }\n\n        // \u5E94\u7528\u4FEE\u6539\uFF08\u5982\u679C\u6709\uFF09\n        if (options.modifiedState) {\n            resumeState = {\n                ...resumeState,\n                ...options.modifiedState,\n                updatedAt: Date.now(),\n            };\n        }\n\n        this.isRunning = true;\n        this.abortController.reset();\n        const startTime = Date.now();\n\n        try {\n            if (!this.runner) throw new Error('GraphRunner not initialized');\n\n            this.eventStream?.emit('resume', 'info', 'Resuming from checkpoint');\n\n            const result = await this.runner.execute(resumeState);\n            const finalState = result.state;\n            this.lastState = finalState;\n\n            const lastMessage = finalState.conversation.messages\n                .filter(m => m.role === 'assistant').pop();\n            const content = lastMessage?.content || formatAgentResponse(\n                finalState.task.goal,\n                finalState.task.steps.map(s => ({ description: s.description, status: s.status }))\n            );\n\n            this.conversationHistory.push({ role: 'assistant', content });\n\n            return {\n                content,\n                mode: 'agent',\n                steps: finalState.task.steps.map(s => ({\n                    description: s.description,\n                    status: s.status,\n                    result: s.result,\n                })),\n                duration: Date.now() - startTime,\n                usage: { promptTokens: 0, completionTokens: 0, totalTokens: finalState.telemetry.tokenCount },\n            };\n        } catch (error) {\n            if (isAbortError(error)) {\n                return {\n                    content: '[\u4EFB\u52A1\u5DF2\u4E2D\u65AD]',\n                    mode: 'agent',\n                    duration: Date.now() - startTime,\n                    aborted: true,\n                    abortReason: this.abortController.getAbortState().reason,\n                };\n            }\n            throw error;\n        } finally {\n            this.isRunning = false;\n        }\n    }\n\n    /**\n     * \u68C0\u67E5 Agent \u662F\u5426\u6B63\u5728\u8FD0\u884C\n     */\n    isAgentRunning(): boolean {\n        return this.isRunning;\n    }\n\n    /**\n     * \u83B7\u53D6 AbortController\n     */\n    getAbortController(): AgentAbortController {\n        return this.abortController;\n    }\n\n    /**\n     * \u83B7\u53D6\u53EF\u7528\u7684 checkpoints\n     */\n    listCheckpoints(): Checkpoint[] {\n        return this.abortController.listCheckpoints();\n    }\n}\n\n/** \u521B\u5EFA Agent \u5B9E\u4F8B */\nexport function createAgent(config: AgentConfig): Agent {\n    return new Agent(config);\n}\n", "/**\n * Debug Bundle \u5BFC\u51FA\n * \u6536\u96C6\u5E76\u5BFC\u51FA\u5B8C\u6574\u7684\u8C03\u8BD5\u4FE1\u606F\n */\n\nimport type { State, Checkpoint } from './types';\nimport type { EventStream } from './event-stream';\n\nexport interface DebugBundle {\n    version: string;\n    timestamp: number;\n    state: State;\n    events: ReturnType<EventStream['export']>;\n    checkpoints?: Checkpoint[];\n    metadata: {\n        userAgent?: string;\n        platform?: string;\n        [key: string]: unknown;\n    };\n}\n\n/**\n * \u521B\u5EFA Debug Bundle\n */\nexport function createDebugBundle(\n    state: State,\n    eventStream: EventStream,\n    options?: {\n        checkpoints?: Checkpoint[];\n        metadata?: Record<string, unknown>;\n    }\n): DebugBundle {\n    return {\n        version: '0.1.0',\n        timestamp: Date.now(),\n        state,\n        events: eventStream.export(),\n        checkpoints: options?.checkpoints,\n        metadata: {\n            userAgent: typeof navigator !== 'undefined' ? navigator.userAgent : undefined,\n            platform: typeof navigator !== 'undefined' ? navigator.platform : undefined,\n            ...options?.metadata,\n        },\n    };\n}\n\n/**\n * \u5BFC\u51FA\u4E3A JSON \u5B57\u7B26\u4E32\n */\nexport function exportDebugBundle(bundle: DebugBundle): string {\n    return JSON.stringify(bundle, null, 2);\n}\n\n/**\n * \u5BFC\u51FA\u4E3A\u6587\u4EF6\uFF08\u6D4F\u89C8\u5668\u73AF\u5883\uFF09\n */\nexport function downloadDebugBundle(bundle: DebugBundle, filename?: string): void {\n    const json = exportDebugBundle(bundle);\n    const blob = new Blob([json], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename || `debug-bundle-${Date.now()}.json`;\n    a.click();\n\n    URL.revokeObjectURL(url);\n}\n\n/**\n * \u4ECE JSON \u6062\u590D Debug Bundle\n */\nexport function importDebugBundle(json: string): DebugBundle {\n    return JSON.parse(json);\n}\n", "/**\n * Planner \u8282\u70B9\n * \u8D1F\u8D23\u89E3\u6790\u7528\u6237\u76EE\u6807\uFF0C\u751F\u6210\u4EFB\u52A1\u8BA1\u5212\u4E0E\u6B65\u9AA4\n */\n\nimport { BaseNode } from '../core/node';\nimport type { NodeResult, State, TaskStep } from '../core/types';\nimport { updateState } from '../core/state';\n\nexport class PlannerNode extends BaseNode {\n    constructor() {\n        super('planner', 'Planner');\n    }\n\n    async execute(state: State): Promise<NodeResult> {\n        const events: NodeResult['events'] = [];\n        const startTime = Date.now();\n\n        try {\n            // \u4ECE\u7528\u6237\u76EE\u6807\u751F\u6210\u8BA1\u5212\uFF08v0.1 \u4F7F\u7528\u89C4\u5219\u5F15\u64CE\uFF0C\u540E\u7EED\u53EF\u63A5\u5165 LLM\uFF09\n            const plan = await this.generatePlan(state.task.goal);\n            const steps = this.parseSteps(plan);\n\n            // \u66F4\u65B0 State\n            const newState = updateState(state, draft => {\n                draft.task.plan = plan;\n                draft.task.steps = steps;\n                draft.task.progress = 10; // \u89C4\u5212\u5B8C\u6210 10%\n            });\n\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'node_end',\n                nodeId: this.id,\n                status: 'success',\n                summary: `\u751F\u6210\u4E86 ${steps.length} \u4E2A\u5B50\u4EFB\u52A1`,\n                metadata: { stepCount: steps.length },\n            });\n\n            return this.createResult(newState, events);\n        } catch (error) {\n            events.push({\n                id: `evt-${Date.now()}`,\n                timestamp: Date.now(),\n                type: 'error',\n                nodeId: this.id,\n                status: 'failure',\n                summary: `\u89C4\u5212\u5931\u8D25: ${error}`,\n            });\n\n            throw error;\n        }\n    }\n\n    /**\n     * \u751F\u6210\u8BA1\u5212\uFF08\u7B80\u5316\u7248\u89C4\u5219\u5F15\u64CE\uFF09\n     * \u5B9E\u9645\u9879\u76EE\u4E2D\u5E94\u8C03\u7528 LLM API\n     */\n    private async generatePlan(goal: string): Promise<string> {\n        // \u6A21\u62DF\u5F02\u6B65\u5904\u7406\n        await new Promise(resolve => setTimeout(resolve, 100));\n\n        // \u7B80\u5355\u89C4\u5219\uFF1A\u6839\u636E\u5173\u952E\u8BCD\u751F\u6210\u8BA1\u5212\n        if (goal.includes('SQL') || goal.includes('sql')) {\n            return `1. \u5206\u6790\u5F53\u524D SQL \u8BED\u53E5\\n2. \u8BC6\u522B\u4F18\u5316\u70B9\\n3. \u751F\u6210\u4F18\u5316\u540E\u7684 SQL\\n4. \u9A8C\u8BC1\u7ED3\u679C\u4E00\u81F4\u6027`;\n        }\n\n        if (goal.includes('\u6587\u6863') || goal.includes('\u641C\u7D22')) {\n            return `1. \u89E3\u6790\u641C\u7D22\u5173\u952E\u8BCD\\n2. \u68C0\u7D22\u76F8\u5173\u6587\u6863\\n3. \u63D0\u53D6\u5173\u952E\u4FE1\u606F\\n4. \u6C47\u603B\u7ED3\u679C`;\n        }\n\n        // \u9ED8\u8BA4\u901A\u7528\u8BA1\u5212\n        return `1. \u7406\u89E3\u7528\u6237\u9700\u6C42\\n2. \u6536\u96C6\u5FC5\u8981\u4FE1\u606F\\n3. \u6267\u884C\u76F8\u5173\u64CD\u4F5C\\n4. \u9A8C\u8BC1\u7ED3\u679C\\n5. \u751F\u6210\u7B54\u590D`;\n    }\n\n    /**\n     * \u89E3\u6790\u6B65\u9AA4\n     */\n    private parseSteps(plan: string): TaskStep[] {\n        const lines = plan.split('\\n').filter(line => line.trim());\n\n        return lines.map((line, index) => ({\n            id: `step-${index + 1}`,\n            description: line.replace(/^\\d+\\.\\s*/, ''), // \u79FB\u9664\u5E8F\u53F7\n            status: 'pending' as const,\n        }));\n    }\n}\n", "/**\n * \u793A\u4F8B\u5DE5\u5177\u5B9E\u73B0\n * \u63D0\u4F9B SQL \u67E5\u8BE2\u548C\u6587\u6863\u641C\u7D22\u7684\u6A21\u62DF\u5DE5\u5177\n */\n\nimport { z } from 'zod';\nimport type { Tool } from '../core/types';\n\n/**\n * SQL \u67E5\u8BE2\u5DE5\u5177\uFF08\u6A21\u62DF\uFF09\n * \u9ED8\u8BA4 SELECT-only\uFF0C\u62D2\u7EDD INSERT/UPDATE/DELETE\n */\nexport const sqlQueryTool: Tool = {\n    name: 'sql-query',\n    description: 'Execute SQL SELECT queries on the database. Use this tool when the user wants to query data, list records, or get information from the database. Examples: \"show all users\", \"list products\", \"get customer data\".',\n\n    inputSchema: z.object({\n        query: z.string().min(1, 'Query cannot be empty').describe('The SQL SELECT query to execute'),\n        database: z.string().optional().describe('Optional database name'),\n    }),\n\n    outputSchema: z.object({\n        rows: z.array(z.record(z.unknown())),\n        rowCount: z.number(),\n        executionTime: z.number(),\n    }),\n\n    timeout: 5000,\n\n    retryPolicy: {\n        maxRetries: 3,\n        backoffMs: 1000,\n        backoffMultiplier: 2,\n    },\n\n    permissions: ['sql:read'],\n    requiresConfirmation: true,\n    confirmationMessage: 'Execute database query?',\n\n    allowedNodes: ['tool-runner'],\n\n    async execute(input: unknown) {\n        const { query } = input as { query: string };\n\n        // \u5B89\u5168\u68C0\u67E5\uFF1A\u4EC5\u5141\u8BB8 SELECT\n        const normalizedQuery = query.trim().toUpperCase();\n        if (!normalizedQuery.startsWith('SELECT')) {\n            throw new Error('Only SELECT queries are allowed');\n        }\n\n        console.log('[SQL-Query] Executing:', query);\n\n        // \u6A21\u62DF\u67E5\u8BE2\u5EF6\u8FDF\n        await new Promise(resolve => setTimeout(resolve, 100));\n\n        // \u8FD4\u56DE\u6A21\u62DF\u6570\u636E\n        return {\n            rows: [\n                { id: 1, name: 'Alice', email: 'alice@example.com' },\n                { id: 2, name: 'Bob', email: 'bob@example.com' },\n                { id: 3, name: 'Charlie', email: 'charlie@example.com' },\n            ],\n            rowCount: 3,\n            executionTime: 100,\n        };\n    },\n};\n\n/**\n * \u6587\u6863\u641C\u7D22\u5DE5\u5177\uFF08\u6A21\u62DF\uFF09\n */\nexport const documentSearchTool: Tool = {\n    name: 'document-search',\n    description: 'Search for documents and articles in the knowledge base. Use this tool when the user wants to find documentation, tutorials, guides, or articles. Examples: \"find SQL optimization docs\", \"search for performance guide\", \"look up tutorial\".',\n\n    inputSchema: z.object({\n        keywords: z.array(z.string()).min(1, 'At least one keyword required').describe('Keywords to search for'),\n        limit: z.number().min(1).max(50).optional().default(10).describe('Maximum number of results'),\n    }),\n\n    outputSchema: z.object({\n        documents: z.array(z.object({\n            id: z.string(),\n            title: z.string(),\n            snippet: z.string(),\n            relevance: z.number(),\n        })),\n        totalCount: z.number(),\n    }),\n\n    timeout: 3000,\n\n    retryPolicy: {\n        maxRetries: 2,\n        backoffMs: 500,\n        backoffMultiplier: 2,\n    },\n\n    permissions: ['document:read'],\n\n    async execute(input: unknown) {\n        const { keywords, limit = 10 } = input as { keywords: string[]; limit?: number };\n\n        // \u6A21\u62DF\u641C\u7D22\u5EF6\u8FDF\n        await new Promise(resolve => setTimeout(resolve, 200));\n\n        // \u8FD4\u56DE\u6A21\u62DF\u6587\u6863\n        const mockDocs = [\n            {\n                id: 'doc-1',\n                title: 'SQL \u4F18\u5316\u6700\u4F73\u5B9E\u8DF5',\n                snippet: '\u672C\u6587\u4ECB\u7ECD\u4E86\u5E38\u89C1\u7684 SQL \u4F18\u5316\u6280\u5DE7\uFF0C\u5305\u62EC\u7D22\u5F15\u4F7F\u7528\u3001\u67E5\u8BE2\u91CD\u5199\u7B49...',\n                relevance: 0.95,\n            },\n            {\n                id: 'doc-2',\n                title: '\u6570\u636E\u5E93\u6027\u80FD\u8C03\u4F18\u6307\u5357',\n                snippet: '\u6DF1\u5165\u63A2\u8BA8\u6570\u636E\u5E93\u6027\u80FD\u8C03\u4F18\u7684\u5404\u4E2A\u65B9\u9762\uFF0C\u4ECE\u786C\u4EF6\u5230\u67E5\u8BE2\u4F18\u5316...',\n                relevance: 0.87,\n            },\n            {\n                id: 'doc-3',\n                title: 'PostgreSQL \u67E5\u8BE2\u4F18\u5316\u5668\u539F\u7406',\n                snippet: '\u8BE6\u7EC6\u89E3\u6790 PostgreSQL \u67E5\u8BE2\u4F18\u5316\u5668\u7684\u5DE5\u4F5C\u539F\u7406\u548C\u4F18\u5316\u7B56\u7565...',\n                relevance: 0.76,\n            },\n        ];\n\n        return {\n            documents: mockDocs.slice(0, limit),\n            totalCount: mockDocs.length,\n        };\n    },\n};\n\n/**\n * \u83B7\u53D6\u6240\u6709\u793A\u4F8B\u5DE5\u5177\n */\nexport function getExampleTools(): Tool[] {\n    return [sqlQueryTool, documentSearchTool];\n}\n", "/**\n * LLM \u54CD\u5E94\u7F13\u5B58\n * \u7B80\u5355\u7684\u5185\u5B58\u7F13\u5B58\u5B9E\u73B0\uFF0C\u652F\u6301 TTL \u548C LRU \u6DD8\u6C70\u7B56\u7565\n */\n\nimport type { ChatRequest, ChatResponse } from '../llm-provider';\nimport type { CacheConfig } from './types';\n\ninterface CacheEntry {\n    response: ChatResponse;\n    timestamp: number;\n    hits: number;\n}\n\n/**\n * LLM \u7F13\u5B58\u7BA1\u7406\u5668\n */\nexport class LLMCache {\n    private cache: Map<string, CacheEntry> = new Map();\n    private config: CacheConfig;\n    private accessOrder: string[] = [];\n\n    constructor(config: CacheConfig) {\n        this.config = config;\n    }\n\n    /**\n     * \u751F\u6210\u7F13\u5B58\u952E\n     */\n    generateKey(request: ChatRequest): string {\n        if (this.config.keyGenerator) {\n            return this.config.keyGenerator(request);\n        }\n\n        // \u9ED8\u8BA4\uFF1A\u57FA\u4E8E\u6D88\u606F\u5185\u5BB9\u548C\u6E29\u5EA6\u751F\u6210 key\n        const keyData = {\n            messages: request.messages.map(m => ({\n                role: m.role,\n                content: m.content,\n            })),\n            temperature: request.temperature ?? 0.7,\n        };\n\n        return this.hashString(JSON.stringify(keyData));\n    }\n\n    /**\n     * \u7B80\u5355\u7684\u5B57\u7B26\u4E32\u54C8\u5E0C\n     */\n    private hashString(str: string): string {\n        let hash = 0;\n        for (let i = 0; i < str.length; i++) {\n            const char = str.charCodeAt(i);\n            hash = ((hash << 5) - hash) + char;\n            hash = hash & hash;\n        }\n        return hash.toString(36);\n    }\n\n    /**\n     * \u83B7\u53D6\u7F13\u5B58\n     */\n    get(key: string): ChatResponse | null {\n        if (!this.config.enabled) return null;\n\n        const entry = this.cache.get(key);\n        if (!entry) return null;\n\n        // \u68C0\u67E5 TTL\n        if (Date.now() - entry.timestamp > this.config.ttl) {\n            this.cache.delete(key);\n            this.removeFromAccessOrder(key);\n            return null;\n        }\n\n        // \u66F4\u65B0\u8BBF\u95EE\u987A\u5E8F\uFF08LRU\uFF09\n        entry.hits++;\n        this.updateAccessOrder(key);\n\n        return entry.response;\n    }\n\n    /**\n     * \u8BBE\u7F6E\u7F13\u5B58\n     */\n    set(key: string, response: ChatResponse): void {\n        if (!this.config.enabled) return;\n\n        // \u68C0\u67E5\u5BB9\u91CF\uFF0C\u9700\u8981\u65F6\u6DD8\u6C70\u65E7\u6761\u76EE\n        while (this.cache.size >= this.config.maxEntries) {\n            this.evictOldest();\n        }\n\n        this.cache.set(key, {\n            response,\n            timestamp: Date.now(),\n            hits: 0,\n        });\n\n        this.accessOrder.push(key);\n    }\n\n    /**\n     * \u66F4\u65B0\u8BBF\u95EE\u987A\u5E8F\n     */\n    private updateAccessOrder(key: string): void {\n        this.removeFromAccessOrder(key);\n        this.accessOrder.push(key);\n    }\n\n    /**\n     * \u4ECE\u8BBF\u95EE\u987A\u5E8F\u4E2D\u79FB\u9664\n     */\n    private removeFromAccessOrder(key: string): void {\n        const index = this.accessOrder.indexOf(key);\n        if (index > -1) {\n            this.accessOrder.splice(index, 1);\n        }\n    }\n\n    /**\n     * \u6DD8\u6C70\u6700\u65E7\u7684\u6761\u76EE\uFF08LRU\uFF09\n     */\n    private evictOldest(): void {\n        if (this.accessOrder.length === 0) return;\n\n        const oldestKey = this.accessOrder.shift()!;\n        this.cache.delete(oldestKey);\n    }\n\n    /**\n     * \u6E05\u7A7A\u7F13\u5B58\n     */\n    clear(): void {\n        this.cache.clear();\n        this.accessOrder = [];\n    }\n\n    /**\n     * \u83B7\u53D6\u7F13\u5B58\u7EDF\u8BA1\n     */\n    getStats(): { size: number; maxSize: number; hitRate: number } {\n        let totalHits = 0;\n        let totalAccess = 0;\n\n        this.cache.forEach(entry => {\n            totalHits += entry.hits;\n            totalAccess += entry.hits + 1; // +1 for initial set\n        });\n\n        return {\n            size: this.cache.size,\n            maxSize: this.config.maxEntries,\n            hitRate: totalAccess > 0 ? totalHits / totalAccess : 0,\n        };\n    }\n\n    /**\n     * \u4F7F\u6307\u5B9A\u952E\u7684\u7F13\u5B58\u5931\u6548\n     */\n    invalidate(key: string): boolean {\n        const existed = this.cache.has(key);\n        this.cache.delete(key);\n        this.removeFromAccessOrder(key);\n        return existed;\n    }\n\n    /**\n     * \u6E05\u7406\u8FC7\u671F\u6761\u76EE\n     */\n    cleanup(): number {\n        const now = Date.now();\n        let removed = 0;\n\n        for (const [key, entry] of this.cache.entries()) {\n            if (now - entry.timestamp > this.config.ttl) {\n                this.cache.delete(key);\n                this.removeFromAccessOrder(key);\n                removed++;\n            }\n        }\n\n        return removed;\n    }\n}\n", "/**\n * LLM \u7EDF\u8BA1\u6536\u96C6\u5668\n * \u6536\u96C6\u548C\u805A\u5408 LLM \u8C03\u7528\u7684\u7EDF\u8BA1\u6570\u636E\n */\n\nimport type { TokenUsage } from '../llm-provider';\nimport type {\n    LLMCallStats,\n    LLMAggregateStats,\n    ProviderStats,\n    ModelStats,\n} from './types';\n\n/**\n * LLM \u7EDF\u8BA1\u6536\u96C6\u5668\n */\nexport class LLMStatsCollector {\n    private history: LLMCallStats[] = [];\n    private maxHistory: number;\n    private enabled: boolean;\n\n    constructor(options: { maxHistory?: number; enabled?: boolean } = {}) {\n        this.maxHistory = options.maxHistory ?? 1000;\n        this.enabled = options.enabled ?? true;\n    }\n\n    /**\n     * \u8BB0\u5F55\u4E00\u6B21\u8C03\u7528\n     */\n    record(stats: LLMCallStats): void {\n        if (!this.enabled) return;\n\n        this.history.push(stats);\n\n        // \u4FDD\u6301\u5386\u53F2\u8BB0\u5F55\u5728\u9650\u5236\u5185\n        if (this.history.length > this.maxHistory) {\n            this.history.shift();\n        }\n    }\n\n    /**\n     * \u83B7\u53D6\u805A\u5408\u7EDF\u8BA1\n     */\n    getAggregateStats(): LLMAggregateStats {\n        const stats: LLMAggregateStats = {\n            totalRequests: 0,\n            successfulRequests: 0,\n            failedRequests: 0,\n            cacheHits: 0,\n            totalTokens: 0,\n            totalPromptTokens: 0,\n            totalCompletionTokens: 0,\n            totalDuration: 0,\n            averageDuration: 0,\n            byProvider: {},\n            byModel: {},\n        };\n\n        for (const call of this.history) {\n            stats.totalRequests++;\n            stats.totalDuration += call.duration;\n\n            if (call.success) {\n                stats.successfulRequests++;\n            } else {\n                stats.failedRequests++;\n            }\n\n            if (call.cached) {\n                stats.cacheHits++;\n            }\n\n            if (call.usage) {\n                stats.totalTokens += call.usage.totalTokens;\n                stats.totalPromptTokens += call.usage.promptTokens;\n                stats.totalCompletionTokens += call.usage.completionTokens;\n            }\n\n            // \u6309 Provider \u805A\u5408\n            if (!stats.byProvider[call.providerName]) {\n                stats.byProvider[call.providerName] = {\n                    requests: 0,\n                    successes: 0,\n                    failures: 0,\n                    totalTokens: 0,\n                    totalDuration: 0,\n                };\n            }\n            const providerStats = stats.byProvider[call.providerName];\n            providerStats.requests++;\n            providerStats.totalDuration += call.duration;\n            if (call.success) providerStats.successes++;\n            else providerStats.failures++;\n            if (call.usage) providerStats.totalTokens += call.usage.totalTokens;\n\n            // \u6309\u6A21\u578B\u805A\u5408\n            if (!stats.byModel[call.model]) {\n                stats.byModel[call.model] = {\n                    requests: 0,\n                    successes: 0,\n                    failures: 0,\n                    totalTokens: 0,\n                    averageTokensPerRequest: 0,\n                };\n            }\n            const modelStats = stats.byModel[call.model];\n            modelStats.requests++;\n            if (call.success) modelStats.successes++;\n            else modelStats.failures++;\n            if (call.usage) modelStats.totalTokens += call.usage.totalTokens;\n        }\n\n        // \u8BA1\u7B97\u5E73\u5747\u503C\n        if (stats.totalRequests > 0) {\n            stats.averageDuration = stats.totalDuration / stats.totalRequests;\n        }\n\n        // \u8BA1\u7B97\u6BCF\u4E2A\u6A21\u578B\u7684\u5E73\u5747 tokens\n        for (const model in stats.byModel) {\n            const modelStats = stats.byModel[model];\n            if (modelStats.requests > 0) {\n                modelStats.averageTokensPerRequest = modelStats.totalTokens / modelStats.requests;\n            }\n        }\n\n        return stats;\n    }\n\n    /**\n     * \u83B7\u53D6\u6700\u8FD1 N \u6B21\u8C03\u7528\u7684\u7EDF\u8BA1\n     */\n    getRecentStats(count: number = 10): LLMCallStats[] {\n        return this.history.slice(-count);\n    }\n\n    /**\n     * \u83B7\u53D6\u6307\u5B9A\u65F6\u95F4\u8303\u56F4\u5185\u7684\u7EDF\u8BA1\n     */\n    getStatsInTimeRange(startTime: number, endTime: number): LLMCallStats[] {\n        return this.history.filter(\n            call => call.startTime >= startTime && call.endTime <= endTime\n        );\n    }\n\n    /**\n     * \u83B7\u53D6\u5931\u8D25\u7684\u8C03\u7528\n     */\n    getFailedCalls(): LLMCallStats[] {\n        return this.history.filter(call => !call.success);\n    }\n\n    /**\n     * \u83B7\u53D6\u6210\u529F\u7387\n     */\n    getSuccessRate(): number {\n        if (this.history.length === 0) return 1;\n        const successful = this.history.filter(call => call.success).length;\n        return successful / this.history.length;\n    }\n\n    /**\n     * \u83B7\u53D6\u5E73\u5747\u54CD\u5E94\u65F6\u95F4\n     */\n    getAverageResponseTime(): number {\n        if (this.history.length === 0) return 0;\n        const totalDuration = this.history.reduce((sum, call) => sum + call.duration, 0);\n        return totalDuration / this.history.length;\n    }\n\n    /**\n     * \u83B7\u53D6 token \u4F7F\u7528\u6458\u8981\n     */\n    getTokenUsageSummary(): TokenUsage & { count: number } {\n        const summary = {\n            promptTokens: 0,\n            completionTokens: 0,\n            totalTokens: 0,\n            count: 0,\n        };\n\n        for (const call of this.history) {\n            if (call.usage) {\n                summary.promptTokens += call.usage.promptTokens;\n                summary.completionTokens += call.usage.completionTokens;\n                summary.totalTokens += call.usage.totalTokens;\n                summary.count++;\n            }\n        }\n\n        return summary;\n    }\n\n    /**\n     * \u6E05\u7A7A\u7EDF\u8BA1\u5386\u53F2\n     */\n    clear(): void {\n        this.history = [];\n    }\n\n    /**\n     * \u5BFC\u51FA\u7EDF\u8BA1\u6570\u636E\n     */\n    export(): {\n        history: LLMCallStats[];\n        aggregate: LLMAggregateStats;\n        exportedAt: number;\n    } {\n        return {\n            history: [...this.history],\n            aggregate: this.getAggregateStats(),\n            exportedAt: Date.now(),\n        };\n    }\n\n    /**\n     * \u542F\u7528/\u7981\u7528\u7EDF\u8BA1\u6536\u96C6\n     */\n    setEnabled(enabled: boolean): void {\n        this.enabled = enabled;\n    }\n\n    /**\n     * \u68C0\u67E5\u662F\u5426\u542F\u7528\n     */\n    isEnabled(): boolean {\n        return this.enabled;\n    }\n}\n", "/**\n * LLM Service \u7C7B\u578B\u5B9A\u4E49\n * \u7EDF\u4E00 LLM \u8C03\u7528\u7684\u8BF7\u6C42/\u54CD\u5E94\u7C7B\u578B\u4E0E\u4E2D\u95F4\u4EF6\u63A5\u53E3\n */\n\nimport type { ChatMessage, ChatRequest, ChatResponse, ChatStreamChunk, TokenUsage } from '../llm-provider';\n\n// ============================================================================\n// \u8BF7\u6C42/\u54CD\u5E94\u7C7B\u578B\u6269\u5C55\n// ============================================================================\n\n/**\n * \u6269\u5C55\u7684\u8BF7\u6C42\u9009\u9879\n */\nexport interface LLMRequestOptions {\n    /** \u4E2D\u65AD\u4FE1\u53F7 */\n    signal?: AbortSignal;\n    /** \u662F\u5426\u8DF3\u8FC7\u7F13\u5B58 */\n    skipCache?: boolean;\n    /** \u8BF7\u6C42\u4F18\u5148\u7EA7 */\n    priority?: 'low' | 'normal' | 'high';\n    /** \u81EA\u5B9A\u4E49\u5143\u6570\u636E */\n    metadata?: Record<string, unknown>;\n    /** \u8D85\u65F6\u65F6\u95F4\uFF08\u8986\u76D6\u9ED8\u8BA4\u503C\uFF09 */\n    timeout?: number;\n    /** \u6700\u5927\u91CD\u8BD5\u6B21\u6570\uFF08\u8986\u76D6\u9ED8\u8BA4\u503C\uFF09 */\n    maxRetries?: number;\n}\n\n/**\n * \u6269\u5C55\u7684\u8BF7\u6C42\u4E0A\u4E0B\u6587\n */\nexport interface LLMRequestContext {\n    /** \u552F\u4E00\u8BF7\u6C42 ID */\n    requestId: string;\n    /** \u8BF7\u6C42\u5F00\u59CB\u65F6\u95F4 */\n    startTime: number;\n    /** Provider \u540D\u79F0 */\n    providerName: string;\n    /** \u6A21\u578B\u540D\u79F0 */\n    model: string;\n    /** \u91CD\u8BD5\u6B21\u6570 */\n    retryCount: number;\n    /** \u539F\u59CB\u8BF7\u6C42 */\n    request: ChatRequest;\n    /** \u8BF7\u6C42\u9009\u9879 */\n    options: LLMRequestOptions;\n}\n\n/**\n * \u6269\u5C55\u7684\u54CD\u5E94\u7ED3\u679C\n */\nexport interface LLMResult extends ChatResponse {\n    /** \u8BF7\u6C42 ID */\n    requestId: string;\n    /** \u8017\u65F6\uFF08\u6BEB\u79D2\uFF09 */\n    duration: number;\n    /** \u662F\u5426\u6765\u81EA\u7F13\u5B58 */\n    cached: boolean;\n    /** \u91CD\u8BD5\u6B21\u6570 */\n    retryCount: number;\n}\n\n/**\n * \u6D41\u5F0F\u54CD\u5E94\u7ED3\u679C\n */\nexport interface LLMStreamResult {\n    /** \u8BF7\u6C42 ID */\n    requestId: string;\n    /** \u6D41\u5F0F\u751F\u6210\u5668 */\n    stream: AsyncGenerator<ChatStreamChunk>;\n    /** \u4E2D\u65AD\u65B9\u6CD5 */\n    abort: () => void;\n}\n\n// ============================================================================\n// \u4E2D\u95F4\u4EF6\u63A5\u53E3\n// ============================================================================\n\n/**\n * \u8BF7\u6C42\u4E2D\u95F4\u4EF6 - \u5728\u8BF7\u6C42\u53D1\u9001\u524D\u6267\u884C\n */\nexport interface LLMRequestMiddleware {\n    name: string;\n    /** \u5904\u7406\u8BF7\u6C42\uFF0C\u8FD4\u56DE\u4FEE\u6539\u540E\u7684\u8BF7\u6C42\u6216\u629B\u51FA\u9519\u8BEF\u4EE5\u4E2D\u6B62 */\n    process(\n        request: ChatRequest,\n        context: LLMRequestContext\n    ): Promise<ChatRequest> | ChatRequest;\n}\n\n/**\n * \u54CD\u5E94\u4E2D\u95F4\u4EF6 - \u5728\u54CD\u5E94\u8FD4\u56DE\u540E\u6267\u884C\n */\nexport interface LLMResponseMiddleware {\n    name: string;\n    /** \u5904\u7406\u54CD\u5E94\uFF0C\u8FD4\u56DE\u4FEE\u6539\u540E\u7684\u54CD\u5E94 */\n    process(\n        response: ChatResponse,\n        context: LLMRequestContext\n    ): Promise<ChatResponse> | ChatResponse;\n}\n\n/**\n * \u9519\u8BEF\u4E2D\u95F4\u4EF6 - \u5728\u53D1\u751F\u9519\u8BEF\u65F6\u6267\u884C\n */\nexport interface LLMErrorMiddleware {\n    name: string;\n    /** \u5904\u7406\u9519\u8BEF\uFF0C\u53EF\u4EE5\u6062\u590D\u3001\u4FEE\u6539\u6216\u91CD\u65B0\u629B\u51FA */\n    process(\n        error: Error,\n        context: LLMRequestContext\n    ): Promise<ChatResponse | null> | ChatResponse | null;\n}\n\n// ============================================================================\n// \u7EDF\u8BA1\u7C7B\u578B\n// ============================================================================\n\n/**\n * \u5355\u6B21\u8C03\u7528\u7EDF\u8BA1\n */\nexport interface LLMCallStats {\n    requestId: string;\n    providerName: string;\n    model: string;\n    startTime: number;\n    endTime: number;\n    duration: number;\n    usage?: TokenUsage;\n    success: boolean;\n    cached: boolean;\n    retryCount: number;\n    error?: string;\n}\n\n/**\n * \u805A\u5408\u7EDF\u8BA1\n */\nexport interface LLMAggregateStats {\n    /** \u603B\u8BF7\u6C42\u6570 */\n    totalRequests: number;\n    /** \u6210\u529F\u8BF7\u6C42\u6570 */\n    successfulRequests: number;\n    /** \u5931\u8D25\u8BF7\u6C42\u6570 */\n    failedRequests: number;\n    /** \u7F13\u5B58\u547D\u4E2D\u6570 */\n    cacheHits: number;\n    /** \u603B token \u6570 */\n    totalTokens: number;\n    /** \u603B prompt token \u6570 */\n    totalPromptTokens: number;\n    /** \u603B completion token \u6570 */\n    totalCompletionTokens: number;\n    /** \u603B\u8017\u65F6 */\n    totalDuration: number;\n    /** \u5E73\u5747\u54CD\u5E94\u65F6\u95F4 */\n    averageDuration: number;\n    /** \u6309 provider \u7684\u7EDF\u8BA1 */\n    byProvider: Record<string, ProviderStats>;\n    /** \u6309\u6A21\u578B\u7684\u7EDF\u8BA1 */\n    byModel: Record<string, ModelStats>;\n}\n\n/**\n * Provider \u7EDF\u8BA1\n */\nexport interface ProviderStats {\n    requests: number;\n    successes: number;\n    failures: number;\n    totalTokens: number;\n    totalDuration: number;\n}\n\n/**\n * \u6A21\u578B\u7EDF\u8BA1\n */\nexport interface ModelStats {\n    requests: number;\n    successes: number;\n    failures: number;\n    totalTokens: number;\n    averageTokensPerRequest: number;\n}\n\n// ============================================================================\n// \u670D\u52A1\u914D\u7F6E\n// ============================================================================\n\n/**\n * \u91CD\u8BD5\u7B56\u7565\u914D\u7F6E\n */\nexport interface RetryConfig {\n    /** \u6700\u5927\u91CD\u8BD5\u6B21\u6570 */\n    maxRetries: number;\n    /** \u521D\u59CB\u9000\u907F\u65F6\u95F4\uFF08\u6BEB\u79D2\uFF09 */\n    initialBackoff: number;\n    /** \u6700\u5927\u9000\u907F\u65F6\u95F4\uFF08\u6BEB\u79D2\uFF09 */\n    maxBackoff: number;\n    /** \u9000\u907F\u500D\u6570 */\n    backoffMultiplier: number;\n    /** \u53EF\u91CD\u8BD5\u7684\u9519\u8BEF\u7C7B\u578B */\n    retryableErrors: string[];\n}\n\n/**\n * \u7F13\u5B58\u914D\u7F6E\n */\nexport interface CacheConfig {\n    /** \u662F\u5426\u542F\u7528\u7F13\u5B58 */\n    enabled: boolean;\n    /** \u7F13\u5B58 TTL\uFF08\u6BEB\u79D2\uFF09 */\n    ttl: number;\n    /** \u6700\u5927\u7F13\u5B58\u6761\u76EE\u6570 */\n    maxEntries: number;\n    /** \u7F13\u5B58\u952E\u751F\u6210\u51FD\u6570 */\n    keyGenerator?: (request: ChatRequest) => string;\n}\n\n/**\n * \u901F\u7387\u9650\u5236\u914D\u7F6E\n */\nexport interface RateLimitConfig {\n    /** \u662F\u5426\u542F\u7528 */\n    enabled: boolean;\n    /** \u65F6\u95F4\u7A97\u53E3\uFF08\u6BEB\u79D2\uFF09 */\n    windowMs: number;\n    /** \u7A97\u53E3\u5185\u6700\u5927\u8BF7\u6C42\u6570 */\n    maxRequests: number;\n}\n\n/**\n * LLM Service \u5B8C\u6574\u914D\u7F6E\n */\nexport interface LLMServiceConfig {\n    /** \u9ED8\u8BA4\u8D85\u65F6\u65F6\u95F4\uFF08\u6BEB\u79D2\uFF09 */\n    defaultTimeout: number;\n    /** \u91CD\u8BD5\u914D\u7F6E */\n    retry: RetryConfig;\n    /** \u7F13\u5B58\u914D\u7F6E */\n    cache: CacheConfig;\n    /** \u901F\u7387\u9650\u5236\u914D\u7F6E */\n    rateLimit: RateLimitConfig;\n    /** \u662F\u5426\u542F\u7528\u7EDF\u8BA1\u6536\u96C6 */\n    enableStats: boolean;\n    /** \u7EDF\u8BA1\u4FDD\u7559\u7684\u6700\u5927\u5386\u53F2\u6761\u76EE\u6570 */\n    maxStatsHistory: number;\n}\n\n/**\n * \u9ED8\u8BA4\u670D\u52A1\u914D\u7F6E\n */\nexport const DEFAULT_LLM_SERVICE_CONFIG: LLMServiceConfig = {\n    defaultTimeout: 60000,\n    retry: {\n        maxRetries: 3,\n        initialBackoff: 1000,\n        maxBackoff: 30000,\n        backoffMultiplier: 2,\n        retryableErrors: ['ECONNREFUSED', 'ETIMEDOUT', 'ECONNRESET', 'fetch failed', 'network error'],\n    },\n    cache: {\n        enabled: false,\n        ttl: 5 * 60 * 1000, // 5 \u5206\u949F\n        maxEntries: 100,\n    },\n    rateLimit: {\n        enabled: false,\n        windowMs: 60000, // 1 \u5206\u949F\n        maxRequests: 60,\n    },\n    enableStats: true,\n    maxStatsHistory: 1000,\n};\n", "/**\n * LLM Service \u6838\u5FC3\u5B9E\u73B0\n * \u63D0\u4F9B\u7EDF\u4E00\u7684 LLM \u8C03\u7528\u63A5\u53E3\uFF0C\u652F\u6301\u4E2D\u95F4\u4EF6\u3001\u7F13\u5B58\u3001\u91CD\u8BD5\u3001\u7EDF\u8BA1\u7B49\u529F\u80FD\n */\n\nimport { LLMProvider, type ChatRequest, type ChatResponse, type ChatStreamChunk } from '../llm-provider';\nimport { LLMCache } from './cache';\nimport { LLMStatsCollector } from './stats';\nimport type {\n    LLMRequestOptions,\n    LLMRequestContext,\n    LLMResult,\n    LLMStreamResult,\n    LLMRequestMiddleware,\n    LLMResponseMiddleware,\n    LLMErrorMiddleware,\n    LLMServiceConfig,\n    LLMAggregateStats,\n    LLMCallStats,\n} from './types';\nimport { DEFAULT_LLM_SERVICE_CONFIG } from './types';\n\n// ============================================================================\n// \u8F85\u52A9\u51FD\u6570\n// ============================================================================\n\n/**\n * \u751F\u6210\u552F\u4E00\u8BF7\u6C42 ID\n */\nfunction generateRequestId(): string {\n    return `req_${Date.now().toString(36)}_${Math.random().toString(36).slice(2, 8)}`;\n}\n\n/**\n * \u7761\u7720\u51FD\u6570\n */\nfunction sleep(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n/**\n * \u68C0\u67E5\u9519\u8BEF\u662F\u5426\u53EF\u91CD\u8BD5\n */\nfunction isRetryableError(error: Error, retryableErrors: string[]): boolean {\n    const errorMessage = error.message.toLowerCase();\n    return retryableErrors.some(re => errorMessage.includes(re.toLowerCase()));\n}\n\n// ============================================================================\n// LLM Service \u7C7B\n// ============================================================================\n\n/**\n * LLM Service\n * \u9AD8\u7EA7 LLM \u8C03\u7528\u670D\u52A1\uFF0C\u5C01\u88C5 Provider \u5E76\u63D0\u4F9B\u9644\u52A0\u529F\u80FD\n */\nexport class LLMService {\n    private provider: LLMProvider;\n    private config: LLMServiceConfig;\n    private cache: LLMCache;\n    private stats: LLMStatsCollector;\n    private requestMiddlewares: LLMRequestMiddleware[] = [];\n    private responseMiddlewares: LLMResponseMiddleware[] = [];\n    private errorMiddlewares: LLMErrorMiddleware[] = [];\n    private rateLimitState: { count: number; windowStart: number } = {\n        count: 0,\n        windowStart: Date.now(),\n    };\n\n    constructor(\n        provider: LLMProvider,\n        config: Partial<LLMServiceConfig> = {}\n    ) {\n        this.provider = provider;\n        this.config = { ...DEFAULT_LLM_SERVICE_CONFIG, ...config };\n        this.cache = new LLMCache(this.config.cache);\n        this.stats = new LLMStatsCollector({\n            maxHistory: this.config.maxStatsHistory,\n            enabled: this.config.enableStats,\n        });\n    }\n\n    // ========================================================================\n    // \u4E3B\u8981 API\n    // ========================================================================\n\n    /**\n     * \u53D1\u9001\u804A\u5929\u8BF7\u6C42\uFF08\u975E\u6D41\u5F0F\uFF09\n     */\n    async chat(\n        request: ChatRequest,\n        options: LLMRequestOptions = {}\n    ): Promise<LLMResult> {\n        const requestId = generateRequestId();\n        const startTime = Date.now();\n\n        const context: LLMRequestContext = {\n            requestId,\n            startTime,\n            providerName: this.provider.getProviderName(),\n            model: this.provider.getModel(),\n            retryCount: 0,\n            request,\n            options,\n        };\n\n        try {\n            // \u901F\u7387\u9650\u5236\u68C0\u67E5\n            await this.checkRateLimit();\n\n            // \u68C0\u67E5\u7F13\u5B58\n            if (!options.skipCache) {\n                const cacheKey = this.cache.generateKey(request);\n                const cached = this.cache.get(cacheKey);\n                if (cached) {\n                    const result = this.createResult(cached, context, true);\n                    this.recordStats(context, result, true);\n                    return result;\n                }\n            }\n\n            // \u6267\u884C\u8BF7\u6C42\u4E2D\u95F4\u4EF6\n            let processedRequest = request;\n            for (const middleware of this.requestMiddlewares) {\n                processedRequest = await middleware.process(processedRequest, context);\n            }\n\n            // \u6267\u884C\u8BF7\u6C42\uFF08\u5E26\u91CD\u8BD5\uFF09\n            const response = await this.executeWithRetry(processedRequest, context, options);\n\n            // \u6267\u884C\u54CD\u5E94\u4E2D\u95F4\u4EF6\n            let processedResponse = response;\n            for (const middleware of this.responseMiddlewares) {\n                processedResponse = await middleware.process(processedResponse, context);\n            }\n\n            // \u7F13\u5B58\u54CD\u5E94\n            if (!options.skipCache) {\n                const cacheKey = this.cache.generateKey(request);\n                this.cache.set(cacheKey, processedResponse);\n            }\n\n            const result = this.createResult(processedResponse, context, false);\n            this.recordStats(context, result, true);\n            return result;\n\n        } catch (error) {\n            // \u6267\u884C\u9519\u8BEF\u4E2D\u95F4\u4EF6\n            for (const middleware of this.errorMiddlewares) {\n                const recovered = await middleware.process(error as Error, context);\n                if (recovered) {\n                    const result = this.createResult(recovered, context, false);\n                    this.recordStats(context, result, true);\n                    return result;\n                }\n            }\n\n            // \u8BB0\u5F55\u5931\u8D25\u7EDF\u8BA1\n            this.recordStats(context, null, false, (error as Error).message);\n            throw error;\n        }\n    }\n\n    /**\n     * \u53D1\u9001\u804A\u5929\u8BF7\u6C42\uFF08\u6D41\u5F0F\uFF09\n     */\n    async chatStream(\n        request: ChatRequest,\n        options: LLMRequestOptions = {}\n    ): Promise<LLMStreamResult> {\n        const requestId = generateRequestId();\n        const startTime = Date.now();\n        let aborted = false;\n\n        const context: LLMRequestContext = {\n            requestId,\n            startTime,\n            providerName: this.provider.getProviderName(),\n            model: this.provider.getModel(),\n            retryCount: 0,\n            request,\n            options,\n        };\n\n        // \u901F\u7387\u9650\u5236\u68C0\u67E5\n        await this.checkRateLimit();\n\n        // \u6267\u884C\u8BF7\u6C42\u4E2D\u95F4\u4EF6\n        let processedRequest = request;\n        for (const middleware of this.requestMiddlewares) {\n            processedRequest = await middleware.process(processedRequest, context);\n        }\n\n        // \u521B\u5EFA\u6D41\u5F0F\u751F\u6210\u5668\u5305\u88C5\n        const self = this;\n        async function* wrappedStream(): AsyncGenerator<ChatStreamChunk> {\n            try {\n                const stream = self.provider.chatStream(processedRequest);\n                for await (const chunk of stream) {\n                    if (aborted || options.signal?.aborted) {\n                        break;\n                    }\n                    yield chunk;\n                }\n            } catch (error) {\n                self.recordStats(context, null, false, (error as Error).message);\n                throw error;\n            }\n        }\n\n        return {\n            requestId,\n            stream: wrappedStream(),\n            abort: () => {\n                aborted = true;\n            },\n        };\n    }\n\n    /**\n     * \u7B80\u4FBF\u65B9\u6CD5\uFF1A\u53D1\u9001\u5355\u6761\u6D88\u606F\n     */\n    async complete(\n        prompt: string,\n        systemPrompt?: string,\n        options: LLMRequestOptions = {}\n    ): Promise<string> {\n        const messages = [];\n        if (systemPrompt) {\n            messages.push({ role: 'system' as const, content: systemPrompt });\n        }\n        messages.push({ role: 'user' as const, content: prompt });\n\n        const result = await this.chat({ messages }, options);\n        return result.content;\n    }\n\n    // ========================================================================\n    // \u4E2D\u95F4\u4EF6\u7BA1\u7406\n    // ========================================================================\n\n    /**\n     * \u6DFB\u52A0\u8BF7\u6C42\u4E2D\u95F4\u4EF6\n     */\n    useRequest(middleware: LLMRequestMiddleware): this {\n        this.requestMiddlewares.push(middleware);\n        return this;\n    }\n\n    /**\n     * \u6DFB\u52A0\u54CD\u5E94\u4E2D\u95F4\u4EF6\n     */\n    useResponse(middleware: LLMResponseMiddleware): this {\n        this.responseMiddlewares.push(middleware);\n        return this;\n    }\n\n    /**\n     * \u6DFB\u52A0\u9519\u8BEF\u4E2D\u95F4\u4EF6\n     */\n    useError(middleware: LLMErrorMiddleware): this {\n        this.errorMiddlewares.push(middleware);\n        return this;\n    }\n\n    /**\n     * \u79FB\u9664\u4E2D\u95F4\u4EF6\n     */\n    removeMiddleware(name: string): boolean {\n        let removed = false;\n\n        const removeFromArray = <T extends { name: string }>(arr: T[]): T[] => {\n            const index = arr.findIndex(m => m.name === name);\n            if (index > -1) {\n                arr.splice(index, 1);\n                removed = true;\n            }\n            return arr;\n        };\n\n        this.requestMiddlewares = removeFromArray(this.requestMiddlewares);\n        this.responseMiddlewares = removeFromArray(this.responseMiddlewares);\n        this.errorMiddlewares = removeFromArray(this.errorMiddlewares);\n\n        return removed;\n    }\n\n    // ========================================================================\n    // \u7EDF\u8BA1\u4E0E\u7F13\u5B58 API\n    // ========================================================================\n\n    /**\n     * \u83B7\u53D6\u805A\u5408\u7EDF\u8BA1\n     */\n    getStats(): LLMAggregateStats {\n        return this.stats.getAggregateStats();\n    }\n\n    /**\n     * \u83B7\u53D6\u6700\u8FD1\u7684\u8C03\u7528\u8BB0\u5F55\n     */\n    getRecentCalls(count: number = 10): LLMCallStats[] {\n        return this.stats.getRecentStats(count);\n    }\n\n    /**\n     * \u5BFC\u51FA\u7EDF\u8BA1\u6570\u636E\n     */\n    exportStats() {\n        return this.stats.export();\n    }\n\n    /**\n     * \u6E05\u7A7A\u7EDF\u8BA1\n     */\n    clearStats(): void {\n        this.stats.clear();\n    }\n\n    /**\n     * \u6E05\u7A7A\u7F13\u5B58\n     */\n    clearCache(): void {\n        this.cache.clear();\n    }\n\n    /**\n     * \u83B7\u53D6\u7F13\u5B58\u7EDF\u8BA1\n     */\n    getCacheStats() {\n        return this.cache.getStats();\n    }\n\n    // ========================================================================\n    // Provider \u8BBF\u95EE\n    // ========================================================================\n\n    /**\n     * \u83B7\u53D6\u5E95\u5C42 Provider\n     */\n    getProvider(): LLMProvider {\n        return this.provider;\n    }\n\n    /**\n     * \u83B7\u53D6 Provider \u540D\u79F0\n     */\n    getProviderName(): string {\n        return this.provider.getProviderName();\n    }\n\n    /**\n     * \u83B7\u53D6\u5F53\u524D\u6A21\u578B\n     */\n    getModel(): string {\n        return this.provider.getModel();\n    }\n\n    // ========================================================================\n    // \u79C1\u6709\u65B9\u6CD5\n    // ========================================================================\n\n    /**\n     * \u6267\u884C\u8BF7\u6C42\uFF08\u5E26\u91CD\u8BD5\uFF09\n     */\n    private async executeWithRetry(\n        request: ChatRequest,\n        context: LLMRequestContext,\n        options: LLMRequestOptions\n    ): Promise<ChatResponse> {\n        const maxRetries = options.maxRetries ?? this.config.retry.maxRetries;\n        const timeout = options.timeout ?? this.config.defaultTimeout;\n        let lastError: Error | null = null;\n\n        for (let attempt = 0; attempt <= maxRetries; attempt++) {\n            context.retryCount = attempt;\n\n            try {\n                // \u521B\u5EFA\u8D85\u65F6 Promise\n                const timeoutPromise = new Promise<never>((_, reject) => {\n                    setTimeout(() => reject(new Error('Request timeout')), timeout);\n                });\n\n                // \u521B\u5EFA\u8BF7\u6C42 Promise\n                const requestPromise = this.provider.chat(request);\n\n                // \u7ADE\u4E89\u6267\u884C\n                const response = await Promise.race([requestPromise, timeoutPromise]);\n                return response;\n\n            } catch (error) {\n                lastError = error as Error;\n\n                // \u68C0\u67E5\u4E2D\u65AD\u4FE1\u53F7\n                if (options.signal?.aborted) {\n                    throw new Error('Request aborted');\n                }\n\n                // \u68C0\u67E5\u662F\u5426\u53EF\u91CD\u8BD5\n                if (attempt < maxRetries && isRetryableError(lastError, this.config.retry.retryableErrors)) {\n                    const backoff = Math.min(\n                        this.config.retry.initialBackoff * Math.pow(this.config.retry.backoffMultiplier, attempt),\n                        this.config.retry.maxBackoff\n                    );\n                    await sleep(backoff);\n                    continue;\n                }\n\n                throw lastError;\n            }\n        }\n\n        throw lastError || new Error('Max retries exceeded');\n    }\n\n    /**\n     * \u68C0\u67E5\u901F\u7387\u9650\u5236\n     */\n    private async checkRateLimit(): Promise<void> {\n        if (!this.config.rateLimit.enabled) return;\n\n        const now = Date.now();\n\n        // \u68C0\u67E5\u662F\u5426\u9700\u8981\u91CD\u7F6E\u7A97\u53E3\n        if (now - this.rateLimitState.windowStart >= this.config.rateLimit.windowMs) {\n            this.rateLimitState = { count: 0, windowStart: now };\n        }\n\n        // \u68C0\u67E5\u662F\u5426\u8D85\u8FC7\u9650\u5236\n        if (this.rateLimitState.count >= this.config.rateLimit.maxRequests) {\n            const waitTime = this.config.rateLimit.windowMs - (now - this.rateLimitState.windowStart);\n            if (waitTime > 0) {\n                await sleep(waitTime);\n                this.rateLimitState = { count: 0, windowStart: Date.now() };\n            }\n        }\n\n        this.rateLimitState.count++;\n    }\n\n    /**\n     * \u521B\u5EFA\u7ED3\u679C\u5BF9\u8C61\n     */\n    private createResult(\n        response: ChatResponse,\n        context: LLMRequestContext,\n        cached: boolean\n    ): LLMResult {\n        return {\n            ...response,\n            requestId: context.requestId,\n            duration: Date.now() - context.startTime,\n            cached,\n            retryCount: context.retryCount,\n        };\n    }\n\n    /**\n     * \u8BB0\u5F55\u7EDF\u8BA1\n     */\n    private recordStats(\n        context: LLMRequestContext,\n        result: LLMResult | null,\n        success: boolean,\n        error?: string\n    ): void {\n        this.stats.record({\n            requestId: context.requestId,\n            providerName: context.providerName,\n            model: context.model,\n            startTime: context.startTime,\n            endTime: Date.now(),\n            duration: Date.now() - context.startTime,\n            usage: result?.usage,\n            success,\n            cached: result?.cached ?? false,\n            retryCount: context.retryCount,\n            error,\n        });\n    }\n}\n\n// ============================================================================\n// \u5DE5\u5382\u51FD\u6570\n// ============================================================================\n\n/**\n * \u521B\u5EFA LLM Service \u5B9E\u4F8B\n */\nexport function createLLMService(\n    provider: LLMProvider,\n    config: Partial<LLMServiceConfig> = {}\n): LLMService {\n    return new LLMService(provider, config);\n}\n", "/**\n * \u5185\u7F6E\u4E2D\u95F4\u4EF6\n * \u63D0\u4F9B\u5E38\u7528\u7684\u8BF7\u6C42/\u54CD\u5E94/\u9519\u8BEF\u5904\u7406\u4E2D\u95F4\u4EF6\n */\n\nimport type { ChatRequest, ChatResponse } from '../llm-provider';\nimport type {\n    LLMRequestContext,\n    LLMRequestMiddleware,\n    LLMResponseMiddleware,\n    LLMErrorMiddleware,\n} from './types';\n\n// ============================================================================\n// \u8BF7\u6C42\u4E2D\u95F4\u4EF6\n// ============================================================================\n\n/**\n * \u8BF7\u6C42\u65E5\u5FD7\u4E2D\u95F4\u4EF6 - \u8BB0\u5F55\u8BF7\u6C42\u4FE1\u606F\n */\nexport function createRequestLoggingMiddleware(\n    logger: (message: string, data?: unknown) => void = console.log\n): LLMRequestMiddleware {\n    return {\n        name: 'request-logging',\n        process(request: ChatRequest, context: LLMRequestContext): ChatRequest {\n            logger(`[LLM] Request ${context.requestId}`, {\n                provider: context.providerName,\n                model: context.model,\n                messageCount: request.messages.length,\n            });\n            return request;\n        },\n    };\n}\n\n/**\n * \u54CD\u5E94\u65E5\u5FD7\u4E2D\u95F4\u4EF6 - \u8BB0\u5F55\u54CD\u5E94\u4FE1\u606F\n */\nexport function createResponseLoggingMiddleware(\n    logger: (message: string, data?: unknown) => void = console.log\n): LLMResponseMiddleware {\n    return {\n        name: 'response-logging',\n        process(response: ChatResponse, context: LLMRequestContext): ChatResponse {\n            logger(`[LLM] Response ${context.requestId}`, {\n                duration: Date.now() - context.startTime,\n                contentLength: response.content.length,\n                usage: response.usage,\n            });\n            return response;\n        },\n    };\n}\n\n/**\n * \u65E5\u5FD7\u4E2D\u95F4\u4EF6\u5DE5\u5382 - \u540C\u65F6\u521B\u5EFA\u8BF7\u6C42\u548C\u54CD\u5E94\u65E5\u5FD7\u4E2D\u95F4\u4EF6\n */\nexport function createLoggingMiddleware(\n    logger: (message: string, data?: unknown) => void = console.log\n): { request: LLMRequestMiddleware; response: LLMResponseMiddleware } {\n    return {\n        request: createRequestLoggingMiddleware(logger),\n        response: createResponseLoggingMiddleware(logger),\n    };\n}\n\n/**\n * \u7CFB\u7EDF\u63D0\u793A\u6CE8\u5165\u4E2D\u95F4\u4EF6\n */\nexport function createSystemPromptMiddleware(\n    systemPrompt: string,\n    options: { prepend?: boolean; override?: boolean } = {}\n): LLMRequestMiddleware {\n    const { prepend = true, override = false } = options;\n\n    return {\n        name: 'system-prompt',\n        process(request: ChatRequest, _context: LLMRequestContext): ChatRequest {\n            const messages = [...request.messages];\n            const existingSystemIndex = messages.findIndex(m => m.role === 'system');\n\n            if (override || existingSystemIndex === -1) {\n                const systemMessage = { role: 'system' as const, content: systemPrompt };\n\n                if (existingSystemIndex > -1) {\n                    messages[existingSystemIndex] = systemMessage;\n                } else if (prepend) {\n                    messages.unshift(systemMessage);\n                } else {\n                    messages.push(systemMessage);\n                }\n            }\n\n            return { ...request, messages };\n        },\n    };\n}\n\n/**\n * \u6D88\u606F\u8FC7\u6EE4\u4E2D\u95F4\u4EF6 - \u8FC7\u6EE4\u654F\u611F\u5185\u5BB9\n */\nexport function createContentFilterMiddleware(\n    filterPatterns: Array<{ pattern: RegExp; replacement: string }>\n): LLMRequestMiddleware {\n    return {\n        name: 'content-filter',\n        process(request: ChatRequest, _context: LLMRequestContext): ChatRequest {\n            const messages = request.messages.map(msg => {\n                let content = msg.content;\n                for (const { pattern, replacement } of filterPatterns) {\n                    content = content.replace(pattern, replacement);\n                }\n                return { ...msg, content };\n            });\n\n            return { ...request, messages };\n        },\n    };\n}\n\n/**\n * \u6D88\u606F\u622A\u65AD\u4E2D\u95F4\u4EF6 - \u9650\u5236\u6D88\u606F\u957F\u5EA6\n */\nexport function createTruncationMiddleware(\n    maxMessages: number,\n    options: { keepSystemPrompt?: boolean; keepLatestN?: number } = {}\n): LLMRequestMiddleware {\n    const { keepSystemPrompt = true, keepLatestN = 2 } = options;\n\n    return {\n        name: 'truncation',\n        process(request: ChatRequest, _context: LLMRequestContext): ChatRequest {\n            if (request.messages.length <= maxMessages) {\n                return request;\n            }\n\n            let messages = request.messages;\n            const systemMessage = keepSystemPrompt\n                ? messages.find(m => m.role === 'system')\n                : undefined;\n\n            // \u79FB\u9664\u7CFB\u7EDF\u6D88\u606F\u540E\u5904\u7406\n            const nonSystemMessages = messages.filter(m => m.role !== 'system');\n\n            // \u4FDD\u7559\u6700\u65B0\u7684 N \u6761\u6D88\u606F\n            const truncatedMessages = nonSystemMessages.slice(-keepLatestN);\n\n            // \u91CD\u65B0\u7EC4\u88C5\n            messages = systemMessage\n                ? [systemMessage, ...truncatedMessages]\n                : truncatedMessages;\n\n            return { ...request, messages };\n        },\n    };\n}\n\n// ============================================================================\n// \u54CD\u5E94\u4E2D\u95F4\u4EF6\n// ============================================================================\n\n/**\n * \u54CD\u5E94\u9A8C\u8BC1\u4E2D\u95F4\u4EF6\n */\nexport function createValidationMiddleware(\n    validator: (content: string) => boolean,\n    onInvalid?: (content: string) => string\n): LLMResponseMiddleware {\n    return {\n        name: 'validation',\n        process(response: ChatResponse, _context: LLMRequestContext): ChatResponse {\n            if (!validator(response.content)) {\n                if (onInvalid) {\n                    return { ...response, content: onInvalid(response.content) };\n                }\n                throw new Error('Response validation failed');\n            }\n            return response;\n        },\n    };\n}\n\n/**\n * \u54CD\u5E94\u8F6C\u6362\u4E2D\u95F4\u4EF6\n */\nexport function createTransformMiddleware(\n    transformer: (content: string) => string\n): LLMResponseMiddleware {\n    return {\n        name: 'transform',\n        process(response: ChatResponse, _context: LLMRequestContext): ChatResponse {\n            return { ...response, content: transformer(response.content) };\n        },\n    };\n}\n\n/**\n * JSON \u89E3\u6790\u4E2D\u95F4\u4EF6\n */\nexport function createJsonParseMiddleware(\n    options: { strict?: boolean; defaultValue?: unknown } = {}\n): LLMResponseMiddleware {\n    const { strict = false, defaultValue = null } = options;\n\n    return {\n        name: 'json-parse',\n        process(response: ChatResponse, _context: LLMRequestContext): ChatResponse {\n            try {\n                // \u5C1D\u8BD5\u63D0\u53D6 JSON \u5757\n                const jsonMatch = response.content.match(/```(?:json)?\\s*([\\s\\S]*?)\\s*```/);\n                const jsonContent = jsonMatch ? jsonMatch[1] : response.content;\n\n                const parsed = JSON.parse(jsonContent);\n                return {\n                    ...response,\n                    content: JSON.stringify(parsed), // \u89C4\u8303\u5316\u540E\u7684 JSON\n                };\n            } catch (error) {\n                if (strict) {\n                    throw new Error(`Failed to parse JSON response: ${error}`);\n                }\n                return {\n                    ...response,\n                    content: JSON.stringify(defaultValue),\n                };\n            }\n        },\n    };\n}\n\n// ============================================================================\n// \u9519\u8BEF\u4E2D\u95F4\u4EF6\n// ============================================================================\n\n/**\n * \u964D\u7EA7\u4E2D\u95F4\u4EF6 - \u8FD4\u56DE\u9ED8\u8BA4\u54CD\u5E94\n */\nexport function createFallbackMiddleware(\n    fallbackContent: string | ((error: Error, context: LLMRequestContext) => string)\n): LLMErrorMiddleware {\n    return {\n        name: 'fallback',\n        process(error: Error, context: LLMRequestContext): ChatResponse {\n            const content = typeof fallbackContent === 'function'\n                ? fallbackContent(error, context)\n                : fallbackContent;\n\n            return {\n                content,\n                finishReason: 'stop',\n            };\n        },\n    };\n}\n\n/**\n * \u9519\u8BEF\u65E5\u5FD7\u4E2D\u95F4\u4EF6\n */\nexport function createErrorLoggingMiddleware(\n    logger: (message: string, error: Error, context: LLMRequestContext) => void = console.error\n): LLMErrorMiddleware {\n    return {\n        name: 'error-logging',\n        process(error: Error, context: LLMRequestContext): null {\n            logger(`[LLM] Error in request ${context.requestId}`, error, context);\n            return null; // \u4E0D\u5904\u7406\u9519\u8BEF\uFF0C\u7EE7\u7EED\u4F20\u9012\n        },\n    };\n}\n\n/**\n * \u9519\u8BEF\u8F6C\u6362\u4E2D\u95F4\u4EF6 - \u8F6C\u6362\u9519\u8BEF\u7C7B\u578B\n */\nexport function createErrorTransformMiddleware(\n    transformer: (error: Error, context: LLMRequestContext) => Error\n): LLMErrorMiddleware {\n    return {\n        name: 'error-transform',\n        process(error: Error, context: LLMRequestContext): null {\n            throw transformer(error, context);\n        },\n    };\n}\n"],
  "mappings": ";;;;;;;;;AAsOO,IAAK,YAAL,kBAAKA,eAAL;AACH,EAAAA,WAAA,aAAU;AACV,EAAAA,WAAA,aAAU;AACV,EAAAA,WAAA,gBAAa;AACb,EAAAA,WAAA,gBAAa;AACb,EAAAA,WAAA,eAAY;AACZ,EAAAA,WAAA,kBAAe;AACf,EAAAA,WAAA,sBAAmB;AACnB,EAAAA,WAAA,qBAAkB;AAClB,EAAAA,WAAA,aAAU;AATF,SAAAA;AAAA,GAAA;;;AC5NL,SAAS,YAAY,MAAc,QAAiC;AACvE,QAAM,MAAM,KAAK,IAAI;AAErB,SAAO;AAAA,IACH,IAAI,WAAW;AAAA,IACf,cAAc;AAAA,MACV,UAAU,CAAC;AAAA,MACX,oBAAoB,CAAC;AAAA,IACzB;AAAA,IACA,MAAM;AAAA,MACF;AAAA,MACA,OAAO,CAAC;AAAA,MACR,aAAa;AAAA,MACb,kBAAkB;AAAA,MAClB,UAAU;AAAA,IACd;AAAA,IACA,QAAQ;AAAA,MACJ,WAAW,CAAC;AAAA,MACZ,cAAc,CAAC;AAAA,IACnB;AAAA,IACA,WAAW,CAAC;AAAA,IACZ,WAAW;AAAA,MACP,eAAe;AAAA,MACf,YAAY;AAAA,MACZ,eAAe;AAAA,MACf,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,aAAa,CAAC;AAAA,IAClB;AAAA,IACA,QAAQ;AAAA,MACJ,cAAc;AAAA,MACd,aAAa;AAAA;AAAA,MACb,YAAY;AAAA,MACZ,aAAa,CAAC;AAAA,MACd,cAAc;AAAA;AAAA,MACd,GAAG;AAAA,IACP;AAAA,IACA,WAAW;AAAA,IACX,WAAW;AAAA,EACf;AACJ;AAMO,SAAS,YACZ,OACA,SACK;AAEL,QAAM,QAAQ,UAAU,KAAK;AAG7B,QAAM,SAAS,QAAQ,KAAK;AAG5B,QAAM,WAAW,UAAU;AAG3B,WAAS,YAAY,KAAK,IAAI;AAE9B,SAAO;AACX;AAKO,SAAS,eAAe,OAAsB;AACjD,SAAO,KAAK,UAAU,KAAK;AAC/B;AAKO,SAAS,iBAAiB,MAAqB;AAClD,SAAO,KAAK,MAAM,IAAI;AAC1B;AAKO,SAAS,cAAc,OAAuB;AACjD,SAAO,CAAC,EACJ,MAAM,MACN,MAAM,gBACN,MAAM,QACN,MAAM,UACN,MAAM,aACN,MAAM,aACN,MAAM;AAEd;AAMA,SAAS,aAAqB;AAC1B,SAAO,GAAG,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC;AACnE;AAEA,SAAS,UAAa,KAAW;AAE7B,MAAI,OAAO,oBAAoB,YAAY;AACvC,WAAO,gBAAgB,GAAG;AAAA,EAC9B;AAEA,MAAI,QAAQ,QAAQ,OAAO,QAAQ,UAAU;AACzC,WAAO;AAAA,EACX;AAEA,MAAI,eAAe,MAAM;AACrB,WAAO,IAAI,KAAK,IAAI,QAAQ,CAAC;AAAA,EACjC;AAEA,MAAI,eAAe,OAAO;AACtB,WAAO,IAAI,IAAI,UAAQ,UAAU,IAAI,CAAC;AAAA,EAC1C;AAEA,MAAI,eAAe,QAAQ;AACvB,UAAM,YAAY,CAAC;AACnB,eAAW,OAAO,KAAK;AACnB,UAAI,OAAO,UAAU,eAAe,KAAK,KAAK,GAAG,GAAG;AAChD,kBAAU,GAAG,IAAI,UAAU,IAAI,GAAG,CAAC;AAAA,MACvC;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAEA,SAAO;AACX;AAKO,IAAM,eAAe;AAAA;AAAA,EAExB,WAAW,OAAc,MAAgD,SAAiB;AACtF,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,aAAa,SAAS,KAAK;AAAA,QAC7B;AAAA,QACA;AAAA,QACA,WAAW,KAAK,IAAI;AAAA,MACxB,CAAC;AAAA,IACL,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,eAAe,OAAc,UAAkB;AAC3C,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,KAAK,WAAW,KAAK,IAAI,KAAK,KAAK,IAAI,GAAG,QAAQ,CAAC;AAAA,IAC7D,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,eAAe,OAAc,QAAgB;AACzC,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,KAAK,cAAc;AAAA,IAC7B,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,kBAAkB,OAAc;AAC5B,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,UAAU,iBAAiB;AAAA,IACrC,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,eAAe,OAAc;AACzB,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,UAAU,cAAc;AAAA,IAClC,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,eAAe,OAAc;AACzB,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,UAAU,cAAc;AAAA,IAClC,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,iBAAiB,OAAc,QAAgB,UAAkB;AAC7D,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,UAAU,YAAY,MAAM,KAC7B,MAAM,UAAU,YAAY,MAAM,KAAK,KAAK;AACjD,YAAM,UAAU,iBAAiB;AAAA,IACrC,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,cAAc,OAAc,OAAiE;AACzF,WAAO,YAAY,OAAO,WAAS;AAC/B,UAAI,MAAM,OAAQ,OAAM,UAAU,cAAc,MAAM;AACtD,UAAI,MAAM,WAAY,OAAM,UAAU,cAAc,MAAM;AAE1D,UAAI,CAAC,MAAM,UAAU,CAAC,MAAM,cAAc,MAAM,OAAO;AACnD,cAAM,UAAU,cAAc,MAAM;AAAA,MACxC;AAAA,IACJ,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,YAAY,OAAsD;AAC9D,UAAM,EAAE,WAAW,OAAO,IAAI;AAE9B,QAAI,UAAU,iBAAiB,OAAO,cAAc;AAChD,aAAO,EAAE,UAAU,MAAM,QAAQ,qDAAa,UAAU,aAAa,IAAI,OAAO,YAAY,IAAI;AAAA,IACpG;AAEA,QAAI,UAAU,iBAAiB,OAAO,aAAa;AAC/C,aAAO,EAAE,UAAU,MAAM,QAAQ,mCAAU,UAAU,aAAa,MAAM,OAAO,WAAW,MAAM;AAAA,IACpG;AAEA,QAAI,UAAU,cAAc,OAAO,YAAY;AAC3C,aAAO,EAAE,UAAU,MAAM,QAAQ,yCAAW,UAAU,UAAU,IAAI,OAAO,UAAU,IAAI;AAAA,IAC7F;AAEA,WAAO,EAAE,UAAU,MAAM;AAAA,EAC7B;AACJ;;;AC/NO,IAAM,cAAN,MAAkB;AAAA,EAAlB;AACH,wBAAQ,UAAkB,CAAC;AAC3B,wBAAQ,aAAsD,oBAAI,IAAI;AACtE,wBAAQ,gBAAqC,oBAAI,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,EAKrD,KACI,MACA,QACA,SACA,SAKK;AACL,UAAM,QAAe;AAAA,MACjB,IAAI,KAAK,gBAAgB;AAAA,MACzB,WAAW,KAAK,IAAI;AAAA,MACpB;AAAA,MACA;AAAA,MACA;AAAA,MACA,QAAQ,SAAS;AAAA,MACjB,UAAU,SAAS;AAAA,IACvB;AAGA,QAAI,SAAS,YAAY,QAAW;AAChC,YAAM,aAAa,WAAW,MAAM,EAAE;AACtC,WAAK,aAAa,IAAI,YAAY,QAAQ,OAAO;AACjD,YAAM,aAAa;AAAA,IACvB;AAEA,SAAK,OAAO,KAAK,KAAK;AAGtB,QAAI,KAAK,OAAO,SAAS,KAAM;AAC3B,WAAK,QAAQ;AAAA,IACjB;AAGA,SAAK,gBAAgB,MAAM,KAAK;AAChC,SAAK,gBAAgB,KAAK,KAAK;AAE/B,WAAO;AAAA,EACX;AAAA,EAEQ,UAAU;AAEd,UAAM,eAAe,KAAK,OAAO,SAAS;AAC1C,QAAI,gBAAgB,EAAG;AAEvB,UAAM,gBAAgB,KAAK,OAAO,OAAO,GAAG,YAAY;AAGxD,kBAAc,QAAQ,SAAO;AACzB,UAAI,IAAI,YAAY;AAChB,aAAK,aAAa,OAAO,IAAI,UAAU;AAAA,MAC3C;AAAA,IACJ,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA,EAKA,GAAG,MAAuB,UAAqC;AAC3D,QAAI,CAAC,KAAK,UAAU,IAAI,IAAI,GAAG;AAC3B,WAAK,UAAU,IAAI,MAAM,oBAAI,IAAI,CAAC;AAAA,IACtC;AACA,SAAK,UAAU,IAAI,IAAI,EAAG,IAAI,QAAQ;AAGtC,WAAO,MAAM;AACT,WAAK,UAAU,IAAI,IAAI,GAAG,OAAO,QAAQ;AAAA,IAC7C;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,YAAqB;AACjB,WAAO,CAAC,GAAG,KAAK,MAAM;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA,EAKA,WAAW,YAA6B;AACpC,WAAO,KAAK,aAAa,IAAI,UAAU;AAAA,EAC3C;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACV,SAAK,SAAS,CAAC;AACf,SAAK,aAAa,MAAM;AAAA,EAC5B;AAAA;AAAA;AAAA;AAAA,EAKA,SAAiE;AAC7D,UAAM,WAAoC,CAAC;AAC3C,SAAK,aAAa,QAAQ,CAAC,OAAO,QAAQ;AACtC,eAAS,GAAG,IAAI;AAAA,IACpB,CAAC;AAED,WAAO;AAAA,MACH,QAAQ,KAAK;AAAA,MACb;AAAA,IACJ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,MAAoE;AACvE,SAAK,SAAS,KAAK;AACnB,SAAK,eAAe,IAAI,IAAI,OAAO,QAAQ,KAAK,QAAQ,CAAC;AAAA,EAC7D;AAAA,EAEQ,gBAAgB,MAAuB,OAAoB;AAC/D,UAAM,YAAY,KAAK,UAAU,IAAI,IAAI;AACzC,QAAI,WAAW;AACX,gBAAU,QAAQ,cAAY;AAC1B,YAAI;AACA,mBAAS,KAAK;AAAA,QAClB,SAAS,OAAO;AACZ,kBAAQ,MAAM,+BAA+B,IAAI,KAAK,KAAK;AAAA,QAC/D;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EAEQ,kBAA0B;AAC9B,WAAO,OAAO,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC;AAAA,EACvE;AACJ;;;ACrJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAO,IAAI;AAAA,CACV,SAAUC,OAAM;AACb,EAAAA,MAAK,cAAc,CAAC,MAAM;AAAA,EAAE;AAC5B,WAAS,SAAS,MAAM;AAAA,EAAE;AAC1B,EAAAA,MAAK,WAAW;AAChB,WAAS,YAAY,IAAI;AACrB,UAAM,IAAI,MAAM;AAAA,EACpB;AACA,EAAAA,MAAK,cAAc;AACnB,EAAAA,MAAK,cAAc,CAAC,UAAU;AAC1B,UAAM,MAAM,CAAC;AACb,eAAW,QAAQ,OAAO;AACtB,UAAI,IAAI,IAAI;AAAA,IAChB;AACA,WAAO;AAAA,EACX;AACA,EAAAA,MAAK,qBAAqB,CAAC,QAAQ;AAC/B,UAAM,YAAYA,MAAK,WAAW,GAAG,EAAE,OAAO,CAAC,MAAM,OAAO,IAAI,IAAI,CAAC,CAAC,MAAM,QAAQ;AACpF,UAAM,WAAW,CAAC;AAClB,eAAW,KAAK,WAAW;AACvB,eAAS,CAAC,IAAI,IAAI,CAAC;AAAA,IACvB;AACA,WAAOA,MAAK,aAAa,QAAQ;AAAA,EACrC;AACA,EAAAA,MAAK,eAAe,CAAC,QAAQ;AACzB,WAAOA,MAAK,WAAW,GAAG,EAAE,IAAI,SAAU,GAAG;AACzC,aAAO,IAAI,CAAC;AAAA,IAChB,CAAC;AAAA,EACL;AACA,EAAAA,MAAK,aAAa,OAAO,OAAO,SAAS,aACnC,CAAC,QAAQ,OAAO,KAAK,GAAG,IACxB,CAAC,WAAW;AACV,UAAM,OAAO,CAAC;AACd,eAAW,OAAO,QAAQ;AACtB,UAAI,OAAO,UAAU,eAAe,KAAK,QAAQ,GAAG,GAAG;AACnD,aAAK,KAAK,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AACJ,EAAAA,MAAK,OAAO,CAAC,KAAK,YAAY;AAC1B,eAAW,QAAQ,KAAK;AACpB,UAAI,QAAQ,IAAI;AACZ,eAAO;AAAA,IACf;AACA,WAAO;AAAA,EACX;AACA,EAAAA,MAAK,YAAY,OAAO,OAAO,cAAc,aACvC,CAAC,QAAQ,OAAO,UAAU,GAAG,IAC7B,CAAC,QAAQ,OAAO,QAAQ,YAAY,OAAO,SAAS,GAAG,KAAK,KAAK,MAAM,GAAG,MAAM;AACtF,WAAS,WAAW,OAAO,YAAY,OAAO;AAC1C,WAAO,MAAM,IAAI,CAAC,QAAS,OAAO,QAAQ,WAAW,IAAI,GAAG,MAAM,GAAI,EAAE,KAAK,SAAS;AAAA,EAC1F;AACA,EAAAA,MAAK,aAAa;AAClB,EAAAA,MAAK,wBAAwB,CAAC,GAAG,UAAU;AACvC,QAAI,OAAO,UAAU,UAAU;AAC3B,aAAO,MAAM,SAAS;AAAA,IAC1B;AACA,WAAO;AAAA,EACX;AACJ,GAAG,SAAS,OAAO,CAAC,EAAE;AACf,IAAI;AAAA,CACV,SAAUC,aAAY;AACnB,EAAAA,YAAW,cAAc,CAAC,OAAO,WAAW;AACxC,WAAO;AAAA,MACH,GAAG;AAAA,MACH,GAAG;AAAA;AAAA,IACP;AAAA,EACJ;AACJ,GAAG,eAAe,aAAa,CAAC,EAAE;AAC3B,IAAM,gBAAgB,KAAK,YAAY;AAAA,EAC1C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ,CAAC;AACM,IAAM,gBAAgB,CAAC,SAAS;AACnC,QAAM,IAAI,OAAO;AACjB,UAAQ,GAAG;AAAA,IACP,KAAK;AACD,aAAO,cAAc;AAAA,IACzB,KAAK;AACD,aAAO,cAAc;AAAA,IACzB,KAAK;AACD,aAAO,OAAO,MAAM,IAAI,IAAI,cAAc,MAAM,cAAc;AAAA,IAClE,KAAK;AACD,aAAO,cAAc;AAAA,IACzB,KAAK;AACD,aAAO,cAAc;AAAA,IACzB,KAAK;AACD,aAAO,cAAc;AAAA,IACzB,KAAK;AACD,aAAO,cAAc;AAAA,IACzB,KAAK;AACD,UAAI,MAAM,QAAQ,IAAI,GAAG;AACrB,eAAO,cAAc;AAAA,MACzB;AACA,UAAI,SAAS,MAAM;AACf,eAAO,cAAc;AAAA,MACzB;AACA,UAAI,KAAK,QAAQ,OAAO,KAAK,SAAS,cAAc,KAAK,SAAS,OAAO,KAAK,UAAU,YAAY;AAChG,eAAO,cAAc;AAAA,MACzB;AACA,UAAI,OAAO,QAAQ,eAAe,gBAAgB,KAAK;AACnD,eAAO,cAAc;AAAA,MACzB;AACA,UAAI,OAAO,QAAQ,eAAe,gBAAgB,KAAK;AACnD,eAAO,cAAc;AAAA,MACzB;AACA,UAAI,OAAO,SAAS,eAAe,gBAAgB,MAAM;AACrD,eAAO,cAAc;AAAA,MACzB;AACA,aAAO,cAAc;AAAA,IACzB;AACI,aAAO,cAAc;AAAA,EAC7B;AACJ;;;ACnIO,IAAM,eAAe,KAAK,YAAY;AAAA,EACzC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ,CAAC;AACM,IAAM,gBAAgB,CAAC,QAAQ;AAClC,QAAM,OAAO,KAAK,UAAU,KAAK,MAAM,CAAC;AACxC,SAAO,KAAK,QAAQ,eAAe,KAAK;AAC5C;AACO,IAAM,WAAN,MAAM,kBAAiB,MAAM;AAAA,EAChC,IAAI,SAAS;AACT,WAAO,KAAK;AAAA,EAChB;AAAA,EACA,YAAY,QAAQ;AAChB,UAAM;AACN,SAAK,SAAS,CAAC;AACf,SAAK,WAAW,CAAC,QAAQ;AACrB,WAAK,SAAS,CAAC,GAAG,KAAK,QAAQ,GAAG;AAAA,IACtC;AACA,SAAK,YAAY,CAAC,OAAO,CAAC,MAAM;AAC5B,WAAK,SAAS,CAAC,GAAG,KAAK,QAAQ,GAAG,IAAI;AAAA,IAC1C;AACA,UAAM,cAAc,WAAW;AAC/B,QAAI,OAAO,gBAAgB;AAEvB,aAAO,eAAe,MAAM,WAAW;AAAA,IAC3C,OACK;AACD,WAAK,YAAY;AAAA,IACrB;AACA,SAAK,OAAO;AACZ,SAAK,SAAS;AAAA,EAClB;AAAA,EACA,OAAO,SAAS;AACZ,UAAM,SAAS,WACX,SAAU,OAAO;AACb,aAAO,MAAM;AAAA,IACjB;AACJ,UAAM,cAAc,EAAE,SAAS,CAAC,EAAE;AAClC,UAAM,eAAe,CAAC,UAAU;AAC5B,iBAAW,SAAS,MAAM,QAAQ;AAC9B,YAAI,MAAM,SAAS,iBAAiB;AAChC,gBAAM,YAAY,IAAI,YAAY;AAAA,QACtC,WACS,MAAM,SAAS,uBAAuB;AAC3C,uBAAa,MAAM,eAAe;AAAA,QACtC,WACS,MAAM,SAAS,qBAAqB;AACzC,uBAAa,MAAM,cAAc;AAAA,QACrC,WACS,MAAM,KAAK,WAAW,GAAG;AAC9B,sBAAY,QAAQ,KAAK,OAAO,KAAK,CAAC;AAAA,QAC1C,OACK;AACD,cAAI,OAAO;AACX,cAAI,IAAI;AACR,iBAAO,IAAI,MAAM,KAAK,QAAQ;AAC1B,kBAAM,KAAK,MAAM,KAAK,CAAC;AACvB,kBAAM,WAAW,MAAM,MAAM,KAAK,SAAS;AAC3C,gBAAI,CAAC,UAAU;AACX,mBAAK,EAAE,IAAI,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,EAAE;AAAA,YAQzC,OACK;AACD,mBAAK,EAAE,IAAI,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,EAAE;AACrC,mBAAK,EAAE,EAAE,QAAQ,KAAK,OAAO,KAAK,CAAC;AAAA,YACvC;AACA,mBAAO,KAAK,EAAE;AACd;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AACA,iBAAa,IAAI;AACjB,WAAO;AAAA,EACX;AAAA,EACA,OAAO,OAAO,OAAO;AACjB,QAAI,EAAE,iBAAiB,YAAW;AAC9B,YAAM,IAAI,MAAM,mBAAmB,KAAK,EAAE;AAAA,IAC9C;AAAA,EACJ;AAAA,EACA,WAAW;AACP,WAAO,KAAK;AAAA,EAChB;AAAA,EACA,IAAI,UAAU;AACV,WAAO,KAAK,UAAU,KAAK,QAAQ,KAAK,uBAAuB,CAAC;AAAA,EACpE;AAAA,EACA,IAAI,UAAU;AACV,WAAO,KAAK,OAAO,WAAW;AAAA,EAClC;AAAA,EACA,QAAQ,SAAS,CAAC,UAAU,MAAM,SAAS;AACvC,UAAM,cAAc,CAAC;AACrB,UAAM,aAAa,CAAC;AACpB,eAAW,OAAO,KAAK,QAAQ;AAC3B,UAAI,IAAI,KAAK,SAAS,GAAG;AACrB,cAAM,UAAU,IAAI,KAAK,CAAC;AAC1B,oBAAY,OAAO,IAAI,YAAY,OAAO,KAAK,CAAC;AAChD,oBAAY,OAAO,EAAE,KAAK,OAAO,GAAG,CAAC;AAAA,MACzC,OACK;AACD,mBAAW,KAAK,OAAO,GAAG,CAAC;AAAA,MAC/B;AAAA,IACJ;AACA,WAAO,EAAE,YAAY,YAAY;AAAA,EACrC;AAAA,EACA,IAAI,aAAa;AACb,WAAO,KAAK,QAAQ;AAAA,EACxB;AACJ;AACA,SAAS,SAAS,CAAC,WAAW;AAC1B,QAAM,QAAQ,IAAI,SAAS,MAAM;AACjC,SAAO;AACX;;;AClIA,IAAM,WAAW,CAAC,OAAO,SAAS;AAC9B,MAAI;AACJ,UAAQ,MAAM,MAAM;AAAA,IAChB,KAAK,aAAa;AACd,UAAI,MAAM,aAAa,cAAc,WAAW;AAC5C,kBAAU;AAAA,MACd,OACK;AACD,kBAAU,YAAY,MAAM,QAAQ,cAAc,MAAM,QAAQ;AAAA,MACpE;AACA;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU,mCAAmC,KAAK,UAAU,MAAM,UAAU,KAAK,qBAAqB,CAAC;AACvG;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU,kCAAkC,KAAK,WAAW,MAAM,MAAM,IAAI,CAAC;AAC7E;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU;AACV;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU,yCAAyC,KAAK,WAAW,MAAM,OAAO,CAAC;AACjF;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU,gCAAgC,KAAK,WAAW,MAAM,OAAO,CAAC,eAAe,MAAM,QAAQ;AACrG;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU;AACV;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU;AACV;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU;AACV;AAAA,IACJ,KAAK,aAAa;AACd,UAAI,OAAO,MAAM,eAAe,UAAU;AACtC,YAAI,cAAc,MAAM,YAAY;AAChC,oBAAU,gCAAgC,MAAM,WAAW,QAAQ;AACnE,cAAI,OAAO,MAAM,WAAW,aAAa,UAAU;AAC/C,sBAAU,GAAG,OAAO,sDAAsD,MAAM,WAAW,QAAQ;AAAA,UACvG;AAAA,QACJ,WACS,gBAAgB,MAAM,YAAY;AACvC,oBAAU,mCAAmC,MAAM,WAAW,UAAU;AAAA,QAC5E,WACS,cAAc,MAAM,YAAY;AACrC,oBAAU,iCAAiC,MAAM,WAAW,QAAQ;AAAA,QACxE,OACK;AACD,eAAK,YAAY,MAAM,UAAU;AAAA,QACrC;AAAA,MACJ,WACS,MAAM,eAAe,SAAS;AACnC,kBAAU,WAAW,MAAM,UAAU;AAAA,MACzC,OACK;AACD,kBAAU;AAAA,MACd;AACA;AAAA,IACJ,KAAK,aAAa;AACd,UAAI,MAAM,SAAS;AACf,kBAAU,sBAAsB,MAAM,QAAQ,YAAY,MAAM,YAAY,aAAa,WAAW,IAAI,MAAM,OAAO;AAAA,eAChH,MAAM,SAAS;AACpB,kBAAU,uBAAuB,MAAM,QAAQ,YAAY,MAAM,YAAY,aAAa,MAAM,IAAI,MAAM,OAAO;AAAA,eAC5G,MAAM,SAAS;AACpB,kBAAU,kBAAkB,MAAM,QAAQ,sBAAsB,MAAM,YAAY,8BAA8B,eAAe,GAAG,MAAM,OAAO;AAAA,eAC1I,MAAM,SAAS;AACpB,kBAAU,kBAAkB,MAAM,QAAQ,sBAAsB,MAAM,YAAY,8BAA8B,eAAe,GAAG,MAAM,OAAO;AAAA,eAC1I,MAAM,SAAS;AACpB,kBAAU,gBAAgB,MAAM,QAAQ,sBAAsB,MAAM,YAAY,8BAA8B,eAAe,GAAG,IAAI,KAAK,OAAO,MAAM,OAAO,CAAC,CAAC;AAAA;AAE/J,kBAAU;AACd;AAAA,IACJ,KAAK,aAAa;AACd,UAAI,MAAM,SAAS;AACf,kBAAU,sBAAsB,MAAM,QAAQ,YAAY,MAAM,YAAY,YAAY,WAAW,IAAI,MAAM,OAAO;AAAA,eAC/G,MAAM,SAAS;AACpB,kBAAU,uBAAuB,MAAM,QAAQ,YAAY,MAAM,YAAY,YAAY,OAAO,IAAI,MAAM,OAAO;AAAA,eAC5G,MAAM,SAAS;AACpB,kBAAU,kBAAkB,MAAM,QAAQ,YAAY,MAAM,YAAY,0BAA0B,WAAW,IAAI,MAAM,OAAO;AAAA,eACzH,MAAM,SAAS;AACpB,kBAAU,kBAAkB,MAAM,QAAQ,YAAY,MAAM,YAAY,0BAA0B,WAAW,IAAI,MAAM,OAAO;AAAA,eACzH,MAAM,SAAS;AACpB,kBAAU,gBAAgB,MAAM,QAAQ,YAAY,MAAM,YAAY,6BAA6B,cAAc,IAAI,IAAI,KAAK,OAAO,MAAM,OAAO,CAAC,CAAC;AAAA;AAEpJ,kBAAU;AACd;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU;AACV;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU;AACV;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU,gCAAgC,MAAM,UAAU;AAC1D;AAAA,IACJ,KAAK,aAAa;AACd,gBAAU;AACV;AAAA,IACJ;AACI,gBAAU,KAAK;AACf,WAAK,YAAY,KAAK;AAAA,EAC9B;AACA,SAAO,EAAE,QAAQ;AACrB;AACA,IAAO,aAAQ;;;AC3Gf,IAAI,mBAAmB;AAEhB,SAAS,YAAY,KAAK;AAC7B,qBAAmB;AACvB;AACO,SAAS,cAAc;AAC1B,SAAO;AACX;;;ACNO,IAAM,YAAY,CAAC,WAAW;AACjC,QAAM,EAAE,MAAM,MAAM,WAAW,UAAU,IAAI;AAC7C,QAAM,WAAW,CAAC,GAAG,MAAM,GAAI,UAAU,QAAQ,CAAC,CAAE;AACpD,QAAM,YAAY;AAAA,IACd,GAAG;AAAA,IACH,MAAM;AAAA,EACV;AACA,MAAI,UAAU,YAAY,QAAW;AACjC,WAAO;AAAA,MACH,GAAG;AAAA,MACH,MAAM;AAAA,MACN,SAAS,UAAU;AAAA,IACvB;AAAA,EACJ;AACA,MAAI,eAAe;AACnB,QAAM,OAAO,UACR,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EACjB,MAAM,EACN,QAAQ;AACb,aAAW,OAAO,MAAM;AACpB,mBAAe,IAAI,WAAW,EAAE,MAAM,cAAc,aAAa,CAAC,EAAE;AAAA,EACxE;AACA,SAAO;AAAA,IACH,GAAG;AAAA,IACH,MAAM;AAAA,IACN,SAAS;AAAA,EACb;AACJ;AACO,IAAM,aAAa,CAAC;AACpB,SAAS,kBAAkB,KAAK,WAAW;AAC9C,QAAM,cAAc,YAAY;AAChC,QAAM,QAAQ,UAAU;AAAA,IACpB;AAAA,IACA,MAAM,IAAI;AAAA,IACV,MAAM,IAAI;AAAA,IACV,WAAW;AAAA,MACP,IAAI,OAAO;AAAA;AAAA,MACX,IAAI;AAAA;AAAA,MACJ;AAAA;AAAA,MACA,gBAAgB,aAAkB,SAAY;AAAA;AAAA,IAClD,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;AAAA,EACvB,CAAC;AACD,MAAI,OAAO,OAAO,KAAK,KAAK;AAChC;AACO,IAAM,cAAN,MAAM,aAAY;AAAA,EACrB,cAAc;AACV,SAAK,QAAQ;AAAA,EACjB;AAAA,EACA,QAAQ;AACJ,QAAI,KAAK,UAAU;AACf,WAAK,QAAQ;AAAA,EACrB;AAAA,EACA,QAAQ;AACJ,QAAI,KAAK,UAAU;AACf,WAAK,QAAQ;AAAA,EACrB;AAAA,EACA,OAAO,WAAW,QAAQ,SAAS;AAC/B,UAAM,aAAa,CAAC;AACpB,eAAW,KAAK,SAAS;AACrB,UAAI,EAAE,WAAW;AACb,eAAO;AACX,UAAI,EAAE,WAAW;AACb,eAAO,MAAM;AACjB,iBAAW,KAAK,EAAE,KAAK;AAAA,IAC3B;AACA,WAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,WAAW;AAAA,EACrD;AAAA,EACA,aAAa,iBAAiB,QAAQ,OAAO;AACzC,UAAM,YAAY,CAAC;AACnB,eAAW,QAAQ,OAAO;AACtB,YAAM,MAAM,MAAM,KAAK;AACvB,YAAM,QAAQ,MAAM,KAAK;AACzB,gBAAU,KAAK;AAAA,QACX;AAAA,QACA;AAAA,MACJ,CAAC;AAAA,IACL;AACA,WAAO,aAAY,gBAAgB,QAAQ,SAAS;AAAA,EACxD;AAAA,EACA,OAAO,gBAAgB,QAAQ,OAAO;AAClC,UAAM,cAAc,CAAC;AACrB,eAAW,QAAQ,OAAO;AACtB,YAAM,EAAE,KAAK,MAAM,IAAI;AACvB,UAAI,IAAI,WAAW;AACf,eAAO;AACX,UAAI,MAAM,WAAW;AACjB,eAAO;AACX,UAAI,IAAI,WAAW;AACf,eAAO,MAAM;AACjB,UAAI,MAAM,WAAW;AACjB,eAAO,MAAM;AACjB,UAAI,IAAI,UAAU,gBAAgB,OAAO,MAAM,UAAU,eAAe,KAAK,YAAY;AACrF,oBAAY,IAAI,KAAK,IAAI,MAAM;AAAA,MACnC;AAAA,IACJ;AACA,WAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,YAAY;AAAA,EACtD;AACJ;AACO,IAAM,UAAU,OAAO,OAAO;AAAA,EACjC,QAAQ;AACZ,CAAC;AACM,IAAM,QAAQ,CAAC,WAAW,EAAE,QAAQ,SAAS,MAAM;AACnD,IAAM,KAAK,CAAC,WAAW,EAAE,QAAQ,SAAS,MAAM;AAChD,IAAM,YAAY,CAAC,MAAM,EAAE,WAAW;AACtC,IAAM,UAAU,CAAC,MAAM,EAAE,WAAW;AACpC,IAAM,UAAU,CAAC,MAAM,EAAE,WAAW;AACpC,IAAM,UAAU,CAAC,MAAM,OAAO,YAAY,eAAe,aAAa;;;AC5GtE,IAAI;AAAA,CACV,SAAUC,YAAW;AAClB,EAAAA,WAAU,WAAW,CAAC,YAAY,OAAO,YAAY,WAAW,EAAE,QAAQ,IAAI,WAAW,CAAC;AAE1F,EAAAA,WAAU,WAAW,CAAC,YAAY,OAAO,YAAY,WAAW,UAAU,SAAS;AACvF,GAAG,cAAc,YAAY,CAAC,EAAE;;;ACAhC,IAAM,qBAAN,MAAyB;AAAA,EACrB,YAAY,QAAQ,OAAO,MAAM,KAAK;AAClC,SAAK,cAAc,CAAC;AACpB,SAAK,SAAS;AACd,SAAK,OAAO;AACZ,SAAK,QAAQ;AACb,SAAK,OAAO;AAAA,EAChB;AAAA,EACA,IAAI,OAAO;AACP,QAAI,CAAC,KAAK,YAAY,QAAQ;AAC1B,UAAI,MAAM,QAAQ,KAAK,IAAI,GAAG;AAC1B,aAAK,YAAY,KAAK,GAAG,KAAK,OAAO,GAAG,KAAK,IAAI;AAAA,MACrD,OACK;AACD,aAAK,YAAY,KAAK,GAAG,KAAK,OAAO,KAAK,IAAI;AAAA,MAClD;AAAA,IACJ;AACA,WAAO,KAAK;AAAA,EAChB;AACJ;AACA,IAAM,eAAe,CAAC,KAAK,WAAW;AAClC,MAAI,QAAQ,MAAM,GAAG;AACjB,WAAO,EAAE,SAAS,MAAM,MAAM,OAAO,MAAM;AAAA,EAC/C,OACK;AACD,QAAI,CAAC,IAAI,OAAO,OAAO,QAAQ;AAC3B,YAAM,IAAI,MAAM,2CAA2C;AAAA,IAC/D;AACA,WAAO;AAAA,MACH,SAAS;AAAA,MACT,IAAI,QAAQ;AACR,YAAI,KAAK;AACL,iBAAO,KAAK;AAChB,cAAM,QAAQ,IAAI,SAAS,IAAI,OAAO,MAAM;AAC5C,aAAK,SAAS;AACd,eAAO,KAAK;AAAA,MAChB;AAAA,IACJ;AAAA,EACJ;AACJ;AACA,SAAS,oBAAoB,QAAQ;AACjC,MAAI,CAAC;AACD,WAAO,CAAC;AACZ,QAAM,EAAE,UAAAC,WAAU,oBAAoB,gBAAgB,YAAY,IAAI;AACtE,MAAIA,cAAa,sBAAsB,iBAAiB;AACpD,UAAM,IAAI,MAAM,0FAA0F;AAAA,EAC9G;AACA,MAAIA;AACA,WAAO,EAAE,UAAUA,WAAU,YAAY;AAC7C,QAAM,YAAY,CAAC,KAAK,QAAQ;AAC5B,UAAM,EAAE,QAAQ,IAAI;AACpB,QAAI,IAAI,SAAS,sBAAsB;AACnC,aAAO,EAAE,SAAS,WAAW,IAAI,aAAa;AAAA,IAClD;AACA,QAAI,OAAO,IAAI,SAAS,aAAa;AACjC,aAAO,EAAE,SAAS,WAAW,kBAAkB,IAAI,aAAa;AAAA,IACpE;AACA,QAAI,IAAI,SAAS;AACb,aAAO,EAAE,SAAS,IAAI,aAAa;AACvC,WAAO,EAAE,SAAS,WAAW,sBAAsB,IAAI,aAAa;AAAA,EACxE;AACA,SAAO,EAAE,UAAU,WAAW,YAAY;AAC9C;AACO,IAAM,UAAN,MAAc;AAAA,EACjB,IAAI,cAAc;AACd,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,SAAS,OAAO;AACZ,WAAO,cAAc,MAAM,IAAI;AAAA,EACnC;AAAA,EACA,gBAAgB,OAAO,KAAK;AACxB,WAAQ,OAAO;AAAA,MACX,QAAQ,MAAM,OAAO;AAAA,MACrB,MAAM,MAAM;AAAA,MACZ,YAAY,cAAc,MAAM,IAAI;AAAA,MACpC,gBAAgB,KAAK,KAAK;AAAA,MAC1B,MAAM,MAAM;AAAA,MACZ,QAAQ,MAAM;AAAA,IAClB;AAAA,EACJ;AAAA,EACA,oBAAoB,OAAO;AACvB,WAAO;AAAA,MACH,QAAQ,IAAI,YAAY;AAAA,MACxB,KAAK;AAAA,QACD,QAAQ,MAAM,OAAO;AAAA,QACrB,MAAM,MAAM;AAAA,QACZ,YAAY,cAAc,MAAM,IAAI;AAAA,QACpC,gBAAgB,KAAK,KAAK;AAAA,QAC1B,MAAM,MAAM;AAAA,QACZ,QAAQ,MAAM;AAAA,MAClB;AAAA,IACJ;AAAA,EACJ;AAAA,EACA,WAAW,OAAO;AACd,UAAM,SAAS,KAAK,OAAO,KAAK;AAChC,QAAI,QAAQ,MAAM,GAAG;AACjB,YAAM,IAAI,MAAM,wCAAwC;AAAA,IAC5D;AACA,WAAO;AAAA,EACX;AAAA,EACA,YAAY,OAAO;AACf,UAAM,SAAS,KAAK,OAAO,KAAK;AAChC,WAAO,QAAQ,QAAQ,MAAM;AAAA,EACjC;AAAA,EACA,MAAM,MAAM,QAAQ;AAChB,UAAM,SAAS,KAAK,UAAU,MAAM,MAAM;AAC1C,QAAI,OAAO;AACP,aAAO,OAAO;AAClB,UAAM,OAAO;AAAA,EACjB;AAAA,EACA,UAAU,MAAM,QAAQ;AACpB,UAAM,MAAM;AAAA,MACR,QAAQ;AAAA,QACJ,QAAQ,CAAC;AAAA,QACT,OAAO,QAAQ,SAAS;AAAA,QACxB,oBAAoB,QAAQ;AAAA,MAChC;AAAA,MACA,MAAM,QAAQ,QAAQ,CAAC;AAAA,MACvB,gBAAgB,KAAK,KAAK;AAAA,MAC1B,QAAQ;AAAA,MACR;AAAA,MACA,YAAY,cAAc,IAAI;AAAA,IAClC;AACA,UAAM,SAAS,KAAK,WAAW,EAAE,MAAM,MAAM,IAAI,MAAM,QAAQ,IAAI,CAAC;AACpE,WAAO,aAAa,KAAK,MAAM;AAAA,EACnC;AAAA,EACA,YAAY,MAAM;AACd,UAAM,MAAM;AAAA,MACR,QAAQ;AAAA,QACJ,QAAQ,CAAC;AAAA,QACT,OAAO,CAAC,CAAC,KAAK,WAAW,EAAE;AAAA,MAC/B;AAAA,MACA,MAAM,CAAC;AAAA,MACP,gBAAgB,KAAK,KAAK;AAAA,MAC1B,QAAQ;AAAA,MACR;AAAA,MACA,YAAY,cAAc,IAAI;AAAA,IAClC;AACA,QAAI,CAAC,KAAK,WAAW,EAAE,OAAO;AAC1B,UAAI;AACA,cAAM,SAAS,KAAK,WAAW,EAAE,MAAM,MAAM,CAAC,GAAG,QAAQ,IAAI,CAAC;AAC9D,eAAO,QAAQ,MAAM,IACf;AAAA,UACE,OAAO,OAAO;AAAA,QAClB,IACE;AAAA,UACE,QAAQ,IAAI,OAAO;AAAA,QACvB;AAAA,MACR,SACO,KAAK;AACR,YAAI,KAAK,SAAS,YAAY,GAAG,SAAS,aAAa,GAAG;AACtD,eAAK,WAAW,EAAE,QAAQ;AAAA,QAC9B;AACA,YAAI,SAAS;AAAA,UACT,QAAQ,CAAC;AAAA,UACT,OAAO;AAAA,QACX;AAAA,MACJ;AAAA,IACJ;AACA,WAAO,KAAK,YAAY,EAAE,MAAM,MAAM,CAAC,GAAG,QAAQ,IAAI,CAAC,EAAE,KAAK,CAAC,WAAW,QAAQ,MAAM,IAClF;AAAA,MACE,OAAO,OAAO;AAAA,IAClB,IACE;AAAA,MACE,QAAQ,IAAI,OAAO;AAAA,IACvB,CAAC;AAAA,EACT;AAAA,EACA,MAAM,WAAW,MAAM,QAAQ;AAC3B,UAAM,SAAS,MAAM,KAAK,eAAe,MAAM,MAAM;AACrD,QAAI,OAAO;AACP,aAAO,OAAO;AAClB,UAAM,OAAO;AAAA,EACjB;AAAA,EACA,MAAM,eAAe,MAAM,QAAQ;AAC/B,UAAM,MAAM;AAAA,MACR,QAAQ;AAAA,QACJ,QAAQ,CAAC;AAAA,QACT,oBAAoB,QAAQ;AAAA,QAC5B,OAAO;AAAA,MACX;AAAA,MACA,MAAM,QAAQ,QAAQ,CAAC;AAAA,MACvB,gBAAgB,KAAK,KAAK;AAAA,MAC1B,QAAQ;AAAA,MACR;AAAA,MACA,YAAY,cAAc,IAAI;AAAA,IAClC;AACA,UAAM,mBAAmB,KAAK,OAAO,EAAE,MAAM,MAAM,IAAI,MAAM,QAAQ,IAAI,CAAC;AAC1E,UAAM,SAAS,OAAO,QAAQ,gBAAgB,IAAI,mBAAmB,QAAQ,QAAQ,gBAAgB;AACrG,WAAO,aAAa,KAAK,MAAM;AAAA,EACnC;AAAA,EACA,OAAO,OAAO,SAAS;AACnB,UAAM,qBAAqB,CAAC,QAAQ;AAChC,UAAI,OAAO,YAAY,YAAY,OAAO,YAAY,aAAa;AAC/D,eAAO,EAAE,QAAQ;AAAA,MACrB,WACS,OAAO,YAAY,YAAY;AACpC,eAAO,QAAQ,GAAG;AAAA,MACtB,OACK;AACD,eAAO;AAAA,MACX;AAAA,IACJ;AACA,WAAO,KAAK,YAAY,CAAC,KAAK,QAAQ;AAClC,YAAM,SAAS,MAAM,GAAG;AACxB,YAAM,WAAW,MAAM,IAAI,SAAS;AAAA,QAChC,MAAM,aAAa;AAAA,QACnB,GAAG,mBAAmB,GAAG;AAAA,MAC7B,CAAC;AACD,UAAI,OAAO,YAAY,eAAe,kBAAkB,SAAS;AAC7D,eAAO,OAAO,KAAK,CAAC,SAAS;AACzB,cAAI,CAAC,MAAM;AACP,qBAAS;AACT,mBAAO;AAAA,UACX,OACK;AACD,mBAAO;AAAA,UACX;AAAA,QACJ,CAAC;AAAA,MACL;AACA,UAAI,CAAC,QAAQ;AACT,iBAAS;AACT,eAAO;AAAA,MACX,OACK;AACD,eAAO;AAAA,MACX;AAAA,IACJ,CAAC;AAAA,EACL;AAAA,EACA,WAAW,OAAO,gBAAgB;AAC9B,WAAO,KAAK,YAAY,CAAC,KAAK,QAAQ;AAClC,UAAI,CAAC,MAAM,GAAG,GAAG;AACb,YAAI,SAAS,OAAO,mBAAmB,aAAa,eAAe,KAAK,GAAG,IAAI,cAAc;AAC7F,eAAO;AAAA,MACX,OACK;AACD,eAAO;AAAA,MACX;AAAA,IACJ,CAAC;AAAA,EACL;AAAA,EACA,YAAY,YAAY;AACpB,WAAO,IAAI,WAAW;AAAA,MAClB,QAAQ;AAAA,MACR,UAAU,sBAAsB;AAAA,MAChC,QAAQ,EAAE,MAAM,cAAc,WAAW;AAAA,IAC7C,CAAC;AAAA,EACL;AAAA,EACA,YAAY,YAAY;AACpB,WAAO,KAAK,YAAY,UAAU;AAAA,EACtC;AAAA,EACA,YAAY,KAAK;AAEb,SAAK,MAAM,KAAK;AAChB,SAAK,OAAO;AACZ,SAAK,QAAQ,KAAK,MAAM,KAAK,IAAI;AACjC,SAAK,YAAY,KAAK,UAAU,KAAK,IAAI;AACzC,SAAK,aAAa,KAAK,WAAW,KAAK,IAAI;AAC3C,SAAK,iBAAiB,KAAK,eAAe,KAAK,IAAI;AACnD,SAAK,MAAM,KAAK,IAAI,KAAK,IAAI;AAC7B,SAAK,SAAS,KAAK,OAAO,KAAK,IAAI;AACnC,SAAK,aAAa,KAAK,WAAW,KAAK,IAAI;AAC3C,SAAK,cAAc,KAAK,YAAY,KAAK,IAAI;AAC7C,SAAK,WAAW,KAAK,SAAS,KAAK,IAAI;AACvC,SAAK,WAAW,KAAK,SAAS,KAAK,IAAI;AACvC,SAAK,UAAU,KAAK,QAAQ,KAAK,IAAI;AACrC,SAAK,QAAQ,KAAK,MAAM,KAAK,IAAI;AACjC,SAAK,UAAU,KAAK,QAAQ,KAAK,IAAI;AACrC,SAAK,KAAK,KAAK,GAAG,KAAK,IAAI;AAC3B,SAAK,MAAM,KAAK,IAAI,KAAK,IAAI;AAC7B,SAAK,YAAY,KAAK,UAAU,KAAK,IAAI;AACzC,SAAK,QAAQ,KAAK,MAAM,KAAK,IAAI;AACjC,SAAK,UAAU,KAAK,QAAQ,KAAK,IAAI;AACrC,SAAK,QAAQ,KAAK,MAAM,KAAK,IAAI;AACjC,SAAK,WAAW,KAAK,SAAS,KAAK,IAAI;AACvC,SAAK,OAAO,KAAK,KAAK,KAAK,IAAI;AAC/B,SAAK,WAAW,KAAK,SAAS,KAAK,IAAI;AACvC,SAAK,aAAa,KAAK,WAAW,KAAK,IAAI;AAC3C,SAAK,aAAa,KAAK,WAAW,KAAK,IAAI;AAC3C,SAAK,WAAW,IAAI;AAAA,MAChB,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,UAAU,CAAC,SAAS,KAAK,WAAW,EAAE,IAAI;AAAA,IAC9C;AAAA,EACJ;AAAA,EACA,WAAW;AACP,WAAO,YAAY,OAAO,MAAM,KAAK,IAAI;AAAA,EAC7C;AAAA,EACA,WAAW;AACP,WAAO,YAAY,OAAO,MAAM,KAAK,IAAI;AAAA,EAC7C;AAAA,EACA,UAAU;AACN,WAAO,KAAK,SAAS,EAAE,SAAS;AAAA,EACpC;AAAA,EACA,QAAQ;AACJ,WAAO,SAAS,OAAO,IAAI;AAAA,EAC/B;AAAA,EACA,UAAU;AACN,WAAO,WAAW,OAAO,MAAM,KAAK,IAAI;AAAA,EAC5C;AAAA,EACA,GAAG,QAAQ;AACP,WAAO,SAAS,OAAO,CAAC,MAAM,MAAM,GAAG,KAAK,IAAI;AAAA,EACpD;AAAA,EACA,IAAI,UAAU;AACV,WAAO,gBAAgB,OAAO,MAAM,UAAU,KAAK,IAAI;AAAA,EAC3D;AAAA,EACA,UAAU,WAAW;AACjB,WAAO,IAAI,WAAW;AAAA,MAClB,GAAG,oBAAoB,KAAK,IAAI;AAAA,MAChC,QAAQ;AAAA,MACR,UAAU,sBAAsB;AAAA,MAChC,QAAQ,EAAE,MAAM,aAAa,UAAU;AAAA,IAC3C,CAAC;AAAA,EACL;AAAA,EACA,QAAQ,KAAK;AACT,UAAM,mBAAmB,OAAO,QAAQ,aAAa,MAAM,MAAM;AACjE,WAAO,IAAI,WAAW;AAAA,MAClB,GAAG,oBAAoB,KAAK,IAAI;AAAA,MAChC,WAAW;AAAA,MACX,cAAc;AAAA,MACd,UAAU,sBAAsB;AAAA,IACpC,CAAC;AAAA,EACL;AAAA,EACA,QAAQ;AACJ,WAAO,IAAI,WAAW;AAAA,MAClB,UAAU,sBAAsB;AAAA,MAChC,MAAM;AAAA,MACN,GAAG,oBAAoB,KAAK,IAAI;AAAA,IACpC,CAAC;AAAA,EACL;AAAA,EACA,MAAM,KAAK;AACP,UAAM,iBAAiB,OAAO,QAAQ,aAAa,MAAM,MAAM;AAC/D,WAAO,IAAI,SAAS;AAAA,MAChB,GAAG,oBAAoB,KAAK,IAAI;AAAA,MAChC,WAAW;AAAA,MACX,YAAY;AAAA,MACZ,UAAU,sBAAsB;AAAA,IACpC,CAAC;AAAA,EACL;AAAA,EACA,SAAS,aAAa;AAClB,UAAM,OAAO,KAAK;AAClB,WAAO,IAAI,KAAK;AAAA,MACZ,GAAG,KAAK;AAAA,MACR;AAAA,IACJ,CAAC;AAAA,EACL;AAAA,EACA,KAAK,QAAQ;AACT,WAAO,YAAY,OAAO,MAAM,MAAM;AAAA,EAC1C;AAAA,EACA,WAAW;AACP,WAAO,YAAY,OAAO,IAAI;AAAA,EAClC;AAAA,EACA,aAAa;AACT,WAAO,KAAK,UAAU,MAAS,EAAE;AAAA,EACrC;AAAA,EACA,aAAa;AACT,WAAO,KAAK,UAAU,IAAI,EAAE;AAAA,EAChC;AACJ;AACA,IAAM,YAAY;AAClB,IAAM,aAAa;AACnB,IAAM,YAAY;AAGlB,IAAM,YAAY;AAClB,IAAM,cAAc;AACpB,IAAM,WAAW;AACjB,IAAM,gBAAgB;AAatB,IAAM,aAAa;AAInB,IAAM,cAAc;AACpB,IAAI;AAEJ,IAAM,YAAY;AAClB,IAAM,gBAAgB;AAGtB,IAAM,YAAY;AAClB,IAAM,gBAAgB;AAEtB,IAAM,cAAc;AAEpB,IAAM,iBAAiB;AAMvB,IAAM,kBAAkB;AACxB,IAAM,YAAY,IAAI,OAAO,IAAI,eAAe,GAAG;AACnD,SAAS,gBAAgB,MAAM;AAC3B,MAAI,qBAAqB;AACzB,MAAI,KAAK,WAAW;AAChB,yBAAqB,GAAG,kBAAkB,UAAU,KAAK,SAAS;AAAA,EACtE,WACS,KAAK,aAAa,MAAM;AAC7B,yBAAqB,GAAG,kBAAkB;AAAA,EAC9C;AACA,QAAM,oBAAoB,KAAK,YAAY,MAAM;AACjD,SAAO,8BAA8B,kBAAkB,IAAI,iBAAiB;AAChF;AACA,SAAS,UAAU,MAAM;AACrB,SAAO,IAAI,OAAO,IAAI,gBAAgB,IAAI,CAAC,GAAG;AAClD;AAEO,SAAS,cAAc,MAAM;AAChC,MAAI,QAAQ,GAAG,eAAe,IAAI,gBAAgB,IAAI,CAAC;AACvD,QAAM,OAAO,CAAC;AACd,OAAK,KAAK,KAAK,QAAQ,OAAO,GAAG;AACjC,MAAI,KAAK;AACL,SAAK,KAAK,sBAAsB;AACpC,UAAQ,GAAG,KAAK,IAAI,KAAK,KAAK,GAAG,CAAC;AAClC,SAAO,IAAI,OAAO,IAAI,KAAK,GAAG;AAClC;AACA,SAAS,UAAU,IAAI,SAAS;AAC5B,OAAK,YAAY,QAAQ,CAAC,YAAY,UAAU,KAAK,EAAE,GAAG;AACtD,WAAO;AAAA,EACX;AACA,OAAK,YAAY,QAAQ,CAAC,YAAY,UAAU,KAAK,EAAE,GAAG;AACtD,WAAO;AAAA,EACX;AACA,SAAO;AACX;AACA,SAAS,WAAW,KAAK,KAAK;AAC1B,MAAI,CAAC,SAAS,KAAK,GAAG;AAClB,WAAO;AACX,MAAI;AACA,UAAM,CAAC,MAAM,IAAI,IAAI,MAAM,GAAG;AAC9B,QAAI,CAAC;AACD,aAAO;AAEX,UAAM,SAAS,OACV,QAAQ,MAAM,GAAG,EACjB,QAAQ,MAAM,GAAG,EACjB,OAAO,OAAO,UAAW,IAAK,OAAO,SAAS,KAAM,GAAI,GAAG;AAChE,UAAM,UAAU,KAAK,MAAM,KAAK,MAAM,CAAC;AACvC,QAAI,OAAO,YAAY,YAAY,YAAY;AAC3C,aAAO;AACX,QAAI,SAAS,WAAW,SAAS,QAAQ;AACrC,aAAO;AACX,QAAI,CAAC,QAAQ;AACT,aAAO;AACX,QAAI,OAAO,QAAQ,QAAQ;AACvB,aAAO;AACX,WAAO;AAAA,EACX,QACM;AACF,WAAO;AAAA,EACX;AACJ;AACA,SAAS,YAAY,IAAI,SAAS;AAC9B,OAAK,YAAY,QAAQ,CAAC,YAAY,cAAc,KAAK,EAAE,GAAG;AAC1D,WAAO;AAAA,EACX;AACA,OAAK,YAAY,QAAQ,CAAC,YAAY,cAAc,KAAK,EAAE,GAAG;AAC1D,WAAO;AAAA,EACX;AACA,SAAO;AACX;AACO,IAAM,YAAN,MAAM,mBAAkB,QAAQ;AAAA,EACnC,OAAO,OAAO;AACV,QAAI,KAAK,KAAK,QAAQ;AAClB,YAAM,OAAO,OAAO,MAAM,IAAI;AAAA,IAClC;AACA,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,QAAQ;AACrC,YAAMC,OAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkBA,MAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAUA,KAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,SAAS,IAAI,YAAY;AAC/B,QAAI,MAAM;AACV,eAAW,SAAS,KAAK,KAAK,QAAQ;AAClC,UAAI,MAAM,SAAS,OAAO;AACtB,YAAI,MAAM,KAAK,SAAS,MAAM,OAAO;AACjC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,YACf,MAAM;AAAA,YACN,WAAW;AAAA,YACX,OAAO;AAAA,YACP,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,OAAO;AAC3B,YAAI,MAAM,KAAK,SAAS,MAAM,OAAO;AACjC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,YACf,MAAM;AAAA,YACN,WAAW;AAAA,YACX,OAAO;AAAA,YACP,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,UAAU;AAC9B,cAAM,SAAS,MAAM,KAAK,SAAS,MAAM;AACzC,cAAM,WAAW,MAAM,KAAK,SAAS,MAAM;AAC3C,YAAI,UAAU,UAAU;AACpB,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,cAAI,QAAQ;AACR,8BAAkB,KAAK;AAAA,cACnB,MAAM,aAAa;AAAA,cACnB,SAAS,MAAM;AAAA,cACf,MAAM;AAAA,cACN,WAAW;AAAA,cACX,OAAO;AAAA,cACP,SAAS,MAAM;AAAA,YACnB,CAAC;AAAA,UACL,WACS,UAAU;AACf,8BAAkB,KAAK;AAAA,cACnB,MAAM,aAAa;AAAA,cACnB,SAAS,MAAM;AAAA,cACf,MAAM;AAAA,cACN,WAAW;AAAA,cACX,OAAO;AAAA,cACP,SAAS,MAAM;AAAA,YACnB,CAAC;AAAA,UACL;AACA,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,SAAS;AAC7B,YAAI,CAAC,WAAW,KAAK,MAAM,IAAI,GAAG;AAC9B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,SAAS;AAC7B,YAAI,CAAC,YAAY;AACb,uBAAa,IAAI,OAAO,aAAa,GAAG;AAAA,QAC5C;AACA,YAAI,CAAC,WAAW,KAAK,MAAM,IAAI,GAAG;AAC9B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,QAAQ;AAC5B,YAAI,CAAC,UAAU,KAAK,MAAM,IAAI,GAAG;AAC7B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,UAAU;AAC9B,YAAI,CAAC,YAAY,KAAK,MAAM,IAAI,GAAG;AAC/B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,QAAQ;AAC5B,YAAI,CAAC,UAAU,KAAK,MAAM,IAAI,GAAG;AAC7B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,SAAS;AAC7B,YAAI,CAAC,WAAW,KAAK,MAAM,IAAI,GAAG;AAC9B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,QAAQ;AAC5B,YAAI,CAAC,UAAU,KAAK,MAAM,IAAI,GAAG;AAC7B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,OAAO;AAC3B,YAAI;AACA,cAAI,IAAI,MAAM,IAAI;AAAA,QACtB,QACM;AACF,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,SAAS;AAC7B,cAAM,MAAM,YAAY;AACxB,cAAM,aAAa,MAAM,MAAM,KAAK,MAAM,IAAI;AAC9C,YAAI,CAAC,YAAY;AACb,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,QAAQ;AAC5B,cAAM,OAAO,MAAM,KAAK,KAAK;AAAA,MACjC,WACS,MAAM,SAAS,YAAY;AAChC,YAAI,CAAC,MAAM,KAAK,SAAS,MAAM,OAAO,MAAM,QAAQ,GAAG;AACnD,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY,EAAE,UAAU,MAAM,OAAO,UAAU,MAAM,SAAS;AAAA,YAC9D,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,eAAe;AACnC,cAAM,OAAO,MAAM,KAAK,YAAY;AAAA,MACxC,WACS,MAAM,SAAS,eAAe;AACnC,cAAM,OAAO,MAAM,KAAK,YAAY;AAAA,MACxC,WACS,MAAM,SAAS,cAAc;AAClC,YAAI,CAAC,MAAM,KAAK,WAAW,MAAM,KAAK,GAAG;AACrC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY,EAAE,YAAY,MAAM,MAAM;AAAA,YACtC,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,YAAY;AAChC,YAAI,CAAC,MAAM,KAAK,SAAS,MAAM,KAAK,GAAG;AACnC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY,EAAE,UAAU,MAAM,MAAM;AAAA,YACpC,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,YAAY;AAChC,cAAM,QAAQ,cAAc,KAAK;AACjC,YAAI,CAAC,MAAM,KAAK,MAAM,IAAI,GAAG;AACzB,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY;AAAA,YACZ,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,QAAQ;AAC5B,cAAM,QAAQ;AACd,YAAI,CAAC,MAAM,KAAK,MAAM,IAAI,GAAG;AACzB,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY;AAAA,YACZ,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,QAAQ;AAC5B,cAAM,QAAQ,UAAU,KAAK;AAC7B,YAAI,CAAC,MAAM,KAAK,MAAM,IAAI,GAAG;AACzB,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY;AAAA,YACZ,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,YAAY;AAChC,YAAI,CAAC,cAAc,KAAK,MAAM,IAAI,GAAG;AACjC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,MAAM;AAC1B,YAAI,CAAC,UAAU,MAAM,MAAM,MAAM,OAAO,GAAG;AACvC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,OAAO;AAC3B,YAAI,CAAC,WAAW,MAAM,MAAM,MAAM,GAAG,GAAG;AACpC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,QAAQ;AAC5B,YAAI,CAAC,YAAY,MAAM,MAAM,MAAM,OAAO,GAAG;AACzC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,UAAU;AAC9B,YAAI,CAAC,YAAY,KAAK,MAAM,IAAI,GAAG;AAC/B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,aAAa;AACjC,YAAI,CAAC,eAAe,KAAK,MAAM,IAAI,GAAG;AAClC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,YAAY;AAAA,YACZ,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,OACK;AACD,aAAK,YAAY,KAAK;AAAA,MAC1B;AAAA,IACJ;AACA,WAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,MAAM,KAAK;AAAA,EACrD;AAAA,EACA,OAAO,OAAO,YAAY,SAAS;AAC/B,WAAO,KAAK,WAAW,CAAC,SAAS,MAAM,KAAK,IAAI,GAAG;AAAA,MAC/C;AAAA,MACA,MAAM,aAAa;AAAA,MACnB,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA,EACA,UAAU,OAAO;AACb,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ,CAAC,GAAG,KAAK,KAAK,QAAQ,KAAK;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,MAAM,SAAS;AACX,WAAO,KAAK,UAAU,EAAE,MAAM,SAAS,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC3E;AAAA,EACA,IAAI,SAAS;AACT,WAAO,KAAK,UAAU,EAAE,MAAM,OAAO,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EACzE;AAAA,EACA,MAAM,SAAS;AACX,WAAO,KAAK,UAAU,EAAE,MAAM,SAAS,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC3E;AAAA,EACA,KAAK,SAAS;AACV,WAAO,KAAK,UAAU,EAAE,MAAM,QAAQ,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC1E;AAAA,EACA,OAAO,SAAS;AACZ,WAAO,KAAK,UAAU,EAAE,MAAM,UAAU,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC5E;AAAA,EACA,KAAK,SAAS;AACV,WAAO,KAAK,UAAU,EAAE,MAAM,QAAQ,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC1E;AAAA,EACA,MAAM,SAAS;AACX,WAAO,KAAK,UAAU,EAAE,MAAM,SAAS,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC3E;AAAA,EACA,KAAK,SAAS;AACV,WAAO,KAAK,UAAU,EAAE,MAAM,QAAQ,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC1E;AAAA,EACA,OAAO,SAAS;AACZ,WAAO,KAAK,UAAU,EAAE,MAAM,UAAU,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC5E;AAAA,EACA,UAAU,SAAS;AAEf,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,SAAS;AACT,WAAO,KAAK,UAAU,EAAE,MAAM,OAAO,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EACzE;AAAA,EACA,GAAG,SAAS;AACR,WAAO,KAAK,UAAU,EAAE,MAAM,MAAM,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EACxE;AAAA,EACA,KAAK,SAAS;AACV,WAAO,KAAK,UAAU,EAAE,MAAM,QAAQ,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC1E;AAAA,EACA,SAAS,SAAS;AACd,QAAI,OAAO,YAAY,UAAU;AAC7B,aAAO,KAAK,UAAU;AAAA,QAClB,MAAM;AAAA,QACN,WAAW;AAAA,QACX,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,SAAS;AAAA,MACb,CAAC;AAAA,IACL;AACA,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,WAAW,OAAO,SAAS,cAAc,cAAc,OAAO,SAAS;AAAA,MACvE,QAAQ,SAAS,UAAU;AAAA,MAC3B,OAAO,SAAS,SAAS;AAAA,MACzB,GAAG,UAAU,SAAS,SAAS,OAAO;AAAA,IAC1C,CAAC;AAAA,EACL;AAAA,EACA,KAAK,SAAS;AACV,WAAO,KAAK,UAAU,EAAE,MAAM,QAAQ,QAAQ,CAAC;AAAA,EACnD;AAAA,EACA,KAAK,SAAS;AACV,QAAI,OAAO,YAAY,UAAU;AAC7B,aAAO,KAAK,UAAU;AAAA,QAClB,MAAM;AAAA,QACN,WAAW;AAAA,QACX,SAAS;AAAA,MACb,CAAC;AAAA,IACL;AACA,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,WAAW,OAAO,SAAS,cAAc,cAAc,OAAO,SAAS;AAAA,MACvE,GAAG,UAAU,SAAS,SAAS,OAAO;AAAA,IAC1C,CAAC;AAAA,EACL;AAAA,EACA,SAAS,SAAS;AACd,WAAO,KAAK,UAAU,EAAE,MAAM,YAAY,GAAG,UAAU,SAAS,OAAO,EAAE,CAAC;AAAA,EAC9E;AAAA,EACA,MAAM,OAAO,SAAS;AAClB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN;AAAA,MACA,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA,EACA,SAAS,OAAO,SAAS;AACrB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN;AAAA,MACA,UAAU,SAAS;AAAA,MACnB,GAAG,UAAU,SAAS,SAAS,OAAO;AAAA,IAC1C,CAAC;AAAA,EACL;AAAA,EACA,WAAW,OAAO,SAAS;AACvB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN;AAAA,MACA,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA,EACA,SAAS,OAAO,SAAS;AACrB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN;AAAA,MACA,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,WAAW,SAAS;AACpB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,WAAW,SAAS;AACpB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA,EACA,OAAO,KAAK,SAAS;AACjB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,GAAG,UAAU,SAAS,OAAO;AAAA,IACjC,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA,EAIA,SAAS,SAAS;AACd,WAAO,KAAK,IAAI,GAAG,UAAU,SAAS,OAAO,CAAC;AAAA,EAClD;AAAA,EACA,OAAO;AACH,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ,CAAC,GAAG,KAAK,KAAK,QAAQ,EAAE,MAAM,OAAO,CAAC;AAAA,IAClD,CAAC;AAAA,EACL;AAAA,EACA,cAAc;AACV,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ,CAAC,GAAG,KAAK,KAAK,QAAQ,EAAE,MAAM,cAAc,CAAC;AAAA,IACzD,CAAC;AAAA,EACL;AAAA,EACA,cAAc;AACV,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ,CAAC,GAAG,KAAK,KAAK,QAAQ,EAAE,MAAM,cAAc,CAAC;AAAA,IACzD,CAAC;AAAA,EACL;AAAA,EACA,IAAI,aAAa;AACb,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,UAAU;AAAA,EACjE;AAAA,EACA,IAAI,SAAS;AACT,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,MAAM;AAAA,EAC7D;AAAA,EACA,IAAI,SAAS;AACT,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,MAAM;AAAA,EAC7D;AAAA,EACA,IAAI,aAAa;AACb,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,UAAU;AAAA,EACjE;AAAA,EACA,IAAI,UAAU;AACV,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,OAAO;AAAA,EAC9D;AAAA,EACA,IAAI,QAAQ;AACR,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,KAAK;AAAA,EAC5D;AAAA,EACA,IAAI,UAAU;AACV,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,OAAO;AAAA,EAC9D;AAAA,EACA,IAAI,SAAS;AACT,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,MAAM;AAAA,EAC7D;AAAA,EACA,IAAI,WAAW;AACX,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,QAAQ;AAAA,EAC/D;AAAA,EACA,IAAI,SAAS;AACT,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,MAAM;AAAA,EAC7D;AAAA,EACA,IAAI,UAAU;AACV,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,OAAO;AAAA,EAC9D;AAAA,EACA,IAAI,SAAS;AACT,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,MAAM;AAAA,EAC7D;AAAA,EACA,IAAI,OAAO;AACP,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,IAAI;AAAA,EAC3D;AAAA,EACA,IAAI,SAAS;AACT,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,MAAM;AAAA,EAC7D;AAAA,EACA,IAAI,WAAW;AACX,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,QAAQ;AAAA,EAC/D;AAAA,EACA,IAAI,cAAc;AAEd,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,WAAW;AAAA,EAClE;AAAA,EACA,IAAI,YAAY;AACZ,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAAA,EACA,IAAI,YAAY;AACZ,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AACJ;AACA,UAAU,SAAS,CAAC,WAAW;AAC3B,SAAO,IAAI,UAAU;AAAA,IACjB,QAAQ,CAAC;AAAA,IACT,UAAU,sBAAsB;AAAA,IAChC,QAAQ,QAAQ,UAAU;AAAA,IAC1B,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AAEA,SAAS,mBAAmB,KAAK,MAAM;AACnC,QAAM,eAAe,IAAI,SAAS,EAAE,MAAM,GAAG,EAAE,CAAC,KAAK,IAAI;AACzD,QAAM,gBAAgB,KAAK,SAAS,EAAE,MAAM,GAAG,EAAE,CAAC,KAAK,IAAI;AAC3D,QAAM,WAAW,cAAc,eAAe,cAAc;AAC5D,QAAM,SAAS,OAAO,SAAS,IAAI,QAAQ,QAAQ,EAAE,QAAQ,KAAK,EAAE,CAAC;AACrE,QAAM,UAAU,OAAO,SAAS,KAAK,QAAQ,QAAQ,EAAE,QAAQ,KAAK,EAAE,CAAC;AACvE,SAAQ,SAAS,UAAW,MAAM;AACtC;AACO,IAAM,YAAN,MAAM,mBAAkB,QAAQ;AAAA,EACnC,cAAc;AACV,UAAM,GAAG,SAAS;AAClB,SAAK,MAAM,KAAK;AAChB,SAAK,MAAM,KAAK;AAChB,SAAK,OAAO,KAAK;AAAA,EACrB;AAAA,EACA,OAAO,OAAO;AACV,QAAI,KAAK,KAAK,QAAQ;AAClB,YAAM,OAAO,OAAO,MAAM,IAAI;AAAA,IAClC;AACA,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,QAAQ;AACrC,YAAMA,OAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkBA,MAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAUA,KAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,MAAM;AACV,UAAM,SAAS,IAAI,YAAY;AAC/B,eAAW,SAAS,KAAK,KAAK,QAAQ;AAClC,UAAI,MAAM,SAAS,OAAO;AACtB,YAAI,CAAC,KAAK,UAAU,MAAM,IAAI,GAAG;AAC7B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,UAAU;AAAA,YACV,UAAU;AAAA,YACV,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,OAAO;AAC3B,cAAM,WAAW,MAAM,YAAY,MAAM,OAAO,MAAM,QAAQ,MAAM,QAAQ,MAAM;AAClF,YAAI,UAAU;AACV,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,YACf,MAAM;AAAA,YACN,WAAW,MAAM;AAAA,YACjB,OAAO;AAAA,YACP,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,OAAO;AAC3B,cAAM,SAAS,MAAM,YAAY,MAAM,OAAO,MAAM,QAAQ,MAAM,QAAQ,MAAM;AAChF,YAAI,QAAQ;AACR,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,YACf,MAAM;AAAA,YACN,WAAW,MAAM;AAAA,YACjB,OAAO;AAAA,YACP,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,cAAc;AAClC,YAAI,mBAAmB,MAAM,MAAM,MAAM,KAAK,MAAM,GAAG;AACnD,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY,MAAM;AAAA,YAClB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,UAAU;AAC9B,YAAI,CAAC,OAAO,SAAS,MAAM,IAAI,GAAG;AAC9B,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,OACK;AACD,aAAK,YAAY,KAAK;AAAA,MAC1B;AAAA,IACJ;AACA,WAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,MAAM,KAAK;AAAA,EACrD;AAAA,EACA,IAAI,OAAO,SAAS;AAChB,WAAO,KAAK,SAAS,OAAO,OAAO,MAAM,UAAU,SAAS,OAAO,CAAC;AAAA,EACxE;AAAA,EACA,GAAG,OAAO,SAAS;AACf,WAAO,KAAK,SAAS,OAAO,OAAO,OAAO,UAAU,SAAS,OAAO,CAAC;AAAA,EACzE;AAAA,EACA,IAAI,OAAO,SAAS;AAChB,WAAO,KAAK,SAAS,OAAO,OAAO,MAAM,UAAU,SAAS,OAAO,CAAC;AAAA,EACxE;AAAA,EACA,GAAG,OAAO,SAAS;AACf,WAAO,KAAK,SAAS,OAAO,OAAO,OAAO,UAAU,SAAS,OAAO,CAAC;AAAA,EACzE;AAAA,EACA,SAAS,MAAM,OAAO,WAAW,SAAS;AACtC,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ;AAAA,QACJ,GAAG,KAAK,KAAK;AAAA,QACb;AAAA,UACI;AAAA,UACA;AAAA,UACA;AAAA,UACA,SAAS,UAAU,SAAS,OAAO;AAAA,QACvC;AAAA,MACJ;AAAA,IACJ,CAAC;AAAA,EACL;AAAA,EACA,UAAU,OAAO;AACb,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ,CAAC,GAAG,KAAK,KAAK,QAAQ,KAAK;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,SAAS;AACT,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,SAAS,SAAS;AACd,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,SAAS,SAAS;AACd,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,YAAY,SAAS;AACjB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,YAAY,SAAS;AACjB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,WAAW,OAAO,SAAS;AACvB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN;AAAA,MACA,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,OAAO,SAAS;AACZ,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,KAAK,SAAS;AACV,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,WAAW;AAAA,MACX,OAAO,OAAO;AAAA,MACd,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC,EAAE,UAAU;AAAA,MACT,MAAM;AAAA,MACN,WAAW;AAAA,MACX,OAAO,OAAO;AAAA,MACd,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,WAAW;AACX,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAAA,EACA,IAAI,WAAW;AACX,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAAA,EACA,IAAI,QAAQ;AACR,WAAO,CAAC,CAAC,KAAK,KAAK,OAAO,KAAK,CAAC,OAAO,GAAG,SAAS,SAAU,GAAG,SAAS,gBAAgB,KAAK,UAAU,GAAG,KAAK,CAAE;AAAA,EACtH;AAAA,EACA,IAAI,WAAW;AACX,QAAI,MAAM;AACV,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,YAAY,GAAG,SAAS,SAAS,GAAG,SAAS,cAAc;AACvE,eAAO;AAAA,MACX,WACS,GAAG,SAAS,OAAO;AACxB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB,WACS,GAAG,SAAS,OAAO;AACxB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO,OAAO,SAAS,GAAG,KAAK,OAAO,SAAS,GAAG;AAAA,EACtD;AACJ;AACA,UAAU,SAAS,CAAC,WAAW;AAC3B,SAAO,IAAI,UAAU;AAAA,IACjB,QAAQ,CAAC;AAAA,IACT,UAAU,sBAAsB;AAAA,IAChC,QAAQ,QAAQ,UAAU;AAAA,IAC1B,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,YAAN,MAAM,mBAAkB,QAAQ;AAAA,EACnC,cAAc;AACV,UAAM,GAAG,SAAS;AAClB,SAAK,MAAM,KAAK;AAChB,SAAK,MAAM,KAAK;AAAA,EACpB;AAAA,EACA,OAAO,OAAO;AACV,QAAI,KAAK,KAAK,QAAQ;AAClB,UAAI;AACA,cAAM,OAAO,OAAO,MAAM,IAAI;AAAA,MAClC,QACM;AACF,eAAO,KAAK,iBAAiB,KAAK;AAAA,MACtC;AAAA,IACJ;AACA,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,QAAQ;AACrC,aAAO,KAAK,iBAAiB,KAAK;AAAA,IACtC;AACA,QAAI,MAAM;AACV,UAAM,SAAS,IAAI,YAAY;AAC/B,eAAW,SAAS,KAAK,KAAK,QAAQ;AAClC,UAAI,MAAM,SAAS,OAAO;AACtB,cAAM,WAAW,MAAM,YAAY,MAAM,OAAO,MAAM,QAAQ,MAAM,QAAQ,MAAM;AAClF,YAAI,UAAU;AACV,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,MAAM;AAAA,YACN,SAAS,MAAM;AAAA,YACf,WAAW,MAAM;AAAA,YACjB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,OAAO;AAC3B,cAAM,SAAS,MAAM,YAAY,MAAM,OAAO,MAAM,QAAQ,MAAM,QAAQ,MAAM;AAChF,YAAI,QAAQ;AACR,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,MAAM;AAAA,YACN,SAAS,MAAM;AAAA,YACf,WAAW,MAAM;AAAA,YACjB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,cAAc;AAClC,YAAI,MAAM,OAAO,MAAM,UAAU,OAAO,CAAC,GAAG;AACxC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,YAAY,MAAM;AAAA,YAClB,SAAS,MAAM;AAAA,UACnB,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,OACK;AACD,aAAK,YAAY,KAAK;AAAA,MAC1B;AAAA,IACJ;AACA,WAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,MAAM,KAAK;AAAA,EACrD;AAAA,EACA,iBAAiB,OAAO;AACpB,UAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,sBAAkB,KAAK;AAAA,MACnB,MAAM,aAAa;AAAA,MACnB,UAAU,cAAc;AAAA,MACxB,UAAU,IAAI;AAAA,IAClB,CAAC;AACD,WAAO;AAAA,EACX;AAAA,EACA,IAAI,OAAO,SAAS;AAChB,WAAO,KAAK,SAAS,OAAO,OAAO,MAAM,UAAU,SAAS,OAAO,CAAC;AAAA,EACxE;AAAA,EACA,GAAG,OAAO,SAAS;AACf,WAAO,KAAK,SAAS,OAAO,OAAO,OAAO,UAAU,SAAS,OAAO,CAAC;AAAA,EACzE;AAAA,EACA,IAAI,OAAO,SAAS;AAChB,WAAO,KAAK,SAAS,OAAO,OAAO,MAAM,UAAU,SAAS,OAAO,CAAC;AAAA,EACxE;AAAA,EACA,GAAG,OAAO,SAAS;AACf,WAAO,KAAK,SAAS,OAAO,OAAO,OAAO,UAAU,SAAS,OAAO,CAAC;AAAA,EACzE;AAAA,EACA,SAAS,MAAM,OAAO,WAAW,SAAS;AACtC,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ;AAAA,QACJ,GAAG,KAAK,KAAK;AAAA,QACb;AAAA,UACI;AAAA,UACA;AAAA,UACA;AAAA,UACA,SAAS,UAAU,SAAS,OAAO;AAAA,QACvC;AAAA,MACJ;AAAA,IACJ,CAAC;AAAA,EACL;AAAA,EACA,UAAU,OAAO;AACb,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,QAAQ,CAAC,GAAG,KAAK,KAAK,QAAQ,KAAK;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,SAAS,SAAS;AACd,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO,OAAO,CAAC;AAAA,MACf,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,SAAS,SAAS;AACd,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO,OAAO,CAAC;AAAA,MACf,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,YAAY,SAAS;AACjB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO,OAAO,CAAC;AAAA,MACf,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,YAAY,SAAS;AACjB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO,OAAO,CAAC;AAAA,MACf,WAAW;AAAA,MACX,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,WAAW,OAAO,SAAS;AACvB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN;AAAA,MACA,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,WAAW;AACX,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAAA,EACA,IAAI,WAAW;AACX,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AACJ;AACA,UAAU,SAAS,CAAC,WAAW;AAC3B,SAAO,IAAI,UAAU;AAAA,IACjB,QAAQ,CAAC;AAAA,IACT,UAAU,sBAAsB;AAAA,IAChC,QAAQ,QAAQ,UAAU;AAAA,IAC1B,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,aAAN,cAAyB,QAAQ;AAAA,EACpC,OAAO,OAAO;AACV,QAAI,KAAK,KAAK,QAAQ;AAClB,YAAM,OAAO,QAAQ,MAAM,IAAI;AAAA,IACnC;AACA,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,SAAS;AACtC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AACJ;AACA,WAAW,SAAS,CAAC,WAAW;AAC5B,SAAO,IAAI,WAAW;AAAA,IAClB,UAAU,sBAAsB;AAAA,IAChC,QAAQ,QAAQ,UAAU;AAAA,IAC1B,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,UAAN,MAAM,iBAAgB,QAAQ;AAAA,EACjC,OAAO,OAAO;AACV,QAAI,KAAK,KAAK,QAAQ;AAClB,YAAM,OAAO,IAAI,KAAK,MAAM,IAAI;AAAA,IACpC;AACA,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,MAAM;AACnC,YAAMA,OAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkBA,MAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAUA,KAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,OAAO,MAAM,MAAM,KAAK,QAAQ,CAAC,GAAG;AACpC,YAAMA,OAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkBA,MAAK;AAAA,QACnB,MAAM,aAAa;AAAA,MACvB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,SAAS,IAAI,YAAY;AAC/B,QAAI,MAAM;AACV,eAAW,SAAS,KAAK,KAAK,QAAQ;AAClC,UAAI,MAAM,SAAS,OAAO;AACtB,YAAI,MAAM,KAAK,QAAQ,IAAI,MAAM,OAAO;AACpC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,YACf,WAAW;AAAA,YACX,OAAO;AAAA,YACP,SAAS,MAAM;AAAA,YACf,MAAM;AAAA,UACV,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,MAAM,SAAS,OAAO;AAC3B,YAAI,MAAM,KAAK,QAAQ,IAAI,MAAM,OAAO;AACpC,gBAAM,KAAK,gBAAgB,OAAO,GAAG;AACrC,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,SAAS,MAAM;AAAA,YACf,WAAW;AAAA,YACX,OAAO;AAAA,YACP,SAAS,MAAM;AAAA,YACf,MAAM;AAAA,UACV,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,OACK;AACD,aAAK,YAAY,KAAK;AAAA,MAC1B;AAAA,IACJ;AACA,WAAO;AAAA,MACH,QAAQ,OAAO;AAAA,MACf,OAAO,IAAI,KAAK,MAAM,KAAK,QAAQ,CAAC;AAAA,IACxC;AAAA,EACJ;AAAA,EACA,UAAU,OAAO;AACb,WAAO,IAAI,SAAQ;AAAA,MACf,GAAG,KAAK;AAAA,MACR,QAAQ,CAAC,GAAG,KAAK,KAAK,QAAQ,KAAK;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,SAAS,SAAS;AAClB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO,QAAQ,QAAQ;AAAA,MACvB,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,SAAS,SAAS;AAClB,WAAO,KAAK,UAAU;AAAA,MAClB,MAAM;AAAA,MACN,OAAO,QAAQ,QAAQ;AAAA,MACvB,SAAS,UAAU,SAAS,OAAO;AAAA,IACvC,CAAC;AAAA,EACL;AAAA,EACA,IAAI,UAAU;AACV,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO,OAAO,OAAO,IAAI,KAAK,GAAG,IAAI;AAAA,EACzC;AAAA,EACA,IAAI,UAAU;AACV,QAAI,MAAM;AACV,eAAW,MAAM,KAAK,KAAK,QAAQ;AAC/B,UAAI,GAAG,SAAS,OAAO;AACnB,YAAI,QAAQ,QAAQ,GAAG,QAAQ;AAC3B,gBAAM,GAAG;AAAA,MACjB;AAAA,IACJ;AACA,WAAO,OAAO,OAAO,IAAI,KAAK,GAAG,IAAI;AAAA,EACzC;AACJ;AACA,QAAQ,SAAS,CAAC,WAAW;AACzB,SAAO,IAAI,QAAQ;AAAA,IACf,QAAQ,CAAC;AAAA,IACT,QAAQ,QAAQ,UAAU;AAAA,IAC1B,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,YAAN,cAAwB,QAAQ;AAAA,EACnC,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,QAAQ;AACrC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AACJ;AACA,UAAU,SAAS,CAAC,WAAW;AAC3B,SAAO,IAAI,UAAU;AAAA,IACjB,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,eAAN,cAA2B,QAAQ;AAAA,EACtC,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,WAAW;AACxC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AACJ;AACA,aAAa,SAAS,CAAC,WAAW;AAC9B,SAAO,IAAI,aAAa;AAAA,IACpB,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,UAAN,cAAsB,QAAQ;AAAA,EACjC,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,MAAM;AACnC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AACJ;AACA,QAAQ,SAAS,CAAC,WAAW;AACzB,SAAO,IAAI,QAAQ;AAAA,IACf,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,SAAN,cAAqB,QAAQ;AAAA,EAChC,cAAc;AACV,UAAM,GAAG,SAAS;AAElB,SAAK,OAAO;AAAA,EAChB;AAAA,EACA,OAAO,OAAO;AACV,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AACJ;AACA,OAAO,SAAS,CAAC,WAAW;AACxB,SAAO,IAAI,OAAO;AAAA,IACd,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,aAAN,cAAyB,QAAQ;AAAA,EACpC,cAAc;AACV,UAAM,GAAG,SAAS;AAElB,SAAK,WAAW;AAAA,EACpB;AAAA,EACA,OAAO,OAAO;AACV,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AACJ;AACA,WAAW,SAAS,CAAC,WAAW;AAC5B,SAAO,IAAI,WAAW;AAAA,IAClB,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,WAAN,cAAuB,QAAQ;AAAA,EAClC,OAAO,OAAO;AACV,UAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,sBAAkB,KAAK;AAAA,MACnB,MAAM,aAAa;AAAA,MACnB,UAAU,cAAc;AAAA,MACxB,UAAU,IAAI;AAAA,IAClB,CAAC;AACD,WAAO;AAAA,EACX;AACJ;AACA,SAAS,SAAS,CAAC,WAAW;AAC1B,SAAO,IAAI,SAAS;AAAA,IAChB,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,UAAN,cAAsB,QAAQ;AAAA,EACjC,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,WAAW;AACxC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AACJ;AACA,QAAQ,SAAS,CAAC,WAAW;AACzB,SAAO,IAAI,QAAQ;AAAA,IACf,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,WAAN,MAAM,kBAAiB,QAAQ;AAAA,EAClC,OAAO,OAAO;AACV,UAAM,EAAE,KAAK,OAAO,IAAI,KAAK,oBAAoB,KAAK;AACtD,UAAM,MAAM,KAAK;AACjB,QAAI,IAAI,eAAe,cAAc,OAAO;AACxC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,IAAI,gBAAgB,MAAM;AAC1B,YAAM,SAAS,IAAI,KAAK,SAAS,IAAI,YAAY;AACjD,YAAM,WAAW,IAAI,KAAK,SAAS,IAAI,YAAY;AACnD,UAAI,UAAU,UAAU;AACpB,0BAAkB,KAAK;AAAA,UACnB,MAAM,SAAS,aAAa,UAAU,aAAa;AAAA,UACnD,SAAU,WAAW,IAAI,YAAY,QAAQ;AAAA,UAC7C,SAAU,SAAS,IAAI,YAAY,QAAQ;AAAA,UAC3C,MAAM;AAAA,UACN,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS,IAAI,YAAY;AAAA,QAC7B,CAAC;AACD,eAAO,MAAM;AAAA,MACjB;AAAA,IACJ;AACA,QAAI,IAAI,cAAc,MAAM;AACxB,UAAI,IAAI,KAAK,SAAS,IAAI,UAAU,OAAO;AACvC,0BAAkB,KAAK;AAAA,UACnB,MAAM,aAAa;AAAA,UACnB,SAAS,IAAI,UAAU;AAAA,UACvB,MAAM;AAAA,UACN,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS,IAAI,UAAU;AAAA,QAC3B,CAAC;AACD,eAAO,MAAM;AAAA,MACjB;AAAA,IACJ;AACA,QAAI,IAAI,cAAc,MAAM;AACxB,UAAI,IAAI,KAAK,SAAS,IAAI,UAAU,OAAO;AACvC,0BAAkB,KAAK;AAAA,UACnB,MAAM,aAAa;AAAA,UACnB,SAAS,IAAI,UAAU;AAAA,UACvB,MAAM;AAAA,UACN,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS,IAAI,UAAU;AAAA,QAC3B,CAAC;AACD,eAAO,MAAM;AAAA,MACjB;AAAA,IACJ;AACA,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,QAAQ,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE,IAAI,CAAC,MAAM,MAAM;AAC9C,eAAO,IAAI,KAAK,YAAY,IAAI,mBAAmB,KAAK,MAAM,IAAI,MAAM,CAAC,CAAC;AAAA,MAC9E,CAAC,CAAC,EAAE,KAAK,CAACC,YAAW;AACjB,eAAO,YAAY,WAAW,QAAQA,OAAM;AAAA,MAChD,CAAC;AAAA,IACL;AACA,UAAM,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,IAAI,CAAC,MAAM,MAAM;AAC1C,aAAO,IAAI,KAAK,WAAW,IAAI,mBAAmB,KAAK,MAAM,IAAI,MAAM,CAAC,CAAC;AAAA,IAC7E,CAAC;AACD,WAAO,YAAY,WAAW,QAAQ,MAAM;AAAA,EAChD;AAAA,EACA,IAAI,UAAU;AACV,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,IAAI,WAAW,SAAS;AACpB,WAAO,IAAI,UAAS;AAAA,MAChB,GAAG,KAAK;AAAA,MACR,WAAW,EAAE,OAAO,WAAW,SAAS,UAAU,SAAS,OAAO,EAAE;AAAA,IACxE,CAAC;AAAA,EACL;AAAA,EACA,IAAI,WAAW,SAAS;AACpB,WAAO,IAAI,UAAS;AAAA,MAChB,GAAG,KAAK;AAAA,MACR,WAAW,EAAE,OAAO,WAAW,SAAS,UAAU,SAAS,OAAO,EAAE;AAAA,IACxE,CAAC;AAAA,EACL;AAAA,EACA,OAAO,KAAK,SAAS;AACjB,WAAO,IAAI,UAAS;AAAA,MAChB,GAAG,KAAK;AAAA,MACR,aAAa,EAAE,OAAO,KAAK,SAAS,UAAU,SAAS,OAAO,EAAE;AAAA,IACpE,CAAC;AAAA,EACL;AAAA,EACA,SAAS,SAAS;AACd,WAAO,KAAK,IAAI,GAAG,OAAO;AAAA,EAC9B;AACJ;AACA,SAAS,SAAS,CAAC,QAAQ,WAAW;AAClC,SAAO,IAAI,SAAS;AAAA,IAChB,MAAM;AAAA,IACN,WAAW;AAAA,IACX,WAAW;AAAA,IACX,aAAa;AAAA,IACb,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACA,SAAS,eAAe,QAAQ;AAC5B,MAAI,kBAAkB,WAAW;AAC7B,UAAM,WAAW,CAAC;AAClB,eAAW,OAAO,OAAO,OAAO;AAC5B,YAAM,cAAc,OAAO,MAAM,GAAG;AACpC,eAAS,GAAG,IAAI,YAAY,OAAO,eAAe,WAAW,CAAC;AAAA,IAClE;AACA,WAAO,IAAI,UAAU;AAAA,MACjB,GAAG,OAAO;AAAA,MACV,OAAO,MAAM;AAAA,IACjB,CAAC;AAAA,EACL,WACS,kBAAkB,UAAU;AACjC,WAAO,IAAI,SAAS;AAAA,MAChB,GAAG,OAAO;AAAA,MACV,MAAM,eAAe,OAAO,OAAO;AAAA,IACvC,CAAC;AAAA,EACL,WACS,kBAAkB,aAAa;AACpC,WAAO,YAAY,OAAO,eAAe,OAAO,OAAO,CAAC,CAAC;AAAA,EAC7D,WACS,kBAAkB,aAAa;AACpC,WAAO,YAAY,OAAO,eAAe,OAAO,OAAO,CAAC,CAAC;AAAA,EAC7D,WACS,kBAAkB,UAAU;AACjC,WAAO,SAAS,OAAO,OAAO,MAAM,IAAI,CAAC,SAAS,eAAe,IAAI,CAAC,CAAC;AAAA,EAC3E,OACK;AACD,WAAO;AAAA,EACX;AACJ;AACO,IAAM,YAAN,MAAM,mBAAkB,QAAQ;AAAA,EACnC,cAAc;AACV,UAAM,GAAG,SAAS;AAClB,SAAK,UAAU;AAKf,SAAK,YAAY,KAAK;AAqCtB,SAAK,UAAU,KAAK;AAAA,EACxB;AAAA,EACA,aAAa;AACT,QAAI,KAAK,YAAY;AACjB,aAAO,KAAK;AAChB,UAAM,QAAQ,KAAK,KAAK,MAAM;AAC9B,UAAM,OAAO,KAAK,WAAW,KAAK;AAClC,SAAK,UAAU,EAAE,OAAO,KAAK;AAC7B,WAAO,KAAK;AAAA,EAChB;AAAA,EACA,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,QAAQ;AACrC,YAAMD,OAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkBA,MAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAUA,KAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,UAAM,EAAE,OAAO,MAAM,UAAU,IAAI,KAAK,WAAW;AACnD,UAAM,YAAY,CAAC;AACnB,QAAI,EAAE,KAAK,KAAK,oBAAoB,YAAY,KAAK,KAAK,gBAAgB,UAAU;AAChF,iBAAW,OAAO,IAAI,MAAM;AACxB,YAAI,CAAC,UAAU,SAAS,GAAG,GAAG;AAC1B,oBAAU,KAAK,GAAG;AAAA,QACtB;AAAA,MACJ;AAAA,IACJ;AACA,UAAM,QAAQ,CAAC;AACf,eAAW,OAAO,WAAW;AACzB,YAAM,eAAe,MAAM,GAAG;AAC9B,YAAM,QAAQ,IAAI,KAAK,GAAG;AAC1B,YAAM,KAAK;AAAA,QACP,KAAK,EAAE,QAAQ,SAAS,OAAO,IAAI;AAAA,QACnC,OAAO,aAAa,OAAO,IAAI,mBAAmB,KAAK,OAAO,IAAI,MAAM,GAAG,CAAC;AAAA,QAC5E,WAAW,OAAO,IAAI;AAAA,MAC1B,CAAC;AAAA,IACL;AACA,QAAI,KAAK,KAAK,oBAAoB,UAAU;AACxC,YAAM,cAAc,KAAK,KAAK;AAC9B,UAAI,gBAAgB,eAAe;AAC/B,mBAAW,OAAO,WAAW;AACzB,gBAAM,KAAK;AAAA,YACP,KAAK,EAAE,QAAQ,SAAS,OAAO,IAAI;AAAA,YACnC,OAAO,EAAE,QAAQ,SAAS,OAAO,IAAI,KAAK,GAAG,EAAE;AAAA,UACnD,CAAC;AAAA,QACL;AAAA,MACJ,WACS,gBAAgB,UAAU;AAC/B,YAAI,UAAU,SAAS,GAAG;AACtB,4BAAkB,KAAK;AAAA,YACnB,MAAM,aAAa;AAAA,YACnB,MAAM;AAAA,UACV,CAAC;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ,WACS,gBAAgB,SAAS;AAAA,MAClC,OACK;AACD,cAAM,IAAI,MAAM,sDAAsD;AAAA,MAC1E;AAAA,IACJ,OACK;AAED,YAAM,WAAW,KAAK,KAAK;AAC3B,iBAAW,OAAO,WAAW;AACzB,cAAM,QAAQ,IAAI,KAAK,GAAG;AAC1B,cAAM,KAAK;AAAA,UACP,KAAK,EAAE,QAAQ,SAAS,OAAO,IAAI;AAAA,UACnC,OAAO,SAAS;AAAA,YAAO,IAAI,mBAAmB,KAAK,OAAO,IAAI,MAAM,GAAG;AAAA;AAAA,UACvE;AAAA,UACA,WAAW,OAAO,IAAI;AAAA,QAC1B,CAAC;AAAA,MACL;AAAA,IACJ;AACA,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,QAAQ,QAAQ,EAClB,KAAK,YAAY;AAClB,cAAM,YAAY,CAAC;AACnB,mBAAW,QAAQ,OAAO;AACtB,gBAAM,MAAM,MAAM,KAAK;AACvB,gBAAM,QAAQ,MAAM,KAAK;AACzB,oBAAU,KAAK;AAAA,YACX;AAAA,YACA;AAAA,YACA,WAAW,KAAK;AAAA,UACpB,CAAC;AAAA,QACL;AACA,eAAO;AAAA,MACX,CAAC,EACI,KAAK,CAAC,cAAc;AACrB,eAAO,YAAY,gBAAgB,QAAQ,SAAS;AAAA,MACxD,CAAC;AAAA,IACL,OACK;AACD,aAAO,YAAY,gBAAgB,QAAQ,KAAK;AAAA,IACpD;AAAA,EACJ;AAAA,EACA,IAAI,QAAQ;AACR,WAAO,KAAK,KAAK,MAAM;AAAA,EAC3B;AAAA,EACA,OAAO,SAAS;AACZ,cAAU;AACV,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,aAAa;AAAA,MACb,GAAI,YAAY,SACV;AAAA,QACE,UAAU,CAAC,OAAO,QAAQ;AACtB,gBAAM,eAAe,KAAK,KAAK,WAAW,OAAO,GAAG,EAAE,WAAW,IAAI;AACrE,cAAI,MAAM,SAAS;AACf,mBAAO;AAAA,cACH,SAAS,UAAU,SAAS,OAAO,EAAE,WAAW;AAAA,YACpD;AACJ,iBAAO;AAAA,YACH,SAAS;AAAA,UACb;AAAA,QACJ;AAAA,MACJ,IACE,CAAC;AAAA,IACX,CAAC;AAAA,EACL;AAAA,EACA,QAAQ;AACJ,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,aAAa;AAAA,IACjB,CAAC;AAAA,EACL;AAAA,EACA,cAAc;AACV,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,aAAa;AAAA,IACjB,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,OAAO,cAAc;AACjB,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,OAAO,OAAO;AAAA,QACV,GAAG,KAAK,KAAK,MAAM;AAAA,QACnB,GAAG;AAAA,MACP;AAAA,IACJ,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,SAAS;AACX,UAAM,SAAS,IAAI,WAAU;AAAA,MACzB,aAAa,QAAQ,KAAK;AAAA,MAC1B,UAAU,QAAQ,KAAK;AAAA,MACvB,OAAO,OAAO;AAAA,QACV,GAAG,KAAK,KAAK,MAAM;AAAA,QACnB,GAAG,QAAQ,KAAK,MAAM;AAAA,MAC1B;AAAA,MACA,UAAU,sBAAsB;AAAA,IACpC,CAAC;AACD,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoCA,OAAO,KAAK,QAAQ;AAChB,WAAO,KAAK,QAAQ,EAAE,CAAC,GAAG,GAAG,OAAO,CAAC;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBA,SAAS,OAAO;AACZ,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,UAAU;AAAA,IACd,CAAC;AAAA,EACL;AAAA,EACA,KAAK,MAAM;AACP,UAAM,QAAQ,CAAC;AACf,eAAW,OAAO,KAAK,WAAW,IAAI,GAAG;AACrC,UAAI,KAAK,GAAG,KAAK,KAAK,MAAM,GAAG,GAAG;AAC9B,cAAM,GAAG,IAAI,KAAK,MAAM,GAAG;AAAA,MAC/B;AAAA,IACJ;AACA,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,OAAO,MAAM;AAAA,IACjB,CAAC;AAAA,EACL;AAAA,EACA,KAAK,MAAM;AACP,UAAM,QAAQ,CAAC;AACf,eAAW,OAAO,KAAK,WAAW,KAAK,KAAK,GAAG;AAC3C,UAAI,CAAC,KAAK,GAAG,GAAG;AACZ,cAAM,GAAG,IAAI,KAAK,MAAM,GAAG;AAAA,MAC/B;AAAA,IACJ;AACA,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,OAAO,MAAM;AAAA,IACjB,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA,EAIA,cAAc;AACV,WAAO,eAAe,IAAI;AAAA,EAC9B;AAAA,EACA,QAAQ,MAAM;AACV,UAAM,WAAW,CAAC;AAClB,eAAW,OAAO,KAAK,WAAW,KAAK,KAAK,GAAG;AAC3C,YAAM,cAAc,KAAK,MAAM,GAAG;AAClC,UAAI,QAAQ,CAAC,KAAK,GAAG,GAAG;AACpB,iBAAS,GAAG,IAAI;AAAA,MACpB,OACK;AACD,iBAAS,GAAG,IAAI,YAAY,SAAS;AAAA,MACzC;AAAA,IACJ;AACA,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,OAAO,MAAM;AAAA,IACjB,CAAC;AAAA,EACL;AAAA,EACA,SAAS,MAAM;AACX,UAAM,WAAW,CAAC;AAClB,eAAW,OAAO,KAAK,WAAW,KAAK,KAAK,GAAG;AAC3C,UAAI,QAAQ,CAAC,KAAK,GAAG,GAAG;AACpB,iBAAS,GAAG,IAAI,KAAK,MAAM,GAAG;AAAA,MAClC,OACK;AACD,cAAM,cAAc,KAAK,MAAM,GAAG;AAClC,YAAI,WAAW;AACf,eAAO,oBAAoB,aAAa;AACpC,qBAAW,SAAS,KAAK;AAAA,QAC7B;AACA,iBAAS,GAAG,IAAI;AAAA,MACpB;AAAA,IACJ;AACA,WAAO,IAAI,WAAU;AAAA,MACjB,GAAG,KAAK;AAAA,MACR,OAAO,MAAM;AAAA,IACjB,CAAC;AAAA,EACL;AAAA,EACA,QAAQ;AACJ,WAAO,cAAc,KAAK,WAAW,KAAK,KAAK,CAAC;AAAA,EACpD;AACJ;AACA,UAAU,SAAS,CAAC,OAAO,WAAW;AAClC,SAAO,IAAI,UAAU;AAAA,IACjB,OAAO,MAAM;AAAA,IACb,aAAa;AAAA,IACb,UAAU,SAAS,OAAO;AAAA,IAC1B,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACA,UAAU,eAAe,CAAC,OAAO,WAAW;AACxC,SAAO,IAAI,UAAU;AAAA,IACjB,OAAO,MAAM;AAAA,IACb,aAAa;AAAA,IACb,UAAU,SAAS,OAAO;AAAA,IAC1B,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACA,UAAU,aAAa,CAAC,OAAO,WAAW;AACtC,SAAO,IAAI,UAAU;AAAA,IACjB;AAAA,IACA,aAAa;AAAA,IACb,UAAU,SAAS,OAAO;AAAA,IAC1B,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,WAAN,cAAuB,QAAQ;AAAA,EAClC,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAC9C,UAAM,UAAU,KAAK,KAAK;AAC1B,aAAS,cAAc,SAAS;AAE5B,iBAAW,UAAU,SAAS;AAC1B,YAAI,OAAO,OAAO,WAAW,SAAS;AAClC,iBAAO,OAAO;AAAA,QAClB;AAAA,MACJ;AACA,iBAAW,UAAU,SAAS;AAC1B,YAAI,OAAO,OAAO,WAAW,SAAS;AAElC,cAAI,OAAO,OAAO,KAAK,GAAG,OAAO,IAAI,OAAO,MAAM;AAClD,iBAAO,OAAO;AAAA,QAClB;AAAA,MACJ;AAEA,YAAM,cAAc,QAAQ,IAAI,CAAC,WAAW,IAAI,SAAS,OAAO,IAAI,OAAO,MAAM,CAAC;AAClF,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB;AAAA,MACJ,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,QAAQ,IAAI,QAAQ,IAAI,OAAO,WAAW;AAC7C,cAAM,WAAW;AAAA,UACb,GAAG;AAAA,UACH,QAAQ;AAAA,YACJ,GAAG,IAAI;AAAA,YACP,QAAQ,CAAC;AAAA,UACb;AAAA,UACA,QAAQ;AAAA,QACZ;AACA,eAAO;AAAA,UACH,QAAQ,MAAM,OAAO,YAAY;AAAA,YAC7B,MAAM,IAAI;AAAA,YACV,MAAM,IAAI;AAAA,YACV,QAAQ;AAAA,UACZ,CAAC;AAAA,UACD,KAAK;AAAA,QACT;AAAA,MACJ,CAAC,CAAC,EAAE,KAAK,aAAa;AAAA,IAC1B,OACK;AACD,UAAI,QAAQ;AACZ,YAAM,SAAS,CAAC;AAChB,iBAAW,UAAU,SAAS;AAC1B,cAAM,WAAW;AAAA,UACb,GAAG;AAAA,UACH,QAAQ;AAAA,YACJ,GAAG,IAAI;AAAA,YACP,QAAQ,CAAC;AAAA,UACb;AAAA,UACA,QAAQ;AAAA,QACZ;AACA,cAAM,SAAS,OAAO,WAAW;AAAA,UAC7B,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AACD,YAAI,OAAO,WAAW,SAAS;AAC3B,iBAAO;AAAA,QACX,WACS,OAAO,WAAW,WAAW,CAAC,OAAO;AAC1C,kBAAQ,EAAE,QAAQ,KAAK,SAAS;AAAA,QACpC;AACA,YAAI,SAAS,OAAO,OAAO,QAAQ;AAC/B,iBAAO,KAAK,SAAS,OAAO,MAAM;AAAA,QACtC;AAAA,MACJ;AACA,UAAI,OAAO;AACP,YAAI,OAAO,OAAO,KAAK,GAAG,MAAM,IAAI,OAAO,MAAM;AACjD,eAAO,MAAM;AAAA,MACjB;AACA,YAAM,cAAc,OAAO,IAAI,CAACE,YAAW,IAAI,SAASA,OAAM,CAAC;AAC/D,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB;AAAA,MACJ,CAAC;AACD,aAAO;AAAA,IACX;AAAA,EACJ;AAAA,EACA,IAAI,UAAU;AACV,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,SAAS,SAAS,CAAC,OAAO,WAAW;AACjC,SAAO,IAAI,SAAS;AAAA,IAChB,SAAS;AAAA,IACT,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AAQA,IAAM,mBAAmB,CAAC,SAAS;AAC/B,MAAI,gBAAgB,SAAS;AACzB,WAAO,iBAAiB,KAAK,MAAM;AAAA,EACvC,WACS,gBAAgB,YAAY;AACjC,WAAO,iBAAiB,KAAK,UAAU,CAAC;AAAA,EAC5C,WACS,gBAAgB,YAAY;AACjC,WAAO,CAAC,KAAK,KAAK;AAAA,EACtB,WACS,gBAAgB,SAAS;AAC9B,WAAO,KAAK;AAAA,EAChB,WACS,gBAAgB,eAAe;AAEpC,WAAO,KAAK,aAAa,KAAK,IAAI;AAAA,EACtC,WACS,gBAAgB,YAAY;AACjC,WAAO,iBAAiB,KAAK,KAAK,SAAS;AAAA,EAC/C,WACS,gBAAgB,cAAc;AACnC,WAAO,CAAC,MAAS;AAAA,EACrB,WACS,gBAAgB,SAAS;AAC9B,WAAO,CAAC,IAAI;AAAA,EAChB,WACS,gBAAgB,aAAa;AAClC,WAAO,CAAC,QAAW,GAAG,iBAAiB,KAAK,OAAO,CAAC,CAAC;AAAA,EACzD,WACS,gBAAgB,aAAa;AAClC,WAAO,CAAC,MAAM,GAAG,iBAAiB,KAAK,OAAO,CAAC,CAAC;AAAA,EACpD,WACS,gBAAgB,YAAY;AACjC,WAAO,iBAAiB,KAAK,OAAO,CAAC;AAAA,EACzC,WACS,gBAAgB,aAAa;AAClC,WAAO,iBAAiB,KAAK,OAAO,CAAC;AAAA,EACzC,WACS,gBAAgB,UAAU;AAC/B,WAAO,iBAAiB,KAAK,KAAK,SAAS;AAAA,EAC/C,OACK;AACD,WAAO,CAAC;AAAA,EACZ;AACJ;AACO,IAAM,wBAAN,MAAM,+BAA8B,QAAQ;AAAA,EAC/C,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAC9C,QAAI,IAAI,eAAe,cAAc,QAAQ;AACzC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,gBAAgB,KAAK;AAC3B,UAAM,qBAAqB,IAAI,KAAK,aAAa;AACjD,UAAM,SAAS,KAAK,WAAW,IAAI,kBAAkB;AACrD,QAAI,CAAC,QAAQ;AACT,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,SAAS,MAAM,KAAK,KAAK,WAAW,KAAK,CAAC;AAAA,QAC1C,MAAM,CAAC,aAAa;AAAA,MACxB,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,OAAO,YAAY;AAAA,QACtB,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,QAAQ;AAAA,MACZ,CAAC;AAAA,IACL,OACK;AACD,aAAO,OAAO,WAAW;AAAA,QACrB,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,QAAQ;AAAA,MACZ,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EACA,IAAI,gBAAgB;AAChB,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,IAAI,UAAU;AACV,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,IAAI,aAAa;AACb,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,OAAO,OAAO,eAAe,SAAS,QAAQ;AAE1C,UAAM,aAAa,oBAAI,IAAI;AAE3B,eAAW,QAAQ,SAAS;AACxB,YAAM,sBAAsB,iBAAiB,KAAK,MAAM,aAAa,CAAC;AACtE,UAAI,CAAC,oBAAoB,QAAQ;AAC7B,cAAM,IAAI,MAAM,mCAAmC,aAAa,mDAAmD;AAAA,MACvH;AACA,iBAAW,SAAS,qBAAqB;AACrC,YAAI,WAAW,IAAI,KAAK,GAAG;AACvB,gBAAM,IAAI,MAAM,0BAA0B,OAAO,aAAa,CAAC,wBAAwB,OAAO,KAAK,CAAC,EAAE;AAAA,QAC1G;AACA,mBAAW,IAAI,OAAO,IAAI;AAAA,MAC9B;AAAA,IACJ;AACA,WAAO,IAAI,uBAAsB;AAAA,MAC7B,UAAU,sBAAsB;AAAA,MAChC;AAAA,MACA;AAAA,MACA;AAAA,MACA,GAAG,oBAAoB,MAAM;AAAA,IACjC,CAAC;AAAA,EACL;AACJ;AACA,SAAS,YAAY,GAAG,GAAG;AACvB,QAAM,QAAQ,cAAc,CAAC;AAC7B,QAAM,QAAQ,cAAc,CAAC;AAC7B,MAAI,MAAM,GAAG;AACT,WAAO,EAAE,OAAO,MAAM,MAAM,EAAE;AAAA,EAClC,WACS,UAAU,cAAc,UAAU,UAAU,cAAc,QAAQ;AACvE,UAAM,QAAQ,KAAK,WAAW,CAAC;AAC/B,UAAM,aAAa,KAAK,WAAW,CAAC,EAAE,OAAO,CAAC,QAAQ,MAAM,QAAQ,GAAG,MAAM,EAAE;AAC/E,UAAM,SAAS,EAAE,GAAG,GAAG,GAAG,EAAE;AAC5B,eAAW,OAAO,YAAY;AAC1B,YAAM,cAAc,YAAY,EAAE,GAAG,GAAG,EAAE,GAAG,CAAC;AAC9C,UAAI,CAAC,YAAY,OAAO;AACpB,eAAO,EAAE,OAAO,MAAM;AAAA,MAC1B;AACA,aAAO,GAAG,IAAI,YAAY;AAAA,IAC9B;AACA,WAAO,EAAE,OAAO,MAAM,MAAM,OAAO;AAAA,EACvC,WACS,UAAU,cAAc,SAAS,UAAU,cAAc,OAAO;AACrE,QAAI,EAAE,WAAW,EAAE,QAAQ;AACvB,aAAO,EAAE,OAAO,MAAM;AAAA,IAC1B;AACA,UAAM,WAAW,CAAC;AAClB,aAAS,QAAQ,GAAG,QAAQ,EAAE,QAAQ,SAAS;AAC3C,YAAM,QAAQ,EAAE,KAAK;AACrB,YAAM,QAAQ,EAAE,KAAK;AACrB,YAAM,cAAc,YAAY,OAAO,KAAK;AAC5C,UAAI,CAAC,YAAY,OAAO;AACpB,eAAO,EAAE,OAAO,MAAM;AAAA,MAC1B;AACA,eAAS,KAAK,YAAY,IAAI;AAAA,IAClC;AACA,WAAO,EAAE,OAAO,MAAM,MAAM,SAAS;AAAA,EACzC,WACS,UAAU,cAAc,QAAQ,UAAU,cAAc,QAAQ,CAAC,MAAM,CAAC,GAAG;AAChF,WAAO,EAAE,OAAO,MAAM,MAAM,EAAE;AAAA,EAClC,OACK;AACD,WAAO,EAAE,OAAO,MAAM;AAAA,EAC1B;AACJ;AACO,IAAM,kBAAN,cAA8B,QAAQ;AAAA,EACzC,OAAO,OAAO;AACV,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,UAAM,eAAe,CAAC,YAAY,gBAAgB;AAC9C,UAAI,UAAU,UAAU,KAAK,UAAU,WAAW,GAAG;AACjD,eAAO;AAAA,MACX;AACA,YAAM,SAAS,YAAY,WAAW,OAAO,YAAY,KAAK;AAC9D,UAAI,CAAC,OAAO,OAAO;AACf,0BAAkB,KAAK;AAAA,UACnB,MAAM,aAAa;AAAA,QACvB,CAAC;AACD,eAAO;AAAA,MACX;AACA,UAAI,QAAQ,UAAU,KAAK,QAAQ,WAAW,GAAG;AAC7C,eAAO,MAAM;AAAA,MACjB;AACA,aAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,OAAO,KAAK;AAAA,IACtD;AACA,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,QAAQ,IAAI;AAAA,QACf,KAAK,KAAK,KAAK,YAAY;AAAA,UACvB,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AAAA,QACD,KAAK,KAAK,MAAM,YAAY;AAAA,UACxB,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AAAA,MACL,CAAC,EAAE,KAAK,CAAC,CAAC,MAAM,KAAK,MAAM,aAAa,MAAM,KAAK,CAAC;AAAA,IACxD,OACK;AACD,aAAO,aAAa,KAAK,KAAK,KAAK,WAAW;AAAA,QAC1C,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,QAAQ;AAAA,MACZ,CAAC,GAAG,KAAK,KAAK,MAAM,WAAW;AAAA,QAC3B,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,QAAQ;AAAA,MACZ,CAAC,CAAC;AAAA,IACN;AAAA,EACJ;AACJ;AACA,gBAAgB,SAAS,CAAC,MAAM,OAAO,WAAW;AAC9C,SAAO,IAAI,gBAAgB;AAAA,IACvB;AAAA,IACA;AAAA,IACA,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AAEO,IAAM,WAAN,MAAM,kBAAiB,QAAQ;AAAA,EAClC,OAAO,OAAO;AACV,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,QAAI,IAAI,eAAe,cAAc,OAAO;AACxC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,IAAI,KAAK,SAAS,KAAK,KAAK,MAAM,QAAQ;AAC1C,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,SAAS,KAAK,KAAK,MAAM;AAAA,QACzB,WAAW;AAAA,QACX,OAAO;AAAA,QACP,MAAM;AAAA,MACV,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,OAAO,KAAK,KAAK;AACvB,QAAI,CAAC,QAAQ,IAAI,KAAK,SAAS,KAAK,KAAK,MAAM,QAAQ;AACnD,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,SAAS,KAAK,KAAK,MAAM;AAAA,QACzB,WAAW;AAAA,QACX,OAAO;AAAA,QACP,MAAM;AAAA,MACV,CAAC;AACD,aAAO,MAAM;AAAA,IACjB;AACA,UAAM,QAAQ,CAAC,GAAG,IAAI,IAAI,EACrB,IAAI,CAAC,MAAM,cAAc;AAC1B,YAAM,SAAS,KAAK,KAAK,MAAM,SAAS,KAAK,KAAK,KAAK;AACvD,UAAI,CAAC;AACD,eAAO;AACX,aAAO,OAAO,OAAO,IAAI,mBAAmB,KAAK,MAAM,IAAI,MAAM,SAAS,CAAC;AAAA,IAC/E,CAAC,EACI,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;AACtB,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,QAAQ,IAAI,KAAK,EAAE,KAAK,CAAC,YAAY;AACxC,eAAO,YAAY,WAAW,QAAQ,OAAO;AAAA,MACjD,CAAC;AAAA,IACL,OACK;AACD,aAAO,YAAY,WAAW,QAAQ,KAAK;AAAA,IAC/C;AAAA,EACJ;AAAA,EACA,IAAI,QAAQ;AACR,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,KAAK,MAAM;AACP,WAAO,IAAI,UAAS;AAAA,MAChB,GAAG,KAAK;AAAA,MACR;AAAA,IACJ,CAAC;AAAA,EACL;AACJ;AACA,SAAS,SAAS,CAAC,SAAS,WAAW;AACnC,MAAI,CAAC,MAAM,QAAQ,OAAO,GAAG;AACzB,UAAM,IAAI,MAAM,uDAAuD;AAAA,EAC3E;AACA,SAAO,IAAI,SAAS;AAAA,IAChB,OAAO;AAAA,IACP,UAAU,sBAAsB;AAAA,IAChC,MAAM;AAAA,IACN,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,YAAN,MAAM,mBAAkB,QAAQ;AAAA,EACnC,IAAI,YAAY;AACZ,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,IAAI,cAAc;AACd,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,OAAO,OAAO;AACV,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,QAAI,IAAI,eAAe,cAAc,QAAQ;AACzC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,QAAQ,CAAC;AACf,UAAM,UAAU,KAAK,KAAK;AAC1B,UAAM,YAAY,KAAK,KAAK;AAC5B,eAAW,OAAO,IAAI,MAAM;AACxB,YAAM,KAAK;AAAA,QACP,KAAK,QAAQ,OAAO,IAAI,mBAAmB,KAAK,KAAK,IAAI,MAAM,GAAG,CAAC;AAAA,QACnE,OAAO,UAAU,OAAO,IAAI,mBAAmB,KAAK,IAAI,KAAK,GAAG,GAAG,IAAI,MAAM,GAAG,CAAC;AAAA,QACjF,WAAW,OAAO,IAAI;AAAA,MAC1B,CAAC;AAAA,IACL;AACA,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,YAAY,iBAAiB,QAAQ,KAAK;AAAA,IACrD,OACK;AACD,aAAO,YAAY,gBAAgB,QAAQ,KAAK;AAAA,IACpD;AAAA,EACJ;AAAA,EACA,IAAI,UAAU;AACV,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,OAAO,OAAO,OAAO,QAAQ,OAAO;AAChC,QAAI,kBAAkB,SAAS;AAC3B,aAAO,IAAI,WAAU;AAAA,QACjB,SAAS;AAAA,QACT,WAAW;AAAA,QACX,UAAU,sBAAsB;AAAA,QAChC,GAAG,oBAAoB,KAAK;AAAA,MAChC,CAAC;AAAA,IACL;AACA,WAAO,IAAI,WAAU;AAAA,MACjB,SAAS,UAAU,OAAO;AAAA,MAC1B,WAAW;AAAA,MACX,UAAU,sBAAsB;AAAA,MAChC,GAAG,oBAAoB,MAAM;AAAA,IACjC,CAAC;AAAA,EACL;AACJ;AACO,IAAM,SAAN,cAAqB,QAAQ;AAAA,EAChC,IAAI,YAAY;AACZ,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,IAAI,cAAc;AACd,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,OAAO,OAAO;AACV,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,QAAI,IAAI,eAAe,cAAc,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,UAAU,KAAK,KAAK;AAC1B,UAAM,YAAY,KAAK,KAAK;AAC5B,UAAM,QAAQ,CAAC,GAAG,IAAI,KAAK,QAAQ,CAAC,EAAE,IAAI,CAAC,CAAC,KAAK,KAAK,GAAG,UAAU;AAC/D,aAAO;AAAA,QACH,KAAK,QAAQ,OAAO,IAAI,mBAAmB,KAAK,KAAK,IAAI,MAAM,CAAC,OAAO,KAAK,CAAC,CAAC;AAAA,QAC9E,OAAO,UAAU,OAAO,IAAI,mBAAmB,KAAK,OAAO,IAAI,MAAM,CAAC,OAAO,OAAO,CAAC,CAAC;AAAA,MAC1F;AAAA,IACJ,CAAC;AACD,QAAI,IAAI,OAAO,OAAO;AAClB,YAAM,WAAW,oBAAI,IAAI;AACzB,aAAO,QAAQ,QAAQ,EAAE,KAAK,YAAY;AACtC,mBAAW,QAAQ,OAAO;AACtB,gBAAM,MAAM,MAAM,KAAK;AACvB,gBAAM,QAAQ,MAAM,KAAK;AACzB,cAAI,IAAI,WAAW,aAAa,MAAM,WAAW,WAAW;AACxD,mBAAO;AAAA,UACX;AACA,cAAI,IAAI,WAAW,WAAW,MAAM,WAAW,SAAS;AACpD,mBAAO,MAAM;AAAA,UACjB;AACA,mBAAS,IAAI,IAAI,OAAO,MAAM,KAAK;AAAA,QACvC;AACA,eAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,SAAS;AAAA,MACnD,CAAC;AAAA,IACL,OACK;AACD,YAAM,WAAW,oBAAI,IAAI;AACzB,iBAAW,QAAQ,OAAO;AACtB,cAAM,MAAM,KAAK;AACjB,cAAM,QAAQ,KAAK;AACnB,YAAI,IAAI,WAAW,aAAa,MAAM,WAAW,WAAW;AACxD,iBAAO;AAAA,QACX;AACA,YAAI,IAAI,WAAW,WAAW,MAAM,WAAW,SAAS;AACpD,iBAAO,MAAM;AAAA,QACjB;AACA,iBAAS,IAAI,IAAI,OAAO,MAAM,KAAK;AAAA,MACvC;AACA,aAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,SAAS;AAAA,IACnD;AAAA,EACJ;AACJ;AACA,OAAO,SAAS,CAAC,SAAS,WAAW,WAAW;AAC5C,SAAO,IAAI,OAAO;AAAA,IACd;AAAA,IACA;AAAA,IACA,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,SAAN,MAAM,gBAAe,QAAQ;AAAA,EAChC,OAAO,OAAO;AACV,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,QAAI,IAAI,eAAe,cAAc,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,MAAM,KAAK;AACjB,QAAI,IAAI,YAAY,MAAM;AACtB,UAAI,IAAI,KAAK,OAAO,IAAI,QAAQ,OAAO;AACnC,0BAAkB,KAAK;AAAA,UACnB,MAAM,aAAa;AAAA,UACnB,SAAS,IAAI,QAAQ;AAAA,UACrB,MAAM;AAAA,UACN,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS,IAAI,QAAQ;AAAA,QACzB,CAAC;AACD,eAAO,MAAM;AAAA,MACjB;AAAA,IACJ;AACA,QAAI,IAAI,YAAY,MAAM;AACtB,UAAI,IAAI,KAAK,OAAO,IAAI,QAAQ,OAAO;AACnC,0BAAkB,KAAK;AAAA,UACnB,MAAM,aAAa;AAAA,UACnB,SAAS,IAAI,QAAQ;AAAA,UACrB,MAAM;AAAA,UACN,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS,IAAI,QAAQ;AAAA,QACzB,CAAC;AACD,eAAO,MAAM;AAAA,MACjB;AAAA,IACJ;AACA,UAAM,YAAY,KAAK,KAAK;AAC5B,aAAS,YAAYC,WAAU;AAC3B,YAAM,YAAY,oBAAI,IAAI;AAC1B,iBAAW,WAAWA,WAAU;AAC5B,YAAI,QAAQ,WAAW;AACnB,iBAAO;AACX,YAAI,QAAQ,WAAW;AACnB,iBAAO,MAAM;AACjB,kBAAU,IAAI,QAAQ,KAAK;AAAA,MAC/B;AACA,aAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,UAAU;AAAA,IACpD;AACA,UAAM,WAAW,CAAC,GAAG,IAAI,KAAK,OAAO,CAAC,EAAE,IAAI,CAAC,MAAM,MAAM,UAAU,OAAO,IAAI,mBAAmB,KAAK,MAAM,IAAI,MAAM,CAAC,CAAC,CAAC;AACzH,QAAI,IAAI,OAAO,OAAO;AAClB,aAAO,QAAQ,IAAI,QAAQ,EAAE,KAAK,CAACA,cAAa,YAAYA,SAAQ,CAAC;AAAA,IACzE,OACK;AACD,aAAO,YAAY,QAAQ;AAAA,IAC/B;AAAA,EACJ;AAAA,EACA,IAAI,SAAS,SAAS;AAClB,WAAO,IAAI,QAAO;AAAA,MACd,GAAG,KAAK;AAAA,MACR,SAAS,EAAE,OAAO,SAAS,SAAS,UAAU,SAAS,OAAO,EAAE;AAAA,IACpE,CAAC;AAAA,EACL;AAAA,EACA,IAAI,SAAS,SAAS;AAClB,WAAO,IAAI,QAAO;AAAA,MACd,GAAG,KAAK;AAAA,MACR,SAAS,EAAE,OAAO,SAAS,SAAS,UAAU,SAAS,OAAO,EAAE;AAAA,IACpE,CAAC;AAAA,EACL;AAAA,EACA,KAAK,MAAM,SAAS;AAChB,WAAO,KAAK,IAAI,MAAM,OAAO,EAAE,IAAI,MAAM,OAAO;AAAA,EACpD;AAAA,EACA,SAAS,SAAS;AACd,WAAO,KAAK,IAAI,GAAG,OAAO;AAAA,EAC9B;AACJ;AACA,OAAO,SAAS,CAAC,WAAW,WAAW;AACnC,SAAO,IAAI,OAAO;AAAA,IACd;AAAA,IACA,SAAS;AAAA,IACT,SAAS;AAAA,IACT,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,cAAN,MAAM,qBAAoB,QAAQ;AAAA,EACrC,cAAc;AACV,UAAM,GAAG,SAAS;AAClB,SAAK,WAAW,KAAK;AAAA,EACzB;AAAA,EACA,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAC9C,QAAI,IAAI,eAAe,cAAc,UAAU;AAC3C,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,aAAS,cAAc,MAAM,OAAO;AAChC,aAAO,UAAU;AAAA,QACb,MAAM;AAAA,QACN,MAAM,IAAI;AAAA,QACV,WAAW,CAAC,IAAI,OAAO,oBAAoB,IAAI,gBAAgB,YAAY,GAAG,UAAe,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;AAAA,QAChH,WAAW;AAAA,UACP,MAAM,aAAa;AAAA,UACnB,gBAAgB;AAAA,QACpB;AAAA,MACJ,CAAC;AAAA,IACL;AACA,aAAS,iBAAiB,SAAS,OAAO;AACtC,aAAO,UAAU;AAAA,QACb,MAAM;AAAA,QACN,MAAM,IAAI;AAAA,QACV,WAAW,CAAC,IAAI,OAAO,oBAAoB,IAAI,gBAAgB,YAAY,GAAG,UAAe,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;AAAA,QAChH,WAAW;AAAA,UACP,MAAM,aAAa;AAAA,UACnB,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAAA,IACL;AACA,UAAM,SAAS,EAAE,UAAU,IAAI,OAAO,mBAAmB;AACzD,UAAM,KAAK,IAAI;AACf,QAAI,KAAK,KAAK,mBAAmB,YAAY;AAIzC,YAAM,KAAK;AACX,aAAO,GAAG,kBAAmB,MAAM;AAC/B,cAAM,QAAQ,IAAI,SAAS,CAAC,CAAC;AAC7B,cAAM,aAAa,MAAM,GAAG,KAAK,KAAK,WAAW,MAAM,MAAM,EAAE,MAAM,CAAC,MAAM;AACxE,gBAAM,SAAS,cAAc,MAAM,CAAC,CAAC;AACrC,gBAAM;AAAA,QACV,CAAC;AACD,cAAM,SAAS,MAAM,QAAQ,MAAM,IAAI,MAAM,UAAU;AACvD,cAAM,gBAAgB,MAAM,GAAG,KAAK,QAAQ,KAAK,KAC5C,WAAW,QAAQ,MAAM,EACzB,MAAM,CAAC,MAAM;AACd,gBAAM,SAAS,iBAAiB,QAAQ,CAAC,CAAC;AAC1C,gBAAM;AAAA,QACV,CAAC;AACD,eAAO;AAAA,MACX,CAAC;AAAA,IACL,OACK;AAID,YAAM,KAAK;AACX,aAAO,GAAG,YAAa,MAAM;AACzB,cAAM,aAAa,GAAG,KAAK,KAAK,UAAU,MAAM,MAAM;AACtD,YAAI,CAAC,WAAW,SAAS;AACrB,gBAAM,IAAI,SAAS,CAAC,cAAc,MAAM,WAAW,KAAK,CAAC,CAAC;AAAA,QAC9D;AACA,cAAM,SAAS,QAAQ,MAAM,IAAI,MAAM,WAAW,IAAI;AACtD,cAAM,gBAAgB,GAAG,KAAK,QAAQ,UAAU,QAAQ,MAAM;AAC9D,YAAI,CAAC,cAAc,SAAS;AACxB,gBAAM,IAAI,SAAS,CAAC,iBAAiB,QAAQ,cAAc,KAAK,CAAC,CAAC;AAAA,QACtE;AACA,eAAO,cAAc;AAAA,MACzB,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EACA,aAAa;AACT,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,aAAa;AACT,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,QAAQ,OAAO;AACX,WAAO,IAAI,aAAY;AAAA,MACnB,GAAG,KAAK;AAAA,MACR,MAAM,SAAS,OAAO,KAAK,EAAE,KAAK,WAAW,OAAO,CAAC;AAAA,IACzD,CAAC;AAAA,EACL;AAAA,EACA,QAAQ,YAAY;AAChB,WAAO,IAAI,aAAY;AAAA,MACnB,GAAG,KAAK;AAAA,MACR,SAAS;AAAA,IACb,CAAC;AAAA,EACL;AAAA,EACA,UAAU,MAAM;AACZ,UAAM,gBAAgB,KAAK,MAAM,IAAI;AACrC,WAAO;AAAA,EACX;AAAA,EACA,gBAAgB,MAAM;AAClB,UAAM,gBAAgB,KAAK,MAAM,IAAI;AACrC,WAAO;AAAA,EACX;AAAA,EACA,OAAO,OAAO,MAAM,SAAS,QAAQ;AACjC,WAAO,IAAI,aAAY;AAAA,MACnB,MAAO,OAAO,OAAO,SAAS,OAAO,CAAC,CAAC,EAAE,KAAK,WAAW,OAAO,CAAC;AAAA,MACjE,SAAS,WAAW,WAAW,OAAO;AAAA,MACtC,UAAU,sBAAsB;AAAA,MAChC,GAAG,oBAAoB,MAAM;AAAA,IACjC,CAAC;AAAA,EACL;AACJ;AACO,IAAM,UAAN,cAAsB,QAAQ;AAAA,EACjC,IAAI,SAAS;AACT,WAAO,KAAK,KAAK,OAAO;AAAA,EAC5B;AAAA,EACA,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAC9C,UAAM,aAAa,KAAK,KAAK,OAAO;AACpC,WAAO,WAAW,OAAO,EAAE,MAAM,IAAI,MAAM,MAAM,IAAI,MAAM,QAAQ,IAAI,CAAC;AAAA,EAC5E;AACJ;AACA,QAAQ,SAAS,CAAC,QAAQ,WAAW;AACjC,SAAO,IAAI,QAAQ;AAAA,IACf;AAAA,IACA,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,aAAN,cAAyB,QAAQ;AAAA,EACpC,OAAO,OAAO;AACV,QAAI,MAAM,SAAS,KAAK,KAAK,OAAO;AAChC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,UAAU,IAAI;AAAA,QACd,MAAM,aAAa;AAAA,QACnB,UAAU,KAAK,KAAK;AAAA,MACxB,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,EAAE,QAAQ,SAAS,OAAO,MAAM,KAAK;AAAA,EAChD;AAAA,EACA,IAAI,QAAQ;AACR,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,WAAW,SAAS,CAAC,OAAO,WAAW;AACnC,SAAO,IAAI,WAAW;AAAA,IAClB;AAAA,IACA,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACA,SAAS,cAAc,QAAQ,QAAQ;AACnC,SAAO,IAAI,QAAQ;AAAA,IACf;AAAA,IACA,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,UAAN,MAAM,iBAAgB,QAAQ;AAAA,EACjC,OAAO,OAAO;AACV,QAAI,OAAO,MAAM,SAAS,UAAU;AAChC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,YAAM,iBAAiB,KAAK,KAAK;AACjC,wBAAkB,KAAK;AAAA,QACnB,UAAU,KAAK,WAAW,cAAc;AAAA,QACxC,UAAU,IAAI;AAAA,QACd,MAAM,aAAa;AAAA,MACvB,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,CAAC,KAAK,QAAQ;AACd,WAAK,SAAS,IAAI,IAAI,KAAK,KAAK,MAAM;AAAA,IAC1C;AACA,QAAI,CAAC,KAAK,OAAO,IAAI,MAAM,IAAI,GAAG;AAC9B,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,YAAM,iBAAiB,KAAK,KAAK;AACjC,wBAAkB,KAAK;AAAA,QACnB,UAAU,IAAI;AAAA,QACd,MAAM,aAAa;AAAA,QACnB,SAAS;AAAA,MACb,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AAAA,EACA,IAAI,UAAU;AACV,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,IAAI,OAAO;AACP,UAAM,aAAa,CAAC;AACpB,eAAW,OAAO,KAAK,KAAK,QAAQ;AAChC,iBAAW,GAAG,IAAI;AAAA,IACtB;AACA,WAAO;AAAA,EACX;AAAA,EACA,IAAI,SAAS;AACT,UAAM,aAAa,CAAC;AACpB,eAAW,OAAO,KAAK,KAAK,QAAQ;AAChC,iBAAW,GAAG,IAAI;AAAA,IACtB;AACA,WAAO;AAAA,EACX;AAAA,EACA,IAAI,OAAO;AACP,UAAM,aAAa,CAAC;AACpB,eAAW,OAAO,KAAK,KAAK,QAAQ;AAChC,iBAAW,GAAG,IAAI;AAAA,IACtB;AACA,WAAO;AAAA,EACX;AAAA,EACA,QAAQ,QAAQ,SAAS,KAAK,MAAM;AAChC,WAAO,SAAQ,OAAO,QAAQ;AAAA,MAC1B,GAAG,KAAK;AAAA,MACR,GAAG;AAAA,IACP,CAAC;AAAA,EACL;AAAA,EACA,QAAQ,QAAQ,SAAS,KAAK,MAAM;AAChC,WAAO,SAAQ,OAAO,KAAK,QAAQ,OAAO,CAAC,QAAQ,CAAC,OAAO,SAAS,GAAG,CAAC,GAAG;AAAA,MACvE,GAAG,KAAK;AAAA,MACR,GAAG;AAAA,IACP,CAAC;AAAA,EACL;AACJ;AACA,QAAQ,SAAS;AACV,IAAM,gBAAN,cAA4B,QAAQ;AAAA,EACvC,OAAO,OAAO;AACV,UAAM,mBAAmB,KAAK,mBAAmB,KAAK,KAAK,MAAM;AACjE,UAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,QAAI,IAAI,eAAe,cAAc,UAAU,IAAI,eAAe,cAAc,QAAQ;AACpF,YAAM,iBAAiB,KAAK,aAAa,gBAAgB;AACzD,wBAAkB,KAAK;AAAA,QACnB,UAAU,KAAK,WAAW,cAAc;AAAA,QACxC,UAAU,IAAI;AAAA,QACd,MAAM,aAAa;AAAA,MACvB,CAAC;AACD,aAAO;AAAA,IACX;AACA,QAAI,CAAC,KAAK,QAAQ;AACd,WAAK,SAAS,IAAI,IAAI,KAAK,mBAAmB,KAAK,KAAK,MAAM,CAAC;AAAA,IACnE;AACA,QAAI,CAAC,KAAK,OAAO,IAAI,MAAM,IAAI,GAAG;AAC9B,YAAM,iBAAiB,KAAK,aAAa,gBAAgB;AACzD,wBAAkB,KAAK;AAAA,QACnB,UAAU,IAAI;AAAA,QACd,MAAM,aAAa;AAAA,QACnB,SAAS;AAAA,MACb,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,GAAG,MAAM,IAAI;AAAA,EACxB;AAAA,EACA,IAAI,OAAO;AACP,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,cAAc,SAAS,CAAC,QAAQ,WAAW;AACvC,SAAO,IAAI,cAAc;AAAA,IACrB;AAAA,IACA,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,aAAN,cAAyB,QAAQ;AAAA,EACpC,SAAS;AACL,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAC9C,QAAI,IAAI,eAAe,cAAc,WAAW,IAAI,OAAO,UAAU,OAAO;AACxE,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,UAAM,cAAc,IAAI,eAAe,cAAc,UAAU,IAAI,OAAO,QAAQ,QAAQ,IAAI,IAAI;AAClG,WAAO,GAAG,YAAY,KAAK,CAAC,SAAS;AACjC,aAAO,KAAK,KAAK,KAAK,WAAW,MAAM;AAAA,QACnC,MAAM,IAAI;AAAA,QACV,UAAU,IAAI,OAAO;AAAA,MACzB,CAAC;AAAA,IACL,CAAC,CAAC;AAAA,EACN;AACJ;AACA,WAAW,SAAS,CAAC,QAAQ,WAAW;AACpC,SAAO,IAAI,WAAW;AAAA,IAClB,MAAM;AAAA,IACN,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,aAAN,cAAyB,QAAQ;AAAA,EACpC,YAAY;AACR,WAAO,KAAK,KAAK;AAAA,EACrB;AAAA,EACA,aAAa;AACT,WAAO,KAAK,KAAK,OAAO,KAAK,aAAa,sBAAsB,aAC1D,KAAK,KAAK,OAAO,WAAW,IAC5B,KAAK,KAAK;AAAA,EACpB;AAAA,EACA,OAAO,OAAO;AACV,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,UAAM,SAAS,KAAK,KAAK,UAAU;AACnC,UAAM,WAAW;AAAA,MACb,UAAU,CAAC,QAAQ;AACf,0BAAkB,KAAK,GAAG;AAC1B,YAAI,IAAI,OAAO;AACX,iBAAO,MAAM;AAAA,QACjB,OACK;AACD,iBAAO,MAAM;AAAA,QACjB;AAAA,MACJ;AAAA,MACA,IAAI,OAAO;AACP,eAAO,IAAI;AAAA,MACf;AAAA,IACJ;AACA,aAAS,WAAW,SAAS,SAAS,KAAK,QAAQ;AACnD,QAAI,OAAO,SAAS,cAAc;AAC9B,YAAM,YAAY,OAAO,UAAU,IAAI,MAAM,QAAQ;AACrD,UAAI,IAAI,OAAO,OAAO;AAClB,eAAO,QAAQ,QAAQ,SAAS,EAAE,KAAK,OAAOC,eAAc;AACxD,cAAI,OAAO,UAAU;AACjB,mBAAO;AACX,gBAAM,SAAS,MAAM,KAAK,KAAK,OAAO,YAAY;AAAA,YAC9C,MAAMA;AAAA,YACN,MAAM,IAAI;AAAA,YACV,QAAQ;AAAA,UACZ,CAAC;AACD,cAAI,OAAO,WAAW;AAClB,mBAAO;AACX,cAAI,OAAO,WAAW;AAClB,mBAAO,MAAM,OAAO,KAAK;AAC7B,cAAI,OAAO,UAAU;AACjB,mBAAO,MAAM,OAAO,KAAK;AAC7B,iBAAO;AAAA,QACX,CAAC;AAAA,MACL,OACK;AACD,YAAI,OAAO,UAAU;AACjB,iBAAO;AACX,cAAM,SAAS,KAAK,KAAK,OAAO,WAAW;AAAA,UACvC,MAAM;AAAA,UACN,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AACD,YAAI,OAAO,WAAW;AAClB,iBAAO;AACX,YAAI,OAAO,WAAW;AAClB,iBAAO,MAAM,OAAO,KAAK;AAC7B,YAAI,OAAO,UAAU;AACjB,iBAAO,MAAM,OAAO,KAAK;AAC7B,eAAO;AAAA,MACX;AAAA,IACJ;AACA,QAAI,OAAO,SAAS,cAAc;AAC9B,YAAM,oBAAoB,CAAC,QAAQ;AAC/B,cAAM,SAAS,OAAO,WAAW,KAAK,QAAQ;AAC9C,YAAI,IAAI,OAAO,OAAO;AAClB,iBAAO,QAAQ,QAAQ,MAAM;AAAA,QACjC;AACA,YAAI,kBAAkB,SAAS;AAC3B,gBAAM,IAAI,MAAM,2FAA2F;AAAA,QAC/G;AACA,eAAO;AAAA,MACX;AACA,UAAI,IAAI,OAAO,UAAU,OAAO;AAC5B,cAAM,QAAQ,KAAK,KAAK,OAAO,WAAW;AAAA,UACtC,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AACD,YAAI,MAAM,WAAW;AACjB,iBAAO;AACX,YAAI,MAAM,WAAW;AACjB,iBAAO,MAAM;AAEjB,0BAAkB,MAAM,KAAK;AAC7B,eAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,MAAM,MAAM;AAAA,MACtD,OACK;AACD,eAAO,KAAK,KAAK,OAAO,YAAY,EAAE,MAAM,IAAI,MAAM,MAAM,IAAI,MAAM,QAAQ,IAAI,CAAC,EAAE,KAAK,CAAC,UAAU;AACjG,cAAI,MAAM,WAAW;AACjB,mBAAO;AACX,cAAI,MAAM,WAAW;AACjB,mBAAO,MAAM;AACjB,iBAAO,kBAAkB,MAAM,KAAK,EAAE,KAAK,MAAM;AAC7C,mBAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,MAAM,MAAM;AAAA,UACtD,CAAC;AAAA,QACL,CAAC;AAAA,MACL;AAAA,IACJ;AACA,QAAI,OAAO,SAAS,aAAa;AAC7B,UAAI,IAAI,OAAO,UAAU,OAAO;AAC5B,cAAM,OAAO,KAAK,KAAK,OAAO,WAAW;AAAA,UACrC,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AACD,YAAI,CAAC,QAAQ,IAAI;AACb,iBAAO;AACX,cAAM,SAAS,OAAO,UAAU,KAAK,OAAO,QAAQ;AACpD,YAAI,kBAAkB,SAAS;AAC3B,gBAAM,IAAI,MAAM,iGAAiG;AAAA,QACrH;AACA,eAAO,EAAE,QAAQ,OAAO,OAAO,OAAO,OAAO;AAAA,MACjD,OACK;AACD,eAAO,KAAK,KAAK,OAAO,YAAY,EAAE,MAAM,IAAI,MAAM,MAAM,IAAI,MAAM,QAAQ,IAAI,CAAC,EAAE,KAAK,CAAC,SAAS;AAChG,cAAI,CAAC,QAAQ,IAAI;AACb,mBAAO;AACX,iBAAO,QAAQ,QAAQ,OAAO,UAAU,KAAK,OAAO,QAAQ,CAAC,EAAE,KAAK,CAAC,YAAY;AAAA,YAC7E,QAAQ,OAAO;AAAA,YACf,OAAO;AAAA,UACX,EAAE;AAAA,QACN,CAAC;AAAA,MACL;AAAA,IACJ;AACA,SAAK,YAAY,MAAM;AAAA,EAC3B;AACJ;AACA,WAAW,SAAS,CAAC,QAAQ,QAAQ,WAAW;AAC5C,SAAO,IAAI,WAAW;AAAA,IAClB;AAAA,IACA,UAAU,sBAAsB;AAAA,IAChC;AAAA,IACA,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACA,WAAW,uBAAuB,CAAC,YAAY,QAAQ,WAAW;AAC9D,SAAO,IAAI,WAAW;AAAA,IAClB;AAAA,IACA,QAAQ,EAAE,MAAM,cAAc,WAAW,WAAW;AAAA,IACpD,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AAEO,IAAM,cAAN,cAA0B,QAAQ;AAAA,EACrC,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,WAAW;AACxC,aAAO,GAAG,MAAS;AAAA,IACvB;AACA,WAAO,KAAK,KAAK,UAAU,OAAO,KAAK;AAAA,EAC3C;AAAA,EACA,SAAS;AACL,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,YAAY,SAAS,CAAC,MAAM,WAAW;AACnC,SAAO,IAAI,YAAY;AAAA,IACnB,WAAW;AAAA,IACX,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,cAAN,cAA0B,QAAQ;AAAA,EACrC,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,MAAM;AACnC,aAAO,GAAG,IAAI;AAAA,IAClB;AACA,WAAO,KAAK,KAAK,UAAU,OAAO,KAAK;AAAA,EAC3C;AAAA,EACA,SAAS;AACL,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,YAAY,SAAS,CAAC,MAAM,WAAW;AACnC,SAAO,IAAI,YAAY;AAAA,IACnB,WAAW;AAAA,IACX,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,aAAN,cAAyB,QAAQ;AAAA,EACpC,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAC9C,QAAI,OAAO,IAAI;AACf,QAAI,IAAI,eAAe,cAAc,WAAW;AAC5C,aAAO,KAAK,KAAK,aAAa;AAAA,IAClC;AACA,WAAO,KAAK,KAAK,UAAU,OAAO;AAAA,MAC9B;AAAA,MACA,MAAM,IAAI;AAAA,MACV,QAAQ;AAAA,IACZ,CAAC;AAAA,EACL;AAAA,EACA,gBAAgB;AACZ,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,WAAW,SAAS,CAAC,MAAM,WAAW;AAClC,SAAO,IAAI,WAAW;AAAA,IAClB,WAAW;AAAA,IACX,UAAU,sBAAsB;AAAA,IAChC,cAAc,OAAO,OAAO,YAAY,aAAa,OAAO,UAAU,MAAM,OAAO;AAAA,IACnF,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,WAAN,cAAuB,QAAQ;AAAA,EAClC,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAE9C,UAAM,SAAS;AAAA,MACX,GAAG;AAAA,MACH,QAAQ;AAAA,QACJ,GAAG,IAAI;AAAA,QACP,QAAQ,CAAC;AAAA,MACb;AAAA,IACJ;AACA,UAAM,SAAS,KAAK,KAAK,UAAU,OAAO;AAAA,MACtC,MAAM,OAAO;AAAA,MACb,MAAM,OAAO;AAAA,MACb,QAAQ;AAAA,QACJ,GAAG;AAAA,MACP;AAAA,IACJ,CAAC;AACD,QAAI,QAAQ,MAAM,GAAG;AACjB,aAAO,OAAO,KAAK,CAACC,YAAW;AAC3B,eAAO;AAAA,UACH,QAAQ;AAAA,UACR,OAAOA,QAAO,WAAW,UACnBA,QAAO,QACP,KAAK,KAAK,WAAW;AAAA,YACnB,IAAI,QAAQ;AACR,qBAAO,IAAI,SAAS,OAAO,OAAO,MAAM;AAAA,YAC5C;AAAA,YACA,OAAO,OAAO;AAAA,UAClB,CAAC;AAAA,QACT;AAAA,MACJ,CAAC;AAAA,IACL,OACK;AACD,aAAO;AAAA,QACH,QAAQ;AAAA,QACR,OAAO,OAAO,WAAW,UACnB,OAAO,QACP,KAAK,KAAK,WAAW;AAAA,UACnB,IAAI,QAAQ;AACR,mBAAO,IAAI,SAAS,OAAO,OAAO,MAAM;AAAA,UAC5C;AAAA,UACA,OAAO,OAAO;AAAA,QAClB,CAAC;AAAA,MACT;AAAA,IACJ;AAAA,EACJ;AAAA,EACA,cAAc;AACV,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,SAAS,SAAS,CAAC,MAAM,WAAW;AAChC,SAAO,IAAI,SAAS;AAAA,IAChB,WAAW;AAAA,IACX,UAAU,sBAAsB;AAAA,IAChC,YAAY,OAAO,OAAO,UAAU,aAAa,OAAO,QAAQ,MAAM,OAAO;AAAA,IAC7E,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,SAAN,cAAqB,QAAQ;AAAA,EAChC,OAAO,OAAO;AACV,UAAM,aAAa,KAAK,SAAS,KAAK;AACtC,QAAI,eAAe,cAAc,KAAK;AAClC,YAAM,MAAM,KAAK,gBAAgB,KAAK;AACtC,wBAAkB,KAAK;AAAA,QACnB,MAAM,aAAa;AAAA,QACnB,UAAU,cAAc;AAAA,QACxB,UAAU,IAAI;AAAA,MAClB,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO,EAAE,QAAQ,SAAS,OAAO,MAAM,KAAK;AAAA,EAChD;AACJ;AACA,OAAO,SAAS,CAAC,WAAW;AACxB,SAAO,IAAI,OAAO;AAAA,IACd,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AACO,IAAM,QAAQ,OAAO,WAAW;AAChC,IAAM,aAAN,cAAyB,QAAQ;AAAA,EACpC,OAAO,OAAO;AACV,UAAM,EAAE,IAAI,IAAI,KAAK,oBAAoB,KAAK;AAC9C,UAAM,OAAO,IAAI;AACjB,WAAO,KAAK,KAAK,KAAK,OAAO;AAAA,MACzB;AAAA,MACA,MAAM,IAAI;AAAA,MACV,QAAQ;AAAA,IACZ,CAAC;AAAA,EACL;AAAA,EACA,SAAS;AACL,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACO,IAAM,cAAN,MAAM,qBAAoB,QAAQ;AAAA,EACrC,OAAO,OAAO;AACV,UAAM,EAAE,QAAQ,IAAI,IAAI,KAAK,oBAAoB,KAAK;AACtD,QAAI,IAAI,OAAO,OAAO;AAClB,YAAM,cAAc,YAAY;AAC5B,cAAM,WAAW,MAAM,KAAK,KAAK,GAAG,YAAY;AAAA,UAC5C,MAAM,IAAI;AAAA,UACV,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AACD,YAAI,SAAS,WAAW;AACpB,iBAAO;AACX,YAAI,SAAS,WAAW,SAAS;AAC7B,iBAAO,MAAM;AACb,iBAAO,MAAM,SAAS,KAAK;AAAA,QAC/B,OACK;AACD,iBAAO,KAAK,KAAK,IAAI,YAAY;AAAA,YAC7B,MAAM,SAAS;AAAA,YACf,MAAM,IAAI;AAAA,YACV,QAAQ;AAAA,UACZ,CAAC;AAAA,QACL;AAAA,MACJ;AACA,aAAO,YAAY;AAAA,IACvB,OACK;AACD,YAAM,WAAW,KAAK,KAAK,GAAG,WAAW;AAAA,QACrC,MAAM,IAAI;AAAA,QACV,MAAM,IAAI;AAAA,QACV,QAAQ;AAAA,MACZ,CAAC;AACD,UAAI,SAAS,WAAW;AACpB,eAAO;AACX,UAAI,SAAS,WAAW,SAAS;AAC7B,eAAO,MAAM;AACb,eAAO;AAAA,UACH,QAAQ;AAAA,UACR,OAAO,SAAS;AAAA,QACpB;AAAA,MACJ,OACK;AACD,eAAO,KAAK,KAAK,IAAI,WAAW;AAAA,UAC5B,MAAM,SAAS;AAAA,UACf,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,QACZ,CAAC;AAAA,MACL;AAAA,IACJ;AAAA,EACJ;AAAA,EACA,OAAO,OAAO,GAAG,GAAG;AAChB,WAAO,IAAI,aAAY;AAAA,MACnB,IAAI;AAAA,MACJ,KAAK;AAAA,MACL,UAAU,sBAAsB;AAAA,IACpC,CAAC;AAAA,EACL;AACJ;AACO,IAAM,cAAN,cAA0B,QAAQ;AAAA,EACrC,OAAO,OAAO;AACV,UAAM,SAAS,KAAK,KAAK,UAAU,OAAO,KAAK;AAC/C,UAAM,SAAS,CAAC,SAAS;AACrB,UAAI,QAAQ,IAAI,GAAG;AACf,aAAK,QAAQ,OAAO,OAAO,KAAK,KAAK;AAAA,MACzC;AACA,aAAO;AAAA,IACX;AACA,WAAO,QAAQ,MAAM,IAAI,OAAO,KAAK,CAAC,SAAS,OAAO,IAAI,CAAC,IAAI,OAAO,MAAM;AAAA,EAChF;AAAA,EACA,SAAS;AACL,WAAO,KAAK,KAAK;AAAA,EACrB;AACJ;AACA,YAAY,SAAS,CAAC,MAAM,WAAW;AACnC,SAAO,IAAI,YAAY;AAAA,IACnB,WAAW;AAAA,IACX,UAAU,sBAAsB;AAAA,IAChC,GAAG,oBAAoB,MAAM;AAAA,EACjC,CAAC;AACL;AAQA,SAAS,YAAY,QAAQ,MAAM;AAC/B,QAAM,IAAI,OAAO,WAAW,aAAa,OAAO,IAAI,IAAI,OAAO,WAAW,WAAW,EAAE,SAAS,OAAO,IAAI;AAC3G,QAAM,KAAK,OAAO,MAAM,WAAW,EAAE,SAAS,EAAE,IAAI;AACpD,SAAO;AACX;AACO,SAAS,OAAO,OAAO,UAAU,CAAC,GAWzC,OAAO;AACH,MAAI;AACA,WAAO,OAAO,OAAO,EAAE,YAAY,CAAC,MAAM,QAAQ;AAC9C,YAAM,IAAI,MAAM,IAAI;AACpB,UAAI,aAAa,SAAS;AACtB,eAAO,EAAE,KAAK,CAACC,OAAM;AACjB,cAAI,CAACA,IAAG;AACJ,kBAAM,SAAS,YAAY,SAAS,IAAI;AACxC,kBAAM,SAAS,OAAO,SAAS,SAAS;AACxC,gBAAI,SAAS,EAAE,MAAM,UAAU,GAAG,QAAQ,OAAO,OAAO,CAAC;AAAA,UAC7D;AAAA,QACJ,CAAC;AAAA,MACL;AACA,UAAI,CAAC,GAAG;AACJ,cAAM,SAAS,YAAY,SAAS,IAAI;AACxC,cAAM,SAAS,OAAO,SAAS,SAAS;AACxC,YAAI,SAAS,EAAE,MAAM,UAAU,GAAG,QAAQ,OAAO,OAAO,CAAC;AAAA,MAC7D;AACA;AAAA,IACJ,CAAC;AACL,SAAO,OAAO,OAAO;AACzB;AAEO,IAAM,OAAO;AAAA,EAChB,QAAQ,UAAU;AACtB;AACO,IAAI;AAAA,CACV,SAAUC,wBAAuB;AAC9B,EAAAA,uBAAsB,WAAW,IAAI;AACrC,EAAAA,uBAAsB,WAAW,IAAI;AACrC,EAAAA,uBAAsB,QAAQ,IAAI;AAClC,EAAAA,uBAAsB,WAAW,IAAI;AACrC,EAAAA,uBAAsB,YAAY,IAAI;AACtC,EAAAA,uBAAsB,SAAS,IAAI;AACnC,EAAAA,uBAAsB,WAAW,IAAI;AACrC,EAAAA,uBAAsB,cAAc,IAAI;AACxC,EAAAA,uBAAsB,SAAS,IAAI;AACnC,EAAAA,uBAAsB,QAAQ,IAAI;AAClC,EAAAA,uBAAsB,YAAY,IAAI;AACtC,EAAAA,uBAAsB,UAAU,IAAI;AACpC,EAAAA,uBAAsB,SAAS,IAAI;AACnC,EAAAA,uBAAsB,UAAU,IAAI;AACpC,EAAAA,uBAAsB,WAAW,IAAI;AACrC,EAAAA,uBAAsB,UAAU,IAAI;AACpC,EAAAA,uBAAsB,uBAAuB,IAAI;AACjD,EAAAA,uBAAsB,iBAAiB,IAAI;AAC3C,EAAAA,uBAAsB,UAAU,IAAI;AACpC,EAAAA,uBAAsB,WAAW,IAAI;AACrC,EAAAA,uBAAsB,QAAQ,IAAI;AAClC,EAAAA,uBAAsB,QAAQ,IAAI;AAClC,EAAAA,uBAAsB,aAAa,IAAI;AACvC,EAAAA,uBAAsB,SAAS,IAAI;AACnC,EAAAA,uBAAsB,YAAY,IAAI;AACtC,EAAAA,uBAAsB,SAAS,IAAI;AACnC,EAAAA,uBAAsB,YAAY,IAAI;AACtC,EAAAA,uBAAsB,eAAe,IAAI;AACzC,EAAAA,uBAAsB,aAAa,IAAI;AACvC,EAAAA,uBAAsB,aAAa,IAAI;AACvC,EAAAA,uBAAsB,YAAY,IAAI;AACtC,EAAAA,uBAAsB,UAAU,IAAI;AACpC,EAAAA,uBAAsB,YAAY,IAAI;AACtC,EAAAA,uBAAsB,YAAY,IAAI;AACtC,EAAAA,uBAAsB,aAAa,IAAI;AACvC,EAAAA,uBAAsB,aAAa,IAAI;AAC3C,GAAG,0BAA0B,wBAAwB,CAAC,EAAE;AAKxD,IAAM,iBAAiB,CAEvB,KAAK,SAAS;AAAA,EACV,SAAS,yBAAyB,IAAI,IAAI;AAC9C,MAAM,OAAO,CAAC,SAAS,gBAAgB,KAAK,MAAM;AAClD,IAAM,aAAa,UAAU;AAC7B,IAAM,aAAa,UAAU;AAC7B,IAAM,UAAU,OAAO;AACvB,IAAM,aAAa,UAAU;AAC7B,IAAM,cAAc,WAAW;AAC/B,IAAM,WAAW,QAAQ;AACzB,IAAM,aAAa,UAAU;AAC7B,IAAM,gBAAgB,aAAa;AACnC,IAAM,WAAW,QAAQ;AACzB,IAAM,UAAU,OAAO;AACvB,IAAM,cAAc,WAAW;AAC/B,IAAM,YAAY,SAAS;AAC3B,IAAM,WAAW,QAAQ;AACzB,IAAM,YAAY,SAAS;AAC3B,IAAM,aAAa,UAAU;AAC7B,IAAM,mBAAmB,UAAU;AACnC,IAAM,YAAY,SAAS;AAC3B,IAAM,yBAAyB,sBAAsB;AACrD,IAAM,mBAAmB,gBAAgB;AACzC,IAAM,YAAY,SAAS;AAC3B,IAAM,aAAa,UAAU;AAC7B,IAAM,UAAU,OAAO;AACvB,IAAM,UAAU,OAAO;AACvB,IAAM,eAAe,YAAY;AACjC,IAAM,WAAW,QAAQ;AACzB,IAAM,cAAc,WAAW;AAC/B,IAAM,WAAW,QAAQ;AACzB,IAAM,iBAAiB,cAAc;AACrC,IAAM,cAAc,WAAW;AAC/B,IAAM,cAAc,WAAW;AAC/B,IAAM,eAAe,YAAY;AACjC,IAAM,eAAe,YAAY;AACjC,IAAM,iBAAiB,WAAW;AAClC,IAAM,eAAe,YAAY;AACjC,IAAM,UAAU,MAAM,WAAW,EAAE,SAAS;AAC5C,IAAM,UAAU,MAAM,WAAW,EAAE,SAAS;AAC5C,IAAM,WAAW,MAAM,YAAY,EAAE,SAAS;AACvC,IAAM,SAAS;AAAA,EAClB,QAAS,CAAC,QAAQ,UAAU,OAAO,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC;AAAA,EAC3D,QAAS,CAAC,QAAQ,UAAU,OAAO,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC;AAAA,EAC3D,SAAU,CAAC,QAAQ,WAAW,OAAO;AAAA,IACjC,GAAG;AAAA,IACH,QAAQ;AAAA,EACZ,CAAC;AAAA,EACD,QAAS,CAAC,QAAQ,UAAU,OAAO,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC;AAAA,EAC3D,MAAO,CAAC,QAAQ,QAAQ,OAAO,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC;AAC3D;AAEO,IAAM,QAAQ;;;ACpmHd,IAAM,eAAN,MAAmB;AAAA,EAAnB;AACH,wBAAQ,SAA2B,oBAAI,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,EAK3C,SAAS,MAAkB;AACvB,QAAI,KAAK,MAAM,IAAI,KAAK,IAAI,GAAG;AAC3B,YAAM,IAAI,MAAM,iBAAO,KAAK,IAAI,sBAAO;AAAA,IAC3C;AACA,SAAK,MAAM,IAAI,KAAK,MAAM,IAAI;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,OAAqB;AAC7B,UAAM,QAAQ,UAAQ,KAAK,SAAS,IAAI,CAAC;AAAA,EAC7C;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,MAAgC;AAChC,WAAO,KAAK,MAAM,IAAI,IAAI;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,MAAuB;AACvB,WAAO,KAAK,MAAM,IAAI,IAAI;AAAA,EAC9B;AAAA;AAAA;AAAA;AAAA,EAKA,OAAiB;AACb,WAAO,MAAM,KAAK,KAAK,MAAM,KAAK,CAAC;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc,UAAkB,OAAoE;AAChG,UAAM,OAAO,KAAK,MAAM,IAAI,QAAQ;AACpC,QAAI,CAAC,MAAM;AACP,aAAO,EAAE,OAAO,OAAO,OAAO,iBAAO,QAAQ,uBAAQ;AAAA,IACzD;AAEA,QAAI;AACA,YAAM,OAAO,KAAK,YAAY,MAAM,KAAK;AACzC,aAAO,EAAE,OAAO,MAAM,KAAK;AAAA,IAC/B,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAE,UAAU;AAC7B,eAAO,EAAE,OAAO,OAAO,OAAO,yCAAW,MAAM,OAAO,IAAI,OAAK,EAAE,OAAO,EAAE,KAAK,IAAI,CAAC,GAAG;AAAA,MAC3F;AACA,aAAO,EAAE,OAAO,OAAO,OAAO,OAAO,KAAK,EAAE;AAAA,IAChD;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,UAAkB,QAAqE;AAClG,UAAM,OAAO,KAAK,MAAM,IAAI,QAAQ;AACpC,QAAI,CAAC,MAAM;AACP,aAAO,EAAE,OAAO,OAAO,OAAO,iBAAO,QAAQ,uBAAQ;AAAA,IACzD;AAEA,QAAI;AACA,YAAM,OAAO,KAAK,aAAa,MAAM,MAAM;AAC3C,aAAO,EAAE,OAAO,MAAM,KAAK;AAAA,IAC/B,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAE,UAAU;AAC7B,eAAO,EAAE,OAAO,OAAO,OAAO,yCAAW,MAAM,OAAO,IAAI,OAAK,EAAE,OAAO,EAAE,KAAK,IAAI,CAAC,GAAG;AAAA,MAC3F;AACA,aAAO,EAAE,OAAO,OAAO,OAAO,OAAO,KAAK,EAAE;AAAA,IAChD;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,UAAkB,aAA+C;AAC7E,UAAM,OAAO,KAAK,MAAM,IAAI,QAAQ;AACpC,QAAI,CAAC,KAAM,QAAO;AAGlB,QAAI,CAAC,KAAK,eAAe,KAAK,YAAY,WAAW,GAAG;AACpD,aAAO;AAAA,IACX;AAGA,WAAO,KAAK,YAAY,MAAM,UAAQ,YAAY,IAAI,MAAM,IAAI;AAAA,EACpE;AAAA;AAAA;AAAA;AAAA,EAKA,iBAAiB,UAAkB,QAAyB;AACxD,UAAM,OAAO,KAAK,MAAM,IAAI,QAAQ;AACpC,QAAI,CAAC,KAAM,QAAO;AAGlB,QAAI,CAAC,KAAK,gBAAgB,KAAK,aAAa,WAAW,GAAG;AACtD,aAAO;AAAA,IACX;AAEA,WAAO,KAAK,aAAa,SAAS,MAAM;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,QACF,UACA,OACA,SAK+D;AAC/D,UAAM,OAAO,KAAK,MAAM,IAAI,QAAQ;AACpC,QAAI,CAAC,MAAM;AACP,aAAO,EAAE,SAAS,OAAO,OAAO,iBAAO,QAAQ,uBAAQ;AAAA,IAC3D;AAGA,QAAI,SAAS,UAAU,CAAC,KAAK,iBAAiB,UAAU,QAAQ,MAAM,GAAG;AACrE,aAAO,EAAE,SAAS,OAAO,OAAO,iBAAO,QAAQ,MAAM,iDAAc,QAAQ,IAAI;AAAA,IACnF;AAGA,QAAI,SAAS,eAAe,CAAC,KAAK,gBAAgB,UAAU,QAAQ,WAAW,GAAG;AAC9E,aAAO,EAAE,SAAS,OAAO,OAAO,yCAAW,KAAK,YAAY,KAAK,IAAI,CAAC,GAAG;AAAA,IAC7E;AAGA,UAAM,kBAAkB,KAAK,cAAc,UAAU,KAAK;AAC1D,QAAI,CAAC,gBAAgB,OAAO;AACxB,aAAO,EAAE,SAAS,OAAO,OAAO,gBAAgB,MAAM;AAAA,IAC1D;AAEA,QAAI;AAEA,YAAM,SAAS,MAAM,KAAK;AAAA,QACtB,KAAK,QAAQ,gBAAgB,MAAM;AAAA,UAC/B,UAAU,SAAS;AAAA,QACvB,CAAC;AAAA,QACD,KAAK;AAAA,MACT;AAGA,YAAM,mBAAmB,KAAK,eAAe,UAAU,MAAM;AAC7D,UAAI,CAAC,iBAAiB,OAAO;AACzB,eAAO,EAAE,SAAS,OAAO,OAAO,6BAAS,iBAAiB,KAAK,GAAG;AAAA,MACtE;AAEA,aAAO,EAAE,SAAS,MAAM,QAAQ,iBAAiB,KAAK;AAAA,IAC1D,SAAS,OAAO;AACZ,aAAO,EAAE,SAAS,OAAO,OAAO,OAAO,KAAK,EAAE;AAAA,IAClD;AAAA,EACJ;AAAA,EAEQ,mBAAsB,SAAqB,WAA+B;AAC9E,QAAI;AAEJ,UAAM,iBAAiB,IAAI,QAAW,CAAC,GAAG,WAAW;AACjD,sBAAgB,WAAW,MAAM;AAC7B,eAAO,IAAI,MAAM,yCAAW,SAAS,KAAK,CAAC;AAAA,MAC/C,GAAG,SAAS;AAAA,IAChB,CAAC;AAED,WAAO,QAAQ,KAAK;AAAA,MAChB;AAAA,MACA;AAAA,IACJ,CAAC,EAAE,QAAQ,MAAM;AAEb,mBAAa,aAAa;AAAA,IAC9B,CAAC;AAAA,EACL;AACJ;;;ACjLO,SAAS,YACZ,MACA,SACA,SAMU;AACV,SAAO;AAAA,IACH;AAAA,IACA;AAAA,IACA,QAAQ,SAAS;AAAA,IACjB,UAAU,SAAS;AAAA,IACnB,WAAW,SAAS,aAAa,YAAY,IAAI;AAAA,IACjD,eAAe,SAAS;AAAA,IACxB,WAAW,KAAK,IAAI;AAAA,EACxB;AACJ;AAKA,SAAS,YAAY,MAA0B;AAC3C,UAAQ,MAAM;AAAA,IACV,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AACD,aAAO;AAAA,IACX;AACI,aAAO;AAAA,EACf;AACJ;AAgBO,SAAS,iBAAiB,OAAmB,YAAoB,YAAmC;AAEvG,MAAI,MAAM,SAAS,mBAAmB;AAClC,WAAO;AAAA,MACH,aAAa;AAAA,MACb,eAAe;AAAA,MACf,gBAAgB;AAAA,MAChB,iBAAiB;AAAA,MACjB,YAAY;AAAA,IAChB;AAAA,EACJ;AAGA,MAAI,MAAM,SAAS,cAAc;AAC7B,WAAO;AAAA,MACH,aAAa;AAAA,MACb,eAAe;AAAA,MACf,gBAAgB;AAAA,MAChB,iBAAiB;AAAA,MACjB,YAAY;AAAA,IAChB;AAAA,EACJ;AAGA,MAAI,MAAM,SAAS,cAAc;AAC7B,WAAO;AAAA,MACH,aAAa;AAAA,MACb,eAAe;AAAA,MACf,gBAAgB;AAAA,MAChB,iBAAiB,CAAC,MAAM;AAAA,MACxB,YAAY;AAAA,IAChB;AAAA,EACJ;AAGA,MAAI,MAAM,aAAa,aAAa,YAAY;AAC5C,WAAO;AAAA,MACH,aAAa;AAAA,MACb,eAAe;AAAA,MACf,gBAAgB;AAAA,MAChB,iBAAiB;AAAA,MACjB,YAAY,gBAAM,gBAAgB,UAAU,CAAC,0BAAW,aAAa,CAAC,IAAI,UAAU;AAAA,IACxF;AAAA,EACJ;AAGA,MAAI,cAAc,YAAY;AAC1B,WAAO;AAAA,MACH,aAAa;AAAA,MACb,eAAe;AAAA,MACf,gBAAgB;AAAA,MAChB,iBAAiB;AAAA,MACjB,YAAY;AAAA,IAChB;AAAA,EACJ;AAGA,SAAO;AAAA,IACH,aAAa;AAAA,IACb,eAAe;AAAA,IACf,gBAAgB;AAAA,IAChB,iBAAiB;AAAA,IACjB,YAAY;AAAA,EAChB;AACJ;AAKO,SAAS,gBAAgB,YAAoB,SAAiB,KAAM,aAAqB,GAAW;AACvG,SAAO,SAAS,KAAK,IAAI,YAAY,UAAU;AACnD;AAKA,eAAsB,iBAClB,IACA,YACA,SAAiB,KACjB,aAAqB,GACX;AACV,MAAI;AAEJ,WAAS,IAAI,GAAG,KAAK,YAAY,KAAK;AAClC,QAAI;AACA,aAAO,MAAM,GAAG;AAAA,IACpB,SAAS,OAAO;AACZ,kBAAY,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC;AAEpE,UAAI,IAAI,YAAY;AAChB,cAAM,QAAQ,gBAAgB,GAAG,QAAQ,UAAU;AACnD,cAAM,MAAM,KAAK;AAAA,MACrB;AAAA,IACJ;AAAA,EACJ;AAEA,QAAM;AACV;AAeO,SAAS,qBAAqB,YAA+B;AAChE,SAAO,WAAW;AACtB;AAKO,SAAS,mBAAmB,OAA2B;AAC1D,QAAM,QAAQ,CAAC,IAAI,MAAM,KAAK,YAAY,CAAC,KAAK,MAAM,OAAO;AAE7D,MAAI,MAAM,QAAQ;AACd,UAAM,KAAK,kBAAQ,MAAM,MAAM,GAAG;AAAA,EACtC;AAEA,MAAI,MAAM,UAAU;AAChB,UAAM,KAAK,kBAAQ,MAAM,QAAQ,GAAG;AAAA,EACxC;AAEA,SAAO,MAAM,KAAK,GAAG;AACzB;AAMA,SAAS,MAAM,IAA2B;AACtC,SAAO,IAAI,QAAQ,aAAW,WAAW,SAAS,EAAE,CAAC;AACzD;;;ACxMO,IAAe,WAAf,MAAwC;AAAA,EAC3C,YACoB,IACA,MAClB;AAFkB;AACA;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAUM,aAAa,OAAc,SAA+B,CAAC,GAAe;AAChF,WAAO,EAAE,OAAO,OAAO;AAAA,EAC3B;AACJ;;;ACdO,IAAM,eAAN,MAAmB;AAAA,EACtB,YAA6B,MAAwB;AAAxB;AAAA,EAA0B;AAAA,EAEvD,MAAM,IAAI,MAAY,OAAmC;AACrD,UAAM,KAAK,KAAK,OAAO,cAAc,KAAK,IAAI,KAAK;AAEnD,SAAK,KAAK,YAAY,KAAK,cAAc,QAAQ,yCAAW,KAAK,IAAI,IAAI;AAAA,MACrE,QAAQ,KAAK;AAAA,MACb,UAAU;AAAA,QACN,UAAU,KAAK;AAAA,MACnB;AAAA,IACJ,CAAC;AAED,QAAI,aAAa;AACjB,QAAI;AAEJ,UAAM,UAAU;AAAA,MACZ,WAAW,CAAC,MAAW,QAAa,SAAiB,YAAsB;AACvE,aAAK,KAAK,YAAY,KAAK,MAAM,QAAQ,SAAS;AAAA,UAC9C,QAAQ,KAAK;AAAA,UACb;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ;AAEA,WAAO,cAAc,MAAM,OAAO,YAAY;AAC1C,YAAM,mBAAmB,KAAK,IAAI;AAClC,UAAI;AACA,cAAM,SAAS,MAAM,KAAK,QAAQ,OAAO,OAAO;AAChD,cAAM,WAAW,KAAK,IAAI,IAAI;AAE9B,eAAO,QAAQ,aAAa,iBAAiB,OAAO,OAAO,KAAK,IAAI,QAAQ;AAE5E,cAAM,KAAK,KAAK,OAAO,YAAY,KAAK,IAAI,MAAM;AAElD,aAAK,KAAK,YAAY,KAAK,YAAY,WAAW,6BAAS,KAAK,IAAI,IAAI;AAAA,UACpE,QAAQ,KAAK;AAAA,UACb,UAAU;AAAA,YACN,UAAU,KAAK;AAAA,YACf,YAAY;AAAA,UAChB;AAAA,QACJ,CAAC;AAED,eAAO;AAAA,MACX,SAAS,OAAO;AACZ,oBAAY,iBAAiB,QAAQ,QAAQ,IAAI,MAAM,OAAO,KAAK,CAAC;AACpE,cAAM,WAAW,KAAK,IAAI,IAAI;AAE9B,cAAM,aAAa;AAAA;AAAA,UAEf,UAAU;AAAA,UACV;AAAA,YACI,QAAQ,KAAK;AAAA,YACb,WAAW;AAAA,YACX,eAAe;AAAA,UACnB;AAAA,QACJ;AACA,cAAM,WAAW,iBAAiB,YAAY,YAAY,MAAM,OAAO,UAAU;AAEjF,YAAI,SAAS,aAAa;AACtB;AACA,gBAAM,QAAQ,gBAAgB,aAAa,CAAC;AAE5C,eAAK,KAAK,YAAY,KAAK,SAAS,WAAW,SAAS,cAAc,yBAAU;AAAA,YAC5E,QAAQ,KAAK;AAAA,YACb,UAAU,EAAE,YAAY,MAAM;AAAA,UAClC,CAAC;AAED,kBAAQ,aAAa,eAAe,KAAK;AACzC,gBAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,KAAK,CAAC;AAAA,QAC3D,OAAO;AACH,kBAAQ,aAAa,eAAe,KAAK;AAEzC,eAAK,KAAK,YAAY,KAAK,YAAY,WAAW,yCAAW,KAAK,IAAI,IAAI;AAAA,YACtE,QAAQ,KAAK;AAAA,YACb,UAAU;AAAA,cACN,UAAU,KAAK;AAAA,cACf,OAAO,UAAU;AAAA,cACjB,kBAAkB;AAAA,cAClB,YAAY;AAAA,YAChB;AAAA,UACJ,CAAC;AAED,gBAAM;AAAA,QACV;AAAA,MACJ;AAAA,IACJ;AAEA,UAAM;AAAA,EACV;AACJ;;;AClGO,SAAS,gBACZ,OACA,eACA,OACA,cACa;AACb,MAAI,cAAc;AACd,WAAO;AAAA,EACX;AAEA,QAAM,QAAQ,MAAM,MAAM,OAAO,OAAK,EAAE,SAAS,aAAa;AAE9D,aAAW,QAAQ,OAAO;AACtB,QAAI,KAAK,WAAW;AAChB,UAAI,KAAK,UAAU,KAAK,GAAG;AACvB,eAAO,KAAK;AAAA,MAChB;AAAA,IACJ,OAAO;AACH,aAAO,KAAK;AAAA,IAChB;AAAA,EACJ;AAEA,SAAO;AACX;;;ACtBO,IAAM,oBAAN,MAAwB;AAAA,EAC3B,YACqB,aACA,aACA,OACnB;AAHmB;AACA;AACA;AAAA,EACjB;AAAA,EAEJ,MAAM,KAAK,OAA6B;AACpC,QAAI,CAAC,KAAK,YAAa;AAEvB,UAAM,aAAyB;AAAA,MAC3B,IAAI,cAAc,KAAK,IAAI,CAAC;AAAA,MAC5B,SAAS,MAAM;AAAA,MACf;AAAA,MACA,YAAY,KAAK,YAAY,UAAU,EAAE;AAAA,MACzC,WAAW,KAAK,IAAI;AAAA,IACxB;AAEA,UAAM,KAAK,YAAY,eAAe,UAAU;AAEhD,SAAK,YAAY,KAAK,cAAc,WAAW,iCAAkB,WAAW,EAAE,IAAI;AAAA,MAC9E,UAAU,EAAE,cAAc,WAAW,GAAG;AAAA,IAC5C,CAAC;AAED,UAAM,KAAK,OAAO,eAAe,UAAU;AAAA,EAC/C;AAAA,EAEA,MAAM,KAAK,cAA2C;AAClD,QAAI,CAAC,KAAK,aAAa;AACnB,YAAM,IAAI,MAAM,sFAAgB;AAAA,IACpC;AAEA,UAAM,aAAa,MAAM,KAAK,YAAY,eAAe,YAAY;AACrE,QAAI,CAAC,YAAY;AACb,YAAM,IAAI,MAAM,eAAe,YAAY,sBAAO;AAAA,IACtD;AAEA,WAAO;AAAA,EACX;AACJ;;;ACvBO,IAAM,cAAN,MAAkB;AAAA,EAMrB,YACY,OACA,aACA,OACR,SAGF;AANU;AACA;AACA;AARZ,wBAAQ;AACR,wBAAQ;AACR;AAAA,wBAAQ;AACR,wBAAQ;AAUJ,SAAK,cAAc,IAAI,YAAY;AACnC,SAAK,qBAAqB,SAAS,sBAAsB;AACzD,SAAK,eAAe,IAAI,aAAa;AAAA,MACjC,aAAa,KAAK;AAAA,MAClB,OAAO,KAAK;AAAA,IAChB,CAAC;AACD,SAAK,oBAAoB,IAAI,kBAAkB,KAAK,aAAa,KAAK,aAAa,KAAK,KAAK;AAAA,EACjG;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,QAAQ,cAAqE;AAC/E,QAAI,eAAe;AACnB,QAAI,gBAAgB,KAAK,MAAM;AAC/B,QAAI,YAAY;AAChB,UAAM,YAAY,KAAK,IAAI;AAE3B,QAAI;AACA,aAAO,iBAAiB,YAAY,KAAK,MAAM,UAAU;AAErD,cAAM,cAAc,aAAa,YAAY,YAAY;AACzD,YAAI,YAAY,UAAU;AACtB,eAAK,YAAY,KAAK,mBAAmB,WAAW,YAAY,MAAO;AACvE,gBAAM,KAAK,OAAO,kBAAkB,UAAU,GAAG,CAAC;AAClD;AAAA,QACJ;AAGA,cAAM,OAAO,KAAK,MAAM,MAAM,KAAK,OAAK,EAAE,OAAO,aAAa;AAC9D,YAAI,CAAC,MAAM;AACP,gBAAM,IAAI,MAAM,iBAAO,aAAa,sBAAO;AAAA,QAC/C;AAGA,uBAAe,aAAa,eAAe,cAAc,aAAa;AAGtE,cAAM,SAAS,MAAM,KAAK,aAAa,IAAI,MAAM,YAAY;AAC7D,uBAAe,OAAO;AAGtB,eAAO,OAAO,QAAQ,WAAS;AAC3B,eAAK,YAAY;AAAA,YACb,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,YACN;AAAA,cACI,QAAQ,MAAM;AAAA,cACd,SAAS,MAAM,aAAa,KAAK,YAAY,WAAW,MAAM,UAAU,IAAI;AAAA,cAC5E,UAAU,MAAM;AAAA,YACpB;AAAA,UACJ;AAAA,QACJ,CAAC;AAGD,YAAI,YAAY,KAAK,uBAAuB,GAAG;AAC3C,gBAAM,KAAK,kBAAkB,KAAK,YAAY;AAAA,QAClD;AAGA,cAAM,WAAW,gBAAgB,KAAK,OAAO,eAAe,cAAc,OAAO,QAAQ;AACzF,YAAI,CAAC,SAAU;AACf,wBAAgB;AAChB;AAAA,MACJ;AAGA,UAAI,aAAa,KAAK,MAAM,UAAU;AAClC,aAAK,YAAY;AAAA,UACb;AAAA,UACA;AAAA,UACA,2DAAc,KAAK,MAAM,QAAQ;AAAA,QACrC;AAAA,MACJ;AAEA,YAAM,gBAAgB,KAAK,IAAI,IAAI;AACnC,WAAK,YAAY,KAAK,kBAAkB,QAAQ,4BAA4B;AAAA,QACxE,UAAU;AAAA,UACN,iBAAiB;AAAA,UACjB,YAAY,aAAa,UAAU;AAAA,UACnC,eAAe,aAAa,UAAU;AAAA,UACtC,YAAY,aAAa,UAAU;AAAA,QACvC;AAAA,MACJ,CAAC;AAED,aAAO,EAAE,OAAO,cAAc,QAAQ,KAAK,YAAY;AAAA,IAC3D,SAAS,OAAO;AACZ,YAAM,aAAa;AAAA;AAAA,QAEf,OAAO,KAAK;AAAA,QACZ,EAAE,eAAe,iBAAiB,QAAQ,QAAQ,OAAU;AAAA,MAChE;AACA,WAAK,YAAY,KAAK,SAAS,WAAW,WAAW,SAAS;AAAA,QAC1D,SAAS;AAAA,MACb,CAAC;AAED,YAAM,KAAK,OAAO,UAAU,UAAU;AAEtC,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,cAAsE;AAC/E,UAAM,aAAa,MAAM,KAAK,kBAAkB,KAAK,YAAY;AAEjE,SAAK,YAAY,KAAK,cAAc,QAAQ,qBAAgB,YAAY,eAAK;AAE7E,WAAO,KAAK,QAAQ,WAAW,KAAK;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAKA,iBAA8B;AAC1B,WAAO,KAAK;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,qBAAqB;AACjB,WAAO,KAAK;AAAA,EAChB;AAEJ;;;AC3FO,IAAe,cAAf,MAA2B;AAAA,EAG9B,YAAY,QAA2B;AAFvC,wBAAU;AAGN,SAAK,SAAS;AAAA,MACV,aAAa;AAAA,MACb,SAAS;AAAA,MACT,GAAG;AAAA,IACP;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAoBA,WAAmB;AACf,WAAO,KAAK,OAAO;AAAA,EACvB;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,QAAgB,cAAwC;AACnE,UAAM,WAA0B,CAAC;AAEjC,QAAI,cAAc;AACd,eAAS,KAAK,EAAE,MAAM,UAAU,SAAS,aAAa,CAAC;AAAA,IAC3D;AAEA,aAAS,KAAK,EAAE,MAAM,QAAQ,SAAS,OAAO,CAAC;AAE/C,UAAM,WAAW,MAAM,KAAK,KAAK,EAAE,SAAS,CAAC;AAC7C,WAAO,SAAS;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA,EAKU,cAAc,SAAqC;AACzD,WAAO,QAAQ;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA,EAKU,YAAY,SAAkE;AACpF,WAAO;AAAA,MACH,aAAa,QAAQ,eAAe,KAAK,OAAO,eAAe;AAAA,IACnE;AAAA,EACJ;AACJ;AAeO,IAAM,mBAAN,cAA+B,MAAM;AAAA,EACxC,YACI,SACO,UACA,eACA,YACT;AACE,UAAM,OAAO;AAJN;AACA;AACA;AAGP,SAAK,OAAO;AAAA,EAChB;AACJ;;;AC1IO,IAAM,iBAAN,cAA6B,YAAY;AAAA,EAI5C,YAAY,QAA8B;AACtC,UAAM,MAAM;AAJhB,wBAAQ;AACR,wBAAQ;AAIJ,SAAK,SAAS,OAAO;AACrB,SAAK,UAAU,OAAO,WAAW;AAAA,EACrC;AAAA,EAEA,kBAA0B;AACtB,WAAO;AAAA,EACX;AAAA,EAEA,MAAM,KAAK,SAA6C;AACpD,UAAM,EAAE,YAAY,IAAI,KAAK,YAAY,OAAO;AAEhD,UAAM,cAAc;AAAA,MAChB,OAAO,KAAK,OAAO;AAAA,MACnB,UAAU,QAAQ;AAAA,MAClB;AAAA,MACA,GAAI,QAAQ,QAAQ,EAAE,OAAO,QAAQ,KAAK;AAAA,MAC1C,GAAI,QAAQ,iBAAiB,EAAE,MAAM,QAAQ,cAAc;AAAA,IAC/D;AAEA,QAAI;AAEA,YAAM,gBAAgB,YAAY,QAAQ,KAAK,OAAO,WAAW,GAAK;AACtE,YAAM,aAAa,IAAI,gBAAgB;AAGvC,YAAM,UAAU,MAAM,WAAW,MAAM;AACvC,cAAQ,QAAQ,iBAAiB,SAAS,OAAO;AACjD,oBAAc,iBAAiB,SAAS,OAAO;AAE/C,YAAM,WAAW,MAAM,MAAM,GAAG,KAAK,OAAO,wBAAwB;AAAA,QAChE,QAAQ;AAAA,QACR,SAAS;AAAA,UACL,gBAAgB;AAAA,UAChB,iBAAiB,UAAU,KAAK,MAAM;AAAA,QAC1C;AAAA,QACA,MAAM,KAAK,UAAU,WAAW;AAAA,QAChC,QAAQ,WAAW;AAAA,MACvB,CAAC;AAGD,cAAQ,QAAQ,oBAAoB,SAAS,OAAO;AAEpD,UAAI,CAAC,SAAS,IAAI;AACd,cAAM,YAAY,MAAM,SAAS,KAAK;AACtC,cAAM,IAAI;AAAA,UACN,qBAAqB,SAAS,UAAU;AAAA,UACxC;AAAA,UACA;AAAA,UACA,SAAS;AAAA,QACb;AAAA,MACJ;AAEA,YAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,aAAO;AAAA,QACH,SAAS,KAAK,QAAQ,CAAC,EAAE,QAAQ;AAAA,QACjC,cAAc,KAAK,gBAAgB,KAAK,QAAQ,CAAC,EAAE,aAAa;AAAA,QAChE,OAAO,KAAK,QAAQ;AAAA,UAChB,cAAc,KAAK,MAAM;AAAA,UACzB,kBAAkB,KAAK,MAAM;AAAA,UAC7B,aAAa,KAAK,MAAM;AAAA,QAC5B,IAAI;AAAA,QACJ,OAAO,KAAK;AAAA,MAChB;AAAA,IACJ,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAkB,OAAM;AAC7C,YAAM,IAAI;AAAA,QACN,0BAA0B,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QAChF;AAAA,QACA,iBAAiB,QAAQ,QAAQ;AAAA,MACrC;AAAA,IACJ;AAAA,EACJ;AAAA,EAEA,OAAO,WAAW,SAAuD;AACrE,UAAM,EAAE,YAAY,IAAI,KAAK,YAAY,OAAO;AAEhD,UAAM,cAAc;AAAA,MAChB,OAAO,KAAK,OAAO;AAAA,MACnB,UAAU,QAAQ;AAAA,MAClB;AAAA,MACA,QAAQ;AAAA,MACR,gBAAgB,EAAE,eAAe,KAAK;AAAA,MACtC,GAAI,QAAQ,QAAQ,EAAE,OAAO,QAAQ,KAAK;AAAA,MAC1C,GAAI,QAAQ,iBAAiB,EAAE,MAAM,QAAQ,cAAc;AAAA,IAC/D;AAEA,QAAI;AACA,YAAM,WAAW,MAAM,MAAM,GAAG,KAAK,OAAO,wBAAwB;AAAA,QAChE,QAAQ;AAAA,QACR,SAAS;AAAA,UACL,gBAAgB;AAAA,UAChB,iBAAiB,UAAU,KAAK,MAAM;AAAA,QAC1C;AAAA,QACA,MAAM,KAAK,UAAU,WAAW;AAAA,QAChC,QAAQ,QAAQ;AAAA;AAAA,MACpB,CAAC;AAED,UAAI,CAAC,SAAS,IAAI;AACd,cAAM,IAAI;AAAA,UACN,qBAAqB,SAAS,UAAU;AAAA,UACxC;AAAA,UACA;AAAA,UACA,SAAS;AAAA,QACb;AAAA,MACJ;AAEA,YAAM,SAAS,SAAS,MAAM,UAAU;AACxC,UAAI,CAAC,OAAQ,OAAM,IAAI,MAAM,kBAAkB;AAE/C,YAAM,UAAU,IAAI,YAAY;AAChC,UAAI,SAAS;AAEb,aAAO,MAAM;AACT,cAAM,EAAE,MAAM,MAAM,IAAI,MAAM,OAAO,KAAK;AAC1C,YAAI,KAAM;AAEV,kBAAU,QAAQ,OAAO,OAAO,EAAE,QAAQ,KAAK,CAAC;AAChD,cAAM,QAAQ,OAAO,MAAM,IAAI;AAC/B,iBAAS,MAAM,IAAI,KAAK;AAExB,mBAAW,QAAQ,OAAO;AACtB,cAAI,KAAK,WAAW,QAAQ,GAAG;AAC3B,kBAAM,OAAO,KAAK,MAAM,CAAC;AACzB,gBAAI,SAAS,SAAU;AAEvB,gBAAI;AACA,oBAAM,SAAS,KAAK,MAAM,IAAI;AAC9B,oBAAM,QAAQ,OAAO,QAAQ,CAAC,GAAG,OAAO;AACxC,oBAAM,eAAe,OAAO,QAAQ,CAAC,GAAG;AAExC,kBAAI,OAAO;AACP,sBAAM,EAAE,MAAM;AAAA,cAClB;AAEA,kBAAI,cAAc;AACd,sBAAM;AAAA,kBACF,OAAO;AAAA,kBACP,cAAc,KAAK,gBAAgB,YAAY;AAAA,gBACnD;AAAA,cACJ;AAEA,kBAAI,OAAO,OAAO;AACd,sBAAM;AAAA,kBACF,OAAO;AAAA,kBACP,OAAO;AAAA,oBACH,cAAc,OAAO,MAAM;AAAA,oBAC3B,kBAAkB,OAAO,MAAM;AAAA,oBAC/B,aAAa,OAAO,MAAM;AAAA,kBAC9B;AAAA,gBACJ;AAAA,cACJ;AAAA,YACJ,SAAS,GAAG;AAAA,YAEZ;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAkB,OAAM;AAC7C,YAAM,IAAI;AAAA,QACN,iCAAiC,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QACvF;AAAA,QACA,iBAAiB,QAAQ,QAAQ;AAAA,MACrC;AAAA,IACJ;AAAA,EACJ;AAAA,EAEQ,gBAAgB,QAA8C;AAClE,YAAQ,QAAQ;AAAA,MACZ,KAAK;AAAQ,eAAO;AAAA,MACpB,KAAK;AAAU,eAAO;AAAA,MACtB,KAAK;AAAkB,eAAO;AAAA,MAC9B,KAAK;AAAc,eAAO;AAAA,MAC1B;AAAS,eAAO;AAAA,IACpB;AAAA,EACJ;AACJ;;;ACxLO,IAAM,iBAAN,cAA6B,YAAY;AAAA,EAG5C,YAAY,QAA8B;AACtC,UAAM,MAAM;AAHhB,wBAAQ;AAIJ,SAAK,SAAS,OAAO;AAAA,EACzB;AAAA,EAEA,kBAA0B;AACtB,WAAO;AAAA,EACX;AAAA,EAEA,MAAM,KAAK,SAA6C;AACpD,UAAM,EAAE,YAAY,IAAI,KAAK,YAAY,OAAO;AAGhD,UAAM,WAAW,KAAK,gBAAgB,QAAQ,QAAQ;AAEtD,UAAM,cAAc;AAAA,MAChB;AAAA,MACA,kBAAkB;AAAA,QACd;AAAA,QACA,GAAI,QAAQ,QAAQ,EAAE,MAAM,QAAQ,KAAK;AAAA,QACzC,GAAI,QAAQ,iBAAiB,EAAE,eAAe,QAAQ,cAAc;AAAA,MACxE;AAAA,IACJ;AAEA,QAAI;AAEA,YAAM,gBAAgB,YAAY,QAAQ,KAAK,OAAO,WAAW,GAAK;AACtE,YAAM,aAAa,IAAI,gBAAgB;AAGvC,YAAM,UAAU,MAAM,WAAW,MAAM;AACvC,cAAQ,QAAQ,iBAAiB,SAAS,OAAO;AACjD,oBAAc,iBAAiB,SAAS,OAAO;AAE/C,YAAM,WAAW,MAAM;AAAA,QACnB,2DAA2D,KAAK,OAAO,KAAK,wBAAwB,KAAK,MAAM;AAAA,QAC/G;AAAA,UACI,QAAQ;AAAA,UACR,SAAS;AAAA,YACL,gBAAgB;AAAA,UACpB;AAAA,UACA,MAAM,KAAK,UAAU,WAAW;AAAA,UAChC,QAAQ,WAAW;AAAA,QACvB;AAAA,MACJ;AAGA,cAAQ,QAAQ,oBAAoB,SAAS,OAAO;AAEpD,UAAI,CAAC,SAAS,IAAI;AACd,cAAM,YAAY,MAAM,SAAS,KAAK;AACtC,cAAM,IAAI;AAAA,UACN,qBAAqB,SAAS,UAAU;AAAA,UACxC;AAAA,UACA;AAAA,UACA,SAAS;AAAA,QACb;AAAA,MACJ;AAEA,YAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,UAAI,CAAC,KAAK,aAAa,CAAC,GAAG,SAAS,QAAQ,CAAC,GAAG,MAAM;AAClD,cAAM,IAAI,iBAAiB,kCAAkC,QAAQ;AAAA,MACzE;AAEA,aAAO;AAAA,QACH,SAAS,KAAK,WAAW,CAAC,EAAE,QAAQ,MAAM,CAAC,EAAE;AAAA,QAC7C,cAAc,KAAK,gBAAgB,KAAK,WAAW,CAAC,EAAE,YAAY;AAAA,QAClE,OAAO,KAAK,gBAAgB;AAAA,UACxB,cAAc,KAAK,cAAc,oBAAoB;AAAA,UACrD,kBAAkB,KAAK,cAAc,wBAAwB;AAAA,UAC7D,aAAa,KAAK,cAAc,mBAAmB;AAAA,QACvD,IAAI;AAAA,QACJ,OAAO,KAAK,OAAO;AAAA,MACvB;AAAA,IACJ,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAkB,OAAM;AAC7C,YAAM,IAAI;AAAA,QACN,0BAA0B,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QAChF;AAAA,QACA,iBAAiB,QAAQ,QAAQ;AAAA,MACrC;AAAA,IACJ;AAAA,EACJ;AAAA,EAEA,OAAO,WAAW,SAAuD;AACrE,UAAM,EAAE,YAAY,IAAI,KAAK,YAAY,OAAO;AAEhD,UAAM,WAAW,KAAK,gBAAgB,QAAQ,QAAQ;AAEtD,UAAM,cAAc;AAAA,MAChB;AAAA,MACA,kBAAkB;AAAA,QACd;AAAA,QACA,GAAI,QAAQ,QAAQ,EAAE,MAAM,QAAQ,KAAK;AAAA,QACzC,GAAI,QAAQ,iBAAiB,EAAE,eAAe,QAAQ,cAAc;AAAA,MACxE;AAAA,IACJ;AAEA,QAAI;AACA,YAAM,WAAW,MAAM;AAAA,QACnB,2DAA2D,KAAK,OAAO,KAAK,8BAA8B,KAAK,MAAM;AAAA,QACrH;AAAA,UACI,QAAQ;AAAA,UACR,SAAS;AAAA,YACL,gBAAgB;AAAA,UACpB;AAAA,UACA,MAAM,KAAK,UAAU,WAAW;AAAA,UAChC,QAAQ,QAAQ;AAAA;AAAA,QACpB;AAAA,MACJ;AAEA,UAAI,CAAC,SAAS,IAAI;AACd,cAAM,IAAI;AAAA,UACN,qBAAqB,SAAS,UAAU;AAAA,UACxC;AAAA,UACA;AAAA,UACA,SAAS;AAAA,QACb;AAAA,MACJ;AAEA,YAAM,SAAS,SAAS,MAAM,UAAU;AACxC,UAAI,CAAC,OAAQ,OAAM,IAAI,MAAM,kBAAkB;AAE/C,YAAM,UAAU,IAAI,YAAY;AAChC,UAAI,SAAS;AAEb,aAAO,MAAM;AACT,cAAM,EAAE,MAAM,MAAM,IAAI,MAAM,OAAO,KAAK;AAC1C,YAAI,KAAM;AAEV,kBAAU,QAAQ,OAAO,OAAO,EAAE,QAAQ,KAAK,CAAC;AAChD,cAAM,QAAQ,OAAO,MAAM,IAAI;AAC/B,iBAAS,MAAM,IAAI,KAAK;AAExB,mBAAW,QAAQ,OAAO;AACtB,cAAI,KAAK,KAAK,GAAG;AACb,gBAAI;AACA,oBAAM,SAAS,KAAK,MAAM,IAAI;AAC9B,oBAAM,OAAO,OAAO,aAAa,CAAC,GAAG,SAAS,QAAQ,CAAC,GAAG;AAC1D,oBAAM,eAAe,OAAO,aAAa,CAAC,GAAG;AAE7C,kBAAI,MAAM;AACN,sBAAM,EAAE,OAAO,KAAK;AAAA,cACxB;AAEA,kBAAI,cAAc;AACd,sBAAM;AAAA,kBACF,OAAO;AAAA,kBACP,cAAc,KAAK,gBAAgB,YAAY;AAAA,gBACnD;AAAA,cACJ;AAAA,YACJ,SAAS,GAAG;AAAA,YAEZ;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAkB,OAAM;AAC7C,YAAM,IAAI;AAAA,QACN,iCAAiC,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QACvF;AAAA,QACA,iBAAiB,QAAQ,QAAQ;AAAA,MACrC;AAAA,IACJ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKQ,gBAAgB,UAAgC;AACpD,UAAM,WAAkB,CAAC;AAEzB,eAAW,OAAO,UAAU;AACxB,UAAI,IAAI,SAAS,UAAU;AAEvB,iBAAS,KAAK;AAAA,UACV,MAAM;AAAA,UACN,OAAO,CAAC,EAAE,MAAM,WAAW,IAAI,OAAO,GAAG,CAAC;AAAA,QAC9C,CAAC;AACD,iBAAS,KAAK;AAAA,UACV,MAAM;AAAA,UACN,OAAO,CAAC,EAAE,MAAM,gDAAgD,CAAC;AAAA,QACrE,CAAC;AAAA,MACL,WAAW,IAAI,SAAS,QAAQ;AAC5B,iBAAS,KAAK;AAAA,UACV,MAAM;AAAA,UACN,OAAO,CAAC,EAAE,MAAM,IAAI,QAAQ,CAAC;AAAA,QACjC,CAAC;AAAA,MACL,WAAW,IAAI,SAAS,aAAa;AACjC,iBAAS,KAAK;AAAA,UACV,MAAM;AAAA,UACN,OAAO,CAAC,EAAE,MAAM,IAAI,QAAQ,CAAC;AAAA,QACjC,CAAC;AAAA,MACL;AAAA,IACJ;AAEA,WAAO;AAAA,EACX;AAAA,EAEQ,gBAAgB,QAA+C;AACnE,YAAQ,QAAQ;AAAA,MACZ,KAAK;AAAQ,eAAO;AAAA,MACpB,KAAK;AAAc,eAAO;AAAA,MAC1B,KAAK;AAAU,eAAO;AAAA,MACtB;AAAS,eAAO;AAAA,IACpB;AAAA,EACJ;AACJ;;;ACpNO,IAAM,mBAAN,cAA+B,YAAY;AAAA,EAG9C,YAAY,QAAgC;AACxC,UAAM,MAAM;AAHhB,wBAAQ;AAIJ,SAAK,UAAU,OAAO;AAAA,EAC1B;AAAA,EAEA,kBAA0B;AACtB,WAAO;AAAA,EACX;AAAA,EAEA,MAAM,KAAK,SAA6C;AACpD,UAAM,EAAE,YAAY,IAAI,KAAK,YAAY,OAAO;AAEhD,UAAM,cAAc;AAAA,MAChB,OAAO,KAAK,OAAO;AAAA,MACnB,UAAU,QAAQ;AAAA,MAClB;AAAA,MACA,GAAI,QAAQ,QAAQ,EAAE,OAAO,QAAQ,KAAK;AAAA,MAC1C,GAAI,QAAQ,iBAAiB,EAAE,MAAM,QAAQ,cAAc;AAAA,IAC/D;AAEA,QAAI;AAEA,YAAM,gBAAgB,YAAY,QAAQ,KAAK,OAAO,WAAW,GAAK;AACtE,YAAM,aAAa,IAAI,gBAAgB;AAGvC,YAAM,UAAU,MAAM,WAAW,MAAM;AACvC,cAAQ,QAAQ,iBAAiB,SAAS,OAAO;AACjD,oBAAc,iBAAiB,SAAS,OAAO;AAE/C,YAAM,WAAW,MAAM,MAAM,GAAG,KAAK,OAAO,wBAAwB;AAAA,QAChE,QAAQ;AAAA,QACR,SAAS;AAAA,UACL,gBAAgB;AAAA,QACpB;AAAA,QACA,MAAM,KAAK,UAAU,WAAW;AAAA,QAChC,QAAQ,WAAW;AAAA,MACvB,CAAC;AAGD,cAAQ,QAAQ,oBAAoB,SAAS,OAAO;AAEpD,UAAI,CAAC,SAAS,IAAI;AACd,cAAM,YAAY,MAAM,SAAS,KAAK;AACtC,cAAM,IAAI;AAAA,UACN,wBAAwB,SAAS,UAAU;AAAA,UAC3C;AAAA,UACA;AAAA,UACA,SAAS;AAAA,QACb;AAAA,MACJ;AAEA,YAAM,OAAO,MAAM,SAAS,KAAK;AAEjC,aAAO;AAAA,QACH,SAAS,KAAK,QAAQ,CAAC,EAAE,QAAQ;AAAA,QACjC,cAAc,KAAK,gBAAgB,KAAK,QAAQ,CAAC,EAAE,aAAa;AAAA,QAChE,OAAO,KAAK,QAAQ;AAAA,UAChB,cAAc,KAAK,MAAM;AAAA,UACzB,kBAAkB,KAAK,MAAM;AAAA,UAC7B,aAAa,KAAK,MAAM;AAAA,QAC5B,IAAI;AAAA,QACJ,OAAO,KAAK;AAAA,MAChB;AAAA,IACJ,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAkB,OAAM;AAC7C,YAAM,IAAI;AAAA,QACN,6BAA6B,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QACnF;AAAA,QACA,iBAAiB,QAAQ,QAAQ;AAAA,MACrC;AAAA,IACJ;AAAA,EACJ;AAAA,EAEA,OAAO,WAAW,SAAuD;AACrE,UAAM,EAAE,YAAY,IAAI,KAAK,YAAY,OAAO;AAEhD,UAAM,cAAc;AAAA,MAChB,OAAO,KAAK,OAAO;AAAA,MACnB,UAAU,QAAQ;AAAA,MAClB;AAAA,MACA,QAAQ;AAAA,MACR,gBAAgB,EAAE,eAAe,KAAK;AAAA,MACtC,GAAI,QAAQ,QAAQ,EAAE,OAAO,QAAQ,KAAK;AAAA,MAC1C,GAAI,QAAQ,iBAAiB,EAAE,MAAM,QAAQ,cAAc;AAAA,IAC/D;AAEA,QAAI;AACA,YAAM,WAAW,MAAM,MAAM,GAAG,KAAK,OAAO,wBAAwB;AAAA,QAChE,QAAQ;AAAA,QACR,SAAS;AAAA,UACL,gBAAgB;AAAA,QACpB;AAAA,QACA,MAAM,KAAK,UAAU,WAAW;AAAA,QAChC,QAAQ,QAAQ;AAAA;AAAA,MACpB,CAAC;AAED,UAAI,CAAC,SAAS,IAAI;AACd,cAAM,IAAI;AAAA,UACN,wBAAwB,SAAS,UAAU;AAAA,UAC3C;AAAA,UACA;AAAA,UACA,SAAS;AAAA,QACb;AAAA,MACJ;AAEA,YAAM,SAAS,SAAS,MAAM,UAAU;AACxC,UAAI,CAAC,OAAQ,OAAM,IAAI,MAAM,kBAAkB;AAE/C,YAAM,UAAU,IAAI,YAAY;AAChC,UAAI,SAAS;AAEb,UAAI,gBAAgB;AAEpB,aAAO,MAAM;AAET,YAAI,QAAQ,QAAQ,SAAS;AACzB,gBAAM,OAAO,OAAO;AACpB;AAAA,QACJ;AAEA,cAAM,EAAE,MAAM,MAAM,IAAI,MAAM,OAAO,KAAK;AAC1C,YAAI,KAAM;AAEV,kBAAU,QAAQ,OAAO,OAAO,EAAE,QAAQ,KAAK,CAAC;AAChD,cAAM,QAAQ,OAAO,MAAM,IAAI;AAC/B,iBAAS,MAAM,IAAI,KAAK;AAExB,mBAAW,QAAQ,OAAO;AACtB,cAAI,KAAK,WAAW,QAAQ,GAAG;AAC3B,kBAAM,OAAO,KAAK,MAAM,CAAC;AACzB,gBAAI,SAAS,SAAU;AAEvB,gBAAI;AACA,oBAAM,SAAS,KAAK,MAAM,IAAI;AAC9B,oBAAM,eAAe,OAAO,QAAQ,CAAC,GAAG,OAAO;AAC/C,oBAAM,iBAAiB,OAAO,QAAQ,CAAC,GAAG,OAAO;AACjD,oBAAM,eAAe,OAAO,QAAQ,CAAC,GAAG;AAExC,kBAAI,gBAAgB;AAChB,sBAAM,SAAS,gBAAgB,KAAK;AACpC,gCAAgB;AAChB,sBAAM,EAAE,OAAO,GAAG,MAAM,GAAG,cAAc,GAAG;AAAA,cAChD;AAEA,kBAAI,cAAc;AACd,sBAAM,SAAS,gBAAgB,aAAa;AAC5C,gCAAgB;AAChB,sBAAM,EAAE,OAAO,GAAG,MAAM,GAAG,YAAY,GAAG;AAAA,cAC9C;AAEA,kBAAI,cAAc;AACd,oBAAI,eAAe;AACf,kCAAgB;AAChB,wBAAM,EAAE,OAAO,WAAW;AAAA,gBAC9B;AACA,sBAAM;AAAA,kBACF,OAAO;AAAA,kBACP,cAAc,KAAK,gBAAgB,YAAY;AAAA,gBACnD;AAAA,cACJ;AAEA,kBAAI,OAAO,OAAO;AACd,sBAAM;AAAA,kBACF,OAAO;AAAA,kBACP,OAAO;AAAA,oBACH,cAAc,OAAO,MAAM;AAAA,oBAC3B,kBAAkB,OAAO,MAAM;AAAA,oBAC/B,aAAa,OAAO,MAAM;AAAA,kBAC9B;AAAA,gBACJ;AAAA,cACJ;AAAA,YACJ,SAAS,GAAG;AAAA,YAEZ;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAEA,UAAI,eAAe;AACf,cAAM,EAAE,OAAO,WAAW;AAAA,MAC9B;AAAA,IACJ,SAAS,OAAO;AACZ,UAAI,iBAAiB,iBAAkB,OAAM;AAC7C,YAAM,IAAI;AAAA,QACN,oCAAoC,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QAC1F;AAAA,QACA,iBAAiB,QAAQ,QAAQ;AAAA,MACrC;AAAA,IACJ;AAAA,EACJ;AAAA,EAEQ,gBAAgB,QAA8C;AAClE,YAAQ,QAAQ;AAAA,MACZ,KAAK;AAAQ,eAAO;AAAA,MACpB,KAAK;AAAU,eAAO;AAAA,MACtB,KAAK;AAAkB,eAAO;AAAA,MAC9B;AAAS,eAAO;AAAA,IACpB;AAAA,EACJ;AACJ;;;AC1MO,SAAS,kBAAkB,QAAwC;AACtE,UAAQ,OAAO,MAAM;AAAA,IACjB,KAAK;AACD,aAAO,IAAI,eAAe;AAAA,QACtB,QAAQ,OAAO;AAAA,QACf,OAAO,OAAO;AAAA,QACd,SAAS,OAAO;AAAA,QAChB,aAAa,OAAO;AAAA,QACpB,SAAS,OAAO;AAAA,MACpB,CAAC;AAAA,IAEL,KAAK;AACD,aAAO,IAAI,eAAe;AAAA,QACtB,QAAQ,OAAO;AAAA,QACf,OAAO,OAAO;AAAA,QACd,aAAa,OAAO;AAAA,QACpB,SAAS,OAAO;AAAA,MACpB,CAAC;AAAA,IAEL,KAAK;AACD,aAAO,IAAI,iBAAiB;AAAA,QACxB,SAAS,OAAO;AAAA,QAChB,OAAO,OAAO;AAAA,QACd,aAAa,OAAO;AAAA,QACpB,SAAS,OAAO;AAAA,MACpB,CAAC;AAAA,IAEL;AACI,YAAM,IAAI,MAAM,0BAA2B,OAAe,IAAI,EAAE;AAAA,EACxE;AACJ;AAsBO,SAAS,2BAA2B,UAA4C;AACnF,UAAQ,SAAS,UAAU;AAAA,IACvB,KAAK;AACD,aAAO,kBAAkB;AAAA,QACrB,MAAM;AAAA,QACN,QAAQ,SAAS,OAAO;AAAA,QACxB,OAAO,SAAS,OAAO;AAAA,QACvB,SAAS,SAAS,OAAO;AAAA,MAC7B,CAAC;AAAA,IAEL,KAAK;AACD,aAAO,kBAAkB;AAAA,QACrB,MAAM;AAAA,QACN,QAAQ,SAAS,OAAO;AAAA,QACxB,OAAO,SAAS,OAAO;AAAA,MAC3B,CAAC;AAAA,IAEL,KAAK;AACD,aAAO,kBAAkB;AAAA,QACrB,MAAM;AAAA,QACN,SAAS,SAAS,SAAS;AAAA,QAC3B,OAAO,SAAS,SAAS;AAAA,MAC7B,CAAC;AAAA,IAEL;AACI,YAAM,IAAI,MAAM,qBAAqB,SAAS,QAAQ,EAAE;AAAA,EAChE;AACJ;;;ACpFO,IAAM,iBAAN,cAA6B,SAAS;AAAA,EAGzC,YACY,cACR,QACF;AACE,UAAM,WAAW,aAAa;AAHtB;AAHZ,wBAAQ;AAOJ,SAAK,WAAW,QAAQ;AAAA,EAC5B;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,UAA6B;AACrC,SAAK,WAAW;AAAA,EACpB;AAAA,EAEA,MAAM,QAAQ,OAAc,SAAoC;AAC5D,UAAM,SAA+B,CAAC;AAEtC,QAAI;AAEA,YAAM,EAAE,SAAS,MAAM,IAAI,MAAM,KAAK,oBAAoB,OAAO,MAAM,KAAK,MAAM,OAAO;AACzF,YAAM,QAAQ,KAAK,WAAW,OAAO;AAGrC,UAAI,WAAW,YAAY,OAAO,WAAS;AACvC,cAAM,KAAK,OAAO;AAClB,cAAM,KAAK,QAAQ;AACnB,cAAM,KAAK,WAAW;AAAA,MAC1B,CAAC;AAGD,UAAI,OAAO;AACP,mBAAW,aAAa,cAAc,UAAU;AAAA,UAC5C,QAAQ,MAAM;AAAA,UACd,YAAY,MAAM;AAAA,UAClB,OAAO,MAAM;AAAA,QACjB,CAAC;AAAA,MACL;AAEA,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,0BAAW,MAAM,MAAM,sCAAkB,OAAO,eAAe,SAAS;AAAA,QACjF,UAAU;AAAA,UACN,WAAW,MAAM;AAAA,UACjB;AAAA,QACJ;AAAA,MACJ,CAAC;AAED,aAAO,KAAK,aAAa,UAAU,MAAM;AAAA,IAC7C,SAAS,OAAO;AACZ,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,6BAAS,KAAK;AAAA,MAC3B,CAAC;AAED,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,oBACV,OACA,MACA,SACyC;AACzC,UAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBrB,UAAM,aAAa,iCAAQ,IAAI;AAAA;AAAA;AAG/B,QAAI,KAAK,UAAU;AACf,aAAO,KAAK,iBAAiB,cAAc,YAAY,OAAO,OAAO;AAAA,IACzE;AAGA,WAAO,KAAK,qBAAqB,cAAc,YAAY,OAAO,OAAO;AAAA,EAC7E;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,iBACV,cACA,YACA,OACA,SACyC;AACzC,UAAM,WAA0B;AAAA,MAC5B,EAAE,MAAM,UAAU,SAAS,aAAa;AAAA,MACxC,EAAE,MAAM,QAAQ,SAAS,WAAW;AAAA,IACxC;AAEA,UAAM,eAAe,MAAM,OAAO,iBAAiB;AAEnD,QAAI,gBAAgB,SAAS,WAAW;AAEpC,UAAI,cAAc;AAClB,YAAM,SAAS,KAAK,SAAU,WAAW;AAAA,QACrC;AAAA,QACA,aAAa;AAAA,MACjB,CAAC;AAED,uBAAiB,SAAS,QAAQ;AAC9B,YAAI,MAAM,OAAO;AACb,yBAAe,MAAM;AACrB,kBAAQ,UAAU,gBAAgB,QAAQ,sBAAsB,EAAE,OAAO,MAAM,MAAM,CAAC;AAAA,QAC1F;AAAA,MACJ;AAEA,cAAQ,IAAI,gCAAgC,WAAW;AAEvD,aAAO;AAAA,QACH,SAAS,YAAY,KAAK;AAAA,QAC1B,OAAO;AAAA;AAAA,MACX;AAAA,IACJ,OAAO;AAEH,YAAM,WAAW,MAAM,KAAK,SAAU,KAAK;AAAA,QACvC;AAAA,QACA,aAAa;AAAA,MACjB,CAAC;AAED,cAAQ,IAAI,gCAAgC,SAAS,OAAO;AAE5D,aAAO;AAAA,QACH,SAAS,SAAS,QAAQ,KAAK;AAAA,QAC/B,OAAO,SAAS;AAAA,MACpB;AAAA,IACJ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,qBACV,cACA,YACA,OACA,SACyC;AACzC,UAAM,eAAe,MAAM,OAAO,iBAAiB;AAEnD,UAAM,SAAS,MAAM,KAAK,aAAa,QAAQ,iBAAiB;AAAA,MAC5D,QAAQ;AAAA,MACR;AAAA,MACA,aAAa;AAAA,MACb,UAAU,eAAe,CAAC,UAAkB;AACxC,iBAAS,UAAU,gBAAgB,QAAQ,sBAAsB,EAAE,MAAM,CAAC;AAAA,MAC9E,IAAI;AAAA,IACR,CAAC;AAED,QAAI,CAAC,OAAO,WAAW,CAAC,OAAO,QAAQ;AACnC,cAAQ,MAAM,kDAAyB;AACvC,YAAM,IAAI,MAAM,8BAAU;AAAA,IAC9B;AAEA,UAAM,SAAS,OAAO;AACtB,YAAQ,IAAI,gCAAgC,OAAO,OAAO;AAE1D,WAAO;AAAA,MACH,SAAS,OAAO,QAAQ,KAAK;AAAA,MAC7B,OAAO,OAAO;AAAA,IAClB;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKQ,WAAW,MAA0B;AACzC,UAAM,QAAQ,KAAK,MAAM,IAAI,EAAE,OAAO,UAAQ,KAAK,KAAK,CAAC;AAEzD,WAAO,MAAM,IAAI,CAAC,MAAM,WAAW;AAAA,MAC/B,IAAI,QAAQ,QAAQ,CAAC;AAAA,MACrB,aAAa,KAAK,QAAQ,aAAa,EAAE;AAAA;AAAA,MACzC,QAAQ;AAAA,IACZ,EAAE;AAAA,EACN;AACJ;;;ACpNO,SAAS,wBAAwB,QAAkC;AACtE,MAAI,CAAC,UAAU,CAAC,OAAO,KAAM,QAAO,CAAC;AAErC,MAAI;AACA,UAAM,QAAQ,OAAO,KAAK,QAAQ;AAClC,QAAI,CAAC,MAAO,QAAO,CAAC;AAEpB,UAAM,aAAkC,CAAC;AACzC,eAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,KAAK,GAAG;AAC9C,YAAM,MAAO,OAAe;AAC5B,UAAI,KAAK;AACL,mBAAW,GAAG,IAAI;AAAA,UACd,MAAM,kBAAkB,IAAI,QAAQ;AAAA,UACpC,aAAa,IAAI,eAAe;AAAA,QACpC;AAAA,MACJ;AAAA,IACJ;AACA,WAAO;AAAA,EACX,QAAQ;AACJ,WAAO,CAAC;AAAA,EACZ;AACJ;AAKO,SAAS,sBAAsB,QAAuB;AACzD,MAAI,CAAC,UAAU,CAAC,OAAO,KAAM,QAAO,CAAC;AAErC,MAAI;AACA,UAAM,QAAQ,OAAO,KAAK,QAAQ;AAClC,QAAI,CAAC,MAAO,QAAO,CAAC;AAEpB,UAAM,WAAqB,CAAC;AAC5B,eAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,KAAK,GAAG;AAC9C,YAAM,MAAO,OAAe;AAC5B,UAAI,OAAO,IAAI,aAAa,eAAe;AACvC,iBAAS,KAAK,GAAG;AAAA,MACrB;AAAA,IACJ;AACA,WAAO;AAAA,EACX,QAAQ;AACJ,WAAO,CAAC;AAAA,EACZ;AACJ;AAKO,SAAS,kBAAkB,SAAyB;AACvD,QAAM,UAAkC;AAAA,IACpC,aAAa;AAAA,IACb,aAAa;AAAA,IACb,cAAc;AAAA,IACd,YAAY;AAAA,IACZ,aAAa;AAAA,EACjB;AACA,SAAO,QAAQ,OAAO,KAAK;AAC/B;AAKO,SAAS,qBACZ,cACA,eAAyB,CAAC,eAAe,GACH;AACtC,SAAO,aAAa,KAAK,EACpB,OAAO,UAAQ,CAAC,aAAa,SAAS,IAAI,CAAC,EAC3C,IAAI,UAAQ;AACT,UAAM,OAAO,aAAa,IAAI,IAAI;AAClC,WAAO;AAAA,MACH,MAAM;AAAA,MACN,UAAU;AAAA,QACN;AAAA,QACA,aAAa,KAAK;AAAA,QAClB,YAAY;AAAA,UACR,MAAM;AAAA,UACN,YAAY,wBAAwB,KAAK,WAAW;AAAA,UACpD,UAAU,sBAAsB,KAAK,WAAW;AAAA,QACpD;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ,CAAC;AACT;;;AC1EA,eAAsB,eAClB,cACA,iBACA,UAAkC,CAAC,GACV;AACzB,MAAI,QAAQ,UAAU;AAClB,WAAO,mBAAmB,cAAc,iBAAiB,QAAQ,QAAQ;AAAA,EAC7E;AAEA,QAAM,iBAAiB,QAAQ;AAC/B,MAAI,gBAAgB,SAAS;AACzB,WAAO,gBAAgB,cAAc,iBAAiB,eAAe,SAAS,eAAe,SAAS,eAAe;AAAA,EACzH;AAEA,SAAO,gBAAgB,cAAc,iBAAiB,yBAAyB,wBAAwB;AAC3G;AAEA,eAAe,mBACX,cACA,iBACA,UACyB;AACzB,QAAM,QAAQ,qBAAqB,YAAY;AAE/C,MAAI,MAAM,WAAW,GAAG;AACpB,WAAO,EAAE,MAAM,MAAM,OAAO,OAAU;AAAA,EAC1C;AAEA,QAAM,WAA0B;AAAA,IAC5B;AAAA,MACI,MAAM;AAAA,MACN,SAAS;AAAA,EAA2C,MAAM,IAAI,OAAK,KAAK,EAAE,SAAS,IAAI,KAAK,EAAE,SAAS,WAAW,EAAE,EAAE,KAAK,IAAI,CAAC;AAAA;AAAA;AAAA,IACpI;AAAA,IACA,EAAE,MAAM,QAAQ,SAAS,SAAS,eAAe,GAAG;AAAA,EACxD;AAEA,MAAI;AACA,UAAM,WAAW,MAAM,SAAS,KAAK,EAAE,UAAU,aAAa,IAAI,CAAC;AACnE,UAAM,SAAS,kBAAkB,SAAS,OAAO;AAEjD,QAAI,QAAQ,QAAQ,aAAa,IAAI,OAAO,IAAI,GAAG;AAC/C,aAAO,EAAE,MAAM,EAAE,UAAU,OAAO,MAAM,OAAO,OAAO,SAAS,CAAC,EAAE,GAAG,OAAO,SAAS,MAAM;AAAA,IAC/F;AACA,WAAO,EAAE,MAAM,MAAM,OAAO,SAAS,MAAM;AAAA,EAC/C,SAAS,OAAO;AACZ,YAAQ,MAAM,gCAAgC,KAAK;AACnD,WAAO,EAAE,MAAM,eAAe,eAAe,GAAG,OAAO,OAAU;AAAA,EACrE;AACJ;AAEA,eAAe,gBACX,cACA,iBACA,SACA,OACyB;AACzB,QAAM,QAAQ,qBAAqB,YAAY;AAC/C,MAAI,MAAM,WAAW,EAAG,QAAO,EAAE,MAAM,MAAM,OAAO,OAAU;AAE9D,MAAI;AACA,UAAM,WAAW,MAAM,MAAM,GAAG,OAAO,wBAAwB;AAAA,MAC3D,QAAQ;AAAA,MACR,SAAS,EAAE,gBAAgB,mBAAmB;AAAA,MAC9C,MAAM,KAAK,UAAU;AAAA,QACjB;AAAA,QACA,UAAU;AAAA,UACN,EAAE,MAAM,UAAU,SAAS,qCAAqC;AAAA,UAChE,EAAE,MAAM,QAAQ,SAAS,SAAS,eAAe,GAAG;AAAA,QACxD;AAAA,QACA;AAAA,QACA,aAAa;AAAA,MACjB,CAAC;AAAA,IACL,CAAC;AAED,QAAI,CAAC,SAAS,IAAI;AACd,aAAO,EAAE,MAAM,eAAe,eAAe,GAAG,OAAO,OAAU;AAAA,IACrE;AAEA,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,UAAM,YAAY,KAAK,UAAU,CAAC,GAAG,SAAS;AAE9C,QAAI,YAAY,CAAC,GAAG;AAChB,YAAM,EAAE,MAAM,WAAW,KAAK,IAAI,UAAU,CAAC,EAAE;AAC/C,UAAI,aAAa,IAAI,IAAI,GAAG;AACxB,eAAO,EAAE,MAAM,EAAE,UAAU,MAAM,OAAO,KAAK,MAAM,IAAI,EAAE,GAAG,OAAO,KAAK,MAAM;AAAA,MAClF;AAAA,IACJ;AACA,WAAO,EAAE,MAAM,MAAM,OAAO,KAAK,MAAM;AAAA,EAC3C,SAAS,OAAO;AACZ,WAAO,EAAE,MAAM,eAAe,eAAe,GAAG,OAAO,OAAU;AAAA,EACrE;AACJ;AAEA,SAAS,kBAAkB,SAA8D;AACrF,MAAI;AACA,UAAM,QAAQ,QAAQ,MAAM,aAAa;AACzC,QAAI,MAAO,QAAO,KAAK,MAAM,MAAM,CAAC,CAAC;AAAA,EACzC,QAAQ;AAAA,EAAE;AACV,SAAO;AACX;AAEA,SAAS,eAAe,MAA2D;AAC/E,QAAM,QAAQ,KAAK,YAAY;AAC/B,MAAI,MAAM,SAAS,KAAK,KAAK,MAAM,SAAS,cAAI,GAAG;AAC/C,WAAO,EAAE,UAAU,aAAa,OAAO,EAAE,OAAO,+BAA+B,EAAE;AAAA,EACrF;AACA,MAAI,MAAM,SAAS,cAAI,KAAK,MAAM,SAAS,cAAI,GAAG;AAC9C,WAAO,EAAE,UAAU,mBAAmB,OAAO,EAAE,UAAU,CAAC,cAAI,EAAE,EAAE;AAAA,EACtE;AACA,SAAO;AACX;;;AC9GO,IAAM,iBAAN,cAA6B,SAAS;AAAA,EAGzC,YACY,cACR,QACF;AACE,UAAM,eAAe,YAAY;AAHzB;AAHZ,wBAAQ;AAOJ,SAAK,WAAW,QAAQ;AAAA,EAC5B;AAAA;AAAA,EAGA,YAAY,UAA6B;AACrC,SAAK,WAAW;AAAA,EACpB;AAAA,EAEA,MAAM,QAAQ,OAAc,SAA4C;AACpE,UAAM,SAA+B,CAAC;AACtC,QAAI,eAAe;AAEnB,UAAM,cAAc,MAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB;AAChE,QAAI,CAAC,aAAa;AACd,YAAM,IAAI,MAAM,kDAAU;AAAA,IAC9B;AAEA,mBAAe,YAAY,cAAc,WAAS;AAC9C,YAAM,OAAO,MAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB;AACzD,UAAI,MAAM;AACN,aAAK,SAAS;AAAA,MAClB;AAAA,IACJ,CAAC;AAED,QAAI;AACA,YAAM,cAAc,aAAa,KAAK;AACtC,UAAI,aAAa;AACb,YAAI,YAAY,WAAW,YAAY,IAAI;AACvC,yBAAe,YAAY,cAAc,WAAS;AAC9C,mBAAO,MAAM,KAAK;AAAA,UACtB,CAAC;AAAA,QACL,WAAW,YAAY,WAAW,WAAW;AACzC,iBAAO,KAAK,aAAa,cAAc,MAAM;AAAA,QACjD,WAAW,YAAY,WAAW,YAAY;AAC1C,iBAAO,MAAM,KAAK,gBAAgB,cAAc,aAAa,aAAa,SAAS,MAAM;AAAA,QAC7F,WAAW,YAAY,WAAW,UAAU;AACxC,yBAAe,KAAK,qBAAqB,cAAc,WAAW;AAClE,iBAAO,KAAK;AAAA,YACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,YACrB,WAAW,KAAK,IAAI;AAAA,YACpB,MAAM;AAAA,YACN,QAAQ,KAAK;AAAA,YACb,QAAQ;AAAA,YACR,SAAS,gBAAM,YAAY,QAAQ;AAAA,YACnC,UAAU;AAAA,cACN,UAAU,YAAY;AAAA,cACtB,QAAQ,YAAY;AAAA,cACpB,QAAQ,YAAY;AAAA,cACpB,SAAS;AAAA,YACb;AAAA,UACJ,CAAC;AACD,iBAAO,KAAK,aAAa,cAAc,MAAM;AAAA,QACjD;AAAA,MACJ;AAEA,YAAM,EAAE,MAAM,UAAU,MAAM,IAAI,MAAM;AAAA,QACpC,KAAK;AAAA,QACL,YAAY;AAAA,QACZ,EAAE,UAAU,KAAK,UAAU,gBAAgB,MAAM,UAAU,eAAsB;AAAA,MACrF;AAEA,UAAI,OAAO;AACP,uBAAe,aAAa,cAAc,cAAc;AAAA,UACpD,QAAQ,MAAM;AAAA,UACd,YAAY,MAAM;AAAA,UAClB,OAAO,MAAM;AAAA,QACjB,CAAC;AAAA,MACL;AAEA,UAAI,CAAC,UAAU;AACX,uBAAe,YAAY,cAAc,WAAS;AAC9C,gBAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB,EAAE,SAAS;AACvD,gBAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB,EAAE,SAAS;AACvD,iBAAO,MAAM,KAAK;AAAA,QACtB,CAAC;AAED,eAAO,KAAK;AAAA,UACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,UACrB,WAAW,KAAK,IAAI;AAAA,UACpB,MAAM;AAAA,UACN,QAAQ,KAAK;AAAA,UACb,QAAQ;AAAA,UACR,SAAS,iBAAO,YAAY,WAAW;AAAA,QAC3C,CAAC;AAED,eAAO,KAAK,aAAa,cAAc,MAAM;AAAA,MACjD;AAEA,UACI,aAAa,OAAO,gBACjB,aAAa,OAAO,aAAa,SAAS,KAC1C,CAAC,aAAa,OAAO,aAAa,SAAS,SAAS,QAAQ,GACjE;AACE,uBAAe,YAAY,cAAc,WAAS;AAC9C,gBAAM,OAAO,MAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB;AACzD,cAAI,MAAM;AACN,iBAAK,SAAS;AACd,iBAAK,QAAQ,SAAS,SAAS,QAAQ;AAAA,UAC3C;AACA,iBAAO,MAAM,KAAK;AAAA,QACtB,CAAC;AAED,eAAO,KAAK;AAAA,UACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,UACrB,WAAW,KAAK,IAAI;AAAA,UACpB,MAAM;AAAA,UACN,QAAQ,KAAK;AAAA,UACb,QAAQ;AAAA,UACR,SAAS,gBAAM,SAAS,QAAQ;AAAA,UAChC,UAAU;AAAA,YACN,UAAU,SAAS;AAAA,YACnB,QAAQ,YAAY;AAAA,YACpB,SAAS;AAAA,YACT,QAAQ;AAAA,UACZ;AAAA,QACJ,CAAC;AACD,iBAAS,UAAU,SAAS,WAAW,qBAAqB;AAAA,UACxD,UAAU,SAAS;AAAA,UACnB,QAAQ,YAAY;AAAA,UACpB,QAAQ;AAAA,QACZ,CAAC;AAED,eAAO,KAAK,aAAa,cAAc,MAAM;AAAA,MACjD;AAEA,YAAM,OAAO,KAAK,aAAa,IAAI,SAAS,QAAQ;AACpD,UAAI,QAAQ,KAAK,sBAAsB;AACnC,cAAM,UAAU,KAAK,qBAAqB,SAAS,UAAU,SAAS,OAAO,aAAa,IAAI;AAC9F,uBAAe,YAAY,cAAc,WAAS;AAC9C,gBAAM,KAAK,kBAAkB;AAAA,QACjC,CAAC;AACD,eAAO,KAAK,aAAa,cAAc,MAAM;AAAA,MACjD;AAEA,aAAO,MAAM,KAAK,gBAAgB,cAAc,aAAa,UAAU,SAAS,MAAM;AAAA,IAC1F,SAAS,OAAO;AACZ,qBAAe,aAAa,eAAe,YAAY;AACvD,qBAAe,YAAY,cAAc,WAAS;AAC9C,cAAM,OAAO,MAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB;AACzD,YAAI,MAAM;AACN,eAAK,SAAS;AACd,eAAK,QAAQ,OAAO,KAAK;AAAA,QAC7B;AACA,eAAO,MAAM,KAAK;AAAA,MACtB,CAAC;AAED,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,yCAAW,KAAK;AAAA,MAC7B,CAAC;AAED,YAAM;AAAA,IACV;AAAA,EACJ;AAAA,EAEQ,qBACJ,UACA,OACA,MACA,MACe;AACf,WAAO;AAAA,MACH;AAAA,MACA;AAAA,MACA,QAAQ,KAAK;AAAA,MACb,iBAAiB,KAAK;AAAA,MACtB,aAAa,KAAK,eAAe,CAAC;AAAA,MAClC,qBAAqB,KAAK;AAAA,MAC1B,aAAa,KAAK,IAAI;AAAA,MACtB,QAAQ;AAAA,IACZ;AAAA,EACJ;AAAA,EAEQ,qBAAqB,OAAc,aAAqC;AAC5E,WAAO,YAAY,OAAO,WAAS;AAC/B,YAAM,OAAO,MAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB;AACzD,UAAI,MAAM;AACN,aAAK,SAAS;AACd,aAAK,QAAQ,YAAY,kBAAkB;AAAA,MAC/C;AACA,aAAO,MAAM,KAAK;AAAA,IACtB,CAAC;AAAA,EACL;AAAA,EAEA,MAAc,gBACV,cACA,aACA,UACA,SACA,QACmB;AACnB,WAAO,KAAK;AAAA,MACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,MACrB,WAAW,KAAK,IAAI;AAAA,MACpB,MAAM;AAAA,MACN,QAAQ,KAAK;AAAA,MACb,QAAQ;AAAA,MACR,SAAS,6BAAS,SAAS,QAAQ;AAAA,MACnC,UAAU;AAAA,QACN,UAAU,SAAS;AAAA,QACnB,QAAQ,YAAY;AAAA,QACpB,OAAO,SAAS;AAAA,MACpB;AAAA,IACJ,CAAC;AACD,aAAS,UAAU,SAAS,QAAQ,aAAa;AAAA,MAC7C,UAAU,SAAS;AAAA,MACnB,QAAQ,YAAY;AAAA,IACxB,CAAC;AAED,UAAM,eAAe,aAAa,OAAO,iBAAiB;AAC1D,UAAM,WAAW,gBAAgB,SAAS,YACpC,CAAC,UAA2B;AAC1B,YAAM,aAAa,yBAAyB,KAAK;AACjD,cAAQ,UAAU,gBAAgB,QAAQ,gBAAgB,SAAS,QAAQ,IAAI;AAAA,QAC3E,UAAU,SAAS;AAAA,QACnB,QAAQ,YAAY;AAAA,QACpB,OAAO,WAAW;AAAA,QAClB,KAAK,WAAW;AAAA,QAChB,WAAW,WAAW;AAAA,MAC1B,CAAC;AAAA,IACL,IACE;AAEN,UAAM,YAAY,KAAK,IAAI;AAC3B,UAAM,SAAS,MAAM,KAAK,aAAa,QAAQ,SAAS,UAAU,SAAS,OAAO;AAAA,MAC9E,QAAQ,KAAK;AAAA,MACb,aAAa,aAAa,OAAO;AAAA,MACjC;AAAA,IACJ,CAAC;AACD,UAAM,WAAW,KAAK,IAAI,IAAI;AAE9B,QAAI,CAAC,OAAO,SAAS;AACjB,eAAS,UAAU,SAAS,WAAW,eAAe;AAAA,QAClD,UAAU,SAAS;AAAA,QACnB,QAAQ,YAAY;AAAA,QACpB,SAAS;AAAA,QACT,OAAO,OAAO;AAAA,MAClB,CAAC;AACD,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,gBAAM,SAAS,QAAQ;AAAA,QAChC,UAAU;AAAA,UACN,UAAU,SAAS;AAAA,UACnB,QAAQ,YAAY;AAAA,UACpB,SAAS;AAAA,UACT,OAAO,OAAO;AAAA,QAClB;AAAA,MACJ,CAAC;AACD,YAAM,yCAAiC,OAAO,SAAS,wCAAU;AAAA,QAC7D,QAAQ,KAAK;AAAA,QACb,UAAU,SAAS;AAAA,MACvB,CAAC;AAAA,IACL;AAEA,mBAAe,aAAa,kBAAkB,YAAY;AAC1D,mBAAe,aAAa,iBAAiB,cAAc,KAAK,IAAI,QAAQ;AAC5E,mBAAe,YAAY,cAAc,WAAS;AAC9C,YAAM,OAAO,MAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB;AACzD,UAAI,MAAM;AACN,aAAK,SAAS;AACd,aAAK,SAAS,OAAO;AAAA,MACzB;AAEA,aAAO,MAAM,KAAK;AAClB,UAAI,CAAC,MAAM,UAAU,aAAa;AAC9B,cAAM,UAAU,cAAc,CAAC;AAAA,MACnC;AACA,MAAC,MAAM,UAAU,YAA0B,KAAK;AAAA,QAC5C,QAAQ,YAAY;AAAA,QACpB,UAAU,SAAS;AAAA,QACnB,QAAQ,OAAO;AAAA,QACf,WAAW,KAAK,IAAI;AAAA,MACxB,CAAC;AAAA,IACL,CAAC;AAED,WAAO,KAAK;AAAA,MACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,MACrB,WAAW,KAAK,IAAI;AAAA,MACpB,MAAM;AAAA,MACN,QAAQ,KAAK;AAAA,MACb,QAAQ;AAAA,MACR,SAAS,gBAAM,SAAS,QAAQ,8BAAU,QAAQ;AAAA,MAClD,UAAU;AAAA,QACN,YAAY;AAAA,QACZ,UAAU,SAAS;AAAA,QACnB,QAAQ,YAAY;AAAA,QACpB,SAAS;AAAA,MACb;AAAA,IACJ,CAAC;AACD,aAAS,UAAU,SAAS,WAAW,eAAe;AAAA,MAClD,UAAU,SAAS;AAAA,MACnB,QAAQ,YAAY;AAAA,MACpB,SAAS;AAAA,MACT,YAAY;AAAA,IAChB,CAAC;AAED,WAAO,KAAK,aAAa,cAAc,MAAM;AAAA,EACjD;AAEJ;AAEA,SAAS,yBAAyB,OAAmF;AACjH,MAAI,OAAO,UAAU,UAAU;AAC3B,WAAO,EAAE,SAAS,OAAO,MAAM,OAAO;AAAA,EAC1C;AACA,SAAO;AAAA,IACH,SAAS,MAAM;AAAA,IACf,MAAM,MAAM;AAAA,IACZ,KAAK,MAAM;AAAA,EACf;AACJ;;;ACjUO,IAAM,mBAAN,cAA+B,SAAS;AAAA,EAI3C,YAAY,QAAiC;AACzC,UAAM,gBAAgB,cAAc;AAJxC,wBAAQ;AACR,wBAAQ;AAIJ,SAAK,YAAY,QAAQ;AACzB,SAAK,cAAc,QAAQ,eAAe;AAAA,EAC9C;AAAA,EAEA,uBAAuB,SAAyC;AAC5D,SAAK,YAAY;AAAA,EACrB;AAAA,EAEA,MAAM,QAAQ,OAAc,SAA4C;AACpE,UAAM,SAA+B,CAAC;AACtC,UAAM,UAAU,MAAM,KAAK;AAE3B,QAAI,CAAC,WAAW,QAAQ,WAAW,WAAW;AAC1C,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS;AAAA,MACb,CAAC;AACD,aAAO,KAAK,aAAa,OAAO,MAAM;AAAA,IAC1C;AAEA,UAAM,UAAmC;AAAA,MACrC,UAAU,QAAQ;AAAA,MAClB,OAAO,QAAQ;AAAA,MACf,QAAQ,QAAQ;AAAA,MAChB,iBAAiB,QAAQ;AAAA,MACzB,aAAa,QAAQ;AAAA,MACrB,qBAAqB,QAAQ;AAAA,MAC7B,aAAa,QAAQ;AAAA,IACzB;AAEA,aAAS,UAAU,yBAAyB,WAAW,yCAAW,QAAQ,QAAQ,IAAI,OAAO;AAE7F,UAAM,WAAW,MAAM,KAAK,gBAAgB,OAAO;AACnD,UAAM,eAAe,YAAY,OAAO,WAAS;AAC7C,UAAI,MAAM,KAAK,iBAAiB;AAC5B,cAAM,KAAK,gBAAgB,SAAS,SAAS,WAAW,aAAa;AACrE,cAAM,KAAK,gBAAgB,YAAY,KAAK,IAAI;AAChD,YAAI,SAAS,QAAQ;AACjB,gBAAM,KAAK,gBAAgB,iBAAiB,SAAS;AAAA,QACzD;AAAA,MACJ;AAAA,IACJ,CAAC;AAED,WAAO,KAAK;AAAA,MACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,MACrB,WAAW,KAAK,IAAI;AAAA,MACpB,MAAM;AAAA,MACN,QAAQ,KAAK;AAAA,MACb,QAAQ,SAAS,WAAW,YAAY;AAAA,MACxC,SAAS,SAAS,WACZ,mCAAU,QAAQ,QAAQ,KAC1B,mCAAU,QAAQ,QAAQ;AAAA,MAChC,UAAU;AAAA,QACN,UAAU,QAAQ;AAAA,QAClB,UAAU,SAAS;AAAA,QACnB,QAAQ,SAAS;AAAA,MACrB;AAAA,IACJ,CAAC;AAED,WAAO,KAAK;AAAA,MACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,MACrB,WAAW,KAAK,IAAI;AAAA,MACpB,MAAM;AAAA,MACN,QAAQ,KAAK;AAAA,MACb,QAAQ,SAAS,WAAW,YAAY;AAAA,MACxC,SAAS,SAAS,WAAW,mCAAU;AAAA,IAC3C,CAAC;AAED,WAAO,KAAK,aAAa,cAAc,MAAM;AAAA,EACjD;AAAA,EAEA,MAAc,gBAAgB,SAAqE;AAC/F,QAAI,KAAK,WAAW;AAChB,YAAM,WAAW,MAAM,KAAK,UAAU,OAAO;AAC7C,UAAI,OAAO,aAAa,WAAW;AAC/B,eAAO,EAAE,UAAU,SAAS;AAAA,MAChC;AACA,aAAO;AAAA,IACX;AAEA,QAAI,KAAK,aAAa;AAClB,aAAO,EAAE,UAAU,MAAM,QAAQ,gBAAgB;AAAA,IACrD;AAEA,WAAO,EAAE,UAAU,OAAO,QAAQ,0BAA0B;AAAA,EAChE;AACJ;;;AC9GO,IAAM,eAAN,cAA2B,SAAS;AAAA,EACvC,cAAc;AACV,UAAM,YAAY,UAAU;AAAA,EAChC;AAAA,EAEA,MAAM,QAAQ,OAAmC;AAC7C,UAAM,SAA+B,CAAC;AAEtC,QAAI;AAEA,YAAM,cAAc,MAAM,KAAK,MAAM,MAAM,KAAK,gBAAgB;AAEhE,UAAI,CAAC,aAAa;AACd,cAAM,IAAI,MAAM,kDAAU;AAAA,MAC9B;AAEA,UAAI,YAAY,WAAW,UAAU;AACjC,cAAMC,iBAAgB,KAAK,IAAI,MAAM,KAAK,mBAAmB,GAAG,MAAM,KAAK,MAAM,MAAM;AACvF,cAAMC,cAAa,MAAM,KAAK,MAAM,UAAU;AAC9C,cAAMC,YAAYF,iBAAgBC,cAAc,KAAK;AAErD,cAAME,YAAW,YAAY,OAAO,WAAS;AACzC,gBAAM,KAAK,mBAAmBH;AAC9B,gBAAM,KAAK,WAAW,KAAK,MAAME,SAAQ;AAAA,QAC7C,CAAC;AAED,eAAO,KAAK;AAAA,UACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,UACrB,WAAW,KAAK,IAAI;AAAA,UACpB,MAAM;AAAA,UACN,QAAQ,KAAK;AAAA,UACb,QAAQ;AAAA,UACR,SAAS,iBAAO,YAAY,WAAW;AAAA,QAC3C,CAAC;AAED,eAAO,KAAK,aAAaC,WAAU,MAAM;AAAA,MAC7C;AAEA,YAAMC,WAAU,KAAK,OAAO,YAAY,MAAM;AAE9C,UAAI,CAACA,UAAS;AACV,eAAO,KAAK;AAAA,UACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,UACrB,WAAW,KAAK,IAAI;AAAA,UACpB,MAAM;AAAA,UACN,QAAQ,KAAK;AAAA,UACb,QAAQ;AAAA,UACR,SAAS,iBAAO,YAAY,WAAW;AAAA,QAC3C,CAAC;AAED,eAAO,KAAK,aAAa,OAAO,MAAM;AAAA,MAC1C;AAGA,YAAM,gBAAgB,KAAK,IAAI,MAAM,KAAK,mBAAmB,GAAG,MAAM,KAAK,MAAM,MAAM;AACvF,YAAM,aAAa,MAAM,KAAK,MAAM,UAAU;AAC9C,YAAM,WAAY,gBAAgB,aAAc,KAAK;AAErD,YAAM,WAAW,YAAY,OAAO,WAAS;AACzC,cAAM,KAAK,mBAAmB;AAC9B,cAAM,KAAK,WAAW,KAAK,MAAM,QAAQ;AAAA,MAC7C,CAAC;AAED,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,uDAAe,KAAK,MAAM,QAAQ,CAAC;AAAA,MAChD,CAAC;AAED,aAAO,KAAK,aAAa,UAAU,MAAM;AAAA,IAC7C,SAAS,OAAO;AACZ,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,6BAAS,KAAK;AAAA,MAC3B,CAAC;AAED,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKQ,OAAO,QAA0B;AAErC,QAAI,WAAW,QAAQ,WAAW,QAAW;AACzC,aAAO;AAAA,IACX;AAGA,QAAI,MAAM,QAAQ,MAAM,KAAK,OAAO,WAAW,GAAG;AAC9C,aAAO;AAAA,IACX;AAGA,QAAI,OAAO,WAAW,YAAY,OAAO,KAAK,MAAM,EAAE,WAAW,GAAG;AAChE,aAAO;AAAA,IACX;AAEA,WAAO;AAAA,EACX;AACJ;;;AC5GO,IAAM,gBAAN,cAA4B,SAAS;AAAA,EACxC,cAAc;AACV,UAAM,aAAa,WAAW;AAAA,EAClC;AAAA,EAEA,MAAM,QAAQ,OAAmC;AAC7C,UAAM,SAA+B,CAAC;AAEtC,QAAI;AAEA,YAAM,UAAU,KAAK,iBAAiB,KAAK;AAG3C,YAAM,WAAW,KAAK,iBAAiB,OAAO,OAAO;AAGrD,UAAI,WAAW,aAAa,WAAW,OAAO,aAAa,QAAQ;AACnE,iBAAW,aAAa,eAAe,UAAU,GAAG;AAEpD,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS;AAAA,QACT,UAAU,EAAE,gBAAgB,SAAS,OAAO;AAAA,MAChD,CAAC;AAED,aAAO,KAAK,aAAa,UAAU,MAAM;AAAA,IAC7C,SAAS,OAAO;AACZ,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,yCAAW,KAAK;AAAA,MAC7B,CAAC;AAED,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKQ,iBAAiB,OAAsB;AAC3C,UAAM,iBAAiB,MAAM,KAAK,MAAM,OAAO,OAAK,EAAE,WAAW,WAAW;AAC5E,UAAM,cAAc,MAAM,KAAK,MAAM,OAAO,OAAK,EAAE,WAAW,QAAQ;AAEtE,QAAI,UAAU;AAAA;AAAA;AACd,eAAW,qBAAW,MAAM,KAAK,IAAI;AAAA;AAAA;AACrC,eAAW,iCAAa,eAAe,MAAM,IAAI,MAAM,KAAK,MAAM,MAAM;AAAA;AAAA;AAExE,QAAI,eAAe,SAAS,GAAG;AAC3B,iBAAW;AAAA;AACX,qBAAe,QAAQ,UAAQ;AAC3B,mBAAW,KAAK,KAAK,WAAW;AAAA;AAAA,MACpC,CAAC;AACD,iBAAW;AAAA,IACf;AAEA,QAAI,YAAY,SAAS,GAAG;AACxB,iBAAW;AAAA;AACX,kBAAY,QAAQ,UAAQ;AACxB,mBAAW,KAAK,KAAK,WAAW,KAAK,KAAK,KAAK;AAAA;AAAA,MACnD,CAAC;AACD,iBAAW;AAAA,IACf;AAEA,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKQ,iBAAiB,OAAc,SAAyB;AAC5D,QAAI,WAAW;AAGf,UAAM,cAAc,MAAM,UAAU;AAMpC,QAAI,eAAe,YAAY,SAAS,GAAG;AACvC,kBAAY;AAAA;AAAA;AACZ,kBAAY,QAAQ,YAAU;AAC1B,oBAAY,KAAK,OAAO,QAAQ;AAAA;AAChC,oBAAY;AAAA,EAAe,KAAK,UAAU,OAAO,QAAQ,MAAM,CAAC,CAAC;AAAA;AAAA;AAAA;AAAA,MACrE,CAAC;AAAA,IACL;AAGA,gBAAY;AAAA;AACZ,gBAAY,yBAAU,MAAM,UAAU,aAAa;AAAA;AACnD,gBAAY,2CAAa,MAAM,UAAU,aAAa;AAAA;AACtD,gBAAY,+BAAW,MAAM,UAAU,UAAU;AAAA;AACjD,gBAAY,+BAAW,MAAM,UAAU,UAAU;AAAA;AAEjD,WAAO;AAAA,EACX;AACJ;;;AC9FO,IAAM,mBAAN,cAA+B,SAAS;AAAA,EAK3C,YAAY,QAAiC;AACzC,UAAM,aAAa,eAAe;AALtC,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AAIJ,SAAK,WAAW,QAAQ;AACxB,SAAK,eAAe,QAAQ,gBAAgB;AAC5C,SAAK,WAAW,QAAQ,YAAY;AAAA,EACxC;AAAA;AAAA,EAGA,YAAY,UAA6B;AACrC,SAAK,WAAW;AAAA,EACpB;AAAA,EAEA,MAAM,QAAQ,OAAc,SAAoC;AAC5D,UAAM,SAA+B,CAAC;AAEtC,QAAI;AAEA,YAAM,mBAAmB,KAAK,sBAAsB,KAAK;AAGzD,YAAM,WAAW,KAAK,WAChB,MAAM,KAAK,gBAAgB,OAAO,kBAAkB,OAAO,IAC3D,KAAK,yBAAyB,OAAO,gBAAgB;AAG3D,UAAI,WAAW,aAAa,WAAW,OAAO,aAAa,QAAQ;AACnE,iBAAW,aAAa,eAAe,UAAU,GAAG;AAEpD,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS;AAAA,QACT,UAAU,EAAE,gBAAgB,SAAS,QAAQ,SAAS,CAAC,CAAC,KAAK,SAAS;AAAA,MAC1E,CAAC;AAED,aAAO,KAAK,aAAa,UAAU,MAAM;AAAA,IAC7C,SAAS,OAAO;AACZ,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,yCAAW,KAAK;AAAA,MAC7B,CAAC;AAED,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA,EAGQ,sBAAsB,OAAgC;AAC1D,UAAM,iBAAiB,MAAM,KAAK,MAAM,OAAO,OAAK,EAAE,WAAW,WAAW;AAC5E,UAAM,cAAc,MAAM,KAAK,MAAM,OAAO,OAAK,EAAE,WAAW,QAAQ;AACtE,UAAM,cAAc,MAAM,UAAU;AAEpC,WAAO;AAAA,MACH,MAAM,MAAM,KAAK;AAAA,MACjB,YAAY,MAAM,KAAK,MAAM;AAAA,MAC7B,gBAAgB,eAAe,IAAI,QAAM;AAAA,QACrC,aAAa,EAAE;AAAA,QACf,QAAQ,EAAE;AAAA,MACd,EAAE;AAAA,MACF,aAAa,YAAY,IAAI,QAAM;AAAA,QAC/B,aAAa,EAAE;AAAA,QACf,OAAO,EAAE;AAAA,MACb,EAAE;AAAA,MACF,aAAa,eAAe,CAAC;AAAA,MAC7B,OAAO;AAAA,QACH,UAAU,MAAM,UAAU;AAAA,QAC1B,WAAW,MAAM,UAAU;AAAA,QAC3B,YAAY,MAAM,UAAU;AAAA,MAChC;AAAA,IACJ;AAAA,EACJ;AAAA;AAAA,EAGA,MAAc,gBACV,OACA,KACA,aACe;AACf,UAAM,eAAe,KAAK,kBAAkB;AAC5C,UAAM,aAAa,KAAK,gBAAgB,GAAG;AAE3C,UAAM,WAA0B;AAAA,MAC5B,EAAE,MAAM,UAAU,SAAS,aAAa;AAAA,MACxC,EAAE,MAAM,QAAQ,SAAS,WAAW;AAAA,IACxC;AAEA,UAAM,eAAe,MAAM,OAAO,iBAAiB;AAEnD,QAAI,gBAAgB,aAAa,WAAW;AACxC,UAAI,cAAc;AAClB,YAAM,SAAS,KAAK,SAAU,WAAW;AAAA,QACrC;AAAA,QACA,aAAa;AAAA,MACjB,CAAC;AAED,uBAAiB,SAAS,QAAQ;AAC9B,YAAI,MAAM,OAAO;AACb,yBAAe,MAAM;AACrB,sBAAY,UAAU,gBAAgB,QAAQ,0BAA0B,EAAE,OAAO,MAAM,MAAM,CAAC;AAAA,QAClG;AAAA,MACJ;AAEA,aAAO,KAAK,YAAY,YAAY,KAAK,GAAG,GAAG;AAAA,IACnD;AAEA,UAAM,WAAW,MAAM,KAAK,SAAU,KAAK;AAAA,MACvC;AAAA,MACA,aAAa;AAAA,IACjB,CAAC;AAED,WAAO,KAAK,YAAY,SAAS,QAAQ,KAAK,GAAG,GAAG;AAAA,EACxD;AAAA;AAAA,EAGQ,oBAA4B;AAChC,UAAM,kBAAkB,KAAK,aAAa,OACpC,+CACA,KAAK,aAAa,OACd,+BACA;AAEV,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOV,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMhB;AAAA;AAAA,EAGQ,gBAAgB,KAA+B;AACnD,QAAI,SAAS,mDAAW,IAAI,IAAI;AAAA;AAAA;AAEhC,cAAU;AAAA;AACV,cAAU,mCAAU,IAAI,UAAU;AAAA;AAClC,cAAU,uBAAQ,IAAI,eAAe,MAAM;AAAA;AAC3C,cAAU,uBAAQ,IAAI,YAAY,MAAM;AAAA;AAAA;AAExC,QAAI,IAAI,eAAe,SAAS,GAAG;AAC/B,gBAAU;AAAA;AACV,UAAI,eAAe,QAAQ,CAAC,MAAM,MAAM;AACpC,kBAAU,GAAG,IAAI,CAAC,KAAK,KAAK,WAAW;AAAA;AACvC,YAAI,KAAK,QAAQ;AACb,oBAAU,oBAAU,KAAK,UAAU,KAAK,MAAM,EAAE,UAAU,GAAG,GAAG,CAAC;AAAA;AAAA,QACrE;AAAA,MACJ,CAAC;AACD,gBAAU;AAAA,IACd;AAEA,QAAI,IAAI,YAAY,SAAS,GAAG;AAC5B,gBAAU;AAAA;AACV,UAAI,YAAY,QAAQ,YAAU;AAC9B,kBAAU,KAAK,OAAO,QAAQ,KAAK,KAAK,UAAU,OAAO,MAAM,EAAE,UAAU,GAAG,GAAG,CAAC;AAAA;AAAA,MACtF,CAAC;AACD,gBAAU;AAAA,IACd;AAEA,QAAI,IAAI,YAAY,SAAS,GAAG;AAC5B,gBAAU;AAAA;AACV,UAAI,YAAY,QAAQ,UAAQ;AAC5B,kBAAU,KAAK,KAAK,WAAW,KAAK,KAAK,KAAK;AAAA;AAAA,MAClD,CAAC;AAAA,IACL;AAEA,cAAU;AAAA;AAEV,WAAO;AAAA,EACX;AAAA;AAAA,EAGQ,YAAY,UAAkB,KAA+B;AACjE,QAAI,CAAC,KAAK,aAAc,QAAO;AAE/B,WAAO,WAAW;AAAA;AAAA;AAAA,6BAAmB,IAAI,MAAM,SAAS,oCAAW,IAAI,MAAM,UAAU,YAAY,IAAI,MAAM,QAAQ;AAAA,EACzH;AAAA;AAAA,EAGQ,yBAAyB,OAAc,KAA+B;AAC1E,UAAM,aAAa,IAAI,YAAY,WAAW;AAE9C,QAAI,WAAW,aACT;AAAA;AAAA,IACA;AAAA;AAAA;AAEN,gBAAY,qBAAW,IAAI,IAAI;AAAA;AAAA;AAE/B,QAAI,IAAI,eAAe,SAAS,GAAG;AAC/B,kBAAY;AAAA;AACZ,UAAI,eAAe,QAAQ,CAAC,MAAM,MAAM;AACpC,oBAAY,GAAG,IAAI,CAAC,KAAK,KAAK,WAAW;AAAA;AAAA,MAC7C,CAAC;AACD,kBAAY;AAAA,IAChB;AAEA,QAAI,IAAI,YAAY,SAAS,GAAG;AAC5B,kBAAY;AAAA;AACZ,UAAI,YAAY,QAAQ,YAAU;AAC9B,oBAAY,OAAO,OAAO,QAAQ;AAClC,cAAM,SAAS,KAAK,UAAU,OAAO,MAAM;AAC3C,oBAAY,OAAO,SAAS,MAAM,OAAO,UAAU,GAAG,GAAG,IAAI,QAAQ;AACrE,oBAAY;AAAA,MAChB,CAAC;AAAA,IACL;AAEA,QAAI,IAAI,YAAY,SAAS,GAAG;AAC5B,kBAAY;AAAA;AAAA;AACZ,UAAI,YAAY,QAAQ,UAAQ;AAC5B,oBAAY,KAAK,KAAK,WAAW,KAAK,KAAK,KAAK;AAAA;AAAA,MACpD,CAAC;AAAA,IACL;AAEA,WAAO,KAAK,YAAY,UAAU,GAAG;AAAA,EACzC;AACJ;;;ACvPO,IAAM,8BAAwC;AAAA,EACjD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,IAAM,0BAAoC;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAEO,SAAS,sBAAsB,SAAiB,WAAqB,6BAAsC;AAC9G,QAAM,aAAa,QAAQ,YAAY;AACvC,SAAO,SAAS,KAAK,aAAW,QAAQ,KAAK,UAAU,CAAC;AAC5D;AAEO,SAAS,oBAAoB,SAAiB,WAAqB,yBAAwC;AAC9G,QAAM,UAAU,QAAQ,KAAK;AAC7B,MAAI,CAAC,QAAS,QAAO;AAErB,aAAW,WAAW,UAAU;AAC5B,QAAI,QAAQ,KAAK,OAAO,GAAG;AACvB,YAAM,WAAW,QAAQ,QAAQ,SAAS,EAAE,EAAE,KAAK;AACnD,aAAO,YAAY;AAAA,IACvB;AAAA,EACJ;AAEA,SAAO;AACX;AAEO,SAAS,uBAAuB,SAA0B;AAC7D,MAAI,OAAO,YAAY,SAAU,QAAO;AACxC,MAAI;AACA,WAAO,KAAK,UAAU,OAAO;AAAA,EACjC,SAAS,OAAO;AACZ,WAAO,OAAO,OAAO;AAAA,EACzB;AACJ;;;AC1BO,IAAM,aAAN,cAAyB,SAAS;AAAA,EAMrC,YAAY,QAA0B;AAClC,UAAM,UAAU,cAAc;AANlC,wBAAQ;AACR,wBAAQ;AAMJ,SAAK,SAAS,OAAO;AACrB,SAAK,SAAS;AAAA,MACV,eAAe,OAAO;AAAA,MACtB,oBAAoB,OAAO,sBAAsB;AAAA,MACjD,qBAAqB,OAAO,uBAAuB;AAAA,MACnD,iBAAiB,OAAO,mBAAmB;AAAA,MAC3C,sBAAsB,OAAO;AAAA,IACjC;AAAA,EACJ;AAAA,EAEA,MAAM,QAAQ,OAAmC;AAC7C,UAAM,SAA+B,CAAC;AAEtC,QAAI;AACA,UAAI,MAAM,OAAO,kBAAkB,OAAO;AACtC,eAAO,KAAK,aAAa,OAAO,MAAM;AAAA,MAC1C;AAGA,YAAM,aAAa,MAAM,KAAK,MAAM,MAAM,OAAK,EAAE,WAAW,eAAe,EAAE,WAAW,QAAQ;AAChG,YAAM,oBAAoB,MAAM,KAAK,MAAM,KAAK,OAAK,EAAE,WAAW,WAAW;AAG7E,UAAI,KAAK,OAAO,sBAAsB,cAAc,mBAAmB;AACnE,cAAM,QAAQ,MAAM,KAAK,kBAAkB,KAAK;AAChD,YAAI,OAAO;AACP,iBAAO,KAAK;AAAA,YACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,YACrB,WAAW,KAAK,IAAI;AAAA,YACpB,MAAM;AAAA,YACN,QAAQ,KAAK;AAAA,YACb,QAAQ;AAAA,YACR,SAAS;AAAA,YACT,UAAU,EAAE,MAAM,kBAAkB,MAAM,CAAC,kBAAkB,WAAW,EAAE;AAAA,UAC9E,CAAC;AAAA,QACL;AACA,eAAO,KAAK;AAAA,UACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,UACrB,WAAW,KAAK,IAAI;AAAA,UACpB,MAAM;AAAA,UACN,QAAQ,KAAK;AAAA,UACb,QAAQ;AAAA,UACR,SAAS;AAAA,QACb,CAAC;AAAA,MACL;AAGA,UAAI,KAAK,OAAO,qBAAqB;AACjC,cAAM,QAAQ,MAAM,KAAK,oBAAoB,KAAK;AAClD,YAAI,OAAO;AACP,iBAAO,KAAK;AAAA,YACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,YACrB,WAAW,KAAK,IAAI;AAAA,YACpB,MAAM;AAAA,YACN,QAAQ,KAAK;AAAA,YACb,QAAQ;AAAA,YACR,SAAS;AAAA,YACT,UAAU,EAAE,MAAM,mBAAmB,MAAM,CAAC,mBAAmB,cAAc,EAAE;AAAA,UACnF,CAAC;AACD,iBAAO,KAAK;AAAA,YACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,YACrB,WAAW,KAAK,IAAI;AAAA,YACpB,MAAM;AAAA,YACN,QAAQ,KAAK;AAAA,YACb,QAAQ;AAAA,YACR,SAAS;AAAA,UACb,CAAC;AAAA,QACL;AAAA,MACJ;AAGA,UAAI,KAAK,OAAO,iBAAiB;AAC7B,cAAM,aAAa,MAAM,KAAK,gBAAgB,KAAK;AACnD,YAAI,aAAa,GAAG;AAChB,iBAAO,KAAK;AAAA,YACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,YACrB,WAAW,KAAK,IAAI;AAAA,YACpB,MAAM;AAAA,YACN,QAAQ,KAAK;AAAA,YACb,QAAQ;AAAA,YACR,SAAS,SAAS,UAAU;AAAA,YAC5B,UAAU,EAAE,MAAM,eAAe,OAAO,YAAY,MAAM,CAAC,eAAe,WAAW,EAAE;AAAA,UAC3F,CAAC;AAAA,QACL;AAAA,MACJ;AAGA,YAAM,gBAAgB,MAAM,KAAK,cAAc,KAAK;AACpD,UAAI,gBAAgB,GAAG;AACnB,eAAO,KAAK;AAAA,UACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,UACrB,WAAW,KAAK,IAAI;AAAA,UACpB,MAAM;AAAA,UACN,QAAQ,KAAK;AAAA,UACb,QAAQ;AAAA,UACR,SAAS,SAAS,aAAa;AAAA,UAC/B,UAAU,EAAE,MAAM,YAAY,OAAO,cAAc;AAAA,QACvD,CAAC;AAAA,MACL;AAEA,aAAO,KAAK,aAAa,OAAO,MAAM;AAAA,IAC1C,SAAS,OAAO;AACZ,cAAQ,MAAM,yCAAyC,KAAK;AAE5D,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,uBAAuB,iBAAiB,QAAQ,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,MAC1F,CAAC;AACD,aAAO,KAAK,aAAa,OAAO,MAAM;AAAA,IAC1C;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,kBAAkB,OAAgC;AAC5D,UAAM,aAAa,KAAK,OAAO,uBACzB,KAAK,OAAO,qBAAqB,KAAK,IACtC,KAAK,wBAAwB,KAAK;AAExC,UAAM,iBAAiB,MAAM,KAAK,MAAM,OAAO,OAAK,EAAE,WAAW,WAAW;AAC5E,UAAM,cAAc;AAAA,MAChB,MAAM,MAAM,KAAK;AAAA,MACjB,gBAAgB,eAAe;AAAA,MAC/B,YAAY,MAAM,KAAK,MAAM;AAAA,MAC7B,OAAO,eAAe,IAAI,QAAM;AAAA,QAC5B,aAAa,EAAE;AAAA,QACf,QAAQ,EAAE;AAAA,MACd,EAAE;AAAA,MACF,aAAa,KAAK,IAAI;AAAA,IAC1B;AAEA,UAAM,KAAK,OAAO,SAAS,aAAa;AAAA,MACpC,MAAM,CAAC,kBAAkB,WAAW;AAAA,MACpC;AAAA,MACA,UAAU,cAAc;AAAA,IAC5B,CAAC;AACD,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,oBAAoB,OAAgC;AAC9D,UAAM,eAAe,MAAM,aAAa,SAAS,OAAO,OAAK,EAAE,SAAS,MAAM;AAC9E,UAAM,kBAAkB,aAAa,aAAa,SAAS,CAAC;AAE5D,QAAI,CAAC,gBAAiB,QAAO;AAE7B,UAAM,eAAe,sBAAsB,gBAAgB,OAAO;AAElE,QAAI,cAAc;AACd,YAAM,KAAK,OAAO,SAAS,gBAAgB,SAAS;AAAA,QAChD,MAAM,CAAC,mBAAmB,cAAc;AAAA,QACxC,YAAY;AAAA,QACZ,UAAU;AAAA,MACd,CAAC;AACD,aAAO;AAAA,IACX;AACA,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,gBAAgB,OAA+B;AACzD,QAAI,aAAa;AACjB,eAAW,QAAQ,MAAM,KAAK,OAAO;AACjC,UAAI,KAAK,WAAW,eAAe,KAAK,QAAQ;AAE5C,cAAM,YAAY,KAAK,UAAU,KAAK,MAAM;AAC5C,YAAI,UAAU,SAAS,IAAI;AACvB,gBAAM,KAAK,OAAO;AAAA,YACd;AAAA,cACI,aAAa,KAAK;AAAA,cAClB,QAAQ,KAAK;AAAA,YACjB;AAAA,YACA;AAAA,cACI,MAAM,CAAC,eAAe,WAAW;AAAA,cACjC,YAAY;AAAA,YAChB;AAAA,UACJ;AACA,wBAAc;AAAA,QAClB;AAAA,MACJ;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,cAAc,OAA+B;AACvD,QAAI,aAAa;AAEjB,QAAI,MAAM,UAAU,OAAO,MAAM,UAAU,IAAI,SAAS,GAAG;AACvD,YAAM,KAAK,OAAO;AAAA,QACd;AAAA,UACI,MAAM;AAAA,UACN,SAAS,MAAM,UAAU;AAAA,UACzB,MAAM,MAAM,KAAK;AAAA,QACrB;AAAA,QACA;AAAA,UACI,MAAM,CAAC,YAAY,OAAO,OAAO;AAAA,UACjC,YAAY;AAAA,UACZ,UAAU;AAAA,QACd;AAAA,MACJ;AACA,oBAAc;AAAA,IAClB;AAGA,QAAI,MAAM,UAAU,SAAS,MAAM,UAAU,MAAM,SAAS,GAAG;AAC3D,YAAM,KAAK,OAAO;AAAA,QACd;AAAA,UACI,MAAM;AAAA,UACN,OAAO,MAAM,UAAU;AAAA,UACvB,MAAM,MAAM,KAAK;AAAA,QACrB;AAAA,QACA;AAAA,UACI,MAAM,CAAC,YAAY,SAAS,WAAW;AAAA,UACvC,YAAY;AAAA,UACZ,UAAU;AAAA,QACd;AAAA,MACJ;AACA,oBAAc;AAAA,IAClB;AACA,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKQ,wBAAwB,OAAsB;AAClD,QAAI,aAAa;AAGjB,UAAM,YAAY,MAAM,KAAK,MAAM;AACnC,kBAAc,KAAK,IAAI,YAAY,MAAM,GAAG;AAG5C,UAAM,cAAc,MAAM,KAAK,MAAM,OAAO,OAAK,EAAE,WAAW,QAAQ,EAAE;AACxE,QAAI,cAAc,GAAG;AACjB,oBAAc,cAAc;AAAA,IAChC;AAGA,UAAM,eACD,MAAM,UAAU,OAAO,MAAM,UAAU,IAAI,SAAS,KACpD,MAAM,UAAU,SAAS,MAAM,UAAU,MAAM,SAAS;AAC7D,QAAI,cAAc;AACd,oBAAc;AAAA,IAClB;AAGA,QAAI,MAAM,aAAa,SAAS,SAAS,IAAI;AACzC,oBAAc;AAAA,IAClB;AAEA,WAAO,KAAK,IAAI,KAAK,IAAI,YAAY,GAAG,GAAG,CAAG;AAAA,EAClD;AACJ;;;ACrSA,IAAM,YAAY,CAAC,MAAM,SAAS,OAAO,gBAAM,UAAK,UAAU,aAAa,cAAI;AAG/E,IAAM,kBAAkB;AAAA,EACpB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACJ;AAGA,IAAM,gBAAgB;AAAA,EAClB;AAAA,EAAU;AAAA,EAAQ;AAAA,EAAS;AAAA,EAAW;AAAA,EACtC;AAAA,EAAU;AAAA,EAAY;AAAA,EAAS;AAAA,EAAQ;AAAA,EACvC;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EAAM;AAAA,EACpC;AAAA,EAAO;AAAA,EAAY;AAAA,EACnB;AAAA,EAAY;AAAA,EACZ;AAAA,EAAa;AAAA,EACb;AAAA,EAAa;AACjB;AAKO,SAAS,mBAAmB,SAAiB,UAA4B;AAE5E,MAAI,CAAC,UAAU;AACX,WAAO;AAAA,EACX;AAEA,QAAM,eAAe,QAAQ,YAAY,EAAE,KAAK;AAGhD,MAAI,UAAU,KAAK,OAAK,iBAAiB,KAAK,aAAa,WAAW,IAAI,GAAG,CAAC,GAAG;AAC7E,WAAO;AAAA,EACX;AAGA,MAAI,gBAAgB,KAAK,OAAK,EAAE,KAAK,YAAY,CAAC,GAAG;AACjD,WAAO;AAAA,EACX;AAGA,MAAI,cAAc,KAAK,OAAK,aAAa,SAAS,CAAC,CAAC,GAAG;AACnD,WAAO;AAAA,EACX;AAGA,SAAO;AACX;AAKO,SAAS,oBACZ,MACA,OACM;AACN,QAAM,iBAAiB,MAAM,OAAO,OAAK,EAAE,WAAW,WAAW;AAEjE,MAAI,WAAW;AAAA;AAAA;AACf,cAAY,qBAAW,IAAI;AAAA;AAAA;AAE3B,MAAI,eAAe,SAAS,GAAG;AAC3B,gBAAY;AAAA;AACZ,mBAAe,QAAQ,CAAC,MAAM,MAAM;AAChC,kBAAY,GAAG,IAAI,CAAC,KAAK,KAAK,WAAW;AAAA;AAAA,IAC7C,CAAC;AAAA,EACL;AAEA,SAAO;AACX;;;AC/CO,IAAM,uBAAN,MAA2B;AAAA,EAK9B,cAAc;AAJd,wBAAQ;AACR,wBAAQ,cAAyB,EAAE,SAAS,MAAM;AAClD,wBAAQ,eAAuC,oBAAI,IAAI;AAGnD,SAAK,aAAa,IAAI,gBAAgB;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,SAAsB;AACtB,WAAO,KAAK,WAAW;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,YAAqB;AACrB,WAAO,KAAK,WAAW;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAsC;AAClC,WAAO,EAAE,GAAG,KAAK,WAAW;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,QAAuB;AACzB,QAAI,KAAK,WAAW,QAAS;AAE7B,SAAK,aAAa;AAAA,MACd,SAAS;AAAA,MACT,QAAQ,UAAU;AAAA,MAClB,WAAW,KAAK,IAAI;AAAA,IACxB;AACA,SAAK,WAAW,MAAM,MAAM;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACV,SAAK,aAAa,IAAI,gBAAgB;AACtC,SAAK,aAAa,EAAE,SAAS,MAAM;AAAA,EACvC;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,YAA8B;AACzC,SAAK,YAAY,IAAI,WAAW,IAAI,UAAU;AAC9C,SAAK,WAAW,aAAa;AAAA,EACjC;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc,IAAoC;AAC9C,WAAO,KAAK,YAAY,IAAI,EAAE;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,sBAA8C;AAC1C,WAAO,KAAK,WAAW;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA,EAKA,kBAAgC;AAC5B,WAAO,MAAM,KAAK,KAAK,YAAY,OAAO,CAAC,EACtC,KAAK,CAAC,GAAG,MAAM,EAAE,YAAY,EAAE,SAAS;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,mBAAyB;AACrB,SAAK,YAAY,MAAM;AACvB,QAAI,KAAK,WAAW,YAAY;AAC5B,aAAO,KAAK,WAAW;AAAA,IAC3B;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,iBAAuB;AACnB,QAAI,KAAK,WAAW,OAAO,SAAS;AAChC,YAAM,QAAQ,IAAI,MAAM,KAAK,WAAW,UAAU,mBAAmB;AACrE,YAAM,OAAO;AACb,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,cAAiB,SAAiC;AAC9C,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAEpC,UAAI,KAAK,WAAW,OAAO,SAAS;AAChC,cAAM,QAAQ,IAAI,MAAM,KAAK,WAAW,UAAU,mBAAmB;AACrE,cAAM,OAAO;AACb,eAAO,KAAK;AACZ;AAAA,MACJ;AAGA,YAAM,eAAe,MAAM;AACvB,cAAM,QAAQ,IAAI,MAAM,KAAK,WAAW,UAAU,mBAAmB;AACrE,cAAM,OAAO;AACb,eAAO,KAAK;AAAA,MAChB;AACA,WAAK,WAAW,OAAO,iBAAiB,SAAS,YAAY;AAG7D,cACK,KAAK,OAAO,EACZ,MAAM,MAAM,EACZ,QAAQ,MAAM;AACX,aAAK,WAAW,OAAO,oBAAoB,SAAS,YAAY;AAAA,MACpE,CAAC;AAAA,IACT,CAAC;AAAA,EACL;AACJ;AAKO,SAAS,aAAa,OAAyB;AAClD,MAAI,iBAAiB,OAAO;AACxB,WAAO,MAAM,SAAS,gBAAgB,MAAM,QAAQ,SAAS,SAAS;AAAA,EAC1E;AACA,SAAO;AACX;AAKO,SAAS,wBAA8C;AAC1D,SAAO,IAAI,qBAAqB;AACpC;;;ACnJO,IAAM,wBAAN,MAAoD;AAAA,EACvD,MAAM,MAAM,SAAuD;AAC/D,UAAM,OAAO,mBAAmB,QAAQ,SAAS,QAAQ,QAAQ,IAAI,UAAU;AAC/E,WAAO,EAAE,MAAM,QAAQ,aAAa;AAAA,EACxC;AACJ;AAQA,IAAM,wBACF;AAIG,IAAM,kBAAN,MAA8C;AAAA,EAGjD,YACqB,UACA,UAAkC,CAAC,GACtD;AAFmB;AACA;AAJrB,wBAAQ;AAMJ,SAAK,iBAAiB,QAAQ,kBAAkB,IAAI,sBAAsB;AAAA,EAC9E;AAAA,EAEA,MAAM,MAAM,SAAuD;AAC/D,QAAI,CAAC,QAAQ,UAAU;AACnB,aAAO,EAAE,MAAM,QAAQ,QAAQ,WAAW;AAAA,IAC9C;AAEA,UAAM,WAA0B;AAAA,MAC5B;AAAA,QACI,MAAM;AAAA,QACN,SAAS,KAAK,QAAQ,gBAAgB;AAAA,MAC1C;AAAA,MACA;AAAA,QACI,MAAM;AAAA,QACN,SAAS;AAAA,UACL,iBAAiB,QAAQ,OAAO;AAAA,UAChC,oBAAoB,QAAQ,eAAe,KAAK,IAAI,KAAK,MAAM;AAAA,QACnE,EAAE,KAAK,IAAI;AAAA,MACf;AAAA,IACJ;AAEA,QAAI;AACA,YAAM,WAAW,MAAM,KAAK,SAAS,KAAK;AAAA,QACtC;AAAA,QACA,aAAa,KAAK,QAAQ,eAAe;AAAA,MAC7C,CAAC;AAED,YAAM,WAAW,oBAAoB,SAAS,OAAO;AACrD,UAAI,CAAC,UAAU;AACX,eAAO,MAAM,KAAK,eAAe,MAAM,OAAO;AAAA,MAClD;AAEA,aAAO,wBAAwB,UAAU,OAAO;AAAA,IACpD,SAAS,OAAO;AACZ,cAAQ,MAAM,4CAA4C,KAAK;AAC/D,aAAO,MAAM,KAAK,eAAe,MAAM,OAAO;AAAA,IAClD;AAAA,EACJ;AACJ;AAEA,SAAS,oBAAoB,SAAwC;AACjE,QAAM,QAAQ,QAAQ,MAAM,aAAa;AACzC,MAAI,CAAC,MAAO,QAAO;AAEnB,MAAI;AACA,WAAO,KAAK,MAAM,MAAM,CAAC,CAAC;AAAA,EAC9B,QAAQ;AACJ,WAAO;AAAA,EACX;AACJ;AAEA,SAAS,wBAAwB,UAA0B,SAA8C;AACrG,QAAM,OAAO,SAAS,SAAS,UAAU,UAAU;AACnD,QAAM,eAAe,SAAS,YAAY,gBAAiB,SAAiB;AAC5E,QAAM,eAAe,SAAS,cAAc,gBAAiB,SAAiB;AAC9E,QAAM,mBAAmB,SAAS,cAAc,oBAAqB,SAAiB;AAEtF,QAAM,aAA6B;AAAA,IAC/B;AAAA,IACA,QAAQ,SAAS;AAAA,IACjB,YAAY;AAAA,IACZ,cAAc;AAAA,EAClB;AAEA,MAAI,MAAM,QAAQ,YAAY,KAAK,aAAa,SAAS,GAAG;AACxD,eAAW,aAAa;AAAA,MACpB,cAAc,aAAa,OAAO,UAAQ,QAAQ,eAAe,SAAS,IAAI,CAAC;AAAA,IACnF;AAAA,EACJ;AAEA,MAAI,iBAAiB,UAAa,qBAAqB,QAAW;AAC9D,eAAW,eAAe;AAAA,MACtB,cAAc,iBAAiB,SAAY,SAAY,QAAQ,YAAY;AAAA,MAC3E,kBAAkB,qBAAqB,SAAY,SAAY,QAAQ,gBAAgB;AAAA,IAC3F;AAAA,EACJ;AAEA,MAAI,CAAC,QAAQ,UAAU;AACnB,eAAW,OAAO;AAAA,EACtB;AAEA,SAAO;AACX;;;ACzHO,SAAS,6BAA6B,aAAuC;AAChF,SAAO;AAAA,IACH,IAAI,OAAmB;AACnB,YAAM,YAAY,MAAM,aAAa,KAAK,IAAI;AAC9C,kBAAY,KAAK,SAAS,MAAM,QAAQ,MAAM,QAAQ;AAAA,QAClD,UAAU;AAAA,UACN,OAAO,MAAM;AAAA,UACb,OAAO,MAAM;AAAA,UACb,GAAG,MAAM;AAAA,QACb;AAAA,QACA,SAAS;AAAA,UACL,GAAG;AAAA,UACH;AAAA,QACJ;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AACJ;;;ACzBO,SAAS,aAAa,QAAoB,OAA4B;AACzE,MAAI,SAAS,MAAM,SAAS,EAAG,QAAO;AACtC,SAAO,OAAO,eAAe,CAAC,GAAG,OAAO,YAAY,IAAI,CAAC;AAC7D;AAEO,SAAS,mBAAmB,QAAoB,OAA0C;AAC7F,QAAM,cAAuC,CAAC;AAE9C,aAAW,QAAQ,OAAO;AACtB,UAAM,SAAS,OAAO,MAAM,IAAI,KAAK,CAAC;AACtC,eAAW,cAAc,QAAQ;AAC7B,kBAAY,UAAU,IAAI;AAAA,IAC9B;AAAA,EACJ;AAEA,SAAO;AACX;;;ACKO,IAAM,oCAAqG;AAAA,EAC9G,OAAO;AAAA,EACP,aAAa;AACjB;AAEO,IAAM,kCAAiM;AAAA,EAC1M,qBAAqB;AAAA,EACrB,uBAAuB;AAAA,EACvB,oBAAoB;AAAA,EACpB,kBAAkB;AAAA,EAClB,YAAY;AAAA,EACZ,UAAU;AACd;AAEO,SAAS,4BACZ,UACA,QACqB;AACrB,MAAI,WAAW;AAEf,MAAI,OAAO,kBAAkB,QAAW;AACpC,eAAW,SAAS,OAAO,YAAU,OAAO,SAAS,cAAc,OAAO,aAAc;AAAA,EAC5F;AAEA,MAAI,OAAO,QAAQ,OAAO,KAAK,SAAS,GAAG;AACvC,eAAW,SAAS,OAAO,YAAU;AACjC,UAAI,CAAC,OAAO,SAAS,KAAM,QAAO;AAClC,aAAO,OAAO,SAAS,KAAK,KAAK,SAAO,OAAO,KAAM,SAAS,GAAG,CAAC;AAAA,IACtE,CAAC;AAAA,EACL;AAEA,QAAM,QAAQ,OAAO,SAAS,kCAAkC;AAChE,SAAO,SAAS,MAAM,GAAG,KAAK;AAClC;AAEO,SAAS,mBAAmB,UAAyC;AACxE,QAAM,QAAQ,SAAS,IAAI,YAAU,uBAAuB,OAAO,OAAO,CAAC,EAAE,OAAO,OAAO;AAE3F,MAAI,MAAM,WAAW,EAAG,QAAO;AAC/B,MAAI,MAAM,WAAW,EAAG,QAAO,oBAAoB,MAAM,CAAC,CAAC;AAE3D,SAAO;AAAA,EAAuB,MAAM,IAAI,UAAQ,KAAK,IAAI,EAAE,EAAE,KAAK,IAAI,CAAC;AAC3E;AAEA,eAAsB,mBAClB,QACA,aACA,kBACA,SAA+B,CAAC,GACnB;AACb,QAAM,iBAAiB;AAAA,IACnB,GAAG;AAAA,IACH,GAAG;AAAA,EACP;AAEA,QAAM,WAAW,OAAO,QAAQ,CAAC;AAEjC,MAAI,eAAe,oBAAoB;AACnC,UAAM,WAAW,OAAO,kBAAkB;AAC1C,UAAM,eAAe,oBAAoB,aAAa,QAAQ;AAC9D,QAAI,cAAc;AACd,YAAM,OAAO,SAAS,cAAc;AAAA,QAChC,MAAM,WAAW,CAAC,mBAAmB,gBAAgB,GAAG,QAAQ,CAAC;AAAA,QACjE,YAAY,eAAe,oBAAoB,KAAK,IAAI,KAAK,eAAe,UAAU;AAAA,QACtF,UAAU,eAAe;AAAA,MAC7B,CAAC;AAAA,IACL;AAAA,EACJ;AAEA,MAAI,eAAe,qBAAqB;AACpC,UAAM,WAAW,OAAO,sBAAsB;AAC9C,QAAI,sBAAsB,aAAa,QAAQ,GAAG;AAC9C,YAAM,OAAO,SAAS,aAAa;AAAA,QAC/B,MAAM,WAAW,CAAC,mBAAmB,gBAAgB,GAAG,QAAQ,CAAC;AAAA,QACjE,YAAY,eAAe;AAAA,QAC3B,UAAU,eAAe;AAAA,MAC7B,CAAC;AAAA,IACL;AAAA,EACJ;AAEA,MAAI,eAAe,uBAAuB;AACtC,UAAM,UAAU,YAAY,KAAK;AACjC,QAAI,QAAQ,UAAU,eAAe,kBAAkB;AACnD,YAAM,OAAO;AAAA,QACT;AAAA,UACI,MAAM;AAAA,UACN,WAAW;AAAA,QACf;AAAA,QACA;AAAA,UACI,MAAM,WAAW,CAAC,qBAAqB,GAAG,QAAQ,CAAC;AAAA,UACnD,YAAY,KAAK,IAAI,eAAe,YAAY,GAAG;AAAA,UACnD,UAAU,eAAe;AAAA,QAC7B;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;AAEA,SAAS,WAAW,MAA0B;AAC1C,SAAO,MAAM,KAAK,IAAI,IAAI,IAAI,CAAC,EAAE,OAAO,OAAO;AACnD;;;ACxBO,IAAM,QAAN,MAAY;AAAA,EAwCf,YAAY,QAAqB;AAvCjC,wBAAQ;AACR,wBAAQ;AACR,wBAAQ,UAA6B;AACrC,wBAAQ,eAAkC;AAC1C,wBAAQ;AACR,wBAAQ,aAAqB;AAC7B,wBAAQ,aAA0B;AAClC,wBAAQ;AA4BR,wBAAQ;AACR,wBAAQ,uBAAqC,CAAC;AAC9C,wBAAQ;AAGJ,SAAK,SAAS;AAAA,MACV,UAAU,OAAO;AAAA,MACjB,OAAO,OAAO,SAAS,CAAC;AAAA,MACxB,MAAM,OAAO,QAAQ;AAAA,MACrB,cAAc,OAAO,gBAAgB;AAAA,MACrC,WAAW,OAAO,aAAa;AAAA,MAC/B,UAAU,OAAO,YAAY;AAAA,MAC7B,OAAO,OAAO,SAAS,CAAC;AAAA,MACxB,iBAAiB,OAAO,mBAAmB;AAAA,MAC3C,aAAa,OAAO;AAAA,MACpB,QAAQ,OAAO;AAAA,MACf,cAAc,OAAO,gBAAgB;AAAA,MACrC,MAAM,OAAO;AAAA,MACb,aAAa,OAAO;AAAA,MACpB,oBAAoB,OAAO,sBAAsB;AAAA,MACjD,cAAc,OAAO;AAAA,MACrB,qBAAqB,OAAO;AAAA,MAC5B,kBAAkB,OAAO,oBAAoB;AAAA,MAC7C,sBAAsB,OAAO;AAAA,MAC7B,wBAAwB,OAAO;AAAA,IACnC;AAEA,SAAK,WAAW,KAAK,eAAe,KAAK,OAAO,QAAQ;AACxD,SAAK,eAAe,IAAI,aAAa;AACrC,SAAK,kBAAkB,IAAI,qBAAqB;AAChD,SAAK,eAAe,KAAK,mBAAmB;AAC5C,SAAK,OAAO,MAAM,QAAQ,UAAQ,KAAK,aAAa,SAAS,IAAI,CAAC;AAClE,SAAK,iBAAiB;AACtB,SAAK,cAAc,KAAK,OAAO,gBAAgB,KAAK,cAAc,6BAA6B,KAAK,WAAW,IAAI;AAAA,EACvH;AAAA,EAEQ,eAAe,QAA0C;AAC7D,QAAI,UAAU,QAAQ;AAClB,aAAO,kBAAkB,MAA2B;AAAA,IACxD;AACA,WAAO,2BAA2B,MAA6B;AAAA,EACnE;AAAA,EAEQ,qBAA+C;AACnD,QAAI,KAAK,OAAO,cAAc;AAC1B,aAAO,KAAK,OAAO;AAAA,IACvB;AAEA,QAAI,CAAC,KAAK,OAAO,oBAAoB;AACjC,aAAO;AAAA,IACX;AAEA,WAAO,IAAI,gBAAgB,KAAK,UAAU,KAAK,OAAO,mBAAmB;AAAA,EAC7E;AAAA,EAEQ,mBAAyB;AAC7B,UAAM,UAAU,IAAI,eAAe,KAAK,cAAc,EAAE,UAAU,KAAK,SAAS,CAAC;AACjF,UAAM,aAAa,IAAI,eAAe,KAAK,cAAc,EAAE,UAAU,KAAK,SAAS,CAAC;AACpF,UAAM,YAAY,IAAI,iBAAiB,EAAE,WAAW,KAAK,OAAO,YAAY,CAAC;AAC7E,UAAM,WAAW,IAAI,aAAa;AAGlC,UAAM,YAAY,KAAK,OAAO,kBACxB,IAAI,iBAAiB,EAAE,UAAU,KAAK,SAAS,CAAC,IAChD,IAAI,cAAc;AAGxB,UAAM,QAAwH;AAAA,MAC1H;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACJ;AAGA,QAAI,aAAgC;AACpC,QAAI,KAAK,OAAO,gBAAgB,KAAK,OAAO,QAAQ;AAChD,mBAAa,IAAI,WAAW;AAAA,QACxB,eAAe,KAAK,OAAO;AAAA,QAC3B,oBAAoB;AAAA,QACpB,qBAAqB;AAAA,QACrB,iBAAiB;AAAA,MACrB,CAAC;AACD,YAAM,KAAK,UAAU;AAAA,IACzB;AAEA,UAAM,QAAyB;AAAA,MAC3B;AAAA,MACA,OAAO;AAAA,QACH,EAAE,MAAM,WAAW,IAAI,cAAc;AAAA,QACrC;AAAA,UACI,MAAM;AAAA,UACN,IAAI;AAAA,UACJ,WAAW,CAAC,MAAM,EAAE,KAAK,iBAAiB,WAAW;AAAA,QACzD;AAAA,QACA,EAAE,MAAM,eAAe,IAAI,WAAW;AAAA,QACtC,EAAE,MAAM,gBAAgB,IAAI,cAAc;AAAA,QAC1C,EAAE,MAAM,YAAY,IAAI,aAAa,WAAW,CAAC,MAAM,EAAE,KAAK,oBAAoB,EAAE,KAAK,MAAM,OAAO;AAAA,QACtG,EAAE,MAAM,YAAY,IAAI,eAAe,WAAW,CAAC,MAAM,EAAE,KAAK,mBAAmB,EAAE,KAAK,MAAM,OAAO;AAAA;AAAA,QAEvG,GAAI,aAAa,CAAC,EAAE,MAAM,aAAa,IAAI,SAAS,CAAC,IAAI,CAAC;AAAA,MAC9D;AAAA,MACA,WAAW;AAAA,MACX,UAAU,KAAK,OAAO;AAAA,IAC1B;AAEA,SAAK,SAAS,IAAI,YAAY,OAAO,QAAW,KAAK,OAAO,KAAK;AACjE,SAAK,cAAc,KAAK,OAAO,eAAe;AAAA,EAClD;AAAA;AAAA,EAGA,MAAM,KAAK,SAAiB,UAAuB,CAAC,GAAyB;AACzE,QAAI,KAAK,WAAW;AAChB,YAAM,IAAI,MAAM,+CAA+C;AAAA,IACnE;AAEA,SAAK,YAAY;AACjB,SAAK,gBAAgB,MAAM;AAC3B,UAAM,YAAY,KAAK,IAAI;AAC3B,UAAM,WAAW,MAAM,KAAK,iBAAiB,OAAO;AACpD,UAAM,OAAO,SAAS;AACtB,SAAK,SAAS;AAAA,MACV,QAAQ;AAAA,MACR,QAAQ;AAAA,MACR,UAAU;AAAA,QACN;AAAA,QACA,QAAQ,SAAS;AAAA,QACjB,cAAc,SAAS,YAAY;AAAA,QACnC,cAAc,SAAS;AAAA,MAC3B;AAAA,IACJ,CAAC;AAED,SAAK,oBAAoB,KAAK,EAAE,MAAM,QAAQ,SAAS,QAAQ,CAAC;AAEhE,QAAI;AACA,UAAI,SAAS,QAAQ;AACjB,eAAO,MAAM,KAAK,eAAe,SAAS,SAAS,WAAW,QAAQ;AAAA,MAC1E;AACA,aAAO,MAAM,KAAK,gBAAgB,SAAS,WAAW,QAAQ;AAAA,IAClE,SAAS,OAAO;AACZ,UAAI,aAAa,KAAK,GAAG;AACrB,eAAO;AAAA,UACH,SAAS;AAAA,UACT;AAAA,UACA,UAAU,KAAK,IAAI,IAAI;AAAA,UACvB,SAAS;AAAA,UACT,aAAa,KAAK,gBAAgB,cAAc,EAAE;AAAA,QACtD;AAAA,MACJ;AACA,YAAM;AAAA,IACV,UAAE;AACE,WAAK,YAAY;AAAA,IACrB;AAAA,EACJ;AAAA,EAEA,MAAc,iBAAiB,SAA0C;AACrE,QAAI,KAAK,OAAO,SAAS,OAAQ,QAAO,EAAE,MAAM,QAAQ,QAAQ,SAAS;AACzE,QAAI,KAAK,OAAO,SAAS,QAAS,QAAO,EAAE,MAAM,SAAS,QAAQ,SAAS;AAE3E,UAAM,WAAW,KAAK,aAAa,KAAK,EAAE,SAAS;AACnD,QAAI,CAAC,KAAK,cAAc;AACpB,aAAO;AAAA,QACH,MAAM,mBAAmB,SAAS,QAAQ,IAAI,UAAU;AAAA,QACxD,QAAQ;AAAA,MACZ;AAAA,IACJ;AAEA,UAAM,WAAW,MAAM,KAAK,aAAa,MAAM;AAAA,MAC3C;AAAA,MACA;AAAA,MACA,gBAAgB,KAAK,aAAa,KAAK;AAAA,IAC3C,CAAC;AAED,QAAI,CAAC,YAAY,SAAS,SAAS,SAAS;AACxC,aAAO,EAAE,GAAG,UAAU,MAAM,OAAO;AAAA,IACvC;AAEA,WAAO;AAAA,EACX;AAAA,EAEA,MAAc,eACV,SACA,SACA,WACA,UACoB;AACpB,UAAM,WAA0B,CAAC,EAAE,MAAM,UAAU,SAAS,KAAK,OAAO,aAAa,CAAC;AACtF,UAAM,OAAO,KAAK,YAAY;AAC9B,UAAM,YAAY,KAAK,oBAAoB,KAAK,aAAa,aAAa;AAC1E,UAAM,WAAW,KAAK,oBAAoB,KAAK,aAAa,cAAc;AAC1E,UAAM,gBAAgB,QAAQ,iBACvB,UAAU,cAAc,oBACxB,KAAK,OAAO;AAEnB,QAAI,iBAAiB,KAAK,OAAO,QAAQ;AACrC,YAAM,eAAe,KAAK,4BAA4B,QAAQ,sBAAsB;AACpF,UAAI,WAAW;AACX,cAAM,gBAAgB,MAAM,KAAK,uBAAuB,SAAS,YAAY;AAC7E,YAAI,eAAe;AACf,mBAAS,KAAK,aAAa;AAAA,QAC/B;AAAA,MACJ,OAAO;AACH,aAAK,SAAS;AAAA,UACV,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,UAAU,EAAE,OAAO,QAAQ,QAAQ,aAAa;AAAA,QACpD,CAAC;AAAA,MACL;AAAA,IACJ;AAEA,aAAS,KAAK,GAAG,KAAK,mBAAmB;AAEzC,UAAM,YAAY,QAAQ,UAAU,KAAK,OAAO;AAEhD,QAAI,aAAa,QAAQ,UAAU;AAC/B,UAAI,cAAc;AAClB,UAAI;AACJ,YAAM,SAAS,KAAK,SAAS,WAAW;AAAA,QACpC;AAAA,QACA,aAAa,QAAQ;AAAA,QACrB,QAAQ,KAAK,gBAAgB;AAAA,MACjC,CAAC;AAED,uBAAiB,SAAS,QAAQ;AAC9B,YAAI,MAAM,OAAO;AACb,yBAAe,MAAM;AACrB,kBAAQ,SAAS,MAAM,KAAK;AAAA,QAChC;AACA,YAAI,MAAM,OAAO;AACb,kBAAQ,MAAM;AAAA,QAClB;AAAA,MACJ;AAEA,WAAK,oBAAoB,KAAK,EAAE,MAAM,aAAa,SAAS,YAAY,CAAC;AACzE,UAAI,iBAAiB,KAAK,OAAO,QAAQ;AACrC,YAAI,CAAC,UAAU;AACX,eAAK,SAAS;AAAA,YACV,QAAQ;AAAA,YACR,QAAQ;AAAA,YACR,UAAU,EAAE,OAAO,QAAQ,QAAQ,aAAa;AAAA,UACpD,CAAC;AAAA,QACL,OAAO;AACP,gBAAM,KAAK,eAAe,SAAS,aAAa,QAAQ,oBAAoB;AAAA,QAC5E;AAAA,MACJ;AACA,aAAO;AAAA,QACH,SAAS;AAAA,QACT,MAAM;AAAA,QACN,UAAU,KAAK,IAAI,IAAI;AAAA,QACvB;AAAA,MACJ;AAAA,IACJ;AAEA,UAAM,WAAW,MAAM,KAAK,SAAS,KAAK;AAAA,MACtC;AAAA,MACA,aAAa,QAAQ;AAAA,MACrB,QAAQ,KAAK,gBAAgB;AAAA,IACjC,CAAC;AACD,SAAK,oBAAoB,KAAK,EAAE,MAAM,aAAa,SAAS,SAAS,QAAQ,CAAC;AAC9E,QAAI,iBAAiB,KAAK,OAAO,QAAQ;AACrC,UAAI,CAAC,UAAU;AACX,aAAK,SAAS;AAAA,UACV,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,UAAU,EAAE,OAAO,QAAQ,QAAQ,aAAa;AAAA,QACpD,CAAC;AAAA,MACL,OAAO;AACP,cAAM,KAAK,eAAe,SAAS,SAAS,SAAS,QAAQ,oBAAoB;AAAA,MACjF;AAAA,IACJ;AAEA,WAAO;AAAA,MACH,SAAS,SAAS;AAAA,MAClB,OAAO,SAAS;AAAA,MAChB,MAAM;AAAA,MACN,UAAU,KAAK,IAAI,IAAI;AAAA,IAC3B;AAAA,EACJ;AAAA,EAEA,MAAc,gBACV,SACA,WACA,UACoB;AACpB,QAAI,CAAC,KAAK,OAAQ,OAAM,IAAI,MAAM,6BAA6B;AAG/D,QAAI,mBAA6B,CAAC;AAClC,UAAM,gBAAgB,UAAU,cAAc,gBAAgB,KAAK,OAAO;AAC1E,UAAM,OAAO,KAAK,YAAY;AAC9B,UAAM,cAAc,KAAK,eAAe,EAAE,YAAY,MAAM,iBAAiB,KAAK;AAClF,UAAM,QAAQ,KAAK;AACnB,UAAM,YAAY,KAAK,oBAAoB,KAAK,aAAa,aAAa;AAC1E,UAAM,WAAW,KAAK,oBAAoB,KAAK,aAAa,cAAc;AAC1E,UAAM,wBAAwB,iBAAiB;AAC/C,QAAI,iBAAiB,KAAK,OAAO,QAAQ;AACrC,UAAI,CAAC,WAAW;AACZ,aAAK,SAAS;AAAA,UACV,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,UAAU,EAAE,OAAO,SAAS,QAAQ,aAAa;AAAA,QACrD,CAAC;AAAA,MACL,OAAO;AACP,2BAAmB,MAAM,KAAK,uBAAuB,OAAO;AAAA,MAC5D;AAAA,IACJ;AAEA,UAAM,eAAe,YAAY,SAAS;AAAA,MACtC;AAAA,MACA,cAAc,UAAU,YAAY;AAAA,MACpC,eAAe;AAAA,MACf;AAAA,IACJ,CAAC;AAGD,QAAI,iBAAiB,SAAS,GAAG;AAC7B,mBAAa,OAAO,UAAU,kBAAkB,IAAI;AAAA,IACxD;AAGA,UAAM,SAAS,MAAM,KAAK,gBAAgB;AAAA,MACtC,KAAK,OAAO,QAAQ,YAAY;AAAA,IACpC;AACA,UAAM,aAAa,OAAO;AAC1B,SAAK,YAAY;AAEjB,UAAM,cAAc,WAAW,aAAa,SAAS,OAAO,OAAK,EAAE,SAAS,WAAW,EAAE,IAAI;AAC7F,UAAM,UAAU,aAAa,WAAW;AAAA,MACpC,WAAW,KAAK;AAAA,MAChB,WAAW,KAAK,MAAM,IAAI,QAAM,EAAE,aAAa,EAAE,aAAa,QAAQ,EAAE,OAAO,EAAE;AAAA,IACrF;AAEA,SAAK,oBAAoB,KAAK,EAAE,MAAM,aAAa,QAAQ,CAAC;AAE5D,WAAO;AAAA,MACH;AAAA,MACA,MAAM;AAAA,MACN,OAAO,WAAW,KAAK,MAAM,IAAI,QAAM,EAAE,aAAa,EAAE,aAAa,QAAQ,EAAE,QAAQ,QAAQ,EAAE,OAAO,EAAE;AAAA,MAC1G,UAAU,KAAK,IAAI,IAAI;AAAA,MACvB,OAAO,EAAE,cAAc,GAAG,kBAAkB,GAAG,aAAa,WAAW,UAAU,WAAW;AAAA,IAChG;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,uBAAuB,OAAkC;AACnE,QAAI,CAAC,KAAK,OAAO,OAAQ,QAAO,CAAC;AAEjC,QAAI;AACA,YAAM,WAAW,MAAM,KAAK,OAAO,OAAO,OAAO,KAAK;AACtD,WAAK,aAAa,KAAK,iBAAiB,QAAQ,2BAA2B;AAAA,QACvE,UAAU;AAAA,UACN;AAAA,UACA,OAAO,SAAS;AAAA,UAChB,QAAQ;AAAA,QACZ;AAAA,MACJ,CAAC;AACD,WAAK,SAAS;AAAA,QACV,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,UAAU,EAAE,OAAO,SAAS,OAAO,OAAO,SAAS,OAAO;AAAA,MAC9D,CAAC;AACD,aAAO,SAAS,MAAM,GAAG,CAAC,EAAE,IAAI,OAAK,uBAAuB,EAAE,OAAO,CAAC;AAAA,IAC1E,SAAS,OAAO;AACZ,cAAQ,MAAM,sCAAsC,KAAK;AACzD,aAAO,CAAC;AAAA,IACZ;AAAA,EACJ;AAAA,EAEQ,4BAA4B,UAA2D;AAC3F,WAAO;AAAA,MACH,GAAG;AAAA,MACH,GAAG,KAAK,OAAO;AAAA,MACf,GAAG;AAAA,IACP;AAAA,EACJ;AAAA,EAEQ,0BAA0B,UAAuD;AACrF,WAAO;AAAA,MACH,GAAG;AAAA,MACH,GAAG,KAAK,OAAO;AAAA,MACf,GAAG;AAAA,IACP;AAAA,EACJ;AAAA,EAEA,MAAc,uBACV,OACA,QAC2B;AAC3B,QAAI,CAAC,KAAK,OAAO,OAAQ,QAAO;AAEhC,QAAI;AACA,YAAM,WAAW,MAAM,KAAK,OAAO,OAAO,OAAO,KAAK;AACtD,WAAK,aAAa,KAAK,iBAAiB,QAAQ,0BAA0B;AAAA,QACtE,UAAU;AAAA,UACN;AAAA,UACA,OAAO,SAAS;AAAA,UAChB,QAAQ;AAAA,QACZ;AAAA,MACJ,CAAC;AACD,WAAK,SAAS;AAAA,QACV,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,UAAU,EAAE,OAAO,QAAQ,OAAO,OAAO,SAAS,OAAO;AAAA,MAC7D,CAAC;AACD,YAAM,WAAW,4BAA4B,UAAU,MAAM;AAC7D,YAAM,YAAY,mBAAmB,QAAQ;AAC7C,UAAI,CAAC,UAAW,QAAO;AAEvB,YAAM,OAAQ,OAAO,eAAe,kCAAkC;AACtE,aAAO,EAAE,MAAM,SAAS,UAAU;AAAA,IACtC,SAAS,OAAO;AACZ,cAAQ,MAAM,2CAA2C,KAAK;AAC9D,aAAO;AAAA,IACX;AAAA,EACJ;AAAA,EAEA,MAAc,eACV,aACA,kBACA,gBACa;AACb,QAAI,CAAC,KAAK,OAAO,OAAQ;AAEzB,UAAM,aAAa,KAAK,0BAA0B,cAAc;AAChE,QAAI;AACA,YAAM,mBAAmB,KAAK,OAAO,QAAQ,aAAa,kBAAkB,UAAU;AACtF,WAAK,aAAa,KAAK,eAAe,QAAQ,qBAAqB;AAAA,QAC/D,UAAU;AAAA,UACN,QAAQ;AAAA,UACR,oBAAoB,CAAC,CAAC,WAAW;AAAA,UACjC,qBAAqB,CAAC,CAAC,WAAW;AAAA,UAClC,uBAAuB,CAAC,CAAC,WAAW;AAAA,QACxC;AAAA,MACJ,CAAC;AACD,WAAK,SAAS;AAAA,QACV,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,UAAU;AAAA,UACN,OAAO;AAAA,UACP,oBAAoB,CAAC,CAAC,WAAW;AAAA,UACjC,qBAAqB,CAAC,CAAC,WAAW;AAAA,UAClC,uBAAuB,CAAC,CAAC,WAAW;AAAA,QACxC;AAAA,MACJ,CAAC;AAAA,IACL,SAAS,OAAO;AACZ,cAAQ,MAAM,yCAAyC,KAAK;AAAA,IAChE;AAAA,EACJ;AAAA,EAEQ,cAA2E;AAC/E,UAAM,SAAS,KAAK,OAAO,MAAM;AACjC,QAAI,CAAC,OAAQ,QAAO,CAAC;AACrB,UAAM,QAAQ,aAAa,QAAQ,KAAK,OAAO,MAAM,KAAK;AAC1D,UAAM,cAAc,mBAAmB,QAAQ,KAAK;AACpD,WAAO,EAAE,OAAO,YAAY;AAAA,EAChC;AAAA,EAEQ,oBAAoB,aAAkD,YAA6B;AACvG,QAAI,CAAC,YAAa,QAAO;AACzB,WAAO,YAAY,UAAU,MAAM;AAAA,EACvC;AAAA,EAEQ,SAAS,OAAoE;AACjF,QAAI,CAAC,KAAK,YAAa;AACvB,UAAM,SAAS,KAAK,OAAO,MAAM;AACjC,UAAM,QAAQ,SAAS,aAAa,QAAQ,KAAK,OAAO,MAAM,KAAK,IAAI,KAAK,OAAO,MAAM;AACzF,SAAK,YAAY,IAAI;AAAA,MACjB,GAAG;AAAA,MACH,OAAO,KAAK,OAAO,MAAM;AAAA,MACzB;AAAA,IACJ,CAAC;AAAA,EACL;AAAA;AAAA,EAGA,iBAA8B;AAC1B,QAAI,CAAC,KAAK,aAAa;AACnB,YAAM,IAAI,MAAM,6BAA6B;AAAA,IACjD;AACA,WAAO,KAAK;AAAA,EAChB;AAAA,EACA,kBAAgC;AAAE,WAAO,KAAK;AAAA,EAAc;AAAA,EAC5D,cAA2B;AAAE,WAAO,KAAK;AAAA,EAAU;AAAA,EACnD,aAA4B;AAAE,WAAO,CAAC,GAAG,KAAK,mBAAmB;AAAA,EAAG;AAAA,EACpE,YAAuC;AAAE,WAAO,KAAK,OAAO;AAAA,EAAQ;AAAA,EACpE,qBAAqB;AAAE,WAAO,KAAK,QAAQ,mBAAmB;AAAA,EAAG;AAAA,EAEjE,aAAa,MAAkB;AAAE,SAAK,aAAa,SAAS,IAAI;AAAA,EAAG;AAAA,EACnE,eAAqB;AAAE,SAAK,sBAAsB,CAAC;AAAA,EAAG;AAAA,EACtD,WAAW,SAA8B;AAAE,SAAK,sBAAsB,CAAC,GAAG,OAAO;AAAA,EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUpF,MAAM,QAAuB;AACzB,QAAI,CAAC,KAAK,WAAW;AACjB,cAAQ,KAAK,yCAAyC;AACtD;AAAA,IACJ;AACA,SAAK,gBAAgB,MAAM,MAAM;AACjC,SAAK,aAAa,KAAK,SAAS,WAAW,UAAU,sBAAsB;AAAA,EAC/E;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAM,OAAO,UAAyB,CAAC,GAAyB;AAC5D,QAAI,KAAK,WAAW;AAChB,YAAM,IAAI,MAAM,2BAA2B;AAAA,IAC/C;AAEA,UAAM,eAAe,QAAQ;AAC7B,QAAI,cAA4B;AAEhC,QAAI,cAAc;AACd,YAAM,aAAa,KAAK,gBAAgB,cAAc,YAAY;AAClE,UAAI,CAAC,YAAY;AACb,cAAM,IAAI,MAAM,eAAe,YAAY,cAAc;AAAA,MAC7D;AACA,oBAAc,WAAW;AAAA,IAC7B,OAAO;AAEH,YAAM,mBAAmB,KAAK,gBAAgB,oBAAoB;AAClE,oBAAc,kBAAkB,SAAS,KAAK;AAAA,IAClD;AAEA,QAAI,CAAC,aAAa;AACd,YAAM,IAAI,MAAM,oCAAoC;AAAA,IACxD;AAGA,QAAI,QAAQ,eAAe;AACvB,oBAAc;AAAA,QACV,GAAG;AAAA,QACH,GAAG,QAAQ;AAAA,QACX,WAAW,KAAK,IAAI;AAAA,MACxB;AAAA,IACJ;AAEA,SAAK,YAAY;AACjB,SAAK,gBAAgB,MAAM;AAC3B,UAAM,YAAY,KAAK,IAAI;AAE3B,QAAI;AACA,UAAI,CAAC,KAAK,OAAQ,OAAM,IAAI,MAAM,6BAA6B;AAE/D,WAAK,aAAa,KAAK,UAAU,QAAQ,0BAA0B;AAEnE,YAAM,SAAS,MAAM,KAAK,OAAO,QAAQ,WAAW;AACpD,YAAM,aAAa,OAAO;AAC1B,WAAK,YAAY;AAEjB,YAAM,cAAc,WAAW,aAAa,SACvC,OAAO,OAAK,EAAE,SAAS,WAAW,EAAE,IAAI;AAC7C,YAAM,UAAU,aAAa,WAAW;AAAA,QACpC,WAAW,KAAK;AAAA,QAChB,WAAW,KAAK,MAAM,IAAI,QAAM,EAAE,aAAa,EAAE,aAAa,QAAQ,EAAE,OAAO,EAAE;AAAA,MACrF;AAEA,WAAK,oBAAoB,KAAK,EAAE,MAAM,aAAa,QAAQ,CAAC;AAE5D,aAAO;AAAA,QACH;AAAA,QACA,MAAM;AAAA,QACN,OAAO,WAAW,KAAK,MAAM,IAAI,QAAM;AAAA,UACnC,aAAa,EAAE;AAAA,UACf,QAAQ,EAAE;AAAA,UACV,QAAQ,EAAE;AAAA,QACd,EAAE;AAAA,QACF,UAAU,KAAK,IAAI,IAAI;AAAA,QACvB,OAAO,EAAE,cAAc,GAAG,kBAAkB,GAAG,aAAa,WAAW,UAAU,WAAW;AAAA,MAChG;AAAA,IACJ,SAAS,OAAO;AACZ,UAAI,aAAa,KAAK,GAAG;AACrB,eAAO;AAAA,UACH,SAAS;AAAA,UACT,MAAM;AAAA,UACN,UAAU,KAAK,IAAI,IAAI;AAAA,UACvB,SAAS;AAAA,UACT,aAAa,KAAK,gBAAgB,cAAc,EAAE;AAAA,QACtD;AAAA,MACJ;AACA,YAAM;AAAA,IACV,UAAE;AACE,WAAK,YAAY;AAAA,IACrB;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,iBAA0B;AACtB,WAAO,KAAK;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,qBAA2C;AACvC,WAAO,KAAK;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,kBAAgC;AAC5B,WAAO,KAAK,gBAAgB,gBAAgB;AAAA,EAChD;AACJ;AAGO,SAAS,YAAY,QAA4B;AACpD,SAAO,IAAI,MAAM,MAAM;AAC3B;;;ACxuBO,SAAS,kBACZ,OACA,aACA,SAIW;AACX,SAAO;AAAA,IACH,SAAS;AAAA,IACT,WAAW,KAAK,IAAI;AAAA,IACpB;AAAA,IACA,QAAQ,YAAY,OAAO;AAAA,IAC3B,aAAa,SAAS;AAAA,IACtB,UAAU;AAAA,MACN,WAAW,OAAO,cAAc,cAAc,UAAU,YAAY;AAAA,MACpE,UAAU,OAAO,cAAc,cAAc,UAAU,WAAW;AAAA,MAClE,GAAG,SAAS;AAAA,IAChB;AAAA,EACJ;AACJ;AAKO,SAAS,kBAAkB,QAA6B;AAC3D,SAAO,KAAK,UAAU,QAAQ,MAAM,CAAC;AACzC;AAKO,SAAS,oBAAoB,QAAqB,UAAyB;AAC9E,QAAM,OAAO,kBAAkB,MAAM;AACrC,QAAM,OAAO,IAAI,KAAK,CAAC,IAAI,GAAG,EAAE,MAAM,mBAAmB,CAAC;AAC1D,QAAM,MAAM,IAAI,gBAAgB,IAAI;AAEpC,QAAM,IAAI,SAAS,cAAc,GAAG;AACpC,IAAE,OAAO;AACT,IAAE,WAAW,YAAY,gBAAgB,KAAK,IAAI,CAAC;AACnD,IAAE,MAAM;AAER,MAAI,gBAAgB,GAAG;AAC3B;AAKO,SAAS,kBAAkB,MAA2B;AACzD,SAAO,KAAK,MAAM,IAAI;AAC1B;;;ACjEO,IAAM,cAAN,cAA0B,SAAS;AAAA,EACtC,cAAc;AACV,UAAM,WAAW,SAAS;AAAA,EAC9B;AAAA,EAEA,MAAM,QAAQ,OAAmC;AAC7C,UAAM,SAA+B,CAAC;AACtC,UAAM,YAAY,KAAK,IAAI;AAE3B,QAAI;AAEA,YAAM,OAAO,MAAM,KAAK,aAAa,MAAM,KAAK,IAAI;AACpD,YAAM,QAAQ,KAAK,WAAW,IAAI;AAGlC,YAAM,WAAW,YAAY,OAAO,WAAS;AACzC,cAAM,KAAK,OAAO;AAClB,cAAM,KAAK,QAAQ;AACnB,cAAM,KAAK,WAAW;AAAA,MAC1B,CAAC;AAED,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,sBAAO,MAAM,MAAM;AAAA,QAC5B,UAAU,EAAE,WAAW,MAAM,OAAO;AAAA,MACxC,CAAC;AAED,aAAO,KAAK,aAAa,UAAU,MAAM;AAAA,IAC7C,SAAS,OAAO;AACZ,aAAO,KAAK;AAAA,QACR,IAAI,OAAO,KAAK,IAAI,CAAC;AAAA,QACrB,WAAW,KAAK,IAAI;AAAA,QACpB,MAAM;AAAA,QACN,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,SAAS,6BAAS,KAAK;AAAA,MAC3B,CAAC;AAED,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,MAAc,aAAa,MAA+B;AAEtD,UAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,QAAI,KAAK,SAAS,KAAK,KAAK,KAAK,SAAS,KAAK,GAAG;AAC9C,aAAO;AAAA;AAAA;AAAA;AAAA,IACX;AAEA,QAAI,KAAK,SAAS,cAAI,KAAK,KAAK,SAAS,cAAI,GAAG;AAC5C,aAAO;AAAA;AAAA;AAAA;AAAA,IACX;AAGA,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKQ,WAAW,MAA0B;AACzC,UAAM,QAAQ,KAAK,MAAM,IAAI,EAAE,OAAO,UAAQ,KAAK,KAAK,CAAC;AAEzD,WAAO,MAAM,IAAI,CAAC,MAAM,WAAW;AAAA,MAC/B,IAAI,QAAQ,QAAQ,CAAC;AAAA,MACrB,aAAa,KAAK,QAAQ,aAAa,EAAE;AAAA;AAAA,MACzC,QAAQ;AAAA,IACZ,EAAE;AAAA,EACN;AACJ;;;AC5EO,IAAM,eAAqB;AAAA,EAC9B,MAAM;AAAA,EACN,aAAa;AAAA,EAEb,aAAa,iBAAE,OAAO;AAAA,IAClB,OAAO,iBAAE,OAAO,EAAE,IAAI,GAAG,uBAAuB,EAAE,SAAS,iCAAiC;AAAA,IAC5F,UAAU,iBAAE,OAAO,EAAE,SAAS,EAAE,SAAS,wBAAwB;AAAA,EACrE,CAAC;AAAA,EAED,cAAc,iBAAE,OAAO;AAAA,IACnB,MAAM,iBAAE,MAAM,iBAAE,OAAO,iBAAE,QAAQ,CAAC,CAAC;AAAA,IACnC,UAAU,iBAAE,OAAO;AAAA,IACnB,eAAe,iBAAE,OAAO;AAAA,EAC5B,CAAC;AAAA,EAED,SAAS;AAAA,EAET,aAAa;AAAA,IACT,YAAY;AAAA,IACZ,WAAW;AAAA,IACX,mBAAmB;AAAA,EACvB;AAAA,EAEA,aAAa,CAAC,UAAU;AAAA,EACxB,sBAAsB;AAAA,EACtB,qBAAqB;AAAA,EAErB,cAAc,CAAC,aAAa;AAAA,EAE5B,MAAM,QAAQ,OAAgB;AAC1B,UAAM,EAAE,MAAM,IAAI;AAGlB,UAAM,kBAAkB,MAAM,KAAK,EAAE,YAAY;AACjD,QAAI,CAAC,gBAAgB,WAAW,QAAQ,GAAG;AACvC,YAAM,IAAI,MAAM,iCAAiC;AAAA,IACrD;AAEA,YAAQ,IAAI,0BAA0B,KAAK;AAG3C,UAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,WAAO;AAAA,MACH,MAAM;AAAA,QACF,EAAE,IAAI,GAAG,MAAM,SAAS,OAAO,oBAAoB;AAAA,QACnD,EAAE,IAAI,GAAG,MAAM,OAAO,OAAO,kBAAkB;AAAA,QAC/C,EAAE,IAAI,GAAG,MAAM,WAAW,OAAO,sBAAsB;AAAA,MAC3D;AAAA,MACA,UAAU;AAAA,MACV,eAAe;AAAA,IACnB;AAAA,EACJ;AACJ;AAKO,IAAM,qBAA2B;AAAA,EACpC,MAAM;AAAA,EACN,aAAa;AAAA,EAEb,aAAa,iBAAE,OAAO;AAAA,IAClB,UAAU,iBAAE,MAAM,iBAAE,OAAO,CAAC,EAAE,IAAI,GAAG,+BAA+B,EAAE,SAAS,wBAAwB;AAAA,IACvG,OAAO,iBAAE,OAAO,EAAE,IAAI,CAAC,EAAE,IAAI,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,EAAE,SAAS,2BAA2B;AAAA,EAChG,CAAC;AAAA,EAED,cAAc,iBAAE,OAAO;AAAA,IACnB,WAAW,iBAAE,MAAM,iBAAE,OAAO;AAAA,MACxB,IAAI,iBAAE,OAAO;AAAA,MACb,OAAO,iBAAE,OAAO;AAAA,MAChB,SAAS,iBAAE,OAAO;AAAA,MAClB,WAAW,iBAAE,OAAO;AAAA,IACxB,CAAC,CAAC;AAAA,IACF,YAAY,iBAAE,OAAO;AAAA,EACzB,CAAC;AAAA,EAED,SAAS;AAAA,EAET,aAAa;AAAA,IACT,YAAY;AAAA,IACZ,WAAW;AAAA,IACX,mBAAmB;AAAA,EACvB;AAAA,EAEA,aAAa,CAAC,eAAe;AAAA,EAE7B,MAAM,QAAQ,OAAgB;AAC1B,UAAM,EAAE,UAAU,QAAQ,GAAG,IAAI;AAGjC,UAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,UAAM,WAAW;AAAA,MACb;AAAA,QACI,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,WAAW;AAAA,MACf;AAAA,MACA;AAAA,QACI,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,WAAW;AAAA,MACf;AAAA,MACA;AAAA,QACI,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,WAAW;AAAA,MACf;AAAA,IACJ;AAEA,WAAO;AAAA,MACH,WAAW,SAAS,MAAM,GAAG,KAAK;AAAA,MAClC,YAAY,SAAS;AAAA,IACzB;AAAA,EACJ;AACJ;AAKO,SAAS,kBAA0B;AACtC,SAAO,CAAC,cAAc,kBAAkB;AAC5C;;;AC3HO,IAAM,WAAN,MAAe;AAAA,EAKlB,YAAY,QAAqB;AAJjC,wBAAQ,SAAiC,oBAAI,IAAI;AACjD,wBAAQ;AACR,wBAAQ,eAAwB,CAAC;AAG7B,SAAK,SAAS;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,SAA8B;AACtC,QAAI,KAAK,OAAO,cAAc;AAC1B,aAAO,KAAK,OAAO,aAAa,OAAO;AAAA,IAC3C;AAGA,UAAM,UAAU;AAAA,MACZ,UAAU,QAAQ,SAAS,IAAI,QAAM;AAAA,QACjC,MAAM,EAAE;AAAA,QACR,SAAS,EAAE;AAAA,MACf,EAAE;AAAA,MACF,aAAa,QAAQ,eAAe;AAAA,IACxC;AAEA,WAAO,KAAK,WAAW,KAAK,UAAU,OAAO,CAAC;AAAA,EAClD;AAAA;AAAA;AAAA;AAAA,EAKQ,WAAW,KAAqB;AACpC,QAAI,OAAO;AACX,aAAS,IAAI,GAAG,IAAI,IAAI,QAAQ,KAAK;AACjC,YAAM,OAAO,IAAI,WAAW,CAAC;AAC7B,cAAS,QAAQ,KAAK,OAAQ;AAC9B,aAAO,OAAO;AAAA,IAClB;AACA,WAAO,KAAK,SAAS,EAAE;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,KAAkC;AAClC,QAAI,CAAC,KAAK,OAAO,QAAS,QAAO;AAEjC,UAAM,QAAQ,KAAK,MAAM,IAAI,GAAG;AAChC,QAAI,CAAC,MAAO,QAAO;AAGnB,QAAI,KAAK,IAAI,IAAI,MAAM,YAAY,KAAK,OAAO,KAAK;AAChD,WAAK,MAAM,OAAO,GAAG;AACrB,WAAK,sBAAsB,GAAG;AAC9B,aAAO;AAAA,IACX;AAGA,UAAM;AACN,SAAK,kBAAkB,GAAG;AAE1B,WAAO,MAAM;AAAA,EACjB;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,KAAa,UAA8B;AAC3C,QAAI,CAAC,KAAK,OAAO,QAAS;AAG1B,WAAO,KAAK,MAAM,QAAQ,KAAK,OAAO,YAAY;AAC9C,WAAK,YAAY;AAAA,IACrB;AAEA,SAAK,MAAM,IAAI,KAAK;AAAA,MAChB;AAAA,MACA,WAAW,KAAK,IAAI;AAAA,MACpB,MAAM;AAAA,IACV,CAAC;AAED,SAAK,YAAY,KAAK,GAAG;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKQ,kBAAkB,KAAmB;AACzC,SAAK,sBAAsB,GAAG;AAC9B,SAAK,YAAY,KAAK,GAAG;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKQ,sBAAsB,KAAmB;AAC7C,UAAM,QAAQ,KAAK,YAAY,QAAQ,GAAG;AAC1C,QAAI,QAAQ,IAAI;AACZ,WAAK,YAAY,OAAO,OAAO,CAAC;AAAA,IACpC;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKQ,cAAoB;AACxB,QAAI,KAAK,YAAY,WAAW,EAAG;AAEnC,UAAM,YAAY,KAAK,YAAY,MAAM;AACzC,SAAK,MAAM,OAAO,SAAS;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACV,SAAK,MAAM,MAAM;AACjB,SAAK,cAAc,CAAC;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA,EAKA,WAA+D;AAC3D,QAAI,YAAY;AAChB,QAAI,cAAc;AAElB,SAAK,MAAM,QAAQ,WAAS;AACxB,mBAAa,MAAM;AACnB,qBAAe,MAAM,OAAO;AAAA,IAChC,CAAC;AAED,WAAO;AAAA,MACH,MAAM,KAAK,MAAM;AAAA,MACjB,SAAS,KAAK,OAAO;AAAA,MACrB,SAAS,cAAc,IAAI,YAAY,cAAc;AAAA,IACzD;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,WAAW,KAAsB;AAC7B,UAAM,UAAU,KAAK,MAAM,IAAI,GAAG;AAClC,SAAK,MAAM,OAAO,GAAG;AACrB,SAAK,sBAAsB,GAAG;AAC9B,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,UAAkB;AACd,UAAM,MAAM,KAAK,IAAI;AACrB,QAAI,UAAU;AAEd,eAAW,CAAC,KAAK,KAAK,KAAK,KAAK,MAAM,QAAQ,GAAG;AAC7C,UAAI,MAAM,MAAM,YAAY,KAAK,OAAO,KAAK;AACzC,aAAK,MAAM,OAAO,GAAG;AACrB,aAAK,sBAAsB,GAAG;AAC9B;AAAA,MACJ;AAAA,IACJ;AAEA,WAAO;AAAA,EACX;AACJ;;;ACxKO,IAAM,oBAAN,MAAwB;AAAA,EAK3B,YAAY,UAAsD,CAAC,GAAG;AAJtE,wBAAQ,WAA0B,CAAC;AACnC,wBAAQ;AACR,wBAAQ;AAGJ,SAAK,aAAa,QAAQ,cAAc;AACxC,SAAK,UAAU,QAAQ,WAAW;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,OAA2B;AAC9B,QAAI,CAAC,KAAK,QAAS;AAEnB,SAAK,QAAQ,KAAK,KAAK;AAGvB,QAAI,KAAK,QAAQ,SAAS,KAAK,YAAY;AACvC,WAAK,QAAQ,MAAM;AAAA,IACvB;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAuC;AACnC,UAAM,QAA2B;AAAA,MAC7B,eAAe;AAAA,MACf,oBAAoB;AAAA,MACpB,gBAAgB;AAAA,MAChB,WAAW;AAAA,MACX,aAAa;AAAA,MACb,mBAAmB;AAAA,MACnB,uBAAuB;AAAA,MACvB,eAAe;AAAA,MACf,iBAAiB;AAAA,MACjB,YAAY,CAAC;AAAA,MACb,SAAS,CAAC;AAAA,IACd;AAEA,eAAW,QAAQ,KAAK,SAAS;AAC7B,YAAM;AACN,YAAM,iBAAiB,KAAK;AAE5B,UAAI,KAAK,SAAS;AACd,cAAM;AAAA,MACV,OAAO;AACH,cAAM;AAAA,MACV;AAEA,UAAI,KAAK,QAAQ;AACb,cAAM;AAAA,MACV;AAEA,UAAI,KAAK,OAAO;AACZ,cAAM,eAAe,KAAK,MAAM;AAChC,cAAM,qBAAqB,KAAK,MAAM;AACtC,cAAM,yBAAyB,KAAK,MAAM;AAAA,MAC9C;AAGA,UAAI,CAAC,MAAM,WAAW,KAAK,YAAY,GAAG;AACtC,cAAM,WAAW,KAAK,YAAY,IAAI;AAAA,UAClC,UAAU;AAAA,UACV,WAAW;AAAA,UACX,UAAU;AAAA,UACV,aAAa;AAAA,UACb,eAAe;AAAA,QACnB;AAAA,MACJ;AACA,YAAM,gBAAgB,MAAM,WAAW,KAAK,YAAY;AACxD,oBAAc;AACd,oBAAc,iBAAiB,KAAK;AACpC,UAAI,KAAK,QAAS,eAAc;AAAA,UAC3B,eAAc;AACnB,UAAI,KAAK,MAAO,eAAc,eAAe,KAAK,MAAM;AAGxD,UAAI,CAAC,MAAM,QAAQ,KAAK,KAAK,GAAG;AAC5B,cAAM,QAAQ,KAAK,KAAK,IAAI;AAAA,UACxB,UAAU;AAAA,UACV,WAAW;AAAA,UACX,UAAU;AAAA,UACV,aAAa;AAAA,UACb,yBAAyB;AAAA,QAC7B;AAAA,MACJ;AACA,YAAM,aAAa,MAAM,QAAQ,KAAK,KAAK;AAC3C,iBAAW;AACX,UAAI,KAAK,QAAS,YAAW;AAAA,UACxB,YAAW;AAChB,UAAI,KAAK,MAAO,YAAW,eAAe,KAAK,MAAM;AAAA,IACzD;AAGA,QAAI,MAAM,gBAAgB,GAAG;AACzB,YAAM,kBAAkB,MAAM,gBAAgB,MAAM;AAAA,IACxD;AAGA,eAAW,SAAS,MAAM,SAAS;AAC/B,YAAM,aAAa,MAAM,QAAQ,KAAK;AACtC,UAAI,WAAW,WAAW,GAAG;AACzB,mBAAW,0BAA0B,WAAW,cAAc,WAAW;AAAA,MAC7E;AAAA,IACJ;AAEA,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,QAAgB,IAAoB;AAC/C,WAAO,KAAK,QAAQ,MAAM,CAAC,KAAK;AAAA,EACpC;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAoB,WAAmB,SAAiC;AACpE,WAAO,KAAK,QAAQ;AAAA,MAChB,UAAQ,KAAK,aAAa,aAAa,KAAK,WAAW;AAAA,IAC3D;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,iBAAiC;AAC7B,WAAO,KAAK,QAAQ,OAAO,UAAQ,CAAC,KAAK,OAAO;AAAA,EACpD;AAAA;AAAA;AAAA;AAAA,EAKA,iBAAyB;AACrB,QAAI,KAAK,QAAQ,WAAW,EAAG,QAAO;AACtC,UAAM,aAAa,KAAK,QAAQ,OAAO,UAAQ,KAAK,OAAO,EAAE;AAC7D,WAAO,aAAa,KAAK,QAAQ;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA,EAKA,yBAAiC;AAC7B,QAAI,KAAK,QAAQ,WAAW,EAAG,QAAO;AACtC,UAAM,gBAAgB,KAAK,QAAQ,OAAO,CAAC,KAAK,SAAS,MAAM,KAAK,UAAU,CAAC;AAC/E,WAAO,gBAAgB,KAAK,QAAQ;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAKA,uBAAuD;AACnD,UAAM,UAAU;AAAA,MACZ,cAAc;AAAA,MACd,kBAAkB;AAAA,MAClB,aAAa;AAAA,MACb,OAAO;AAAA,IACX;AAEA,eAAW,QAAQ,KAAK,SAAS;AAC7B,UAAI,KAAK,OAAO;AACZ,gBAAQ,gBAAgB,KAAK,MAAM;AACnC,gBAAQ,oBAAoB,KAAK,MAAM;AACvC,gBAAQ,eAAe,KAAK,MAAM;AAClC,gBAAQ;AAAA,MACZ;AAAA,IACJ;AAEA,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACV,SAAK,UAAU,CAAC;AAAA,EACpB;AAAA;AAAA;AAAA;AAAA,EAKA,SAIE;AACE,WAAO;AAAA,MACH,SAAS,CAAC,GAAG,KAAK,OAAO;AAAA,MACzB,WAAW,KAAK,kBAAkB;AAAA,MAClC,YAAY,KAAK,IAAI;AAAA,IACzB;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,WAAW,SAAwB;AAC/B,SAAK,UAAU;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA,EAKA,YAAqB;AACjB,WAAO,KAAK;AAAA,EAChB;AACJ;;;AC0BO,IAAM,6BAA+C;AAAA,EACxD,gBAAgB;AAAA,EAChB,OAAO;AAAA,IACH,YAAY;AAAA,IACZ,gBAAgB;AAAA,IAChB,YAAY;AAAA,IACZ,mBAAmB;AAAA,IACnB,iBAAiB,CAAC,gBAAgB,aAAa,cAAc,gBAAgB,eAAe;AAAA,EAChG;AAAA,EACA,OAAO;AAAA,IACH,SAAS;AAAA,IACT,KAAK,IAAI,KAAK;AAAA;AAAA,IACd,YAAY;AAAA,EAChB;AAAA,EACA,WAAW;AAAA,IACP,SAAS;AAAA,IACT,UAAU;AAAA;AAAA,IACV,aAAa;AAAA,EACjB;AAAA,EACA,aAAa;AAAA,EACb,iBAAiB;AACrB;;;ACrPA,SAAS,oBAA4B;AACjC,SAAO,OAAO,KAAK,IAAI,EAAE,SAAS,EAAE,CAAC,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,CAAC,CAAC;AACnF;AAKA,SAASC,OAAM,IAA2B;AACtC,SAAO,IAAI,QAAQ,aAAW,WAAW,SAAS,EAAE,CAAC;AACzD;AAKA,SAAS,iBAAiB,OAAc,iBAAoC;AACxE,QAAM,eAAe,MAAM,QAAQ,YAAY;AAC/C,SAAO,gBAAgB,KAAK,QAAM,aAAa,SAAS,GAAG,YAAY,CAAC,CAAC;AAC7E;AAUO,IAAM,aAAN,MAAiB;AAAA,EAapB,YACI,UACA,SAAoC,CAAC,GACvC;AAfF,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AACR,wBAAQ;AACR,wBAAQ,sBAA6C,CAAC;AACtD,wBAAQ,uBAA+C,CAAC;AACxD,wBAAQ,oBAAyC,CAAC;AAClD,wBAAQ,kBAAyD;AAAA,MAC7D,OAAO;AAAA,MACP,aAAa,KAAK,IAAI;AAAA,IAC1B;AAMI,SAAK,WAAW;AAChB,SAAK,SAAS,EAAE,GAAG,4BAA4B,GAAG,OAAO;AACzD,SAAK,QAAQ,IAAI,SAAS,KAAK,OAAO,KAAK;AAC3C,SAAK,QAAQ,IAAI,kBAAkB;AAAA,MAC/B,YAAY,KAAK,OAAO;AAAA,MACxB,SAAS,KAAK,OAAO;AAAA,IACzB,CAAC;AAAA,EACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,KACF,SACA,UAA6B,CAAC,GACZ;AAClB,UAAM,YAAY,kBAAkB;AACpC,UAAM,YAAY,KAAK,IAAI;AAE3B,UAAM,UAA6B;AAAA,MAC/B;AAAA,MACA;AAAA,MACA,cAAc,KAAK,SAAS,gBAAgB;AAAA,MAC5C,OAAO,KAAK,SAAS,SAAS;AAAA,MAC9B,YAAY;AAAA,MACZ;AAAA,MACA;AAAA,IACJ;AAEA,QAAI;AAEA,YAAM,KAAK,eAAe;AAG1B,UAAI,CAAC,QAAQ,WAAW;AACpB,cAAM,WAAW,KAAK,MAAM,YAAY,OAAO;AAC/C,cAAM,SAAS,KAAK,MAAM,IAAI,QAAQ;AACtC,YAAI,QAAQ;AACR,gBAAMC,UAAS,KAAK,aAAa,QAAQ,SAAS,IAAI;AACtD,eAAK,YAAY,SAASA,SAAQ,IAAI;AACtC,iBAAOA;AAAA,QACX;AAAA,MACJ;AAGA,UAAI,mBAAmB;AACvB,iBAAW,cAAc,KAAK,oBAAoB;AAC9C,2BAAmB,MAAM,WAAW,QAAQ,kBAAkB,OAAO;AAAA,MACzE;AAGA,YAAM,WAAW,MAAM,KAAK,iBAAiB,kBAAkB,SAAS,OAAO;AAG/E,UAAI,oBAAoB;AACxB,iBAAW,cAAc,KAAK,qBAAqB;AAC/C,4BAAoB,MAAM,WAAW,QAAQ,mBAAmB,OAAO;AAAA,MAC3E;AAGA,UAAI,CAAC,QAAQ,WAAW;AACpB,cAAM,WAAW,KAAK,MAAM,YAAY,OAAO;AAC/C,aAAK,MAAM,IAAI,UAAU,iBAAiB;AAAA,MAC9C;AAEA,YAAM,SAAS,KAAK,aAAa,mBAAmB,SAAS,KAAK;AAClE,WAAK,YAAY,SAAS,QAAQ,IAAI;AACtC,aAAO;AAAA,IAEX,SAAS,OAAO;AAEZ,iBAAW,cAAc,KAAK,kBAAkB;AAC5C,cAAM,YAAY,MAAM,WAAW,QAAQ,OAAgB,OAAO;AAClE,YAAI,WAAW;AACX,gBAAM,SAAS,KAAK,aAAa,WAAW,SAAS,KAAK;AAC1D,eAAK,YAAY,SAAS,QAAQ,IAAI;AACtC,iBAAO;AAAA,QACX;AAAA,MACJ;AAGA,WAAK,YAAY,SAAS,MAAM,OAAQ,MAAgB,OAAO;AAC/D,YAAM;AAAA,IACV;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,WACF,SACA,UAA6B,CAAC,GACN;AACxB,UAAM,YAAY,kBAAkB;AACpC,UAAM,YAAY,KAAK,IAAI;AAC3B,QAAI,UAAU;AAEd,UAAM,UAA6B;AAAA,MAC/B;AAAA,MACA;AAAA,MACA,cAAc,KAAK,SAAS,gBAAgB;AAAA,MAC5C,OAAO,KAAK,SAAS,SAAS;AAAA,MAC9B,YAAY;AAAA,MACZ;AAAA,MACA;AAAA,IACJ;AAGA,UAAM,KAAK,eAAe;AAG1B,QAAI,mBAAmB;AACvB,eAAW,cAAc,KAAK,oBAAoB;AAC9C,yBAAmB,MAAM,WAAW,QAAQ,kBAAkB,OAAO;AAAA,IACzE;AAGA,UAAM,OAAO;AACb,oBAAgB,gBAAiD;AAC7D,UAAI;AACA,cAAM,SAAS,KAAK,SAAS,WAAW,gBAAgB;AACxD,yBAAiB,SAAS,QAAQ;AAC9B,cAAI,WAAW,QAAQ,QAAQ,SAAS;AACpC;AAAA,UACJ;AACA,gBAAM;AAAA,QACV;AAAA,MACJ,SAAS,OAAO;AACZ,aAAK,YAAY,SAAS,MAAM,OAAQ,MAAgB,OAAO;AAC/D,cAAM;AAAA,MACV;AAAA,IACJ;AAEA,WAAO;AAAA,MACH;AAAA,MACA,QAAQ,cAAc;AAAA,MACtB,OAAO,MAAM;AACT,kBAAU;AAAA,MACd;AAAA,IACJ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SACF,QACA,cACA,UAA6B,CAAC,GACf;AACf,UAAM,WAAW,CAAC;AAClB,QAAI,cAAc;AACd,eAAS,KAAK,EAAE,MAAM,UAAmB,SAAS,aAAa,CAAC;AAAA,IACpE;AACA,aAAS,KAAK,EAAE,MAAM,QAAiB,SAAS,OAAO,CAAC;AAExD,UAAM,SAAS,MAAM,KAAK,KAAK,EAAE,SAAS,GAAG,OAAO;AACpD,WAAO,OAAO;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,WAAW,YAAwC;AAC/C,SAAK,mBAAmB,KAAK,UAAU;AACvC,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,YAAyC;AACjD,SAAK,oBAAoB,KAAK,UAAU;AACxC,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,YAAsC;AAC3C,SAAK,iBAAiB,KAAK,UAAU;AACrC,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA,EAKA,iBAAiB,MAAuB;AACpC,QAAI,UAAU;AAEd,UAAM,kBAAkB,CAA6B,QAAkB;AACnE,YAAM,QAAQ,IAAI,UAAU,OAAK,EAAE,SAAS,IAAI;AAChD,UAAI,QAAQ,IAAI;AACZ,YAAI,OAAO,OAAO,CAAC;AACnB,kBAAU;AAAA,MACd;AACA,aAAO;AAAA,IACX;AAEA,SAAK,qBAAqB,gBAAgB,KAAK,kBAAkB;AACjE,SAAK,sBAAsB,gBAAgB,KAAK,mBAAmB;AACnE,SAAK,mBAAmB,gBAAgB,KAAK,gBAAgB;AAE7D,WAAO;AAAA,EACX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,WAA8B;AAC1B,WAAO,KAAK,MAAM,kBAAkB;AAAA,EACxC;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,QAAgB,IAAoB;AAC/C,WAAO,KAAK,MAAM,eAAe,KAAK;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA,EAKA,cAAc;AACV,WAAO,KAAK,MAAM,OAAO;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA,EAKA,aAAmB;AACf,SAAK,MAAM,MAAM;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA,EAKA,aAAmB;AACf,SAAK,MAAM,MAAM;AAAA,EACrB;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB;AACZ,WAAO,KAAK,MAAM,SAAS;AAAA,EAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,cAA2B;AACvB,WAAO,KAAK;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKA,kBAA0B;AACtB,WAAO,KAAK,SAAS,gBAAgB;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,WAAmB;AACf,WAAO,KAAK,SAAS,SAAS;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAc,iBACV,SACA,SACA,SACqB;AACrB,UAAM,aAAa,QAAQ,cAAc,KAAK,OAAO,MAAM;AAC3D,UAAM,UAAU,QAAQ,WAAW,KAAK,OAAO;AAC/C,QAAI,YAA0B;AAE9B,aAAS,UAAU,GAAG,WAAW,YAAY,WAAW;AACpD,cAAQ,aAAa;AAErB,UAAI;AAEA,cAAM,iBAAiB,IAAI,QAAe,CAAC,GAAG,WAAW;AACrD,qBAAW,MAAM,OAAO,IAAI,MAAM,iBAAiB,CAAC,GAAG,OAAO;AAAA,QAClE,CAAC;AAGD,cAAM,iBAAiB,KAAK,SAAS,KAAK,OAAO;AAGjD,cAAM,WAAW,MAAM,QAAQ,KAAK,CAAC,gBAAgB,cAAc,CAAC;AACpE,eAAO;AAAA,MAEX,SAAS,OAAO;AACZ,oBAAY;AAGZ,YAAI,QAAQ,QAAQ,SAAS;AACzB,gBAAM,IAAI,MAAM,iBAAiB;AAAA,QACrC;AAGA,YAAI,UAAU,cAAc,iBAAiB,WAAW,KAAK,OAAO,MAAM,eAAe,GAAG;AACxF,gBAAM,UAAU,KAAK;AAAA,YACjB,KAAK,OAAO,MAAM,iBAAiB,KAAK,IAAI,KAAK,OAAO,MAAM,mBAAmB,OAAO;AAAA,YACxF,KAAK,OAAO,MAAM;AAAA,UACtB;AACA,gBAAMD,OAAM,OAAO;AACnB;AAAA,QACJ;AAEA,cAAM;AAAA,MACV;AAAA,IACJ;AAEA,UAAM,aAAa,IAAI,MAAM,sBAAsB;AAAA,EACvD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,iBAAgC;AAC1C,QAAI,CAAC,KAAK,OAAO,UAAU,QAAS;AAEpC,UAAM,MAAM,KAAK,IAAI;AAGrB,QAAI,MAAM,KAAK,eAAe,eAAe,KAAK,OAAO,UAAU,UAAU;AACzE,WAAK,iBAAiB,EAAE,OAAO,GAAG,aAAa,IAAI;AAAA,IACvD;AAGA,QAAI,KAAK,eAAe,SAAS,KAAK,OAAO,UAAU,aAAa;AAChE,YAAM,WAAW,KAAK,OAAO,UAAU,YAAY,MAAM,KAAK,eAAe;AAC7E,UAAI,WAAW,GAAG;AACd,cAAMA,OAAM,QAAQ;AACpB,aAAK,iBAAiB,EAAE,OAAO,GAAG,aAAa,KAAK,IAAI,EAAE;AAAA,MAC9D;AAAA,IACJ;AAEA,SAAK,eAAe;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA,EAKQ,aACJ,UACA,SACA,QACS;AACT,WAAO;AAAA,MACH,GAAG;AAAA,MACH,WAAW,QAAQ;AAAA,MACnB,UAAU,KAAK,IAAI,IAAI,QAAQ;AAAA,MAC/B;AAAA,MACA,YAAY,QAAQ;AAAA,IACxB;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKQ,YACJ,SACA,QACA,SACA,OACI;AACJ,SAAK,MAAM,OAAO;AAAA,MACd,WAAW,QAAQ;AAAA,MACnB,cAAc,QAAQ;AAAA,MACtB,OAAO,QAAQ;AAAA,MACf,WAAW,QAAQ;AAAA,MACnB,SAAS,KAAK,IAAI;AAAA,MAClB,UAAU,KAAK,IAAI,IAAI,QAAQ;AAAA,MAC/B,OAAO,QAAQ;AAAA,MACf;AAAA,MACA,QAAQ,QAAQ,UAAU;AAAA,MAC1B,YAAY,QAAQ;AAAA,MACpB;AAAA,IACJ,CAAC;AAAA,EACL;AACJ;AASO,SAAS,iBACZ,UACA,SAAoC,CAAC,GAC3B;AACV,SAAO,IAAI,WAAW,UAAU,MAAM;AAC1C;;;AC1dO,SAAS,+BACZ,SAAoD,QAAQ,KACxC;AACpB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,SAAsB,SAAyC;AACnE,aAAO,iBAAiB,QAAQ,SAAS,IAAI;AAAA,QACzC,UAAU,QAAQ;AAAA,QAClB,OAAO,QAAQ;AAAA,QACf,cAAc,QAAQ,SAAS;AAAA,MACnC,CAAC;AACD,aAAO;AAAA,IACX;AAAA,EACJ;AACJ;AAKO,SAAS,gCACZ,SAAoD,QAAQ,KACvC;AACrB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,UAAwB,SAA0C;AACtE,aAAO,kBAAkB,QAAQ,SAAS,IAAI;AAAA,QAC1C,UAAU,KAAK,IAAI,IAAI,QAAQ;AAAA,QAC/B,eAAe,SAAS,QAAQ;AAAA,QAChC,OAAO,SAAS;AAAA,MACpB,CAAC;AACD,aAAO;AAAA,IACX;AAAA,EACJ;AACJ;AAKO,SAAS,wBACZ,SAAoD,QAAQ,KACM;AAClE,SAAO;AAAA,IACH,SAAS,+BAA+B,MAAM;AAAA,IAC9C,UAAU,gCAAgC,MAAM;AAAA,EACpD;AACJ;AAKO,SAAS,6BACZ,cACA,UAAqD,CAAC,GAClC;AACpB,QAAM,EAAE,UAAU,MAAM,WAAW,MAAM,IAAI;AAE7C,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,SAAsB,UAA0C;AACpE,YAAM,WAAW,CAAC,GAAG,QAAQ,QAAQ;AACrC,YAAM,sBAAsB,SAAS,UAAU,OAAK,EAAE,SAAS,QAAQ;AAEvE,UAAI,YAAY,wBAAwB,IAAI;AACxC,cAAM,gBAAgB,EAAE,MAAM,UAAmB,SAAS,aAAa;AAEvE,YAAI,sBAAsB,IAAI;AAC1B,mBAAS,mBAAmB,IAAI;AAAA,QACpC,WAAW,SAAS;AAChB,mBAAS,QAAQ,aAAa;AAAA,QAClC,OAAO;AACH,mBAAS,KAAK,aAAa;AAAA,QAC/B;AAAA,MACJ;AAEA,aAAO,EAAE,GAAG,SAAS,SAAS;AAAA,IAClC;AAAA,EACJ;AACJ;AAKO,SAAS,8BACZ,gBACoB;AACpB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,SAAsB,UAA0C;AACpE,YAAM,WAAW,QAAQ,SAAS,IAAI,SAAO;AACzC,YAAI,UAAU,IAAI;AAClB,mBAAW,EAAE,SAAS,YAAY,KAAK,gBAAgB;AACnD,oBAAU,QAAQ,QAAQ,SAAS,WAAW;AAAA,QAClD;AACA,eAAO,EAAE,GAAG,KAAK,QAAQ;AAAA,MAC7B,CAAC;AAED,aAAO,EAAE,GAAG,SAAS,SAAS;AAAA,IAClC;AAAA,EACJ;AACJ;AAKO,SAAS,2BACZ,aACA,UAAgE,CAAC,GAC7C;AACpB,QAAM,EAAE,mBAAmB,MAAM,cAAc,EAAE,IAAI;AAErD,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,SAAsB,UAA0C;AACpE,UAAI,QAAQ,SAAS,UAAU,aAAa;AACxC,eAAO;AAAA,MACX;AAEA,UAAI,WAAW,QAAQ;AACvB,YAAM,gBAAgB,mBAChB,SAAS,KAAK,OAAK,EAAE,SAAS,QAAQ,IACtC;AAGN,YAAM,oBAAoB,SAAS,OAAO,OAAK,EAAE,SAAS,QAAQ;AAGlE,YAAM,oBAAoB,kBAAkB,MAAM,CAAC,WAAW;AAG9D,iBAAW,gBACL,CAAC,eAAe,GAAG,iBAAiB,IACpC;AAEN,aAAO,EAAE,GAAG,SAAS,SAAS;AAAA,IAClC;AAAA,EACJ;AACJ;AASO,SAAS,2BACZ,WACA,WACqB;AACrB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,UAAwB,UAA2C;AACvE,UAAI,CAAC,UAAU,SAAS,OAAO,GAAG;AAC9B,YAAI,WAAW;AACX,iBAAO,EAAE,GAAG,UAAU,SAAS,UAAU,SAAS,OAAO,EAAE;AAAA,QAC/D;AACA,cAAM,IAAI,MAAM,4BAA4B;AAAA,MAChD;AACA,aAAO;AAAA,IACX;AAAA,EACJ;AACJ;AAKO,SAAS,0BACZ,aACqB;AACrB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,UAAwB,UAA2C;AACvE,aAAO,EAAE,GAAG,UAAU,SAAS,YAAY,SAAS,OAAO,EAAE;AAAA,IACjE;AAAA,EACJ;AACJ;AAKO,SAAS,0BACZ,UAAwD,CAAC,GACpC;AACrB,QAAM,EAAE,SAAS,OAAO,eAAe,KAAK,IAAI;AAEhD,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,UAAwB,UAA2C;AACvE,UAAI;AAEA,cAAM,YAAY,SAAS,QAAQ,MAAM,iCAAiC;AAC1E,cAAM,cAAc,YAAY,UAAU,CAAC,IAAI,SAAS;AAExD,cAAM,SAAS,KAAK,MAAM,WAAW;AACrC,eAAO;AAAA,UACH,GAAG;AAAA,UACH,SAAS,KAAK,UAAU,MAAM;AAAA;AAAA,QAClC;AAAA,MACJ,SAAS,OAAO;AACZ,YAAI,QAAQ;AACR,gBAAM,IAAI,MAAM,kCAAkC,KAAK,EAAE;AAAA,QAC7D;AACA,eAAO;AAAA,UACH,GAAG;AAAA,UACH,SAAS,KAAK,UAAU,YAAY;AAAA,QACxC;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;AASO,SAAS,yBACZ,iBACkB;AAClB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,OAAc,SAA0C;AAC5D,YAAM,UAAU,OAAO,oBAAoB,aACrC,gBAAgB,OAAO,OAAO,IAC9B;AAEN,aAAO;AAAA,QACH;AAAA,QACA,cAAc;AAAA,MAClB;AAAA,IACJ;AAAA,EACJ;AACJ;AAKO,SAAS,6BACZ,SAA8E,QAAQ,OACpE;AAClB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,OAAc,SAAkC;AACpD,aAAO,0BAA0B,QAAQ,SAAS,IAAI,OAAO,OAAO;AACpE,aAAO;AAAA,IACX;AAAA,EACJ;AACJ;AAKO,SAAS,+BACZ,aACkB;AAClB,SAAO;AAAA,IACH,MAAM;AAAA,IACN,QAAQ,OAAc,SAAkC;AACpD,YAAM,YAAY,OAAO,OAAO;AAAA,IACpC;AAAA,EACJ;AACJ;",
  "names": ["ErrorType", "util", "objectUtil", "errorUtil", "errorMap", "ctx", "result", "issues", "elements", "processed", "result", "r", "ZodFirstPartyTypeKind", "nextStepIndex", "totalSteps", "progress", "newState", "isValid", "sleep", "result"]
}
